!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RongIMLib={})}(this,(function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")(),o={},i=function(e){try{return!!e()}catch(e){return!0}},s=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),c=a,u=Function.prototype.call,d=c?u.bind(u):function(){return u.apply(u,arguments)},l={},h={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,p=f&&!h.call({1:2},1);l.f=p?function(e){var t=f(this,e);return!!t&&t.enumerable}:h;var v,_,E=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},m=a,T=Function.prototype,I=T.call,y=m&&T.bind.bind(I,I),R=m?y:function(e){return function(){return I.apply(e,arguments)}},C=R,S=C({}.toString),O=C("".slice),N=function(e){return O(S(e),8,-1)},A=i,M=N,U=Object,L=R("".split),w=A((function(){return!U("z").propertyIsEnumerable(0)}))?function(e){return"String"==M(e)?L(e,""):U(e)}:U,b=function(e){return null==e},P=b,D=TypeError,B=function(e){if(P(e))throw D("Can't call method on "+e);return e},V=w,x=B,G=function(e){return V(x(e))},k="object"==typeof document&&document.all,F={all:k,IS_HTMLDDA:void 0===k&&void 0!==k},H=F.all,q=F.IS_HTMLDDA?function(e){return"function"==typeof e||e===H}:function(e){return"function"==typeof e},K=q,j=F.all,Y=F.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:K(e)||e===j}:function(e){return"object"==typeof e?null!==e:K(e)},J=r,Q=q,W=function(e){return Q(e)?e:void 0},Z=function(e,t){return arguments.length<2?W(J[e]):J[e]&&J[e][t]},z=R({}.isPrototypeOf),X=Z("navigator","userAgent")||"",$=r,ee=X,te=$.process,ne=$.Deno,re=te&&te.versions||ne&&ne.version,oe=re&&re.v8;oe&&(_=(v=oe.split("."))[0]>0&&v[0]<4?1:+(v[0]+v[1])),!_&&ee&&(!(v=ee.match(/Edge\/(\d+)/))||v[1]>=74)&&(v=ee.match(/Chrome\/(\d+)/))&&(_=+v[1]);var ie=_,se=ie,ae=i,ce=!!Object.getOwnPropertySymbols&&!ae((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&se&&se<41})),ue=ce&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,de=Z,le=q,he=z,fe=Object,ge=ue?function(e){return"symbol"==typeof e}:function(e){var t=de("Symbol");return le(t)&&he(t.prototype,fe(e))},pe=String,ve=function(e){try{return pe(e)}catch(e){return"Object"}},_e=q,Ee=ve,me=TypeError,Te=function(e){if(_e(e))return e;throw me(Ee(e)+" is not a function")},Ie=Te,ye=b,Re=function(e,t){var n=e[t];return ye(n)?void 0:Ie(n)},Ce=d,Se=q,Oe=Y,Ne=TypeError,Ae={exports:{}},Me=r,Ue=Object.defineProperty,Le=function(e,t){try{Ue(Me,e,{value:t,configurable:!0,writable:!0})}catch(n){Me[e]=t}return t},we=Le,be="__core-js_shared__",Pe=r[be]||we(be,{}),De=Pe;(Ae.exports=function(e,t){return De[e]||(De[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Be=B,Ve=Object,xe=function(e){return Ve(Be(e))},Ge=xe,ke=R({}.hasOwnProperty),Fe=Object.hasOwn||function(e,t){return ke(Ge(e),t)},He=R,qe=0,Ke=Math.random(),je=He(1..toString),Ye=function(e){return"Symbol("+(void 0===e?"":e)+")_"+je(++qe+Ke,36)},Je=r,Qe=Ae.exports,We=Fe,Ze=Ye,ze=ce,Xe=ue,$e=Qe("wks"),et=Je.Symbol,nt=et&&et.for,rt=Xe?et:et&&et.withoutSetter||Ze,ot=function(e){if(!We($e,e)||!ze&&"string"!=typeof $e[e]){var t="Symbol."+e;ze&&We(et,e)?$e[e]=et[e]:$e[e]=Xe&&nt?nt(t):rt(t)}return $e[e]},it=d,st=Y,at=ge,ct=Re,ut=function(e,t){var n,r;if("string"===t&&Se(n=e.toString)&&!Oe(r=Ce(n,e)))return r;if(Se(n=e.valueOf)&&!Oe(r=Ce(n,e)))return r;if("string"!==t&&Se(n=e.toString)&&!Oe(r=Ce(n,e)))return r;throw Ne("Can't convert object to primitive value")},dt=TypeError,lt=ot("toPrimitive"),ht=function(e,t){if(!st(e)||at(e))return e;var n,r=ct(e,lt);if(r){if(void 0===t&&(t="default"),n=it(r,e,t),!st(n)||at(n))return n;throw dt("Can't convert object to primitive value")}return void 0===t&&(t="number"),ut(e,t)},ft=ht,gt=ge,pt=function(e){var t=ft(e,"string");return gt(t)?t:t+""},vt=Y,_t=r.document,Et=vt(_t)&&vt(_t.createElement),mt=function(e){return Et?_t.createElement(e):{}},Tt=mt,It=!s&&!i((function(){return 7!=Object.defineProperty(Tt("div"),"a",{get:function(){return 7}}).a})),yt=s,Rt=d,Ct=l,St=E,Ot=G,Nt=pt,At=Fe,Mt=It,Ut=Object.getOwnPropertyDescriptor;o.f=yt?Ut:function(e,t){if(e=Ot(e),t=Nt(t),Mt)try{return Ut(e,t)}catch(e){}if(At(e,t))return St(!Rt(Ct.f,e,t),e[t])};var Lt={},wt=s&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),bt=Y,Pt=String,Dt=TypeError,Bt=function(e){if(bt(e))return e;throw Dt(Pt(e)+" is not an object")},Vt=s,xt=It,Gt=wt,kt=Bt,Ft=pt,Ht=TypeError,qt=Object.defineProperty,Kt=Object.getOwnPropertyDescriptor,jt="enumerable",Yt="configurable",Jt="writable";Lt.f=Vt?Gt?function(e,t,n){if(kt(e),t=Ft(t),kt(n),"function"==typeof e&&"prototype"===t&&"value"in n&&Jt in n&&!n[Jt]){var r=Kt(e,t);r&&r[Jt]&&(e[t]=n.value,n={configurable:Yt in n?n[Yt]:r[Yt],enumerable:jt in n?n[jt]:r[jt],writable:!1})}return qt(e,t,n)}:qt:function(e,t,n){if(kt(e),t=Ft(t),kt(n),xt)try{return qt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Ht("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Qt=Lt,Wt=E,Zt=s?function(e,t,n){return Qt.f(e,t,Wt(1,n))}:function(e,t,n){return e[t]=n,e},zt={exports:{}},Xt=s,$t=Fe,en=Function.prototype,tn=Xt&&Object.getOwnPropertyDescriptor,nn=$t(en,"name"),rn={EXISTS:nn,PROPER:nn&&"something"===function(){}.name,CONFIGURABLE:nn&&(!Xt||Xt&&tn(en,"name").configurable)},on=q,sn=Pe,an=R(Function.toString);on(sn.inspectSource)||(sn.inspectSource=function(e){return an(e)});var cn,un,dn,ln=sn.inspectSource,hn=q,fn=r.WeakMap,gn=hn(fn)&&/native code/.test(String(fn)),pn=Ae.exports,vn=Ye,_n=pn("keys"),En=function(e){return _n[e]||(_n[e]=vn(e))},mn={},Tn=gn,In=r,yn=Y,Rn=Zt,Cn=Fe,Sn=Pe,On=En,Nn=mn,An="Object already initialized",Mn=In.TypeError,Un=In.WeakMap;if(Tn||Sn.state){var Ln=Sn.state||(Sn.state=new Un);Ln.get=Ln.get,Ln.has=Ln.has,Ln.set=Ln.set,cn=function(e,t){if(Ln.has(e))throw Mn(An);return t.facade=e,Ln.set(e,t),t},un=function(e){return Ln.get(e)||{}},dn=function(e){return Ln.has(e)}}else{var wn=On("state");Nn[wn]=!0,cn=function(e,t){if(Cn(e,wn))throw Mn(An);return t.facade=e,Rn(e,wn,t),t},un=function(e){return Cn(e,wn)?e[wn]:{}},dn=function(e){return Cn(e,wn)}}var bn={set:cn,get:un,has:dn,enforce:function(e){return dn(e)?un(e):cn(e,{})},getterFor:function(e){return function(t){var n;if(!yn(t)||(n=un(t)).type!==e)throw Mn("Incompatible receiver, "+e+" required");return n}}},Pn=i,Dn=q,Bn=Fe,Vn=s,xn=rn.CONFIGURABLE,Gn=ln,kn=bn.enforce,Fn=bn.get,Hn=Object.defineProperty,qn=Vn&&!Pn((function(){return 8!==Hn((function(){}),"length",{value:8}).length})),Kn=String(String).split("String"),jn=zt.exports=function(e,t,n){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(t="get "+t),n&&n.setter&&(t="set "+t),(!Bn(e,"name")||xn&&e.name!==t)&&(Vn?Hn(e,"name",{value:t,configurable:!0}):e.name=t),qn&&n&&Bn(n,"arity")&&e.length!==n.arity&&Hn(e,"length",{value:n.arity});try{n&&Bn(n,"constructor")&&n.constructor?Vn&&Hn(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=kn(e);return Bn(r,"source")||(r.source=Kn.join("string"==typeof t?t:"")),e};Function.prototype.toString=jn((function(){return Dn(this)&&Fn(this).source||Gn(this)}),"toString");var Yn=q,Jn=Lt,Qn=zt.exports,Wn=Le,Zn=function(e,t,n,r){r||(r={});var o=r.enumerable,i=void 0!==r.name?r.name:t;if(Yn(n)&&Qn(n,i,r),r.global)o?e[t]=n:Wn(t,n);else{try{r.unsafe?e[t]&&(o=!0):delete e[t]}catch(e){}o?e[t]=n:Jn.f(e,t,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},zn={},Xn=Math.ceil,$n=Math.floor,er=Math.trunc||function(e){var t=+e;return(t>0?$n:Xn)(t)},tr=function(e){var t=+e;return t!=t||0===t?0:er(t)},nr=tr,rr=Math.max,or=Math.min,ir=function(e,t){var n=nr(e);return n<0?rr(n+t,0):or(n,t)},sr=tr,ar=Math.min,cr=function(e){return e>0?ar(sr(e),9007199254740991):0},ur=cr,dr=function(e){return ur(e.length)},lr=G,hr=ir,fr=dr,gr=function(e){return function(t,n,r){var o,i=lr(t),s=fr(i),a=hr(r,s);if(e&&n!=n){for(;s>a;)if((o=i[a++])!=o)return!0}else for(;s>a;a++)if((e||a in i)&&i[a]===n)return e||a||0;return!e&&-1}},pr={includes:gr(!0),indexOf:gr(!1)},vr=Fe,_r=G,Er=pr.indexOf,mr=mn,Tr=R([].push),Ir=function(e,t){var n,r=_r(e),o=0,i=[];for(n in r)!vr(mr,n)&&vr(r,n)&&Tr(i,n);for(;t.length>o;)vr(r,n=t[o++])&&(~Er(i,n)||Tr(i,n));return i},yr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Rr=Ir,Cr=yr.concat("length","prototype");zn.f=Object.getOwnPropertyNames||function(e){return Rr(e,Cr)};var Sr={};Sr.f=Object.getOwnPropertySymbols;var Or,Nr=Z,Ar=zn,Mr=Sr,Ur=Bt,Lr=R([].concat),wr=Nr("Reflect","ownKeys")||function(e){var t=Ar.f(Ur(e)),n=Mr.f;return n?Lr(t,n(e)):t},br=Fe,Pr=wr,Dr=o,Br=Lt,Vr=i,xr=q,Gr=/#|\.prototype\./,kr=function(e,t){var n=Hr[Fr(e)];return n==Kr||n!=qr&&(xr(t)?Vr(t):!!t)},Fr=kr.normalize=function(e){return String(e).replace(Gr,".").toLowerCase()},Hr=kr.data={},qr=kr.NATIVE="N",Kr=kr.POLYFILL="P",jr=kr,Yr=r,Jr=o.f,Qr=Zt,Wr=Zn,Zr=Le,zr=function(e,t,n){for(var r=Pr(t),o=Br.f,i=Dr.f,s=0;s<r.length;s++){var a=r[s];br(e,a)||n&&br(n,a)||o(e,a,i(t,a))}},Xr=jr,$r=function(e,t){var n,r,o,i,s,a=e.target,c=e.global,u=e.stat;if(n=c?Yr:u?Yr[a]||Zr(a,{}):(Yr[a]||{}).prototype)for(r in t){if(i=t[r],o=e.dontCallGetSet?(s=Jr(n,r))&&s.value:n[r],!Xr(c?r:a+(u?".":"#")+r,e.forced)&&void 0!==o){if(typeof i==typeof o)continue;zr(i,o)}(e.sham||o&&o.sham)&&Qr(i,"sham",!0),Wr(n,r,i,e)}},eo=r;$r({global:!0,forced:eo.globalThis!==eo},{globalThis:eo}),function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(Or||(Or={}));var to=Or;function no(e){return no="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},no(e)}var ro={};ro[ot("toStringTag")]="z";var oo="[object z]"===String(ro),io=oo,so=q,ao=N,co=ot("toStringTag"),uo=Object,lo="Arguments"==ao(function(){return arguments}()),ho=io?ao:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=uo(e),co))?n:lo?ao(t):"Object"==(r=ao(t))&&so(t.callee)?"Arguments":r},fo=ho,go=String,po=function(e){if("Symbol"===fo(e))throw TypeError("Cannot convert a Symbol value to a string");return go(e)},vo=Bt,_o=function(){var e=vo(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Eo=i,mo=r.RegExp,To=Eo((function(){var e=mo("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),Io=To||Eo((function(){return!mo("a","y").sticky})),yo={BROKEN_CARET:To||Eo((function(){var e=mo("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:Io,UNSUPPORTED_Y:To},Ro={},Co=Ir,So=yr,Oo=Object.keys||function(e){return Co(e,So)},No=s,Ao=wt,Mo=Lt,Uo=Bt,Lo=G,wo=Oo;Ro.f=No&&!Ao?Object.defineProperties:function(e,t){Uo(e);for(var n,r=Lo(t),o=wo(t),i=o.length,s=0;i>s;)Mo.f(e,n=o[s++],r[n]);return e};var bo,Po=Z("document","documentElement"),Do=Bt,Bo=Ro,Vo=yr,xo=mn,Go=Po,ko=mt,Fo="prototype",Ho="script",qo=En("IE_PROTO"),Ko=function(){},jo=function(e){return"<"+Ho+">"+e+"</"+Ho+">"},Yo=function(e){e.write(jo("")),e.close();var t=e.parentWindow.Object;return e=null,t},Jo=function(){try{bo=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;Jo="undefined"!=typeof document?document.domain&&bo?Yo(bo):(t=ko("iframe"),n="java"+Ho+":",t.style.display="none",Go.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(jo("document.F=Object")),e.close(),e.F):Yo(bo);for(var r=Vo.length;r--;)delete Jo[Fo][Vo[r]];return Jo()};xo[qo]=!0;var Qo=Object.create||function(e,t){var n;return null!==e?(Ko[Fo]=Do(e),n=new Ko,Ko[Fo]=null,n[qo]=e):n=Jo(),void 0===t?n:Bo.f(n,t)},Wo=i,Zo=r.RegExp,zo=Wo((function(){var e=Zo(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Xo=i,$o=r.RegExp,ei=Xo((function(){var e=$o("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),ti=d,ni=R,ri=po,oi=_o,ii=yo,si=Ae.exports,ai=Qo,ci=bn.get,ui=zo,di=ei,li=si("native-string-replace",String.prototype.replace),hi=RegExp.prototype.exec,fi=hi,gi=ni("".charAt),pi=ni("".indexOf),vi=ni("".replace),_i=ni("".slice),Ei=function(){var e=/a/,t=/b*/g;return ti(hi,e,"a"),ti(hi,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),mi=ii.BROKEN_CARET,Ti=void 0!==/()??/.exec("")[1];(Ei||Ti||mi||ui||di)&&(fi=function(e){var t,n,r,o,i,s,a,c=this,u=ci(c),d=ri(e),l=u.raw;if(l)return l.lastIndex=c.lastIndex,t=ti(fi,l,d),c.lastIndex=l.lastIndex,t;var h=u.groups,f=mi&&c.sticky,g=ti(oi,c),p=c.source,v=0,_=d;if(f&&(g=vi(g,"y",""),-1===pi(g,"g")&&(g+="g"),_=_i(d,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==gi(d,c.lastIndex-1))&&(p="(?: "+p+")",_=" "+_,v++),n=new RegExp("^(?:"+p+")",g)),Ti&&(n=new RegExp("^"+p+"$(?!\\s)",g)),Ei&&(r=c.lastIndex),o=ti(hi,f?n:c,_),f?o?(o.input=_i(o.input,v),o[0]=_i(o[0],v),o.index=c.lastIndex,c.lastIndex+=o[0].length):c.lastIndex=0:Ei&&o&&(c.lastIndex=c.global?o.index+o[0].length:r),Ti&&o&&o.length>1&&ti(li,o[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=s=ai(null),i=0;i<h.length;i++)s[(a=h[i])[0]]=o[a[1]];return o});var Ii=fi;$r({target:"RegExp",proto:!0,forced:/./.exec!==Ii},{exec:Ii});var yi=N,Ri=R,Ci=function(e){if("Function"===yi(e))return Ri(e)},Si=Ci,Oi=Zn,Ni=Ii,Ai=i,Mi=ot,Ui=Zt,Li=Mi("species"),wi=RegExp.prototype,bi=function(e,t,n,r){var o=Mi(e),i=!Ai((function(){var t={};return t[o]=function(){return 7},7!=""[e](t)})),s=i&&!Ai((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Li]=function(){return n},n.flags="",n[o]=/./[o]),n.exec=function(){return t=!0,null},n[o](""),!t}));if(!i||!s||n){var a=Si(/./[o]),c=t(o,""[e],(function(e,t,n,r,o){var s=Si(e),c=t.exec;return c===Ni||c===wi.exec?i&&!o?{done:!0,value:a(t,n,r)}:{done:!0,value:s(n,t,r)}:{done:!1}}));Oi(String.prototype,e,c[0]),Oi(wi,o,c[1])}r&&Ui(wi[o],"sham",!0)},Pi=R,Di=tr,Bi=po,Vi=B,xi=Pi("".charAt),Gi=Pi("".charCodeAt),ki=Pi("".slice),Fi=function(e){return function(t,n){var r,o,i=Bi(Vi(t)),s=Di(n),a=i.length;return s<0||s>=a?e?"":void 0:(r=Gi(i,s))<55296||r>56319||s+1===a||(o=Gi(i,s+1))<56320||o>57343?e?xi(i,s):r:e?ki(i,s,s+2):o-56320+(r-55296<<10)+65536}},Hi={codeAt:Fi(!1),charAt:Fi(!0)},qi=Hi.charAt,Ki=function(e,t,n){return t+(n?qi(e,t).length:1)},ji=d,Yi=Bt,Ji=q,Qi=N,Wi=Ii,Zi=TypeError,zi=function(e,t){var n=e.exec;if(Ji(n)){var r=ji(n,e,t);return null!==r&&Yi(r),r}if("RegExp"===Qi(e))return ji(Wi,e,t);throw Zi("RegExp#exec called on incompatible receiver")},Xi=d,$i=Bt,es=b,ts=cr,ns=po,rs=B,os=Re,is=Ki,ss=zi;bi("match",(function(e,t,n){return[function(t){var n=rs(this),r=es(t)?void 0:os(t,e);return r?Xi(r,t,n):new RegExp(t)[e](ns(n))},function(e){var r=$i(this),o=ns(e),i=n(t,r,o);if(i.done)return i.value;if(!r.global)return ss(r,o);var s=r.unicode;r.lastIndex=0;for(var a,c=[],u=0;null!==(a=ss(r,o));){var d=ns(a[0]);c[u]=d,""===d&&(r.lastIndex=is(o,ts(r.lastIndex),s)),u++}return 0===u?null:c}]}));var as=N,cs=Array.isArray||function(e){return"Array"==as(e)},us=TypeError,ds=function(e){if(e>9007199254740991)throw us("Maximum allowed index exceeded");return e},ls=pt,hs=Lt,fs=E,gs=function(e,t,n){var r=ls(t);r in e?hs.f(e,r,fs(0,n)):e[r]=n},ps=R,vs=i,_s=q,Es=ho,ms=ln,Ts=function(){},Is=[],ys=Z("Reflect","construct"),Rs=/^\s*(?:class|function)\b/,Cs=ps(Rs.exec),Ss=!Rs.exec(Ts),Os=function(e){if(!_s(e))return!1;try{return ys(Ts,Is,e),!0}catch(e){return!1}},Ns=function(e){if(!_s(e))return!1;switch(Es(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Ss||!!Cs(Rs,ms(e))}catch(e){return!0}};Ns.sham=!0;var As=!ys||vs((function(){var e;return Os(Os.call)||!Os(Object)||!Os((function(){e=!0}))||e}))?Ns:Os,Ms=cs,Us=As,Ls=Y,ws=ot("species"),bs=Array,Ps=function(e){var t;return Ms(e)&&(t=e.constructor,(Us(t)&&(t===bs||Ms(t.prototype))||Ls(t)&&null===(t=t[ws]))&&(t=void 0)),void 0===t?bs:t},Ds=function(e,t){return new(Ps(e))(0===t?0:t)},Bs=i,Vs=ie,xs=ot("species"),Gs=function(e){return Vs>=51||!Bs((function(){var t=[];return(t.constructor={})[xs]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},ks=$r,Fs=i,Hs=cs,qs=Y,Ks=xe,js=dr,Ys=ds,Js=gs,Qs=Ds,Ws=Gs,Zs=ie,zs=ot("isConcatSpreadable"),Xs=Zs>=51||!Fs((function(){var e=[];return e[zs]=!1,e.concat()[0]!==e})),$s=Ws("concat"),ea=function(e){if(!qs(e))return!1;var t=e[zs];return void 0!==t?!!t:Hs(e)};ks({target:"Array",proto:!0,arity:1,forced:!Xs||!$s},{concat:function(e){var t,n,r,o,i,s=Ks(this),a=Qs(s,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(ea(i=-1===t?s:arguments[t]))for(o=js(i),Ys(c+o),n=0;n<o;n++,c++)n in i&&Js(a,c,i[n]);else Ys(c+1),Js(a,c++,i);return a.length=c,a}});var ta=a,na=Function.prototype,ra=na.apply,oa=na.call,ia="object"==typeof Reflect&&Reflect.apply||(ta?oa.bind(ra):function(){return oa.apply(ra,arguments)}),sa=R,aa=xe,ca=Math.floor,ua=sa("".charAt),da=sa("".replace),la=sa("".slice),ha=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,fa=/\$([$&'`]|\d{1,2})/g,ga=ia,pa=d,va=R,_a=bi,Ea=i,ma=Bt,Ta=q,Ia=b,ya=tr,Ra=cr,Ca=po,Sa=B,Oa=Ki,Na=Re,Aa=function(e,t,n,r,o,i){var s=n+e.length,a=r.length,c=fa;return void 0!==o&&(o=aa(o),c=ha),da(i,c,(function(i,c){var u;switch(ua(c,0)){case"$":return"$";case"&":return e;case"`":return la(t,0,n);case"'":return la(t,s);case"<":u=o[la(c,1,-1)];break;default:var d=+c;if(0===d)return i;if(d>a){var l=ca(d/10);return 0===l?i:l<=a?void 0===r[l-1]?ua(c,1):r[l-1]+ua(c,1):i}u=r[d-1]}return void 0===u?"":u}))},Ma=zi,Ua=ot("replace"),La=Math.max,wa=Math.min,ba=va([].concat),Pa=va([].push),Da=va("".indexOf),Ba=va("".slice),Va="$0"==="a".replace(/./,"$0"),xa=!!/./[Ua]&&""===/./[Ua]("a","$0");_a("replace",(function(e,t,n){var r=xa?"$":"$0";return[function(e,n){var r=Sa(this),o=Ia(e)?void 0:Na(e,Ua);return o?pa(o,e,r,n):pa(t,Ca(r),e,n)},function(e,o){var i=ma(this),s=Ca(e);if("string"==typeof o&&-1===Da(o,r)&&-1===Da(o,"$<")){var a=n(t,i,s,o);if(a.done)return a.value}var c=Ta(o);c||(o=Ca(o));var u=i.global;if(u){var d=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Ma(i,s);if(null===h)break;if(Pa(l,h),!u)break;""===Ca(h[0])&&(i.lastIndex=Oa(s,Ra(i.lastIndex),d))}for(var f,g="",p=0,v=0;v<l.length;v++){for(var _=Ca((h=l[v])[0]),E=La(wa(ya(h.index),s.length),0),m=[],T=1;T<h.length;T++)Pa(m,void 0===(f=h[T])?f:String(f));var I=h.groups;if(c){var y=ba([_],m,E,s);void 0!==I&&Pa(y,I);var R=Ca(ga(o,void 0,y))}else R=Aa(_,s,E,m,I,o);E>=p&&(g+=Ba(s,p,E)+R,p=E+_.length)}return g+Ba(s,p)}]}),!!Ea((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Va||xa);var Ga,ka=72e5,Fa=6e4,Ha=["https://nav.cn.ronghub.com","https://nav2-cn.ronghub.com"],qa=["wsproxy.cn.ronghub.com","wsap-cn.ronghub.com"],Ka=131072,ja=18e4,Ya="RCV4-",Ja={"RC:TxtMsg":{isCounted:!0,isPersited:!0},"RC:ImgMsg":{isCounted:!0,isPersited:!0},"RC:VcMsg":{isCounted:!0,isPersited:!0},"RC:ImgTextMsg":{isCounted:!0,isPersited:!0,searchProps:["content","title"]},"RC:FileMsg":{isCounted:!0,isPersited:!0},"RC:HQVCMsg":{isCounted:!0,isPersited:!0},"RC:LBSMsg":{isCounted:!0,isPersited:!0},"RC:PSImgTxtMsg":{isCounted:!0,isPersited:!0},"RC:PSMultiImgTxtMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpOpendMsg":{isCounted:!0,isPersited:!0},"RC:CombineMsg":{isCounted:!0,isPersited:!0},"RC:ReferenceMsg":{isCounted:!0,isPersited:!0,searchProps:["content"]},"RC:SightMsg":{isCounted:!0,isPersited:!0},"RC:GIFMsg":{isCounted:!0,isPersited:!0},"RC:RLStart":{isCounted:!0,isPersited:!0},"RC:RLEnd":{isCounted:!0,isPersited:!0},"RC:InfoNtf":{isCounted:!1,isPersited:!0},"RC:ContactNtf":{isCounted:!1,isPersited:!0},"RC:ProfileNtf":{isCounted:!1,isPersited:!0},"RC:CmdNtf":{isCounted:!1,isPersited:!0},"RC:GrpNtf":{isCounted:!1,isPersited:!0},"RC:RcCmd":{isCounted:!1,isPersited:!0},"RC:CmdMsg":{isCounted:!1,isPersited:!1},"RC:TypSts":{isCounted:!1,isPersited:!1},"RC:PSCmd":{isCounted:!1,isPersited:!1},"RC:SRSMsg":{isCounted:!1,isPersited:!1},"RC:RRReqMsg":{isCounted:!1,isPersited:!1},"RC:RRRspMsg":{isCounted:!1,isPersited:!1},"RC:CsChaR":{isCounted:!1,isPersited:!1},"RC:CSCha":{isCounted:!1,isPersited:!1},"RC:CsEva":{isCounted:!1,isPersited:!1},"RC:CsContact":{isCounted:!1,isPersited:!1},"RC:CsHs":{isCounted:!1,isPersited:!1},"RC:CsHsR":{isCounted:!1,isPersited:!1},"RC:CsSp":{isCounted:!1,isPersited:!1},"RC:CsEnd":{isCounted:!1,isPersited:!1},"RC:CsUpdate":{isCounted:!1,isPersited:!1},"RC:ReadNtf":{isCounted:!1,isPersited:!1},"RC:chrmKVNotiMsg":{isCounted:!1,isPersited:!1},"RC:VCAccept":{isCounted:!1,isPersited:!1},"RC:VCRinging":{isCounted:!1,isPersited:!1},"RC:VCSummary":{isCounted:!1,isPersited:!1},"RC:VCHangup":{isCounted:!1,isPersited:!1},"RC:VCInvite":{isCounted:!1,isPersited:!1},"RC:VCModifyMedia":{isCounted:!1,isPersited:!1},"RC:VCModifyMem":{isCounted:!1,isPersited:!1},"RC:MsgExMsg":{isCounted:!1,isPersited:!1},"RC:Delivered":{isCounted:!1,isPersited:!1},"RC:RRMsg":{isCounted:!1,isPersited:!1},"RC:LogCmdMsg":{isCounted:!1,isPersited:!1},"RC:InterceptMsg":{isCounted:!1,isPersited:!1},"RC:RLJoin":{isCounted:!1,isPersited:!1},"RC:RLQuit":{isCounted:!1,isPersited:!1},"RC:RL":{isCounted:!1,isPersited:!1}},Qa=["RC:TypSts","RC:InterceptMsg","RC:RL"],Wa={url:"logcollection.ronghub.com",level:1,itv:6,times:5},Za="5.7.2",za=Za.replace(/-.+$/,""),Xa=function(e){return Ga||(Ga={set:function(t,n){e.localStorage.setItem(t,JSON.stringify(n))},get:function(t){var n;try{n=JSON.parse(e.localStorage.getItem(t))}catch(e){n=null}return n},remove:function(t){return e.localStorage.removeItem(t)},getKeys:function(){var t=[];for(var n in e.localStorage)t.push(n);return t}}),Ga},$a=function(){function e(e){this._caches={},e&&(this._caches=e)}return e.prototype.set=function(e,t){this._caches[e]=t},e.prototype.remove=function(e){var t=this.get(e);return delete this._caches[e],t},e.prototype.get=function(e){return this._caches[e]},e.prototype.getKeys=function(){var e=[];for(var t in this._caches)e.push(t);return e},e}(),ec=function(){function e(e,t){var n,r=t?"".concat(Ya).concat(t):Ya;this._rootStorage=Xa(e);var o=this._rootStorage.get(r)||{};this._cache=new $a(((n={})[r]=o,n)),this._storageKey=r}return e.prototype._get=function(){var e=this._storageKey;return this._cache.get(e)||{}},e.prototype._set=function(e){var t=this._storageKey;e=e||{},this._cache.set(t,e),this._rootStorage.set(t,e)},e.prototype.set=function(e,t){var n=this._get();n[e]=t,this._set(n)},e.prototype.remove=function(e){var t=this._get();delete t[e],this._set(t)},e.prototype.clear=function(){var e=this._storageKey;this._rootStorage.remove(e),this._cache.remove(e)},e.prototype.get=function(e){return this._get()[e]},e.prototype.getKeys=function(){var e=this._get(),t=[];for(var n in e)t.push(n);return t},e.prototype.getValues=function(){return this._get()||{}},e}(),tc=function(e,t){return tc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},tc(e,t)};function nc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}tc(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var rc=function(){return rc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},rc.apply(this,arguments)};function oc(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function ic(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function sc(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var ac=function(e){function t(t){return e.call(this,"TODO => ".concat(t))||this}return nc(t,e),t}(Error),cc=R([].slice),uc=$r,dc=cs,lc=As,hc=Y,fc=ir,gc=dr,pc=G,vc=gs,_c=ot,Ec=cc,mc=Gs("slice"),Tc=_c("species"),Ic=Array,yc=Math.max;uc({target:"Array",proto:!0,forced:!mc},{slice:function(e,t){var n,r,o,i=pc(this),s=gc(i),a=fc(e,s),c=fc(void 0===t?s:t,s);if(dc(i)&&(n=i.constructor,(lc(n)&&(n===Ic||dc(n.prototype))||hc(n)&&null===(n=n[Tc]))&&(n=void 0),n===Ic||void 0===n))return Ec(i,a,c);for(r=new(void 0===n?Ic:n)(yc(c-a,0)),o=0;a<c;a++,o++)a in i&&vc(r,o,i[a]);return r.length=o,r}});var Rc=Te,Cc=a,Sc=Ci(Ci.bind),Oc=function(e,t){return Rc(e),void 0===t?e:Cc?Sc(e,t):function(){return e.apply(t,arguments)}},Nc=Oc,Ac=w,Mc=xe,Uc=dr,Lc=Ds,wc=R([].push),bc=function(e){var t=1==e,n=2==e,r=3==e,o=4==e,i=6==e,s=7==e,a=5==e||i;return function(c,u,d,l){for(var h,f,g=Mc(c),p=Ac(g),v=Nc(u,d),_=Uc(p),E=0,m=l||Lc,T=t?m(c,_):n||s?m(c,0):void 0;_>E;E++)if((a||E in p)&&(f=v(h=p[E],E,g),e))if(t)T[E]=f;else if(f)switch(e){case 3:return!0;case 5:return h;case 6:return E;case 2:wc(T,h)}else switch(e){case 4:return!1;case 7:wc(T,h)}return i?-1:r||o?o:T}},Pc={forEach:bc(0),map:bc(1),filter:bc(2),some:bc(3),every:bc(4),find:bc(5),findIndex:bc(6),filterReject:bc(7)},Dc=Pc.filter;$r({target:"Array",proto:!0,forced:!Gs("filter")},{filter:function(e){return Dc(this,e,arguments.length>1?arguments[1]:void 0)}});var Bc=ho,Vc=oo?{}.toString:function(){return"[object "+Bc(this)+"]"};oo||Zn(Object.prototype,"toString",Vc,{unsafe:!0});var xc=Pc.map;$r({target:"Array",proto:!0,forced:!Gs("map")},{map:function(e){return xc(this,e,arguments.length>1?arguments[1]:void 0)}});var Gc=xe,kc=Oo;$r({target:"Object",stat:!0,forced:i((function(){kc(1)}))},{keys:function(e){return kc(Gc(e))}});var Fc=i,Hc=function(e,t){var n=[][e];return!!n&&Fc((function(){n.call(null,t||function(){return 1},1)}))},qc=$r,Kc=w,jc=G,Yc=Hc,Jc=R([].join),Qc=Kc!=Object,Wc=Yc("join",",");qc({target:"Array",proto:!0,forced:Qc||!Wc},{join:function(e){return Jc(jc(this),void 0===e?",":e)}});var Zc=function(e,t){if(e=e.replace(/\?$/,""),!t)return e;var n=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).filter((function(e){return!!e}));return n.length?[e,n.join("&")].join("?"):e};$r({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var zc=q,Xc=String,$c=TypeError,eu=R,tu=Bt,nu=function(e){if("object"==typeof e||zc(e))return e;throw $c("Can't set "+Xc(e)+" as a prototype")},ru=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=eu(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return tu(n),nu(r),t?e(n,r):n.__proto__=r,n}}():void 0),ou=q,iu=Y,su=ru,au=function(e,t,n){var r,o;return su&&ou(r=t.constructor)&&r!==n&&iu(o=r.prototype)&&o!==n.prototype&&su(e,o),e},cu=R(1..valueOf),uu=B,du=po,lu=R("".replace),hu="[\t\n\v\f\r                　\u2028\u2029\ufeff]",fu=RegExp("^"+hu+hu+"*"),gu=RegExp(hu+hu+"*$"),pu=function(e){return function(t){var n=du(uu(t));return 1&e&&(n=lu(n,fu,"")),2&e&&(n=lu(n,gu,"")),n}},vu={start:pu(1),end:pu(2),trim:pu(3)},_u=s,Eu=r,mu=R,Tu=jr,Iu=Zn,yu=Fe,Ru=au,Cu=z,Su=ge,Ou=ht,Nu=i,Au=zn.f,Mu=o.f,Uu=Lt.f,Lu=cu,wu=vu.trim,bu="Number",Pu=Eu[bu],Du=Pu.prototype,Bu=Eu.TypeError,Vu=mu("".slice),xu=mu("".charCodeAt),Gu=function(e){var t=Ou(e,"number");return"bigint"==typeof t?t:ku(t)},ku=function(e){var t,n,r,o,i,s,a,c,u=Ou(e,"number");if(Su(u))throw Bu("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=wu(u),43===(t=xu(u,0))||45===t){if(88===(n=xu(u,2))||120===n)return NaN}else if(48===t){switch(xu(u,1)){case 66:case 98:r=2,o=49;break;case 79:case 111:r=8,o=55;break;default:return+u}for(s=(i=Vu(u,2)).length,a=0;a<s;a++)if((c=xu(i,a))<48||c>o)return NaN;return parseInt(i,r)}return+u};if(Tu(bu,!Pu(" 0o1")||!Pu("0b1")||Pu("+0x1"))){for(var Fu,Hu=function(e){var t=arguments.length<1?0:Pu(Gu(e)),n=this;return Cu(Du,n)&&Nu((function(){Lu(n)}))?Ru(Object(t),n,Hu):t},qu=_u?Au(Pu):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Ku=0;qu.length>Ku;Ku++)yu(Pu,Fu=qu[Ku])&&!yu(Hu,Fu)&&Uu(Hu,Fu,Mu(Pu,Fu));Hu.prototype=Du,Du.constructor=Hu,Iu(Eu,bu,Hu,{constructor:!0})}var ju=ot,Yu=Qo,Ju=Lt.f,Qu=ju("unscopables"),Wu=Array.prototype;null==Wu[Qu]&&Ju(Wu,Qu,{configurable:!0,value:Yu(null)});var Zu=function(e){Wu[Qu][e]=!0},zu=pr.includes,Xu=Zu;$r({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return zu(this,e,arguments.length>1?arguments[1]:void 0)}}),Xu("includes");var $u,ed=Y,td=N,nd=ot("match"),rd=function(e){var t;return ed(e)&&(void 0!==(t=e[nd])?!!t:"RegExp"==td(e))},od=rd,id=TypeError,sd=ot("match"),ad=$r,cd=function(e){if(od(e))throw id("The method doesn't accept regular expressions");return e},ud=B,dd=po,ld=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[sd]=!1,"/./"[e](t)}catch(e){}}return!1},hd=R("".indexOf);ad({target:"String",proto:!0,forced:!ld("includes")},{includes:function(e){return!!~hd(dd(ud(this)),dd(cd(e)),arguments.length>1?arguments[1]:void 0)}}),function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE",e[e.SIGHT=5]="SIGHT",e[e.COMBINE_HTML=6]="COMBINE_HTML"}($u||($u={}));var fd,gd=$u;!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(fd||(fd={}));var pd,vd=fd;!function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.PARAMETER_ERROR=-3]="PARAMETER_ERROR",e[e.EXTRA_METHOD_UNDEFINED=-4]="EXTRA_METHOD_UNDEFINED",e[e.MAIN_PROCESS_ERROR=-5]="MAIN_PROCESS_ERROR",e[e.PARAMETER_CHANGED=-6]="PARAMETER_CHANGED",e[e.SUCCESS=0]="SUCCESS",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.RECALL_MESSAGE=25101]="RECALL_MESSAGE",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.CHATROOM_KV_EXCEED=23423]="CHATROOM_KV_EXCEED",e[e.CHATROOM_KV_OVERWRITE_INVALID=23424]="CHATROOM_KV_OVERWRITE_INVALID",e[e.CHATROOM_KV_STORE_NOT_OPEN=23426]="CHATROOM_KV_STORE_NOT_OPEN",e[e.CHATROOM_KEY_NOT_EXIST=23427]="CHATROOM_KEY_NOT_EXIST",e[e.CHATROOM_KV_SET_ERROR=23431]="CHATROOM_KV_SET_ERROR",e[e.SENSITIVE_SHIELD=21501]="SENSITIVE_SHIELD",e[e.SENSITIVE_REPLACE=21502]="SENSITIVE_REPLACE",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_FAIL=30005]="RC_HTTP_REQ_FAIL",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_REQ_FAILED=30007]="RC_NAVI_REQ_FAILED",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_EXCEED_LIMIT=30012]="RC_PING_EXCEED_LIMIT",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_MSG_CONTENT_EXCEED_LIMIT=30016]="RC_MSG_CONTENT_EXCEED_LIMIT",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_IDENTIFIER_REJECTED=31002]="RC_CONN_IDENTIFIER_REJECTED",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_TOKEN_INCORRECT=31004]="RC_CONN_TOKEN_INCORRECT",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_CONN_TOKEN_EXPIRED=31020]="RC_CONN_TOKEN_EXPIRED",e[e.RC_CONN_DEVICE_ERROR=31021]="RC_CONN_DEVICE_ERROR",e[e.RC_CONN_HOSTNAME_ERROR=31022]="RC_CONN_HOSTNAME_ERROR",e[e.RC_DISCONN_SAME_CLIENT_ON_LINE=31023]="RC_DISCONN_SAME_CLIENT_ON_LINE",e[e.RC_LISCENSE_COUNT_OUT_OF_LIMIT=31024]="RC_LISCENSE_COUNT_OUT_OF_LIMIT",e[e.RC_CONN_WRONG_CLUSTER=31025]="RC_CONN_WRONG_CLUSTER",e[e.RC_APP_AUTH_NOT_PASS=31026]="RC_APP_AUTH_NOT_PASS",e[e.RC_OTP_USED=31027]="RC_OTP_USED",e[e.RC_PLATFORM_ERROR=31028]="RC_PLATFORM_ERROR",e[e.RC_ACCOUNT_CANCELLATION=31029]="RC_ACCOUNT_CANCELLATION",e[e.RC_LICENSE_EXPIRED=31030]="RC_LICENSE_EXPIRED",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.RC_TCP_RESET=32054]="RC_TCP_RESET",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.TAG_EXISTS=33101]="TAG_EXISTS",e[e.TAG_NOT_EXIST=33100]="TAG_NOT_EXIST",e[e.NO_TAG_IN_CONVER=33102]="NO_TAG_IN_CONVER",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.EXPANSION_LIMIT_EXCEET=34010]="EXPANSION_LIMIT_EXCEET",e[e.MESSAGE_KV_NOT_SUPPORT=34008]="MESSAGE_KV_NOT_SUPPORT",e[e.CONVER_OUT_LIMIT_ERROR=34013]="CONVER_OUT_LIMIT_ERROR",e[e.CONVER_GET_ERROR=35021]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.READ_RECEIPT_ERROR=35003]="READ_RECEIPT_ERROR",e[e.PACKAGE_ENVIRONMENT_ERROR=35006]="PACKAGE_ENVIRONMENT_ERROR",e[e.CAN_NOT_RECONNECT=35007]="CAN_NOT_RECONNECT",e[e.SERVER_UNAVAILABLE=35008]="SERVER_UNAVAILABLE",e[e.HOSTNAME_ERROR=35009]="HOSTNAME_ERROR",e[e.HAS_OHTER_SAME_CLIENT_ON_LINE=35010]="HAS_OHTER_SAME_CLIENT_ON_LINE",e[e.METHOD_NOT_AVAILABLE=35011]="METHOD_NOT_AVAILABLE",e[e.METHOD_NOT_SUPPORT=35012]="METHOD_NOT_SUPPORT",e[e.MSG_LIMIT_ERROR=35013]="MSG_LIMIT_ERROR",e[e.METHOD_ONLY_SUPPORT_ULTRA_GROUP=35014]="METHOD_ONLY_SUPPORT_ULTRA_GROUP",e[e.UPLOAD_FILE_FAILED=35020]="UPLOAD_FILE_FAILED",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.CHATROOM_KV_NOT_FOUND=36004]="CHATROOM_KV_NOT_FOUND",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.NOT_SUPPORT=39002]="NOT_SUPPORT",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.ULTRA_GROUP_USER_NOT_IN_PRIVATE_CHANNEL=24416]="ULTRA_GROUP_USER_NOT_IN_PRIVATE_CHANNEL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE",e[e.CHATROOM_KV_STORE_NOT_ALL_SUCCESS=23428]="CHATROOM_KV_STORE_NOT_ALL_SUCCESS",e[e.CHATROOM_KV_STORE_OUT_LIMIT=23429]="CHATROOM_KV_STORE_OUT_LIMIT",e[e.SEARCH_PROPS_LIMIT_ERROR=35022]="SEARCH_PROPS_LIMIT_ERROR",e[e.INVALID_PARAMETER_PROXY=34238]="INVALID_PARAMETER_PROXY",e[e.INVALID_PARAMETER_TESTHOST=34239]="INVALID_PARAMETER_TESTHOST",e[e.INVALID_CONNECT_TESTHOST_FAILED=34240]="INVALID_CONNECT_TESTHOST_FAILED",e[e.RC_CONN_PROXY_UNAVAILABLE=35028]="RC_CONN_PROXY_UNAVAILABLE",e[e.PROXY_UNAVAILABLE=17]="PROXY_UNAVAILABLE"}(pd||(pd={}));var _d,Ed=pd;!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE",e[e.ULTRA_GROUP=10]="ULTRA_GROUP",e[e.RTC_ROOM=12]="RTC_ROOM"}(_d||(_d={}));var md,Td=_d;!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.WEBSOCKET_UNAVAILABLE=7]="WEBSOCKET_UNAVAILABLE",e[e.WEBSOCKET_ERROR=8]="WEBSOCKET_ERROR",e[e.BLOCKED=9]="BLOCKED",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.DISCONNECT_BY_SERVER=13]="DISCONNECT_BY_SERVER",e[e.REDIRECT=14]="REDIRECT",e[e.USER_LOGOUT=19]="USER_LOGOUT",e[e.APPKEY_IS_FAKE=20]="APPKEY_IS_FAKE",e[e.FORBID_RECONNECT_BY_OTHER_SAME_CLIENT=31023]="FORBID_RECONNECT_BY_OTHER_SAME_CLIENT",e[e.ULTRALIMIT=1101]="ULTRALIMIT",e[e.REQUEST_NAVI=201]="REQUEST_NAVI",e[e.RESPONSE_NAVI=202]="RESPONSE_NAVI",e[e.RESPONSE_NAVI_ERROR=203]="RESPONSE_NAVI_ERROR",e[e.RESPONSE_NAVI_TIMEOUT=204]="RESPONSE_NAVI_TIMEOUT",e[e.RC_LICENSE_EXPIRED=31030]="RC_LICENSE_EXPIRED",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR"}(md||(md={}));var Id,yd=md;!function(e){e.TextMessage="RC:TxtMsg",e.VOICE="RC:VcMsg",e.HQ_VOICE="RC:HQVCMsg",e.IMAGE="RC:ImgMsg",e.GIF="RC:GIFMsg",e.RICH_CONTENT="RC:ImgTextMsg",e.LOCATION="RC:LBSMsg",e.FILE="RC:FileMsg",e.SIGHT="RC:SightMsg",e.COMBINE="RC:CombineMsg",e.CHRM_KV_NOTIFY="RC:chrmKVNotiMsg",e.LOG_COMMAND="RC:LogCmdMsg",e.EXPANSION_NOTIFY="RC:MsgExMsg",e.REFERENCE="RC:ReferenceMsg",e.RECALL="RC:RcCmd",e.RECALL_NOTIFICATION_MESSAGE="RC:RcNtf",e.READ_RECEIPT="RC:ReadNtf",e.READ_RECEIPT_REQUEST="RC:RRReqMsg",e.READ_RECEIPT_RESPONSE="RC:RRRspMsg",e.SYNC_READ_STATUS="RC:SRSMsg",e.GROUP_READ_RECEIPT_REQUEST="RC:RRMsg",e.DELIVERED="RC:Delivered",e.DELIVERED_MSG="RC:DRMsg",e.CHATROOM_JOIN="RC:ChrmJoinNtf",e.CHATROOM_LEFT="RC:ChrmQuitNtf",e.CHATROOM_MERGE_CHANGE="RC:ChrmMemChange",e.TYPING_STATUS="RC:TypSts",e.INTERCEPT="RC:InterceptMsg"}(Id||(Id={}));var Rd,Cd=Id;!function(e){e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(Rd||(Rd={}));var Sd,Od=Rd;!function(e){e[e.ALL_MESSAGE=-1]="ALL_MESSAGE",e[e.NOT_SET=0]="NOT_SET",e[e.AT_MESSAGE_NOTIFICATION=1]="AT_MESSAGE_NOTIFICATION",e[e.AT_USER_NOTIFICATION=2]="AT_USER_NOTIFICATION",e[e.AT_GROUP_ALL_USER_NOTIFICATION=4]="AT_GROUP_ALL_USER_NOTIFICATION",e[e.NOT_MESSAGE_NOTIFICATION=5]="NOT_MESSAGE_NOTIFICATION"}(Sd||(Sd={}));var Nd,Ad=Sd;!function(e){e[e.ALL=1]="ALL",e[e.SINGAL=2]="SINGAL"}(Nd||(Nd={}));var Md,Ud=Nd;!function(e){e[e.QINIU=1]="QINIU",e[e.ALI=2]="ALI",e[e.AWS=3]="AWS",e[e.STC=4]="STC"}(Md||(Md={}));var Ld,wd=Md;!function(e){e[e.UPDATE=1]="UPDATE",e[e.DELETE=2]="DELETE"}(Ld||(Ld={}));var bd,Pd,Dd,Bd,Vd=Ld;e.LogLevel=void 0,(bd=e.LogLevel||(e.LogLevel={}))[bd.LOG=0]="LOG",bd[bd.DEBUG=0]="DEBUG",bd[bd.INFO=1]="INFO",bd[bd.WARN=2]="WARN",bd[bd.ERROR=3]="ERROR",bd[bd.FATAL=4]="FATAL",bd[bd.STATISTICS=6]="STATISTICS",bd[bd.NONE=1e3]="NONE",function(e){e.IM="IM",e.RTC="RTC"}(Pd||(Pd={})),function(e){e.L_IMSDK_VER_O="L-imsdk_ver-O",e.A_INIT_O="A-init-O",e.A_INIT_REPEAT_O="A_INIT_REPEAT_O",e.L_INIT_O="L-init-O",e.A_DESTROY_O="A_DESTROY_O",e.L_DESTROY_O="L_DESTROY_O",e.A_CONNECT_T="A-connect-T",e.A_CONNECT_R="A-connect-R",e.A_CONNECT_S="A-connect-S",e.A_DISCONNECT_O="A-disconnect-O",e.A_RECONNECT_T="A-reconnect-T",e.A_RECONNECT_R="A_RECONNECT_R",e.L_CONNECT_T="L-connect-T",e.L_CONNECT_R="L-connect-R",e.L_CONNECT_S="L-connect-S",e.L_NOTIFY_ULTRA_ONLINE_S="L-notify-ultra-online-S",e.L_ULTRA_SYNC_DONE_S="L-ultra-sync-done-S",e.L_BATCH_MESSAGE_O="L-BATCH_MESSAGE-O",e.A_MSG_LISTENER_E="A-MSG_LISTENER-E",e.O="L-original-O",e.T="L-TEST-O",e.L_INSTALL_PLUGIN_T="L-INSTALL_PLUGIN-T",e.L_INSTALL_PLUGIN_R="L-INSTALL_PLUGIN-R",e.L_NAVI_CONF_E="L-NAVI_CONF_ERROR-E",e.A_SEND_MSG_T="A-send_msg-T",e.A_SEND_MSG_R="A-send_msg-R",e.L_SEND_MSG_T="L-send_msg-T",e.L_SEND_MSG_R="L-send_msg-R",e.L_PULL_MSG_T="L-pull_msg-T",e.L_PULL_MSG_R="L-pull_msg-R",e.L_PULL_MSG_O="L-pull_msg-O",e.L_PULL_ULTRA_MSG_T="L-pull_ultra_msg-T",e.L_PULL_ULTRA_MSG_R="L-pull_ultra_msg-R",e.L_PULL_CHATROOM_KV_T="L-pull_chatroom_kv-T",e.L_PULL_CHATROOM_KV_R="L-pull_chatroom_kv-R",e.L_PULL_CHATROOM_MSG_T="L-pull_chatroom_msg-T",e.L_PULL_CHATROOM_MSG_R="L-pull_chatroom_msg-R",e.L_RECV_MULTI_SYNC_MSG_O="L-recv_multi_sync_msg-O",e.L_RECV_S_MSG_O="L-recv_s_msg-O",e.A_DELETE_MESSAGES_S="A-delete_messages-S",e.P_DELETE_MSG_S="P-delete_msg-S",e.L_PULL_CONVERSATION_S="L-pull_conversation-S",e.L_RECALL_ULTRA_MSG_S="L-recall_ultra_msg-S",e.A_REGTYP_O="A-regtyp-O",e.P_REGTYP_E="P-regtype-E",e.L_GET_NAVI_T="L-get_navi-T",e.L_GET_NAVI_R="L-get_navi-R",e.L_REQUEST_T="L-request-T",e.L_REQUEST_R="L-request-R",e.L_PARSE_NAVI_E="L-parse_navi-E",e.L_ENV_S="L-Env-S",e.L_GET_INDEX_NAVI_S="L-get_index_navi-S",e.A_JOIN_CHATROOM_T="A-join_chatroom-T",e.A_JOIN_CHATROOM_R="A-join_chatroom-R",e.L_JOIN_CHATROOM_T="L-join_chatroom-T",e.L_JOIN_CHATROOM_R="L-join_chatroom-R",e.A_QUIT_CHATROOM_T="A-quit_chatroom-T",e.A_QUIT_CHATROOM_R="A-quit_chatroom-R",e.L_REJOIN_CHATROOM_T="L-rejoin_chatroom-T",e.L_REJOIN_CHATROOM_R="L-rejoin_chatroom-R",e.L_REJOIN_CHATROOM_S="L-rejoin_chatroom-S",e.L_MEDIA_S="L-media-S",e.L_MEDIA_UPLOAD_T="L-media_upload-T",e.L_MEDIA_UPLOAD_R="L-media_upload-R",e.G_UPLOAD_LOG_S="G-upload_log-S",e.G_REPORT_LOG_S="G-report_log-S",e.G_UPLOAD_LOG_E="G-upload_log-E",e.G_GET_REAL_TIMELOG_COMMAND_S="G-get_real_timelog_command-S",e.L_CHECK_ALIVE_IM_T="L-check_alive_im-T",e.L_CHECK_ALIVE_IM_R="L-check_alive_im-R",e.L_CHECK_ALIVE_IM_S="L-check_alive_im-S",e.A_GET_HISTORY_MSG_T="A-get_history_msg-T",e.A_GET_HISTORY_MSG_R="A-get_history_msg-R",e.L_GET_HISTORY_MSG_T="L-get_history_msg-T",e.L_GET_HISTORY_MSG_R="L-get_history_msg-R",e.A_GET_PRIVATE_MESSAGE_DELIVER_TIME_E="A-get_privage_message_deliver_time-E",e.A_GET_GROUP_MESSAGE_DELIVER_LIST_E="A-get_group_message_deliver_list-E",e.A_CALLBACK_O="A-callback-O",e.A_CALLBACK_E="A-callback-E",e.L_CALLBACK_E="L-callback-E",e.A_GET_TOP_CONVERSATION_LIST_E="A-get_top_conversation_list-E",e.L_PB_ENCODE_E="L-pb-encode-E",e.L_PB_DECODE_E="L-pb-decode-E",e.L_NOTIFY_NAVI_CHANGE_E="L-notify_navi_change-E",e.L_REPORT_FULL_LOG_O="L-report_full_log-O",e.L_REPORT_FULL_LOG_T="L-report_full_log-T",e.L_REPORT_FULL_LOG_R="L-report_full_log-R",e.L_REPORT_LOG_POLICY_E="L-parse_navi_logpolicy-E",e.L_UNSUPPORT_INDEXDB_O="L-unsupport_IndexDB-O",e.L_LOGDB_OPEN_FAILED_E="L-logDB_open_failed-E",e.L_LOGDB_CLOSED_S="L-logDB_closed-S",e.L_LOGDB_ERROR_E="L-logDB_error-S",e.L_LOGDB_ABORT_S="L-logDB_abort-S",e.L_REALTIME_LOG_R="L_REALTIME_LOG_R",e.L_REALTIME_LOG_O="L_REALTIME_LOG_O",e.L_REALTIME_LOG_T="L_REALTIME_LOG_T",e.L_UNKNOWN_TOPIC_E="L_UNKNOWN_TOPIC_E",e.L_RECV_RMTP_O="L_RECV_RMTP_O",e.L_RECV_RMTP_E="L_RECV_RMTP_E",e.L_RECV_S_NTF_O="L-recv_s_ntf_O",e.L_VER_REPORT_T="L-VER_REPORT-T",e.L_VER_REPORT_R="L-VER_REPORT-R",e.L_CALL_MAIN_SYNC_O="L_CALL_MAIN_SYNC_O",e.L_UNSUPPORT_NTF_FROM_MAIN_E="L_UNSUPPORT_NTF_FROM_MAIN_E",e.A_SET_MSG_CONTENT_O="A_SET_MSG_CONTENT_O",e.A_REMOVE_PROXY_O="A-remove_proxy-O",e.A_SET_PROXY_O="A-set_proxy-O",e.A_TEST_PROXY_O="A-test_proxy-O"}(Dd||(Dd={})),function(e){e[e.QUIT=0]="QUIT",e[e.JOIN=1]="JOIN"}(Bd||(Bd={}));var xd,Gd,kd=Bd;!function(e){e[e.GLOBAL=1]="GLOBAL",e[e.CUSTOM=2]="CUSTOM",e[e.THIRD_PARTY=3]="THIRD_PARTY"}(xd||(xd={})),e.MessageBlockSourceType=void 0,(Gd=e.MessageBlockSourceType||(e.MessageBlockSourceType={}))[Gd.MSG_ORIGINAL=0]="MSG_ORIGINAL",Gd[Gd.MSG_EXPANSION=1]="MSG_EXPANSION",Gd[Gd.MSG_MODIFY=2]="MSG_MODIFY";var Fd,Hd=xd;!function(e){e[e.typing=0]="typing"}(Fd||(Fd={}));var qd,Kd,Yd,Jd,Qd,Wd,Zd,zd,Xd,$d=Fd;e.SentStatus=void 0,(qd=e.SentStatus||(e.SentStatus={}))[qd.SENDING=10]="SENDING",qd[qd.FAILED=20]="FAILED",qd[qd.SENT=30]="SENT",qd[qd.RECEIVED=40]="RECEIVED",qd[qd.READ=50]="READ",qd[qd.DESTROYED=60]="DESTROYED",function(e){e.NAVI="rc-navi",e.REALTIME_LOG_TIMESTAMP="rc-realtime-log-timestamp"}(Kd||(Kd={})),e.UltraGroupChannelType=void 0,(Yd=e.UltraGroupChannelType||(e.UltraGroupChannelType={}))[Yd.PUBLIC=0]="PUBLIC",Yd[Yd.PRIVATE=1]="PRIVATE",e.UltraGroupChannelChangeType=void 0,(Jd=e.UltraGroupChannelChangeType||(e.UltraGroupChannelChangeType={}))[Jd.PUBLIC_TO_PRIVATE=2]="PUBLIC_TO_PRIVATE",Jd[Jd.PRIVATE_TO_PUBLIC=3]="PRIVATE_TO_PUBLIC",Jd[Jd.PUBLIC_TO_PRIVATE_USER_NOT_IN=6]="PUBLIC_TO_PRIVATE_USER_NOT_IN",function(e){e[e.MSG_EXPANSION=1]="MSG_EXPANSION",e[e.MSG_MODIFY=2]="MSG_MODIFY",e[e.MSG_RECALL=3]="MSG_RECALL",e[e.CHANNEL_CHANGE=4]="CHANNEL_CHANGE"}(Qd||(Qd={})),function(e){e[e.CHANNEL_DELETE=1]="CHANNEL_DELETE",e[e.PUBLIC_TO_PRIVATE=2]="PUBLIC_TO_PRIVATE",e[e.PRIVATE_TO_PUBLIC=3]="PRIVATE_TO_PUBLIC",e[e.PRIVATE_CHANNEL_USER_JOIN_PUBLIC=4]="PRIVATE_CHANNEL_USER_JOIN_PUBLIC",e[e.CHANNEL_USER_KICKED=5]="CHANNEL_USER_KICKED",e[e.PUBLIC_TO_PRIVATE_USER_NOT_IN=6]="PUBLIC_TO_PRIVATE_USER_NOT_IN"}(Wd||(Wd={})),function(e){e[e.RTC=0]="RTC",e[e.LIVE=2]="LIVE",e[e.SIP=4]="SIP",e[e.CALL=5]="CALL",e[e.MEETING=6]="MEETING",e[e.CROSS_MUTI=7]="CROSS_MUTI",e[e.CROSS_LIVE=8]="CROSS_LIVE"}(Zd||(Zd={})),function(e){e[e.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",e[e.AUDIO=1]="AUDIO"}(zd||(zd={})),function(e){e[e.ANCHOR=1]="ANCHOR",e[e.AUDIENCE=2]="AUDIENCE"}(Xd||(Xd={}));var el,tl,nl,rl={"RC:VCAccept":"RC:VCAccept","RC:VCRinging":"RC:VCRinging","RC:VCSummary":"RC:VCSummary","RC:VCHangup":"RC:VCHangup","RC:VCInvite":"RC:VCInvite","RC:VCModifyMedia":"RC:VCModifyMedia","RC:VCModifyMem":"RC:VCModifyMem"};!function(e){e[e.ROOM=1]="ROOM",e[e.PERSON=2]="PERSON"}(el||(el={})),function(e){e[e.AnchorToViewer=1]="AnchorToViewer",e[e.ViewerToAnchor=2]="ViewerToAnchor"}(tl||(tl={})),function(e){e[e.KICK=0]="KICK",e[e.REFUSE=1]="REFUSE",e[e.COEXIST=2]="COEXIST"}(nl||(nl={}));var ol=function(e){return"string"==typeof e},il=function(e){return"number"==typeof e&&!Number.isNaN(e)},sl=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")},al=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)},cl=function(e){return ol(e)&&e.length>0},ul=function(e){return"[object Object]"===Object.prototype.toString.call(e)},dl=function(e){return"[object Function]"===Object.prototype.toString.call(e)},ll=function(e){return void 0===e||"[object Undefined]"===Object.prototype.toString.call(e)},hl=function(e){return"[object Null]"===Object.prototype.toString.call(e)},fl=function(e){return ol(e)&&/https?:\/\//.test(e)},gl=function(e){for(var t in e)return!0;return!1},pl=function(e){return il(e)&&Object.prototype.hasOwnProperty.call(Td,e)},vl=function(e){return il(e)&&Object.prototype.hasOwnProperty.call(Ad,e)},_l=function(e){var t=!1;return ol(e)&&!/_/g.test(e)&&e.length<=20&&(t=!0),t},El=function(e){return[Td.PRIVATE,Td.GROUP,Td.SYSTEM,Td.PUBLIC_SERVICE,Td.APP_PUBLIC_SERVICE].includes(e)},ml=function(e){return il(e)&&Object.prototype.hasOwnProperty.call(gd,e)},Tl=function(e){var t=!1,n=!1,r=!1;if(ul(e)){var o=Object.keys(e).length;for(var i in t=o>20,e)if(n||(n=ol(i)&&!/^[A-Za-z0-9_=+-]+$/.test(i)),!r){var s=e[i];r=i.length>32||s.length>4096}}return{isExceedLimit:t,isIllgalEx:n,isExKeyOrValLengthExceedLimit:r}},Il=s,yl=cs,Rl=TypeError,Cl=Object.getOwnPropertyDescriptor,Sl=Il&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),Ol=ve,Nl=TypeError,Al=function(e,t){if(!delete e[t])throw Nl("Cannot delete property "+Ol(t)+" of "+Ol(e))},Ml=$r,Ul=xe,Ll=ir,wl=tr,bl=dr,Pl=Sl?function(e,t){if(yl(e)&&!Cl(e,"length").writable)throw Rl("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},Dl=ds,Bl=Ds,Vl=gs,xl=Al,Gl=Gs("splice"),kl=Math.max,Fl=Math.min;Ml({target:"Array",proto:!0,forced:!Gl},{splice:function(e,t){var n,r,o,i,s,a,c=Ul(this),u=bl(c),d=Ll(e,u),l=arguments.length;for(0===l?n=r=0:1===l?(n=0,r=u-d):(n=l-2,r=Fl(kl(wl(t),0),u-d)),Dl(u+n-r),o=Bl(c,r),i=0;i<r;i++)(s=d+i)in c&&Vl(o,i,c[s]);if(o.length=r,n<r){for(i=d;i<u-r;i++)a=i+n,(s=i+r)in c?c[a]=c[s]:xl(c,a);for(i=u;i>u-r+n;i--)xl(c,i-1)}else if(n>r)for(i=u-r;i>d;i--)a=i+n-1,(s=i+r-1)in c?c[a]=c[s]:xl(c,a);for(i=0;i<n;i++)c[i+d]=arguments[i+2];return Pl(c,u-r+n),o}});var Hl={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ql=mt("span").classList,Kl=ql&&ql.constructor&&ql.constructor.prototype,jl=Kl===Object.prototype?void 0:Kl,Yl=Pc.forEach,Jl=Hc("forEach")?[].forEach:function(e){return Yl(this,e,arguments.length>1?arguments[1]:void 0)},Ql=r,Wl=Hl,Zl=jl,zl=Jl,Xl=Zt,$l=function(e){if(e&&e.forEach!==zl)try{Xl(e,"forEach",zl)}catch(t){e.forEach=zl}};for(var eh in Wl)Wl[eh]&&$l(Ql[eh]&&Ql[eh].prototype);$l(Zl);var th=function(){function e(){this._map={}}return e.prototype.on=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n})},e.prototype.once=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n,once:!0})},e.prototype.off=function(e,t,n){var r=this._map[e];r&&((r=r.filter((function(e){return e.listener!==t||e.target!==n}))).length?this._map[e]=r:delete this._map[e])},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this._map[e];if(r)for(var o=r.length-1;o>=0;o-=1){var i=r[o],s=i.target,a=i.once,c=i.listener;a&&r.splice(o,1);try{c.call.apply(c,sc([s],t,!1))}catch(e){null===console||void 0===console||console.error(e)}}},e.prototype.removeAll=function(e){delete this._map[e]},e.prototype.clear=function(){Object.keys(this._map).forEach(this.removeAll,this)},e}(),nh=tr,rh=po,oh=B,ih=RangeError,sh=R,ah=cr,ch=po,uh=B,dh=sh((function(e){var t=rh(oh(this)),n="",r=nh(e);if(r<0||r==1/0)throw ih("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n})),lh=sh("".slice),hh=Math.ceil,fh=function(e){return function(t,n,r){var o,i,s=ch(uh(t)),a=ah(n),c=s.length,u=void 0===r?" ":ch(r);return a<=c||""==u?s:((i=dh(u,hh((o=a-c)/u.length))).length>o&&(i=lh(i,0,o)),e?s+i:i+s)}},gh={start:fh(!1),end:fh(!0)},ph=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(X),vh=gh.start;$r({target:"String",proto:!0,forced:ph},{padStart:function(e){return vh(this,e,arguments.length>1?arguments[1]:void 0)}});var _h="undefined"!=typeof window&&window?(window.__RCVersionInfo||(window.__RCVersionInfo={}),window.__RCVersionInfo):{};_h.engine="5.7.2";var Eh=function(){function e(){}return e.add=function(e,t){_h[e]=t},e.validEngine=function(e){var t=e.match(/\d+\.\d+\.\d+/);if(!t)return!1;var n=t[0].split(".").map((function(e){return e.padStart(3,"0")})).join("");return _h.engine.match(/\d+\.\d+\.\d+/)[0].split(".").map((function(e){return e.padStart(3,"0")})).join("")>=n},e.getInfo=function(){return _h},e}();var mh=Date.now(),Th=0;function Ih(e,t,n,r){}var yh=Ih.bind(null,e.LogLevel.DEBUG),Rh=Ih.bind(null,e.LogLevel.INFO),Ch=Ih.bind(null,e.LogLevel.WARN),Sh=Ih.bind(null,e.LogLevel.ERROR),Oh=Ih.bind(null,e.LogLevel.FATAL),Nh=Object.freeze({__proto__:null,logLevelTransformer:function(e){return 4-e},ID:function(){var e=Date.now();return mh!==e&&(mh=e,Th=0),"".concat(mh,"-").concat(Th++)},init:function(e){},log:Ih,debug:yh,info:Rh,warn:Ch,error:Sh,fatal:Oh}),Ah=function(){function t(t,n,r){this.tagId=t,this.logSource=n,this.initiator=r,this.debug=this.log.bind(this,e.LogLevel.DEBUG),this.info=this.log.bind(this,e.LogLevel.INFO),this.warn=this.log.bind(this,e.LogLevel.WARN),this.error=this.log.bind(this,e.LogLevel.ERROR),this.fatal=this.log.bind(this,e.LogLevel.FATAL)}return t.prototype.setLogLevel=function(e){},t.prototype.setLogStdout=function(e){},t.prototype.log=function(e){},t.prototype.set=function(e,t){},t.prototype.setStdout=function(e){},t}(),Mh=new Ah("RC-E"),Uh=d,Lh=Fe,wh=z,bh=_o,Ph=RegExp.prototype,Dh=function(e){var t=e.flags;return void 0!==t||"flags"in Ph||Lh(e,"flags")||!wh(Ph,e)?t:Uh(bh,e)},Bh=rn.PROPER,Vh=Zn,xh=Bt,Gh=po,kh=i,Fh=Dh,Hh="toString",qh=RegExp.prototype[Hh],Kh=kh((function(){return"/a/b"!=qh.call({source:"a",flags:"b"})})),jh=Bh&&qh.name!=Hh;(Kh||jh)&&Vh(RegExp.prototype,Hh,(function(){var e=xh(this);return"/"+Gh(e.source)+"/"+Gh(Fh(e))}),{unsafe:!0});var Yh,Jh,Qh=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Wh=function(){var e=Qh();if(e="".concat(e.replace(/-/g,""),"a"),e=function(e){var t="0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZa0".split(""),n=t.length+1,r=+e,o=[];do{var i=r%n;r=(r-i)/n,o.unshift(t[i])}while(r);return o.join("")}(e=parseInt(e,16)),e.length>22&&(e=e.slice(0,22)),e.length<22)for(var t=22-e.length,n=0;n<t;n++)e+="0";return e},Zh=s,zh=rn.EXISTS,Xh=R,$h=Lt.f,ef=Function.prototype,tf=Xh(ef.toString),nf=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,rf=Xh(nf.exec);Zh&&!zh&&$h(ef,"name",{configurable:!0,get:function(){try{return rf(nf,tf(this))[1]}catch(e){return""}}}),function(e){e[e.STRING=0]="STRING",e[e.ONLY_STRING=1]="ONLY_STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.OBJECT=4]="OBJECT",e[e.ARRAY=5]="ARRAY",e[e.CALLBACK=6]="CALLBACK",e[e.CHANNEL_ID=7]="CHANNEL_ID",e[e.CONVERSATION=8]="CONVERSATION"}(Jh||(Jh={}));var of,sf,af,cf,uf=((Yh={})[Jh.STRING]=cl,Yh[Jh.ONLY_STRING]=ol,Yh[Jh.NUMBER]=il,Yh[Jh.BOOLEAN]=function(e){return"boolean"==typeof e},Yh[Jh.OBJECT]=ul,Yh[Jh.ARRAY]=sl,Yh[Jh.CALLBACK]=function(e){var t=!0;return ul(e)||(t=!1),(e=e||{}).onSuccess&&!dl(e.onSuccess)&&(t=!1),e.onError&&!dl(e.onError)&&(t=!1),t},Yh[Jh.CHANNEL_ID]=_l,Yh[Jh.CONVERSATION]=function(e){var t=!0;return ul(e)||(t=!1),ol(e.targetId)||(t=!1),pl(e.conversationType)||(t=!1),ll(e.channelId)||_l(e.channelId)||(t=!1),t},Yh),df=function(e){function t(t){var n=e.call(this,t)||this;return n.name="RCAssertError",n}return nc(t,e),t}(Error),lf=function(e,t,n,r){if(void 0===r&&(r=!1),!hf(e,t,n,r))throw new df("'".concat(e,"' is invalid: ").concat(JSON.stringify(t)))},hf=function(e,t,n,r){void 0===r&&(r=!1),n=uf[n]||n;var o=r?n(t):ll(t)||null==t||n(t);return o||null===console||void 0===console||console.error("'".concat(e,"' is invalid: ").concat(JSON.stringify(t))),o},ff="process"==N(r.process),gf=Lt.f,pf=Fe,vf=ot("toStringTag"),_f=function(e,t,n){e&&!n&&(e=e.prototype),e&&!pf(e,vf)&&gf(e,vf,{configurable:!0,value:t})},Ef=Z,mf=Lt,Tf=s,If=ot("species"),yf=function(e){var t=Ef(e),n=mf.f;Tf&&t&&!t[If]&&n(t,If,{configurable:!0,get:function(){return this}})},Rf=z,Cf=TypeError,Sf=function(e,t){if(Rf(t,e))return e;throw Cf("Incorrect invocation")},Of=As,Nf=ve,Af=TypeError,Mf=function(e){if(Of(e))return e;throw Af(Nf(e)+" is not a constructor")},Uf=Bt,Lf=Mf,wf=b,bf=ot("species"),Pf=function(e,t){var n,r=Uf(e).constructor;return void 0===r||wf(n=Uf(r)[bf])?t:Lf(n)},Df=TypeError,Bf=function(e,t){if(e<t)throw Df("Not enough arguments");return e},Vf=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),xf=r,Gf=ia,kf=Oc,Ff=q,Hf=Fe,qf=i,Kf=Po,jf=cc,Yf=mt,Jf=Bf,Qf=Vf,Wf=ff,Zf=xf.setImmediate,zf=xf.clearImmediate,Xf=xf.process,$f=xf.Dispatch,eg=xf.Function,tg=xf.MessageChannel,ng=xf.String,rg=0,og={},ig="onreadystatechange";try{of=xf.location}catch(Sh){}var sg=function(e){if(Hf(og,e)){var t=og[e];delete og[e],t()}},ag=function(e){return function(){sg(e)}},cg=function(e){sg(e.data)},ug=function(e){xf.postMessage(ng(e),of.protocol+"//"+of.host)};Zf&&zf||(Zf=function(e){Jf(arguments.length,1);var t=Ff(e)?e:eg(e),n=jf(arguments,1);return og[++rg]=function(){Gf(t,void 0,n)},sf(rg),rg},zf=function(e){delete og[e]},Wf?sf=function(e){Xf.nextTick(ag(e))}:$f&&$f.now?sf=function(e){$f.now(ag(e))}:tg&&!Qf?(cf=(af=new tg).port2,af.port1.onmessage=cg,sf=kf(cf.postMessage,cf)):xf.addEventListener&&Ff(xf.postMessage)&&!xf.importScripts&&of&&"file:"!==of.protocol&&!qf(ug)?(sf=ug,xf.addEventListener("message",cg,!1)):sf=ig in Yf("script")?function(e){Kf.appendChild(Yf("script"))[ig]=function(){Kf.removeChild(this),sg(e)}}:function(e){setTimeout(ag(e),0)});var dg,lg,hg,fg,gg,pg,vg,_g,Eg={set:Zf,clear:zf},mg=r,Tg=/ipad|iphone|ipod/i.test(X)&&void 0!==mg.Pebble,Ig=/web0s(?!.*chrome)/i.test(X),yg=r,Rg=Oc,Cg=o.f,Sg=Eg.set,Og=Vf,Ng=Tg,Ag=Ig,Mg=ff,Ug=yg.MutationObserver||yg.WebKitMutationObserver,Lg=yg.document,wg=yg.process,bg=yg.Promise,Pg=Cg(yg,"queueMicrotask"),Dg=Pg&&Pg.value;Dg||(dg=function(){var e,t;for(Mg&&(e=wg.domain)&&e.exit();lg;){t=lg.fn,lg=lg.next;try{t()}catch(e){throw lg?fg():hg=void 0,e}}hg=void 0,e&&e.enter()},Og||Mg||Ag||!Ug||!Lg?!Ng&&bg&&bg.resolve?((vg=bg.resolve(void 0)).constructor=bg,_g=Rg(vg.then,vg),fg=function(){_g(dg)}):Mg?fg=function(){wg.nextTick(dg)}:(Sg=Rg(Sg,yg),fg=function(){Sg(dg)}):(gg=!0,pg=Lg.createTextNode(""),new Ug(dg).observe(pg,{characterData:!0}),fg=function(){pg.data=gg=!gg}));var Bg=Dg||function(e){var t={fn:e,next:void 0};hg&&(hg.next=t),lg||(lg=t,fg()),hg=t},Vg=r,xg=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Gg=function(){this.head=null,this.tail=null};Gg.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var kg=Gg,Fg=r.Promise,Hg="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,qg=!Hg&&!ff&&"object"==typeof window&&"object"==typeof document,Kg=r,jg=Fg,Yg=q,Jg=jr,Qg=ln,Wg=ot,Zg=qg,zg=Hg,Xg=ie;jg&&jg.prototype;var $g=Wg("species"),ep=!1,tp=Yg(Kg.PromiseRejectionEvent),np=Jg("Promise",(function(){var e=Qg(jg),t=e!==String(jg);if(!t&&66===Xg)return!0;if(!Xg||Xg<51||!/native code/.test(e)){var n=new jg((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};if((n.constructor={})[$g]=r,!(ep=n.then((function(){}))instanceof r))return!0}return!t&&(Zg||zg)&&!tp})),rp={CONSTRUCTOR:np,REJECTION_EVENT:tp,SUBCLASSING:ep},op={},ip=Te,sp=TypeError,ap=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw sp("Bad Promise constructor");t=e,n=r})),this.resolve=ip(t),this.reject=ip(n)};op.f=function(e){return new ap(e)};var cp,up,dp,lp=$r,hp=ff,fp=r,gp=d,pp=Zn,vp=ru,_p=_f,Ep=yf,mp=Te,Tp=q,Ip=Y,yp=Sf,Rp=Pf,Cp=Eg.set,Sp=Bg,Op=function(e,t){var n=Vg.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))},Np=xg,Ap=kg,Mp=bn,Up=Fg,Lp=op,wp="Promise",bp=rp.CONSTRUCTOR,Pp=rp.REJECTION_EVENT,Dp=rp.SUBCLASSING,Bp=Mp.getterFor(wp),Vp=Mp.set,xp=Up&&Up.prototype,Gp=Up,kp=xp,Fp=fp.TypeError,Hp=fp.document,qp=fp.process,Kp=Lp.f,jp=Kp,Yp=!!(Hp&&Hp.createEvent&&fp.dispatchEvent),Jp="unhandledrejection",Qp=function(e){var t;return!(!Ip(e)||!Tp(t=e.then))&&t},Wp=function(e,t){var n,r,o,i=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,d=e.domain;try{a?(s||(2===t.rejection&&ev(t),t.rejection=1),!0===a?n=i:(d&&d.enter(),n=a(i),d&&(d.exit(),o=!0)),n===e.promise?u(Fp("Promise-chain cycle")):(r=Qp(n))?gp(r,n,c,u):c(n)):u(i)}catch(e){d&&!o&&d.exit(),u(e)}},Zp=function(e,t){e.notified||(e.notified=!0,Sp((function(){for(var n,r=e.reactions;n=r.get();)Wp(n,e);e.notified=!1,t&&!e.rejection&&Xp(e)})))},zp=function(e,t,n){var r,o;Yp?((r=Hp.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),fp.dispatchEvent(r)):r={promise:t,reason:n},!Pp&&(o=fp["on"+e])?o(r):e===Jp&&Op("Unhandled promise rejection",n)},Xp=function(e){gp(Cp,fp,(function(){var t,n=e.facade,r=e.value;if($p(e)&&(t=Np((function(){hp?qp.emit("unhandledRejection",r,n):zp(Jp,n,r)})),e.rejection=hp||$p(e)?2:1,t.error))throw t.value}))},$p=function(e){return 1!==e.rejection&&!e.parent},ev=function(e){gp(Cp,fp,(function(){var t=e.facade;hp?qp.emit("rejectionHandled",t):zp("rejectionhandled",t,e.value)}))},tv=function(e,t,n){return function(r){e(t,r,n)}},nv=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Zp(e,!0))},rv=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Fp("Promise can't be resolved itself");var r=Qp(t);r?Sp((function(){var n={done:!1};try{gp(r,t,tv(rv,n,e),tv(nv,n,e))}catch(t){nv(n,t,e)}})):(e.value=t,e.state=1,Zp(e,!1))}catch(t){nv({done:!1},t,e)}}};if(bp&&(Gp=function(e){yp(this,kp),mp(e),gp(cp,this);var t=Bp(this);try{e(tv(rv,t),tv(nv,t))}catch(e){nv(t,e)}},kp=Gp.prototype,(cp=function(e){Vp(this,{type:wp,done:!1,notified:!1,parent:!1,reactions:new Ap,rejection:!1,state:0,value:void 0})}).prototype=pp(kp,"then",(function(e,t){var n=Bp(this),r=Kp(Rp(this,Gp));return n.parent=!0,r.ok=!Tp(e)||e,r.fail=Tp(t)&&t,r.domain=hp?qp.domain:void 0,0==n.state?n.reactions.add(r):Sp((function(){Wp(r,n)})),r.promise})),up=function(){var e=new cp,t=Bp(e);this.promise=e,this.resolve=tv(rv,t),this.reject=tv(nv,t)},Lp.f=Kp=function(e){return e===Gp||undefined===e?new up(e):jp(e)},Tp(Up)&&xp!==Object.prototype)){dp=xp.then,Dp||pp(xp,"then",(function(e,t){var n=this;return new Gp((function(e,t){gp(dp,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete xp.constructor}catch(Sh){}vp&&vp(xp,kp)}lp({global:!0,constructor:!0,wrap:!0,forced:bp},{Promise:Gp}),_p(Gp,wp,!1),Ep(wp);var ov={},iv=ov,sv=ot("iterator"),av=Array.prototype,cv=function(e){return void 0!==e&&(iv.Array===e||av[sv]===e)},uv=ho,dv=Re,lv=b,hv=ov,fv=ot("iterator"),gv=function(e){if(!lv(e))return dv(e,fv)||dv(e,"@@iterator")||hv[uv(e)]},pv=d,vv=Te,_v=Bt,Ev=ve,mv=gv,Tv=TypeError,Iv=function(e,t){var n=arguments.length<2?mv(e):t;if(vv(n))return _v(pv(n,e));throw Tv(Ev(e)+" is not iterable")},yv=d,Rv=Bt,Cv=Re,Sv=function(e,t,n){var r,o;Rv(e);try{if(!(r=Cv(e,"return"))){if("throw"===t)throw n;return n}r=yv(r,e)}catch(e){o=!0,r=e}if("throw"===t)throw n;if(o)throw r;return Rv(r),n},Ov=Oc,Nv=d,Av=Bt,Mv=ve,Uv=cv,Lv=dr,wv=z,bv=Iv,Pv=gv,Dv=Sv,Bv=TypeError,Vv=function(e,t){this.stopped=e,this.result=t},xv=Vv.prototype,Gv=function(e,t,n){var r,o,i,s,a,c,u,d=n&&n.that,l=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_RECORD),f=!(!n||!n.IS_ITERATOR),g=!(!n||!n.INTERRUPTED),p=Ov(t,d),v=function(e){return r&&Dv(r,"normal",e),new Vv(!0,e)},_=function(e){return l?(Av(e),g?p(e[0],e[1],v):p(e[0],e[1])):g?p(e,v):p(e)};if(h)r=e.iterator;else if(f)r=e;else{if(!(o=Pv(e)))throw Bv(Mv(e)+" is not iterable");if(Uv(o)){for(i=0,s=Lv(e);s>i;i++)if((a=_(e[i]))&&wv(xv,a))return a;return new Vv(!1)}r=bv(e,o)}for(c=h?e.next:r.next;!(u=Nv(c,r)).done;){try{a=_(u.value)}catch(e){Dv(r,"throw",e)}if("object"==typeof a&&a&&wv(xv,a))return a}return new Vv(!1)},kv=ot("iterator"),Fv=!1;try{var Hv=0,qv={next:function(){return{done:!!Hv++}},return:function(){Fv=!0}};qv[kv]=function(){return this},Array.from(qv,(function(){throw 2}))}catch(Sh){}var Kv=function(e,t){if(!t&&!Fv)return!1;var n=!1;try{var r={};r[kv]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},jv=Fg,Yv=rp.CONSTRUCTOR||!Kv((function(e){jv.all(e).then(void 0,(function(){}))})),Jv=d,Qv=Te,Wv=op,Zv=xg,zv=Gv;$r({target:"Promise",stat:!0,forced:Yv},{all:function(e){var t=this,n=Wv.f(t),r=n.resolve,o=n.reject,i=Zv((function(){var n=Qv(t.resolve),i=[],s=0,a=1;zv(e,(function(e){var c=s++,u=!1;a++,Jv(n,t,e).then((function(e){u||(u=!0,i[c]=e,--a||r(i))}),o)})),--a||r(i)}));return i.error&&o(i.value),n.promise}});var Xv=$r,$v=rp.CONSTRUCTOR,e_=Fg,t_=Z,n_=q,r_=Zn,o_=e_&&e_.prototype;if(Xv({target:"Promise",proto:!0,forced:$v,real:!0},{catch:function(e){return this.then(void 0,e)}}),n_(e_)){var i_=t_("Promise").prototype.catch;o_.catch!==i_&&r_(o_,"catch",i_,{unsafe:!0})}var s_=d,a_=Te,c_=op,u_=xg,d_=Gv;$r({target:"Promise",stat:!0,forced:Yv},{race:function(e){var t=this,n=c_.f(t),r=n.reject,o=u_((function(){var o=a_(t.resolve);d_(e,(function(e){s_(o,t,e).then(n.resolve,r)}))}));return o.error&&r(o.value),n.promise}});var l_=d,h_=op;$r({target:"Promise",stat:!0,forced:rp.CONSTRUCTOR},{reject:function(e){var t=h_.f(this);return l_(t.reject,void 0,e),t.promise}});var f_=Bt,g_=Y,p_=op,v_=$r,__=rp.CONSTRUCTOR,E_=function(e,t){if(f_(e),g_(t)&&t.constructor===e)return t;var n=p_.f(e);return(0,n.resolve)(t),n.promise};Z("Promise"),v_({target:"Promise",stat:!0,forced:__},{resolve:function(e){return E_(this,e)}});var m_=r,T_=ia,I_=q,y_=cc,R_=Bf,C_=/MSIE .\./.test(X),S_=m_.Function,O_=function(e){return C_?function(t,n){var r=R_(arguments.length,1)>2,o=I_(t)?t:S_(t),i=r?y_(arguments,2):void 0;return e(r?function(){T_(o,this,i)}:o,n)}:e},N_={setTimeout:O_(m_.setTimeout),setInterval:O_(m_.setInterval)},A_=N_.setInterval;$r({global:!0,bind:!0,forced:r.setInterval!==A_},{setInterval:A_});var M_=N_.setTimeout;$r({global:!0,bind:!0,forced:r.setTimeout!==M_},{setTimeout:M_});var U_=Lt.f,L_=s,w_=r,b_=R,P_=jr,D_=au,B_=Zt,V_=zn.f,x_=z,G_=rd,k_=po,F_=Dh,H_=yo,q_=function(e,t,n){n in e||U_(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},K_=Zn,j_=i,Y_=Fe,J_=bn.enforce,Q_=yf,W_=zo,Z_=ei,z_=ot("match"),X_=w_.RegExp,$_=X_.prototype,eE=w_.SyntaxError,tE=b_($_.exec),nE=b_("".charAt),rE=b_("".replace),oE=b_("".indexOf),iE=b_("".slice),sE=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,aE=/a/g,cE=/a/g,uE=new X_(aE)!==aE,dE=H_.MISSED_STICKY,lE=H_.UNSUPPORTED_Y,hE=L_&&(!uE||dE||W_||Z_||j_((function(){return cE[z_]=!1,X_(aE)!=aE||X_(cE)==cE||"/a/i"!=X_(aE,"i")})));if(P_("RegExp",hE)){for(var fE=function(e,t){var n,r,o,i,s,a,c=x_($_,this),u=G_(e),d=void 0===t,l=[],h=e;if(!c&&u&&d&&e.constructor===fE)return e;if((u||x_($_,e))&&(e=e.source,d&&(t=F_(h))),e=void 0===e?"":k_(e),t=void 0===t?"":k_(t),h=e,W_&&"dotAll"in aE&&(r=!!t&&oE(t,"s")>-1)&&(t=rE(t,/s/g,"")),n=t,dE&&"sticky"in aE&&(o=!!t&&oE(t,"y")>-1)&&lE&&(t=rE(t,/y/g,"")),Z_&&(i=function(e){for(var t,n=e.length,r=0,o="",i=[],s={},a=!1,c=!1,u=0,d="";r<=n;r++){if("\\"===(t=nE(e,r)))t+=nE(e,++r);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:tE(sE,iE(e,r+1))&&(r+=2,c=!0),o+=t,u++;continue;case">"===t&&c:if(""===d||Y_(s,d))throw new eE("Invalid capture group name");s[d]=!0,i[i.length]=[d,u],c=!1,d="";continue}c?d+=t:o+=t}return[o,i]}(e),e=i[0],l=i[1]),s=D_(X_(e,t),c?this:$_,fE),(r||o||l.length)&&(a=J_(s),r&&(a.dotAll=!0,a.raw=fE(function(e){for(var t,n=e.length,r=0,o="",i=!1;r<=n;r++)"\\"!==(t=nE(e,r))?i||"."!==t?("["===t?i=!0:"]"===t&&(i=!1),o+=t):o+="[\\s\\S]":o+=t+nE(e,++r);return o}(e),n)),o&&(a.sticky=!0),l.length&&(a.groups=l)),e!==h)try{B_(s,"source",""===h?"(?:)":h)}catch(e){}return s},gE=V_(X_),pE=0;gE.length>pE;)q_(fE,X_,gE[pE++]);$_.constructor=fE,fE.prototype=$_,K_(w_,"RegExp",fE,{constructor:!0})}Q_("RegExp");var vE,_E,EE,mE,TE=function(e){if(!ul(e)||void 0===e.low||void 0===e.high)return e;var t=e.low;return t<0&&(t+=4294967296),t=t.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{".concat(t.length,"}$")),t),16)},IE=function(e,t){var n=Math.floor(1e3*Math.random()%1e4),r=Qh(),o=function(e){e=e||"-";var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,o=t.getDate();return"".concat(n).concat(e).concat(r).concat(e).concat(o)}(),i=(new Date).getTime(),s="";if(t){var a=t.split(".");s=".".concat(a[a.length-1])}return"".concat(e,"__RC-").concat(o,"_").concat(n,"_").concat(i).concat(r).concat(s)},yE=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=e.threadId,r=e.apnsCollapseId,o=e.category,i=e.richMediaUri,s=t.channelIdMi,a=t.channelIdHW,c=t.channelIdOPPO,u=t.typeVivo,d=t.googleConfig,l={};l["thread-id"]=n||"",l["apns-collapse-id"]=r||"",l.category=o||"",l.richMediaUri=i||"";var h={};h.collapse_key=null==d?void 0:d.collapseKey,h.imageUrl=null==d?void 0:d.imageUrl;var f=null==d?void 0:d.priority;f&&!["high","normal"].includes(f)&&(f="normal"),h.priority=f;var g=[{HW:{channelId:a||""}},{MI:{channelId:s||""}},{OPPO:{channelId:c||""}},{VIVO:{classification:u||""}},{APNS:l},{FCM:h}];return JSON.stringify(g)},RE=function(e,t,n){var r={},o={notificationId:n||""};if(!t)return{iOSConfig:r,androidConfig:o};try{var i=JSON.parse(t);null==i||i.forEach((function(e){var t,n,i,s,a=Object.keys(e);if(0!==a.length){var c=a[0];switch(c){case"HW":return void(o.channelIdHW=null===(t=e[c])||void 0===t?void 0:t.channelId);case"MI":return void(o.channelIdMi=null===(n=e[c])||void 0===n?void 0:n.channelId);case"OPPO":return void(o.channelIdOPPO=null===(i=e[c])||void 0===i?void 0:i.channelId);case"VIVO":return void(o.typeVivo=null===(s=e[c])||void 0===s?void 0:s.classification);case"APNS":return r.threadId=e[c]["thread-id"],r.apnsCollapseId=e[c]["apns-collapse-id"],r.category=e[c].category,void(r.richMediaUri=e[c].richMediaUri);case"FCM":o.googleConfig={collapseKey:e[c].collapse_key||"",imageUrl:e[c].imageUrl||"",priority:e[c].priority||""}}}}))}catch(n){e.error(Dd.O,"Wrong format for pushConfigs field! content: ".concat(t))}return{iOSConfig:r,androidConfig:o}},CE=function(e){var t=/^[A-Za-z0-9_=+-]+$/.test(e),n=e.length;return t&&(n<=128&&n>=1)},SE=function(e){var t=e.length;return t<=4096&&t>=1},OE=(vE=0,function(){var e=((4294967295&Date.now())>>>0).toString(2),t=Math.floor(Math.random()*(Math.pow(2,20)-1)),n=e+vE.toString(2).padStart(11,"0")+t.toString(2).padStart(20,"0");return vE=2047&++vE,parseInt(n,2)}),NE=function(e,t,n){var r=null==n?void 0:n.isReverse;ul(e)&&function(){for(var n in e)t(e[n],n,e)}(),(sl(e)||ol(e))&&function(){if(r)for(var n=e.length-1;n>=0;n--)t(e[n],n);else for(var o=0,i=e.length;o<i;o++)t(e[o],o)}()},AE=function(e,t){return NE(e,(function(n,r){e[r]=t(n,r)})),e},ME=function(e,t){if(e.indexOf)return e.indexOf(t);var n=-1;return NE(e,(function(e,r){t===e&&(n=r)})),n},UE=function(e,t){var n=[];return NE(e,(function(e){n.push(e)})),-1!==ME(n,t)},LE=function(e){return JSON.parse(JSON.stringify(e))},wE=function(){return"undefined"!=typeof RCCppEngine},bE=function e(t){var n;if("object"===no(t)&&null!==t)if(Array.isArray(t))for(var r in n=[],t)n.push(e(t[r]));else for(var r in n={},t)n[r]=e(t[r]);else n=t;return n},PE=function(e){var t;try{t=bE(e)}catch(n){Mh.error("clone err:",n),t=JSON.parse(JSON.stringify(e))}return t},DE=function(e){var t={},n=JSON.parse(e);return NE(n,(function(e,n){t[n]=e.v})),t},BE={_delayTime:0,setTime:function(e){var t=(new Date).getTime();BE._delayTime=t-e},getTime:function(){var e=BE._delayTime;return(new Date).getTime()-e}},VE=function(e,t){var n=0;return e.isAutoDelete&&(n|=1),e.isOverwrite&&(n|=2),2===t&&(n|=4),n},xE=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),GE=Fe,kE=q,FE=xe,HE=xE,qE=En("IE_PROTO"),KE=Object,jE=KE.prototype,YE=HE?KE.getPrototypeOf:function(e){var t=FE(e);if(GE(t,qE))return t[qE];var n=t.constructor;return kE(n)&&t instanceof n?n.prototype:t instanceof KE?jE:null},JE=i,QE=q,WE=Y,ZE=YE,zE=Zn,XE=ot("iterator"),$E=!1;[].keys&&("next"in(mE=[].keys())?(EE=ZE(ZE(mE)))!==Object.prototype&&(_E=EE):$E=!0);var em=!WE(_E)||JE((function(){var e={};return _E[XE].call(e)!==e}));em&&(_E={}),QE(_E[XE])||zE(_E,XE,(function(){return this}));var tm={IteratorPrototype:_E,BUGGY_SAFARI_ITERATORS:$E},nm=tm.IteratorPrototype,rm=Qo,om=E,im=_f,sm=ov,am=function(){return this},cm=function(e,t,n,r){var o=t+" Iterator";return e.prototype=rm(nm,{next:om(+!r,n)}),im(e,o,!1),sm[o]=am,e},um=$r,dm=d,lm=q,hm=cm,fm=YE,gm=ru,pm=_f,vm=Zt,_m=Zn,Em=ov,mm=rn.PROPER,Tm=rn.CONFIGURABLE,Im=tm.IteratorPrototype,ym=tm.BUGGY_SAFARI_ITERATORS,Rm=ot("iterator"),Cm="keys",Sm="values",Om="entries",Nm=function(){return this},Am=function(e,t,n,r,o,i,s){hm(n,t,r);var a,c,u,d=function(e){if(e===o&&p)return p;if(!ym&&e in f)return f[e];switch(e){case Cm:case Sm:case Om:return function(){return new n(this,e)}}return function(){return new n(this)}},l=t+" Iterator",h=!1,f=e.prototype,g=f[Rm]||f["@@iterator"]||o&&f[o],p=!ym&&g||d(o),v="Array"==t&&f.entries||g;if(v&&(a=fm(v.call(new e)))!==Object.prototype&&a.next&&(fm(a)!==Im&&(gm?gm(a,Im):lm(a[Rm])||_m(a,Rm,Nm)),pm(a,l,!0)),mm&&o==Sm&&g&&g.name!==Sm&&(Tm?vm(f,"name",Sm):(h=!0,p=function(){return dm(g,this)})),o)if(c={values:d(Sm),keys:i?p:d(Cm),entries:d(Om)},s)for(u in c)(ym||h||!(u in f))&&_m(f,u,c[u]);else um({target:t,proto:!0,forced:ym||h},c);return f[Rm]!==p&&_m(f,Rm,p,{name:o}),Em[t]=p,c},Mm=function(e,t){return{value:e,done:t}},Um=G,Lm=Zu,wm=ov,bm=bn,Pm=Lt.f,Dm=Am,Bm=Mm,Vm=s,xm="Array Iterator",Gm=bm.set,km=bm.getterFor(xm),Fm=Dm(Array,"Array",(function(e,t){Gm(this,{type:xm,target:Um(e),index:0,kind:t})}),(function(){var e=km(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,Bm(void 0,!0)):Bm("keys"==n?r:"values"==n?t[r]:[r,t[r]],!1)}),"values"),Hm=wm.Arguments=wm.Array;if(Lm("keys"),Lm("values"),Lm("entries"),Vm&&"values"!==Hm.name)try{Pm(Hm,"name",{value:"values"})}catch(Sh){}var qm=r,Km=Hl,jm=jl,Ym=Fm,Jm=Zt,Qm=ot,Wm=Qm("iterator"),Zm=Qm("toStringTag"),zm=Ym.values,Xm=function(e,t){if(e){if(e[Wm]!==zm)try{Jm(e,Wm,zm)}catch(t){e[Wm]=zm}if(e[Zm]||Jm(e,Zm,t),Km[t])for(var n in Ym)if(e[n]!==Ym[n])try{Jm(e,n,Ym[n])}catch(t){e[n]=Ym[n]}}};for(var $m in Km)Xm(qm[$m]&&qm[$m].prototype,$m);Xm(jm,"DOMTokenList");var eT,tT,nT=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._pullTime=0,this._engine=e}return e.prototype._startPull=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.roomId,n=e.timestamp,(r=this._pullTime)>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullRTCRoomEntry(t,r)]);case 1:return o=a.sent(),i=o.code,s=o.data,i===Ed.SUCCESS?(this._isPulling=!1,this._pullTime=s.syncTime||0,this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pullEntry=function(e,t){this._pullQueue.push({roomId:e,timestamp:t}),this._startPull()},e.prototype.reset=function(){this._pullTime=0,this._isPulling=!1},e}(),rT="rtcRJoin_data",oT="rtcRExit",iT="rtcRInfo",sT="rtcUData",aT="rtcUPut",cT="rtcUDel",uT="rtcSetData",dT="userSetData",lT="rtcQryData",hT="rtcDelData",fT="rtcToken",gT="rtcUserState",pT="rtcUList",vT="viewerJoinR",_T="viewerExitR",ET="rtcPullKv",mT="rtcIdentityChange",TT="rtcInvite",IT="rtcCancelInvite",yT="rtcInviteAnswer",RT="rtcEndInvite",CT="rtcQueryJoined";!function(e){e.RtcInput="RtcInput",e.RtcUserListOutput="RtcUserListOutput",e.SetUserStatusInput="SetUserStatusInput",e.RtcSetDataInput="RtcSetDataInput",e.RtcUserSetDataInput="RtcUserSetDataInput",e.RtcDataInput="RtcDataInput",e.RtcSetOutDataInput="RtcSetOutDataInput",e.MCFollowInput="MCFollowInput",e.RtcTokenOutput="RtcTokenOutput",e.RtcQryOutput="RtcQryOutput",e.RtcQryUserOutDataInput="RtcQryUserOutDataInput",e.RtcUserOutDataOutput="RtcUserOutDataOutput",e.RtcQueryListInput="RtcQueryListInput",e.RtcRoomInfoOutput="RtcRoomInfoOutput",e.RtcValueInfo="RtcValueInfo",e.RtcKeyDeleteInput="RtcKeyDeleteInput",e.RtcNotifyMsg="RtcNotifyMsg",e.RtcPullKV="RtcPullKV",e.RtcKVOutput="RtcKVOutput",e.RtcQueryUserJoinedInput="RtcQueryUserJoinedInput",e.RtcQueryUserJoinedOutput="RtcQueryUserJoinedOutput",e.RtcViewerJoinedOutput="RtcViewerJoinedOutput",e.RtcInviteInput="RtcInviteInput",e.RtcCancelInviteInput="RtcCancelInviteInput",e.RtcInviteAnswerInput="RtcInviteAnswerInput",e.RtcEndInviteInput="RtcEndInviteInput",e.RtcOutput="RtcOutput"}(tT||(tT={}));var ST=((eT={})[tT.RtcInput]=["roomType","broadcastType","extraInnerData","needSysChatroom","identityChangeType","joinType","innerDatas","outerDatas"],eT[tT.RtcUserListOutput]=["users","token","sessionId","roomInfo"],eT[tT.SetUserStatusInput]=["status"],eT[tT.RtcSetDataInput]=["interior","target","key","value","objectName","content"],eT[tT.RtcUserSetDataInput]=["valueInfo","objectName","content"],eT[tT.RtcDataInput]=["interior","target","key","objectName","content"],eT[tT.RtcSetOutDataInput]=["target","valueInfo","objectName","content"],eT[tT.MCFollowInput]=["state"],eT[tT.RtcTokenOutput]=["rtcToken"],eT[tT.RtcQryOutput]=["outInfo"],eT[tT.RtcQryUserOutDataInput]=["userId"],eT[tT.RtcUserOutDataOutput]=["user"],eT[tT.RtcQueryListInput]=["order"],eT[tT.RtcRoomInfoOutput]=["roomId","roomData","userCount","list"],eT[tT.RtcValueInfo]=["key","value"],eT[tT.RtcKeyDeleteInput]=["key"],eT[tT.RtcNotifyMsg]=["type","time","roomId"],eT[tT.RtcPullKV]=["timestamp","roomId"],eT[tT.RtcKVOutput]=["entries","bFullUpdate","syncTime"],eT[tT.RtcQueryUserJoinedInput]=["userId"],eT[tT.RtcQueryUserJoinedOutput]=["info"],eT[tT.RtcInviteInput]=["invitedUserId","timeoutTime","invitedRoomId","inviteInfo","inviteSessionId"],eT[tT.RtcCancelInviteInput]=["invitedUserId","invitedRoomId","inviteInfo","inviteSessionId"],eT[tT.RtcInviteAnswerInput]=["inviteUserId","answerCode","inviteRoomId","inviteSessionId","content","key","value"],eT[tT.RtcEndInviteInput]=["inviteRoomId","inviteSessionId","inviteContent","inviteRoomKeys"],eT),OT="\npackage Modules;\nmessage probuf {\n  enum JoinType {\n    KICK = 0; //踢前一个设备\n    REFUSE = 1; //当前加入拒绝\n    COEXIST = 2; //两个设备共存\n  }\n  enum targetType {\n    ROOM =1 ;\n    PERSON = 2;\n  }\n  message ".concat(tT.SetUserStatusInput,"\n  {\n    optional int32 status=1;\n  }\n  message ").concat(tT.MCFollowInput,"\n  {\n    required string state = 1;\n  }\n  message ").concat(tT.RtcQueryListInput,"{\n    optional int32 order=1;\n  }\n  message ").concat(tT.RtcKeyDeleteInput,"{\n    repeated string key=1;\n  }\n  message ").concat(tT.RtcValueInfo,"{\n    required string key=1;\n    required string value=2;\n  }\n  message RtcUserInfo{\n    required string userId=1;\n    repeated ").concat(tT.RtcValueInfo," userData=2; //用户资源信息\n  }\n  message ").concat(tT.RtcUserListOutput,"{\n    repeated RtcUserInfo users=1;\n    optional string token=2;\n    optional string sessionId=3;\n    repeated RtcValueInfo roomInfo = 4; //房间key value\n    repeated RtcKVEntity entries = 5;//直播KV属性对象集合\n    optional int64 syncTime = 6;//所有属性的最大时间戳（下次拉取KV时用）。\n    optional int32 offlineKickTime = 7;//server超时踢人时间，默认60s\n  }\n  message RtcRoomInfoOutput{\n    optional string roomId = 1;\n    repeated ").concat(tT.RtcValueInfo," roomData = 2;\n    optional int32 userCount = 3;\n    repeated RtcUserInfo list=4;\n  }\n  message ").concat(tT.RtcInput,"{\n    required int32 roomType=1;\n    optional int32 broadcastType=2;\n    optional RtcValueInfo extraInnerData = 3;\n    optional bool needSysChatroom = 4; //是否需要同步聊天室\n    optional IdentityChangeType identityChangeType = 5; //身份变更类型\n    optional JoinType joinType = 6; // 加入房间类型\n    repeated ").concat(tT.RtcValueInfo," innerDatas = 7; //用户内部inner数据，角色或者连麦信息等\n    repeated ").concat(tT.RtcValueInfo," outerDatas = 8; //用户内部outer数据，自定义数据结构RtcInput。\n  }\n  message ").concat(tT.RtcQryOutput,"{\n    repeated ").concat(tT.RtcValueInfo," outInfo=1;\n  }\n  message ").concat(tT.RtcDataInput,"{\n    required bool interior=1;\n    required targetType target=2;\n    repeated string key=3;\n    optional string objectName=4;\n    optional string content=5;\n  }\n  message ").concat(tT.RtcSetDataInput,"{\n    required bool interior=1;\n    required targetType target=2;\n    required string key=3;\n    required string value=4;\n    optional string objectName=5;\n    optional string content=6;\n  }\n  message ").concat(tT.RtcUserSetDataInput," {\n    repeated ").concat(tT.RtcValueInfo," valueInfo = 1;\n    required string objectName = 2;\n    repeated ").concat(tT.RtcValueInfo," content = 3;\n  }\n  message RtcQryInput{\n    required bool isInterior=1;\n    required targetType target=2;\n    repeated string key=3;\n  }\n  message RtcDelDataInput{\n    repeated string key=1;\n    required bool isInterior=2;\n    required targetType target=3;\n  }\n  message RtcOutput\n  {\n    optional int32 nothing=1;\n    optional int64 version=2;\n  }\n  message ").concat(tT.RtcTokenOutput,"{\n    required string rtcToken=1;\n  }\n  message ").concat(tT.RtcSetOutDataInput,"{\n    required targetType target=1;\n    repeated ").concat(tT.RtcValueInfo," valueInfo=2;\n    optional string objectName=3;\n    optional string content=4;\n  }\n  message ").concat(tT.RtcQryUserOutDataInput,"{\n    repeated string userId = 1;\n  }\n  message ").concat(tT.RtcUserOutDataOutput,"{\n    repeated RtcUserInfo user = 1;\n  }\n  message ").concat(tT.RtcNotifyMsg," \n  {\n    required int32 type= 1;   //(通知类型 1:rtc房间状态KV变更通知)\n    optional int64 time= 2;   //消息产生时间\n    optional string roomId=3; //主播房间id\n  }\n  message ").concat(tT.RtcPullKV,"\n  {\n    required int64 timestamp = 1;\n    required string roomId = 2;\n  }\n  message RtcKVEntity \n  {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  message ").concat(tT.RtcKVOutput,"\n  {\n    repeated RtcKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3; \n  }\n  enum IdentityChangeType \n  {\n    AnchorToViewer = 1; //1为主播变观众\n    ViewerToAnchor = 2; //2为观众变主播\n  }\n  message ").concat(tT.RtcQueryUserJoinedInput,"\n  {\n    required string userId = 1;\n  }\n  message RtcJoinedInfo\n  {\n    required string deviceId = 1; //设备ID\n    required string roomId = 2;   //加入的房间ID\n    optional int64 joinTime = 3;  //加入的时间\n  }\n  message ").concat(tT.RtcQueryUserJoinedOutput,"\n  {\n    repeated RtcJoinedInfo info = 1;\n  }\n  message ").concat(tT.RtcViewerJoinedOutput,"\n  {\n    required string rtcToken=1;\n    repeated RtcKVEntity entries = 2;//KV属性对象集合\n    optional int64 syncTime = 3;//所有属性的最大时间戳（下次拉取KV时用）。\n  }\n  message ").concat(tT.RtcInviteInput,"\n  {\n    required string invitedUserId=1;    //被邀请的人的uid\n    optional int32  timeoutTime=2;       //邀请超时时间(秒),默认三十秒\n    required string invitedRoomId=3;    //被邀请的房间\n    required string inviteInfo=4;       //邀请的信息(包含邀请人,被邀请人,各自userid)客户端定义好.协议栈和server透传\n    required string inviteSessionId= 5; //客户端保证唯一性(建议roomid_userid_时间戳_随机数)\n  }\n  message ").concat(tT.RtcCancelInviteInput,"\n  {\n    required string invitedUserId=1;   //被邀请的人的uid\n    required string invitedRoomId=2;   //被邀请的房间\n    required string inviteInfo=3;      //取消邀请的信息(包含邀请人,被邀请人,各自userid)客户端定义好.协议栈和server透传\n    required string inviteSessionId=4; //邀请的sessionId,客户端发起邀请时产生\n  }\n  message ").concat(tT.RtcInviteAnswerInput,"\n  {\n    required string inviteUserId=1;    //邀请的人的uid\n    required int32  answerCode=2;      //是否接受连麦邀请.0为拒绝,1为接受\n    required string inviteRoomId=3;    //邀请的房间\n    required string inviteSessionId=4; //邀请的sessionId\n    required string content=5;         //需要转发的content\n    optional string key=6;             //如果接受的话,需要加这个字段,放在room级别的k和v,新加入房间的能拉取到\n    optional string value=7;           //如果接受的话,需要加这个字段,放在room级别的k和v,新加入房间的能拉取到\n  }\n  message ").concat(tT.RtcEndInviteInput,"\n  {\n    required string inviteRoomId=1;    //邀请的房间\n    required string inviteSessionId=2; //邀请的sessionId\n    required string inviteContent=3;   //结束连麦的信息(需要透传给房间内其他人)\n    repeated string inviteRoomKeys=4;  //需要删除连麦的信息的key\n  }\n}\n"),NT=function(e,t,n,r,o,i){var s=o?Object.keys(o).map((function(t){return e.encode(tT.RtcValueInfo,{key:t,value:o[t]},!0)})):void 0,a=i?Object.keys(i).map((function(t){return e.encode(tT.RtcValueInfo,{key:t,value:i[t]},!0)})):void 0;return e.encode(tT.RtcInput,{roomType:t,broadcastType:n,joinType:r,innerDatas:s,outerDatas:a})},AT=function(e,t){var n=e.decode(tT.RtcUserListOutput,t),r=n.users,o=n.token,i=n.sessionId,s=n.roomInfo,a=n.entries,c=n.offlineKickTime,u={};return NE(r,(function(e){var t=e.userId,n=e.userData,r={};NE(n,(function(e){var t=e.key,n=e.value;r[t]=n})),u[t]=r})),{users:u,token:o,sessionId:i,roomInfo:s,kvEntries:a,offlineKickTime:c}},MT=function(){function e(e,t,n,r,o){this.runtime=e,this.rtcCodec=t,this._watcher=n,this._options=r,this.logger=o,this._appkey=this._options.appkey,this._rtcKVManager=new nT(this)}return e.prototype.registerRTCSignalingListener=function(e){this._rtcSignalingListener=e},e.prototype.getInnerLogger=function(){return this.logger},e.prototype.joinRTCRoom=function(e,t,n,r,o,i){return oc(this,void 0,void 0,(function(){var s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return s=NT(this.rtcCodec,t,n,r,o,i),[4,this.rtcSignaling(e,rT,!0,s)];case 1:return a=l.sent(),c=a.code,u=a.buffer,c===Ed.SUCCESS&&u&&(d=AT(this.rtcCodec,u)),[2,{code:c,data:d}]}}))}))},e.prototype.quitRTCRoom=function(e){return oc(this,void 0,void 0,(function(){var t;return ic(this,(function(n){switch(n.label){case 0:return t=this.rtcCodec.encode(tT.SetUserStatusInput,{status:0}),[4,this.rtcSignaling(e,oT,!0,t)];case 1:return[2,n.sent().code]}}))}))},e.prototype.getRTCRoomInfo=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return t=this.rtcCodec.encode(tT.RtcQueryListInput,{order:2}),[4,this.rtcSignaling(e,iT,!0,t)];case 1:return n=s.sent(),r=n.code,o=n.buffer,r===Ed.SUCCESS&&o&&(i=this.rtcCodec.decode(tT.RtcRoomInfoOutput,o)),[2,{code:r,data:i}]}}))}))},e.prototype.getRTCUserInfoList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return t=this.rtcCodec.encode(tT.RtcQueryListInput,{order:2}),[4,this.rtcSignaling(e,sT,!0,t)];case 1:return n=a.sent(),r=n.code,o=n.buffer,r===Ed.SUCCESS&&o&&(s=AT(this.rtcCodec,o),i={users:s.users}),[2,{code:r,data:i}]}}))}))},e.prototype.getRTCUserInfo=function(e){throw new Error("Method not implemented.")},e.prototype.setRTCUserInfo=function(e,t,n){return oc(this,void 0,void 0,(function(){var r;return ic(this,(function(o){switch(o.label){case 0:return r=this.rtcCodec.encode(tT.RtcValueInfo,{key:t,value:n}),[4,this.rtcSignaling(e,aT,!0,r)];case 1:return[2,o.sent().code]}}))}))},e.prototype.removeRTCUserInfo=function(e,t){return oc(this,void 0,void 0,(function(){var n;return ic(this,(function(r){switch(r.label){case 0:return n=this.rtcCodec.encode(tT.RtcKeyDeleteInput,{key:t}),[4,this.rtcSignaling(e,cT,!1,n)];case 1:return[2,r.sent().code]}}))}))},e.prototype.setRTCData=function(e,t,n,r,o,i){return oc(this,void 0,void 0,(function(){var s;return ic(this,(function(a){switch(a.label){case 0:return s=this.rtcCodec.encode(tT.RtcSetDataInput,{interior:r,target:o,key:t,value:n,objectName:null==i?void 0:i.name,content:null==i?void 0:i.content}),[4,this.rtcSignaling(e,uT,!1,s)];case 1:return[2,a.sent().code]}}))}))},e.prototype.setRTCTotalRes=function(e,t,n,r,o){return oc(this,void 0,void 0,(function(){var i,s;return ic(this,(function(a){switch(a.label){case 0:return i={objectName:r,content:this.rtcCodec.encode(tT.RtcValueInfo,{key:t.name,value:t.content},!0),valueInfo:[this.rtcCodec.encode(tT.RtcValueInfo,{key:"uris",value:n},!0),this.rtcCodec.encode(tT.RtcValueInfo,{key:"mcu_uris",value:o},!0)]},s=this.rtcCodec.encode(tT.RtcUserSetDataInput,i),[4,this.rtcSignaling(e,dT,!0,s)];case 1:return[2,a.sent().code]}}))}))},e.prototype.getRTCData=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return o=this.rtcCodec.encode(tT.RtcDataInput,{interior:n,target:r,key:t}),[4,this.rtcSignaling(e,lT,!0,o)];case 1:return i=d.sent(),s=i.code,a=i.buffer,s===Ed.SUCCESS&&a?(c=this.rtcCodec.decode(tT.RtcQryOutput,a).outInfo,u={},c.forEach((function(e){u[e.key]=e.value})),[2,{code:s,data:u}]):[2,{code:s}]}}))}))},e.prototype.removeRTCData=function(e,t,n,r,o){return oc(this,void 0,void 0,(function(){var i;return ic(this,(function(s){switch(s.label){case 0:return i=this.rtcCodec.encode(tT.RtcDataInput,{interior:n,target:r,key:t,objectName:null==o?void 0:o.name,content:null==o?void 0:o.content}),[4,this.rtcSignaling(e,hT,!1,i)];case 1:return[2,s.sent().code]}}))}))},e.prototype.setRTCOutData=function(e,t,n,r){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){throw new Error("JSEngine's method not implemented.")}))}))},e.prototype.getRTCOutData=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){throw new Error("JSEngine's method not implemented.")}))}))},e.prototype.getRTCToken=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return r=NT(this.rtcCodec,t,n),[4,this.rtcSignaling(e,fT,!0,r)];case 1:return o=c.sent(),i=o.code,s=o.buffer,i===Ed.SUCCESS&&s?(a=this.rtcCodec.decode(tT.RtcTokenOutput,s).rtcToken,[2,{code:i,data:{rtcToken:a}}]):[2,{code:i}]}}))}))},e.prototype.setRTCState=function(e,t){return oc(this,void 0,void 0,(function(){var n;return ic(this,(function(r){switch(r.label){case 0:return n=this.rtcCodec.encode(tT.MCFollowInput,{state:t}),[4,this.rtcSignaling(e,gT,!0,n)];case 1:return[2,r.sent().code]}}))}))},e.prototype.getRTCUserList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return t=this.rtcCodec.encode(tT.RtcQueryListInput,{order:2}),[4,this.rtcSignaling(e,pT,!0,t)];case 1:return n=s.sent(),r=n.code,o=n.buffer,r===Ed.SUCCESS&&o?(i=AT(this.rtcCodec,o),[2,{code:r,data:i}]):[2,{code:r}]}}))}))},e.prototype.joinLivingRoomAsAudience=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return r=NT(this.rtcCodec,t,n),[4,this.rtcSignaling(e,vT,!0,r)];case 1:return o=d.sent(),i=o.code,s=o.buffer,i===Ed.SUCCESS&&s?(a=this.rtcCodec.decode(tT.RtcViewerJoinedOutput,s),c=a.rtcToken,u=a.entries,[2,{code:i,data:{token:c,kvEntries:u}}]):[2,{code:i}]}}))}))},e.prototype.pullRTCRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t=this.rtcCodec.encode(tT.RtcPullKV,{timestamp:0,roomId:e}),[4,this.rtcSignaling(e,ET,!0,t)];case 1:return n=c.sent(),r=n.code,o=n.buffer,r!==Ed.SUCCESS?[2,{code:r}]:(i=this.rtcCodec.decode(tT.RtcKVOutput,o),s=i.entries,i.bFullUpdate,a=i.syncTime,s=(s||[]).map((function(e){return rc(rc({},e),{timestamp:TE(e.timestamp)})})),this._watcher.onRTCDataChange(s,e),[2,{code:r,data:{kvEntries:s,syncTime:TE(a)}}])}}))}))},e.prototype.quitLivingRoomAsAudience=function(e){return oc(this,void 0,void 0,(function(){var t,n;return ic(this,(function(r){switch(r.label){case 0:return t=this.rtcCodec.encode(tT.SetUserStatusInput,{status:0}),[4,this.rtcSignaling(e,_T,!0,t)];case 1:return n=r.sent().code,this._rtcKVManager.reset(),[2,n]}}))}))},e.prototype.rtcIdentityChange=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return r=this.rtcCodec.encode(tT.RtcInput,{roomType:Zd.LIVE,broadcastType:n,identityChangeType:t,needSysChatroom:!1}),[4,this.rtcSignaling(e,mT,!0,r)];case 1:return o=c.sent(),i=o.code,s=o.buffer,i===Ed.SUCCESS&&s?(a=AT(this.rtcCodec,s),[2,{code:i,data:a}]):[2,{code:i}]}}))}))},e.prototype.getRTCJoinedUserInfo=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return t=this.rtcCodec.encode(tT.RtcQueryUserJoinedInput,{userId:e}),[4,this.rtcSignaling("",CT,!0,t)];case 1:return n=s.sent(),r=n.code,o=n.buffer,r===Ed.SUCCESS&&o?(i=this.rtcCodec.decode(tT.RtcQueryUserJoinedOutput,o).info||[],[2,{code:r,data:i.map((function(e){return{deviceId:e.deviceId,roomId:e.roomId,joinTime:TE(e.joinTime)}}))}]):[2,{code:r}]}}))}))},e.prototype.setRTCCDNUris=function(e,t,n){return oc(this,void 0,void 0,(function(){var r;return ic(this,(function(o){switch(o.label){case 0:return r=this.rtcCodec.encode(tT.RtcUserSetDataInput,{objectName:t,valueInfo:this.rtcCodec.encode(tT.RtcValueInfo,{key:"cdn_uris",value:n},!0)}),[4,this.rtcSignaling(e,dT,!0,r)];case 1:return[2,o.sent().code]}}))}))},e.prototype.requestRoomPK=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return t=e.invitedRoomId,n=e.invitedUserId,r=e.inviteSessionId,o=e.inviteTimeout,i=e.inviteInfo,s=e.roomId,a=this.rtcCodec.encode(tT.RtcInviteInput,{invitedRoomId:t,invitedUserId:n,inviteSessionId:r,timeoutTime:o,inviteInfo:i}),[4,this.rtcSignaling(s,TT,!0,a)];case 1:return c=u.sent().code,this._rtcKVManager.reset(),[2,c]}}))}))},e.prototype.cancelRoomPK=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t=e.invitedRoomId,n=e.invitedUserId,r=e.inviteSessionId,o=e.inviteInfo,i=e.roomId,s=this.rtcCodec.encode(tT.RtcCancelInviteInput,{invitedRoomId:t,invitedUserId:n,inviteSessionId:r,inviteInfo:o}),[4,this.rtcSignaling(i,IT,!0,s)];case 1:return a=c.sent().code,this._rtcKVManager.reset(),[2,a]}}))}))},e.prototype.responseRoomPK=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return t=e.inviteUserId,n=e.inviteRoomId,r=e.inviteSessionId,o=e.content,i=e.key,s=e.value,a=e.agree,c=e.roomId,u=this.rtcCodec.encode(tT.RtcInviteAnswerInput,{inviteUserId:t,inviteRoomId:n,inviteSessionId:r,content:o,key:i,value:s,answerCode:a?1:0}),[4,this.rtcSignaling(c,yT,!0,u)];case 1:return d=l.sent().code,this._rtcKVManager.reset(),[2,d]}}))}))},e.prototype.endRoomPK=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t=e.endRoomId,n=e.sessionId,r=e.content,o=e.keys,i=e.roomId,s=this.rtcCodec.encode(tT.RtcEndInviteInput,{inviteRoomId:t,inviteSessionId:n,inviteContent:r,inviteRoomKeys:o}),[4,this.rtcSignaling(i,RT,!0,s)];case 1:return a=c.sent().code,this._rtcKVManager.reset(),[2,a]}}))}))},e.prototype._receiveRtcKv=function(e){if(this._rtcSignalingListener)this._rtcSignalingListener(e);else{var t=this.rtcCodec.decode(tT.RtcNotifyMsg,e),n=t.time,r=t.type,o=t.roomId;if(1===r)this._rtcKVManager.pullEntry(o,TE(n))}},e.prototype.destroy=function(){},e}(),UT=B,LT=po,wT=/"/g,bT=R("".replace),PT=i,DT=function(e,t,n,r){var o=LT(UT(e)),i="<"+t;return""!==n&&(i+=" "+n+'="'+bT(LT(r),wT,"&quot;")+'"'),i+">"+o+"</"+t+">"},BT=function(e){return PT((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))};$r({target:"String",proto:!0,forced:BT("sub")},{sub:function(){return DT(this,"sub","","")}});var VT="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,xT=Zn,GT=function(e,t,n){for(var r in t)xT(e,r,t[r],n);return e},kT=tr,FT=cr,HT=RangeError,qT=function(e){if(void 0===e)return 0;var t=kT(e),n=FT(t);if(t!==n)throw HT("Wrong length or index");return n},KT=Array,jT=Math.abs,YT=Math.pow,JT=Math.floor,QT=Math.log,WT=Math.LN2,ZT={pack:function(e,t,n){var r,o,i,s=KT(n),a=8*n-t-1,c=(1<<a)-1,u=c>>1,d=23===t?YT(2,-24)-YT(2,-77):0,l=e<0||0===e&&1/e<0?1:0,h=0;for((e=jT(e))!=e||e===1/0?(o=e!=e?1:0,r=c):(r=JT(QT(e)/WT),e*(i=YT(2,-r))<1&&(r--,i*=2),(e+=r+u>=1?d/i:d*YT(2,1-u))*i>=2&&(r++,i/=2),r+u>=c?(o=0,r=c):r+u>=1?(o=(e*i-1)*YT(2,t),r+=u):(o=e*YT(2,u-1)*YT(2,t),r=0));t>=8;)s[h++]=255&o,o/=256,t-=8;for(r=r<<t|o,a+=t;a>0;)s[h++]=255&r,r/=256,a-=8;return s[--h]|=128*l,s},unpack:function(e,t){var n,r=e.length,o=8*r-t-1,i=(1<<o)-1,s=i>>1,a=o-7,c=r-1,u=e[c--],d=127&u;for(u>>=7;a>0;)d=256*d+e[c--],a-=8;for(n=d&(1<<-a)-1,d>>=-a,a+=t;a>0;)n=256*n+e[c--],a-=8;if(0===d)d=1-s;else{if(d===i)return n?NaN:u?-1/0:1/0;n+=YT(2,t),d-=s}return(u?-1:1)*n*YT(2,d-t)}},zT=xe,XT=ir,$T=dr,eI=function(e){for(var t=zT(this),n=$T(t),r=arguments.length,o=XT(r>1?arguments[1]:void 0,n),i=r>2?arguments[2]:void 0,s=void 0===i?n:XT(i,n);s>o;)t[o++]=e;return t},tI=ir,nI=dr,rI=gs,oI=Array,iI=Math.max,sI=function(e,t,n){for(var r=nI(e),o=tI(t,r),i=tI(void 0===n?r:n,r),s=oI(iI(i-o,0)),a=0;o<i;o++,a++)rI(s,a,e[o]);return s.length=a,s},aI=r,cI=R,uI=s,dI=VT,lI=rn,hI=Zt,fI=GT,gI=i,pI=Sf,vI=tr,_I=cr,EI=qT,mI=ZT,TI=YE,II=ru,yI=zn.f,RI=Lt.f,CI=eI,SI=sI,OI=_f,NI=lI.PROPER,AI=lI.CONFIGURABLE,MI=bn.get,UI=bn.set,LI="ArrayBuffer",wI="DataView",bI="prototype",PI="Wrong index",DI=aI[LI],BI=DI,VI=BI&&BI[bI],xI=aI[wI],GI=xI&&xI[bI],kI=Object.prototype,FI=aI.Array,HI=aI.RangeError,qI=cI(CI),KI=cI([].reverse),jI=mI.pack,YI=mI.unpack,JI=function(e){return[255&e]},QI=function(e){return[255&e,e>>8&255]},WI=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},ZI=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},zI=function(e){return jI(e,23,4)},XI=function(e){return jI(e,52,8)},$I=function(e,t){RI(e[bI],t,{get:function(){return MI(this)[t]}})},ey=function(e,t,n,r){var o=EI(n),i=MI(e);if(o+t>i.byteLength)throw HI(PI);var s=MI(i.buffer).bytes,a=o+i.byteOffset,c=SI(s,a,a+t);return r?c:KI(c)},ty=function(e,t,n,r,o,i){var s=EI(n),a=MI(e);if(s+t>a.byteLength)throw HI(PI);for(var c=MI(a.buffer).bytes,u=s+a.byteOffset,d=r(+o),l=0;l<t;l++)c[u+l]=d[i?l:t-l-1]};if(dI){var ny=NI&&DI.name!==LI;if(gI((function(){DI(1)}))&&gI((function(){new DI(-1)}))&&!gI((function(){return new DI,new DI(1.5),new DI(NaN),1!=DI.length||ny&&!AI})))ny&&AI&&hI(DI,"name",LI);else{(BI=function(e){return pI(this,VI),new DI(EI(e))})[bI]=VI;for(var ry,oy=yI(DI),iy=0;oy.length>iy;)(ry=oy[iy++])in BI||hI(BI,ry,DI[ry]);VI.constructor=BI}II&&TI(GI)!==kI&&II(GI,kI);var sy=new xI(new BI(2)),ay=cI(GI.setInt8);sy.setInt8(0,2147483648),sy.setInt8(1,2147483649),!sy.getInt8(0)&&sy.getInt8(1)||fI(GI,{setInt8:function(e,t){ay(this,e,t<<24>>24)},setUint8:function(e,t){ay(this,e,t<<24>>24)}},{unsafe:!0})}else VI=(BI=function(e){pI(this,VI);var t=EI(e);UI(this,{bytes:qI(FI(t),0),byteLength:t}),uI||(this.byteLength=t)})[bI],xI=function(e,t,n){pI(this,GI),pI(e,VI);var r=MI(e).byteLength,o=vI(t);if(o<0||o>r)throw HI("Wrong offset");if(o+(n=void 0===n?r-o:_I(n))>r)throw HI("Wrong length");UI(this,{buffer:e,byteLength:n,byteOffset:o}),uI||(this.buffer=e,this.byteLength=n,this.byteOffset=o)},GI=xI[bI],uI&&($I(BI,"byteLength"),$I(xI,"buffer"),$I(xI,"byteLength"),$I(xI,"byteOffset")),fI(GI,{getInt8:function(e){return ey(this,1,e)[0]<<24>>24},getUint8:function(e){return ey(this,1,e)[0]},getInt16:function(e){var t=ey(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=ey(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return ZI(ey(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return ZI(ey(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return YI(ey(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return YI(ey(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){ty(this,1,e,JI,t)},setUint8:function(e,t){ty(this,1,e,JI,t)},setInt16:function(e,t){ty(this,2,e,QI,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){ty(this,2,e,QI,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){ty(this,4,e,WI,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){ty(this,4,e,WI,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){ty(this,4,e,zI,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){ty(this,8,e,XI,t,arguments.length>2?arguments[2]:void 0)}});OI(BI,LI),OI(xI,wI);var cy={ArrayBuffer:BI,DataView:xI},uy=yf,dy="ArrayBuffer",ly=cy[dy];$r({global:!0,constructor:!0,forced:r[dy]!==ly},{ArrayBuffer:ly}),uy(dy);var hy=$r,fy=Ci,gy=i,py=Bt,vy=ir,_y=cr,Ey=Pf,Ty=cy.ArrayBuffer,Iy=cy.DataView,yy=Iy.prototype,Ry=fy(Ty.prototype.slice),Cy=fy(yy.getUint8),Sy=fy(yy.setUint8);hy({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:gy((function(){return!new Ty(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(Ry&&void 0===t)return Ry(py(this),e);for(var n=py(this).byteLength,r=vy(e,n),o=vy(void 0===t?n:t,n),i=new(Ey(this,Ty))(_y(o-r)),s=new Iy(this),a=new Iy(i),c=0;r<o;)Sy(a,c++,Cy(s,r++));return i}});var Oy,Ny,Ay,My={exports:{}},Uy=VT,Ly=s,wy=r,by=q,Py=Y,Dy=Fe,By=ho,Vy=ve,xy=Zt,Gy=Zn,ky=Lt.f,Fy=z,Hy=YE,qy=ru,Ky=ot,jy=Ye,Yy=bn.enforce,Jy=bn.get,Qy=wy.Int8Array,Wy=Qy&&Qy.prototype,Zy=wy.Uint8ClampedArray,zy=Zy&&Zy.prototype,Xy=Qy&&Hy(Qy),$y=Wy&&Hy(Wy),eR=Object.prototype,tR=wy.TypeError,nR=Ky("toStringTag"),rR=jy("TYPED_ARRAY_TAG"),oR="TypedArrayConstructor",iR=Uy&&!!qy&&"Opera"!==By(wy.opera),sR=!1,aR={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},cR={BigInt64Array:8,BigUint64Array:8},uR=function(e){var t=Hy(e);if(Py(t)){var n=Jy(t);return n&&Dy(n,oR)?n[oR]:uR(t)}},dR=function(e){if(!Py(e))return!1;var t=By(e);return Dy(aR,t)||Dy(cR,t)};for(Oy in aR)(Ay=(Ny=wy[Oy])&&Ny.prototype)?Yy(Ay)[oR]=Ny:iR=!1;for(Oy in cR)(Ay=(Ny=wy[Oy])&&Ny.prototype)&&(Yy(Ay)[oR]=Ny);if((!iR||!by(Xy)||Xy===Function.prototype)&&(Xy=function(){throw tR("Incorrect invocation")},iR))for(Oy in aR)wy[Oy]&&qy(wy[Oy],Xy);if((!iR||!$y||$y===eR)&&($y=Xy.prototype,iR))for(Oy in aR)wy[Oy]&&qy(wy[Oy].prototype,$y);if(iR&&Hy(zy)!==$y&&qy(zy,$y),Ly&&!Dy($y,nR))for(Oy in sR=!0,ky($y,nR,{get:function(){return Py(this)?this[rR]:void 0}}),aR)wy[Oy]&&xy(wy[Oy],rR,Oy);var lR={NATIVE_ARRAY_BUFFER_VIEWS:iR,TYPED_ARRAY_TAG:sR&&rR,aTypedArray:function(e){if(dR(e))return e;throw tR("Target is not a typed array")},aTypedArrayConstructor:function(e){if(by(e)&&(!qy||Fy(Xy,e)))return e;throw tR(Vy(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(Ly){if(n)for(var o in aR){var i=wy[o];if(i&&Dy(i.prototype,e))try{delete i.prototype[e]}catch(n){try{i.prototype[e]=t}catch(e){}}}$y[e]&&!n||Gy($y,e,n?t:iR&&Wy[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,o;if(Ly){if(qy){if(n)for(r in aR)if((o=wy[r])&&Dy(o,e))try{delete o[e]}catch(e){}if(Xy[e]&&!n)return;try{return Gy(Xy,e,n?t:iR&&Xy[e]||t)}catch(e){}}for(r in aR)!(o=wy[r])||o[e]&&!n||Gy(o,e,t)}},getTypedArrayConstructor:uR,isView:function(e){if(!Py(e))return!1;var t=By(e);return"DataView"===t||Dy(aR,t)||Dy(cR,t)},isTypedArray:dR,TypedArray:Xy,TypedArrayPrototype:$y},hR=r,fR=i,gR=Kv,pR=lR.NATIVE_ARRAY_BUFFER_VIEWS,vR=hR.ArrayBuffer,_R=hR.Int8Array,ER=!pR||!fR((function(){_R(1)}))||!fR((function(){new _R(-1)}))||!gR((function(e){new _R,new _R(null),new _R(1.5),new _R(e)}),!0)||fR((function(){return 1!==new _R(new vR(2),1,void 0).length})),mR=Y,TR=Math.floor,IR=Number.isInteger||function(e){return!mR(e)&&isFinite(e)&&TR(e)===e},yR=tr,RR=RangeError,CR=function(e){var t=yR(e);if(t<0)throw RR("The argument can't be less than 0");return t},SR=RangeError,OR=function(e,t){var n=CR(e);if(n%t)throw SR("Wrong offset");return n},NR=ho,AR=R("".slice),MR=ht,UR=TypeError,LR=function(e){var t=MR(e,"number");if("number"==typeof t)throw UR("Can't convert number to bigint");return BigInt(t)},wR=Oc,bR=d,PR=Mf,DR=xe,BR=dr,VR=Iv,xR=gv,GR=cv,kR=function(e){return"Big"===AR(NR(e),0,3)},FR=lR.aTypedArrayConstructor,HR=LR,qR=$r,KR=r,jR=d,YR=s,JR=ER,QR=lR,WR=cy,ZR=Sf,zR=E,XR=Zt,$R=IR,eC=cr,tC=qT,nC=OR,rC=pt,oC=Fe,iC=ho,sC=Y,aC=ge,cC=Qo,uC=z,dC=ru,lC=zn.f,hC=function(e){var t,n,r,o,i,s,a,c,u=PR(this),d=DR(e),l=arguments.length,h=l>1?arguments[1]:void 0,f=void 0!==h,g=xR(d);if(g&&!GR(g))for(c=(a=VR(d,g)).next,d=[];!(s=bR(c,a)).done;)d.push(s.value);for(f&&l>2&&(h=wR(h,arguments[2])),n=BR(d),r=new(FR(u))(n),o=kR(r),t=0;n>t;t++)i=f?h(d[t],t):d[t],r[t]=o?HR(i):+i;return r},fC=Pc.forEach,gC=yf,pC=Lt,vC=o,_C=au,EC=bn.get,mC=bn.set,TC=bn.enforce,IC=pC.f,yC=vC.f,RC=Math.round,CC=KR.RangeError,SC=WR.ArrayBuffer,OC=SC.prototype,NC=WR.DataView,AC=QR.NATIVE_ARRAY_BUFFER_VIEWS,MC=QR.TYPED_ARRAY_TAG,UC=QR.TypedArray,LC=QR.TypedArrayPrototype,wC=QR.aTypedArrayConstructor,bC=QR.isTypedArray,PC="BYTES_PER_ELEMENT",DC="Wrong length",BC=function(e,t){wC(e);for(var n=0,r=t.length,o=new e(r);r>n;)o[n]=t[n++];return o},VC=function(e,t){IC(e,t,{get:function(){return EC(this)[t]}})},xC=function(e){var t;return uC(OC,e)||"ArrayBuffer"==(t=iC(e))||"SharedArrayBuffer"==t},GC=function(e,t){return bC(e)&&!aC(t)&&t in e&&$R(+t)&&t>=0},kC=function(e,t){return t=rC(t),GC(e,t)?zR(2,e[t]):yC(e,t)},FC=function(e,t,n){return t=rC(t),!(GC(e,t)&&sC(n)&&oC(n,"value"))||oC(n,"get")||oC(n,"set")||n.configurable||oC(n,"writable")&&!n.writable||oC(n,"enumerable")&&!n.enumerable?IC(e,t,n):(e[t]=n.value,e)};YR?(AC||(vC.f=kC,pC.f=FC,VC(LC,"buffer"),VC(LC,"byteOffset"),VC(LC,"byteLength"),VC(LC,"length")),qR({target:"Object",stat:!0,forced:!AC},{getOwnPropertyDescriptor:kC,defineProperty:FC}),My.exports=function(e,t,n){var r=e.match(/\d+$/)[0]/8,o=e+(n?"Clamped":"")+"Array",i="get"+e,s="set"+e,a=KR[o],c=a,u=c&&c.prototype,d={},l=function(e,t){IC(e,t,{get:function(){return function(e,t){var n=EC(e);return n.view[i](t*r+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,o){var i=EC(e);n&&(o=(o=RC(o))<0?0:o>255?255:255&o),i.view[s](t*r+i.byteOffset,o,!0)}(this,t,e)},enumerable:!0})};AC?JR&&(c=t((function(e,t,n,o){return ZR(e,u),_C(sC(t)?xC(t)?void 0!==o?new a(t,nC(n,r),o):void 0!==n?new a(t,nC(n,r)):new a(t):bC(t)?BC(c,t):jR(hC,c,t):new a(tC(t)),e,c)})),dC&&dC(c,UC),fC(lC(a),(function(e){e in c||XR(c,e,a[e])})),c.prototype=u):(c=t((function(e,t,n,o){ZR(e,u);var i,s,a,d=0,h=0;if(sC(t)){if(!xC(t))return bC(t)?BC(c,t):jR(hC,c,t);i=t,h=nC(n,r);var f=t.byteLength;if(void 0===o){if(f%r)throw CC(DC);if((s=f-h)<0)throw CC(DC)}else if((s=eC(o)*r)+h>f)throw CC(DC);a=s/r}else a=tC(t),i=new SC(s=a*r);for(mC(e,{buffer:i,byteOffset:h,byteLength:s,length:a,view:new NC(i)});d<a;)l(e,d++)})),dC&&dC(c,UC),u=c.prototype=cC(LC)),u.constructor!==c&&XR(u,"constructor",c),TC(u).TypedArrayConstructor=c,MC&&XR(u,MC,o);var h=c!=a;d[o]=c,qR({global:!0,constructor:!0,forced:h,sham:!AC},d),PC in c||XR(c,PC,r),PC in u||XR(u,PC,r),gC(o)}):My.exports=function(){},(0,My.exports)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var HC=xe,qC=ir,KC=dr,jC=Al,YC=Math.min,JC=[].copyWithin||function(e,t){var n=HC(this),r=KC(n),o=qC(e,r),i=qC(t,r),s=arguments.length>2?arguments[2]:void 0,a=YC((void 0===s?r:qC(s,r))-i,r-o),c=1;for(i<o&&o<i+a&&(c=-1,i+=a-1,o+=a-1);a-- >0;)i in n?n[o]=n[i]:jC(n,o),o+=c,i+=c;return n},QC=lR,WC=R(JC),ZC=QC.aTypedArray;(0,QC.exportTypedArrayMethod)("copyWithin",(function(e,t){return WC(ZC(this),e,t,arguments.length>2?arguments[2]:void 0)}));var zC=Pc.every,XC=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("every",(function(e){return zC(XC(this),e,arguments.length>1?arguments[1]:void 0)}));var $C=eI,eS=LR,tS=ho,nS=d,rS=i,oS=lR.aTypedArray,iS=lR.exportTypedArrayMethod,sS=R("".slice);iS("fill",(function(e){var t=arguments.length;oS(this);var n="Big"===sS(tS(this),0,3)?eS(e):+e;return nS($C,this,n,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),rS((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})));var aS=dr,cS=Pf,uS=lR.aTypedArrayConstructor,dS=lR.getTypedArrayConstructor,lS=function(e){return uS(cS(e,dS(e)))},hS=function(e,t){for(var n=0,r=aS(t),o=new e(r);r>n;)o[n]=t[n++];return o},fS=lS,gS=Pc.filter,pS=function(e,t){return hS(fS(e),t)},vS=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("filter",(function(e){var t=gS(vS(this),e,arguments.length>1?arguments[1]:void 0);return pS(this,t)}));var _S=Pc.find,ES=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("find",(function(e){return _S(ES(this),e,arguments.length>1?arguments[1]:void 0)}));var mS=Pc.findIndex,TS=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("findIndex",(function(e){return mS(TS(this),e,arguments.length>1?arguments[1]:void 0)}));var IS=Pc.forEach,yS=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("forEach",(function(e){IS(yS(this),e,arguments.length>1?arguments[1]:void 0)}));var RS=pr.includes,CS=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("includes",(function(e){return RS(CS(this),e,arguments.length>1?arguments[1]:void 0)}));var SS=pr.indexOf,OS=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("indexOf",(function(e){return SS(OS(this),e,arguments.length>1?arguments[1]:void 0)}));var NS=r,AS=i,MS=R,US=lR,LS=Fm,wS=ot("iterator"),bS=NS.Uint8Array,PS=MS(LS.values),DS=MS(LS.keys),BS=MS(LS.entries),VS=US.aTypedArray,xS=US.exportTypedArrayMethod,GS=bS&&bS.prototype,kS=!AS((function(){GS[wS].call([1])})),FS=!!GS&&GS.values&&GS[wS]===GS.values&&"values"===GS.values.name,HS=function(){return PS(VS(this))};xS("entries",(function(){return BS(VS(this))}),kS),xS("keys",(function(){return DS(VS(this))}),kS),xS("values",HS,kS||!FS,{name:"values"}),xS(wS,HS,kS||!FS,{name:"values"});var qS=lR.aTypedArray,KS=lR.exportTypedArrayMethod,jS=R([].join);KS("join",(function(e){return jS(qS(this),e)}));var YS=ia,JS=G,QS=tr,WS=dr,ZS=Hc,zS=Math.min,XS=[].lastIndexOf,$S=!!XS&&1/[1].lastIndexOf(1,-0)<0,eO=ZS("lastIndexOf"),tO=$S||!eO?function(e){if($S)return YS(XS,this,arguments)||0;var t=JS(this),n=WS(t),r=n-1;for(arguments.length>1&&(r=zS(r,QS(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:XS,nO=ia,rO=tO,oO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return nO(rO,oO(this),t>1?[e,arguments[1]]:[e])}));var iO=Pc.map,sO=lS,aO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("map",(function(e){return iO(aO(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(sO(e))(t)}))}));var cO=Te,uO=xe,dO=w,lO=dr,hO=TypeError,fO=function(e){return function(t,n,r,o){cO(n);var i=uO(t),s=dO(i),a=lO(i),c=e?a-1:0,u=e?-1:1;if(r<2)for(;;){if(c in s){o=s[c],c+=u;break}if(c+=u,e?c<0:a<=c)throw hO("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=u)c in s&&(o=n(o,s[c],c,i));return o}},gO={left:fO(!1),right:fO(!0)},pO=gO.left,vO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return pO(vO(this),e,t,t>1?arguments[1]:void 0)}));var _O=gO.right,EO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return _O(EO(this),e,t,t>1?arguments[1]:void 0)}));var mO=lR.aTypedArray,TO=lR.exportTypedArrayMethod,IO=Math.floor;TO("reverse",(function(){for(var e,t=this,n=mO(t).length,r=IO(n/2),o=0;o<r;)e=t[o],t[o++]=t[--n],t[n]=e;return t}));var yO=r,RO=d,CO=lR,SO=dr,OO=OR,NO=xe,AO=i,MO=yO.RangeError,UO=yO.Int8Array,LO=UO&&UO.prototype,wO=LO&&LO.set,bO=CO.aTypedArray,PO=CO.exportTypedArrayMethod,DO=!AO((function(){var e=new Uint8ClampedArray(2);return RO(wO,e,{length:1,0:3},1),3!==e[1]})),BO=DO&&CO.NATIVE_ARRAY_BUFFER_VIEWS&&AO((function(){var e=new UO(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));PO("set",(function(e){bO(this);var t=OO(arguments.length>1?arguments[1]:void 0,1),n=NO(e);if(DO)return RO(wO,this,n,t);var r=this.length,o=SO(n),i=0;if(o+t>r)throw MO("Wrong length");for(;i<o;)this[t+i]=n[i++]}),!DO||BO);var VO=lS,xO=cc,GO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("slice",(function(e,t){for(var n=xO(GO(this),e,t),r=VO(this),o=0,i=n.length,s=new r(i);i>o;)s[o]=n[o++];return s}),i((function(){new Int8Array(1).slice()})));var kO=Pc.some,FO=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("some",(function(e){return kO(FO(this),e,arguments.length>1?arguments[1]:void 0)}));var HO=sI,qO=Math.floor,KO=function(e,t){var n=e.length,r=qO(n/2);return n<8?jO(e,t):YO(e,KO(HO(e,0,r),t),KO(HO(e,r),t),t)},jO=function(e,t){for(var n,r,o=e.length,i=1;i<o;){for(r=i,n=e[i];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==i++&&(e[r]=n)}return e},YO=function(e,t,n,r){for(var o=t.length,i=n.length,s=0,a=0;s<o||a<i;)e[s+a]=s<o&&a<i?r(t[s],n[a])<=0?t[s++]:n[a++]:s<o?t[s++]:n[a++];return e},JO=KO,QO=X.match(/firefox\/(\d+)/i),WO=!!QO&&+QO[1],ZO=/MSIE|Trident/.test(X),zO=X.match(/AppleWebKit\/(\d+)\./),XO=!!zO&&+zO[1],$O=Ci,eN=i,tN=Te,nN=JO,rN=WO,oN=ZO,iN=ie,sN=XO,aN=lR.aTypedArray,cN=lR.exportTypedArrayMethod,uN=r.Uint16Array,dN=uN&&$O(uN.prototype.sort),lN=!(!dN||eN((function(){dN(new uN(2),null)}))&&eN((function(){dN(new uN(2),{})}))),hN=!!dN&&!eN((function(){if(iN)return iN<74;if(rN)return rN<67;if(oN)return!0;if(sN)return sN<602;var e,t,n=new uN(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(dN(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));cN("sort",(function(e){return void 0!==e&&tN(e),hN?dN(this,e):nN(aN(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!hN||lN);var fN=cr,gN=ir,pN=lS,vN=lR.aTypedArray;(0,lR.exportTypedArrayMethod)("subarray",(function(e,t){var n=vN(this),r=n.length,o=gN(e,r);return new(pN(n))(n.buffer,n.byteOffset+o*n.BYTES_PER_ELEMENT,fN((void 0===t?r:gN(t,r))-o))}));var _N=ia,EN=lR,mN=i,TN=cc,IN=r.Int8Array,yN=EN.aTypedArray,RN=EN.exportTypedArrayMethod,CN=[].toLocaleString,SN=!!IN&&mN((function(){CN.call(new IN(1))}));RN("toLocaleString",(function(){return _N(CN,SN?TN(yN(this)):yN(this),TN(arguments))}),mN((function(){return[1,2].toLocaleString()!=new IN([1,2]).toLocaleString()}))||!mN((function(){IN.prototype.toLocaleString.call([1,2])})));var ON=lR.exportTypedArrayMethod,NN=i,AN=R,MN=r.Uint8Array,UN=MN&&MN.prototype||{},LN=[].toString,wN=AN([].join);NN((function(){LN.call({})}))&&(LN=function(){return wN(this)});var bN=UN.toString!=LN;ON("toString",LN,bN);var PN=Zu;function DN(e){var t=function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}function n(e,t){var n,r,i;return t?(i=(e>>>=0)>=0&&e<256)&&(r=c[e])?r:(n=o(e,(0|e)<0?-1:0,!0),i&&(c[e]=n),n):(i=(e|=0)>=-128&&e<128)&&(r=a[e])?r:(n=o(e,e<0?-1:0,!1),i&&(a[e]=n),n)}function r(e,t){if(isNaN(e)||!isFinite(e))return t?p:g;if(t){if(e<0)return p;if(e>=l)return T}else{if(-h>=e)return I;if(e+1>=h)return m}return e<0?r(-e,t).neg():o(0|e%d,0|e/d,t)}function o(t,n,r){return new e(t,n,r)}function i(e,t,n){var o,s,a,c,d,l,h;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||n>36)throw RangeError("radix");if((o=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===o)return i(e.substring(1),t,n).neg();for(s=r(u(n,8)),a=g,c=0;c<e.length;c+=8)d=Math.min(8,e.length-c),l=parseInt(e.substring(c,c+d),n),d<8?(h=r(u(n,d)),a=a.mul(h).add(r(l))):a=(a=a.mul(s)).add(r(l));return a.unsigned=t,a}function s(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?i(t):o(t.low,t.high,t.unsigned)}var a,c,u,d,l,h,f,g,p,v,_,E,m,T,I,y;return e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t,a={},c={},e.fromInt=n,e.fromNumber=r,e.fromBits=o,u=Math.pow,e.fromString=i,e.fromValue=s,65536,1<<24,h=(l=(d=4294967296)*d)/2,f=n(16777216),g=n(0),e.ZERO=g,p=n(0,!0),e.UZERO=p,v=n(1),e.ONE=v,_=n(1,!0),e.UONE=_,E=n(-1),e.NEG_ONE=E,m=o(-1,2147483647,!1),e.MAX_VALUE=m,T=o(-1,-1,!0),e.MAX_UNSIGNED_VALUE=T,I=o(0,-2147483648,!1),e.MIN_VALUE=I,(y=e.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},y.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},y.toString=function(e){var t,n,o,i,s,a,c,d;if((e=e||10)<2||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())return this.eq(I)?(t=r(e),o=(n=this.div(t)).mul(t).sub(this),n.toString(e)+o.toInt().toString(e)):"-"+this.neg().toString(e);for(i=r(u(e,6),this.unsigned),s=this,a="";;){if(c=s.div(i),d=(s.sub(c.mul(i)).toInt()>>>0).toString(e),(s=c).isZero())return d+a;for(;d.length<6;)d="0"+d;a=""+d+a}},y.getHighBits=function(){return this.high},y.getHighBitsUnsigned=function(){return this.high>>>0},y.getLowBits=function(){return this.low},y.getLowBitsUnsigned=function(){return this.low>>>0},y.getNumBitsAbs=function(){var e,t;if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},y.isZero=function(){return 0===this.high&&0===this.low},y.isNegative=function(){return!this.unsigned&&this.high<0},y.isPositive=function(){return this.unsigned||this.high>=0},y.isOdd=function(){return 1==(1&this.low)},y.isEven=function(){return 0==(1&this.low)},y.equals=function(e){return t(e)||(e=s(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},y.eq=y.equals,y.notEquals=function(e){return!this.eq(e)},y.neq=y.notEquals,y.lessThan=function(e){return this.comp(e)<0},y.lt=y.lessThan,y.lessThanOrEqual=function(e){return this.comp(e)<=0},y.lte=y.lessThanOrEqual,y.greaterThan=function(e){return this.comp(e)>0},y.gt=y.greaterThan,y.greaterThanOrEqual=function(e){return this.comp(e)>=0},y.gte=y.greaterThanOrEqual,y.compare=function(e){if(t(e)||(e=s(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},y.comp=y.compare,y.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(v)},y.neg=y.negate,y.add=function(e){var n,r,i,a,c,u,d,l,h,f,g;return t(e)||(e=s(e)),n=this.high>>>16,r=65535&this.high,i=this.low>>>16,a=65535&this.low,c=e.high>>>16,u=65535&e.high,d=e.low>>>16,l=0,h=0,f=0,g=0,f+=(g+=a+(65535&e.low))>>>16,h+=(f+=i+d)>>>16,l+=(h+=r+u)>>>16,l+=n+c,o((f&=65535)<<16|(g&=65535),(l&=65535)<<16|(h&=65535),this.unsigned)},y.subtract=function(e){return t(e)||(e=s(e)),this.add(e.neg())},y.sub=y.subtract,y.multiply=function(e){var n,i,a,c,u,d,l,h,p,v,_,E;return this.isZero()?g:(t(e)||(e=s(e)),e.isZero()?g:this.eq(I)?e.isOdd()?I:g:e.eq(I)?this.isOdd()?I:g:this.isNegative()?e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg():e.isNegative()?this.mul(e.neg()).neg():this.lt(f)&&e.lt(f)?r(this.toNumber()*e.toNumber(),this.unsigned):(n=this.high>>>16,i=65535&this.high,a=this.low>>>16,c=65535&this.low,u=e.high>>>16,d=65535&e.high,l=e.low>>>16,p=0,v=0,_=0,E=0,_+=(E+=c*(h=65535&e.low))>>>16,v+=(_+=a*h)>>>16,_&=65535,v+=(_+=c*l)>>>16,p+=(v+=i*h)>>>16,v&=65535,p+=(v+=a*l)>>>16,v&=65535,p+=(v+=c*d)>>>16,p+=n*h+i*l+a*d+c*u,o((_&=65535)<<16|(E&=65535),(p&=65535)<<16|(v&=65535),this.unsigned)))},y.mul=y.multiply,y.divide=function(e){var n,o,i,a,c,d,l;if(t(e)||(e=s(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?p:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return p;if(e.gt(this.shru(1)))return _;i=p}else{if(this.eq(I))return e.eq(v)||e.eq(E)?I:e.eq(I)?v:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?v:E:(o=this.sub(e.mul(n)),i=n.add(o.div(e)));if(e.eq(I))return this.unsigned?p:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(o=this;o.gte(e);){for(n=Math.max(1,Math.floor(o.toNumber()/e.toNumber())),c=(a=Math.ceil(Math.log(n)/Math.LN2))<=48?1:u(2,a-48),l=(d=r(n)).mul(e);l.isNegative()||l.gt(o);)l=(d=r(n-=c,this.unsigned)).mul(e);d.isZero()&&(d=v),i=i.add(d),o=o.sub(l)}return i},y.div=y.divide,y.modulo=function(e){return t(e)||(e=s(e)),this.sub(this.div(e).mul(e))},y.mod=y.modulo,y.not=function(){return o(~this.low,~this.high,this.unsigned)},y.and=function(e){return t(e)||(e=s(e)),o(this.low&e.low,this.high&e.high,this.unsigned)},y.or=function(e){return t(e)||(e=s(e)),o(this.low|e.low,this.high|e.high,this.unsigned)},y.xor=function(e){return t(e)||(e=s(e)),o(this.low^e.low,this.high^e.high,this.unsigned)},y.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?o(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):o(0,this.low<<e-32,this.unsigned)},y.shl=y.shiftLeft,y.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?o(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):o(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},y.shr=y.shiftRight,y.shiftRightUnsigned=function(e){var n;return t(e)&&(e=e.toInt()),0===(e&=63)?this:(n=this.high,e<32?o(this.low>>>e|n<<32-e,n>>>e,this.unsigned):o(32===e?n:n>>>e-32,0,this.unsigned))},y.shru=y.shiftRightUnsigned,y.toSigned=function(){return this.unsigned?o(this.low,this.high,!1):this},y.toUnsigned=function(){return this.unsigned?this:o(this.low,this.high,!0)},y.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},y.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,255&t>>>24,255&e,255&e>>>8,255&e>>>16,255&e>>>24]},y.toBytesBE=function(){var e=this.high,t=this.low;return[255&e>>>24,255&e>>>16,255&e>>>8,255&e,255&t>>>24,255&t>>>16,255&t>>>8,255&t]},e}(),n=function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,d=-7,l=n?o-1:0,h=n?-1:1,f=e[t+l];for(l+=h,i=f&(1<<-d)-1,f>>=-d,d+=a;d>0;i=256*i+e[t+l],l+=h,d-=8);for(s=i&(1<<-d)-1,i>>=-d,d+=r;d>0;s=256*s+e[t+l],l+=h,d-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),i-=u}return(f?-1:1)*s*Math.pow(2,i-r)}function o(e,t,n,r,o,i){var s,a,c,u=8*i-o-1,d=(1<<u)-1,l=d>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,g=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=d?(a=0,s=d):s+l>=1?(a=(t*c-1)*Math.pow(2,o),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,o),s=0));o>=8;e[n+f]=255&a,f+=g,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;e[n+f]=255&s,f+=g,s/=256,u-=8);e[n+f-g]|=128*p}var i,s,a,c,u,d=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?s:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};return d.VERSION="5.0.1",d.LITTLE_ENDIAN=!0,d.BIG_ENDIAN=!1,d.DEFAULT_CAPACITY=16,d.DEFAULT_ENDIAN=d.BIG_ENDIAN,d.DEFAULT_NOASSERT=!1,d.Long=e||null,(i=d.prototype).__isByteBuffer__,Object.defineProperty(i,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1}),s=new ArrayBuffer(0),a=String.fromCharCode,d.accessor=function(){return Uint8Array},d.allocate=function(e,t,n){return new d(e,t,n)},d.concat=function(e,t,n,r){var o,i,s,a,c,u;for(("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0),o=0,s=0,a=e.length;a>s;++s)d.isByteBuffer(e[s])||(e[s]=d.wrap(e[s],t)),(i=e[s].limit-e[s].offset)>0&&(o+=i);if(0===o)return new d(0,n,r);for(u=new d(o,n,r),s=0;a>s;)(i=(c=e[s++]).limit-c.offset)<=0||(u.view.set(c.view.subarray(c.offset,c.limit),u.offset),u.offset+=i);return u.limit=u.offset,u.offset=0,u},d.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},d.type=function(){return ArrayBuffer},d.wrap=function(e,t,n,r){var o,s;if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return d.fromBase64(e,n);case"hex":return d.fromHex(e,n);case"binary":return d.fromBinary(e,n);case"utf8":return d.fromUTF8(e,n);case"debug":return d.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==no(e))throw TypeError("Illegal buffer");if(d.isByteBuffer(e))return(o=i.clone.call(e)).markedOffset=-1,o;if(e instanceof Uint8Array)o=new d(0,n,r),e.length>0&&(o.buffer=e.buffer,o.offset=e.byteOffset,o.limit=e.byteOffset+e.byteLength,o.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)o=new d(0,n,r),e.byteLength>0&&(o.buffer=e,o.offset=0,o.limit=e.byteLength,o.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for((o=new d(e.length,n,r)).limit=e.length,s=0;s<e.length;++s)o.view[s]=e[s]}return o},i.writeBitSet=function(e,t){var n,r,o,i,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for(r=t,i=(o=e.length)>>3,s=0,t+=this.writeVarint32(o,t);i--;)n=1&!!e[s++]|(1&!!e[s++])<<1|(1&!!e[s++])<<2|(1&!!e[s++])<<3|(1&!!e[s++])<<4|(1&!!e[s++])<<5|(1&!!e[s++])<<6|(1&!!e[s++])<<7,this.writeByte(n,t++);if(o>s){for(a=0,n=0;o>s;)n|=(1&!!e[s++])<<a++;this.writeByte(n,t++)}return c?(this.offset=t,this):t-r},i.readBitSet=function(e){var t,n,r,o,i,s,a,c=void 0===e;for(c&&(e=this.offset),o=(r=(n=this.readVarint32(e)).value)>>3,i=0,s=[],e+=n.length;o--;)t=this.readByte(e++),s[i++]=!!(1&t),s[i++]=!!(2&t),s[i++]=!!(4&t),s[i++]=!!(8&t),s[i++]=!!(16&t),s[i++]=!!(32&t),s[i++]=!!(64&t),s[i++]=!!(128&t);if(r>i)for(a=0,t=this.readByte(e++);r>i;)s[i++]=!!(1&t>>a++);return c&&(this.offset=e),s},i.readBytes=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return n=this.slice(t,t+e),r&&(this.offset+=e),n},i.writeBytes=i.append,i.writeInt8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},i.writeByte=i.writeInt8,i.readInt8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(t=this.view[e]))&&(t=-(255-t+1)),n&&(this.offset+=1),t},i.readByte=i.readInt8,i.writeUint8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},i.writeUInt8=i.writeUint8,i.readUint8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=this.view[e],n&&(this.offset+=1),t},i.readUInt8=i.readUint8,i.writeInt16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},i.writeShort=i.writeInt16,i.readInt16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),32768==(32768&t)&&(t=-(65535-t+1)),n&&(this.offset+=2),t},i.readShort=i.readInt16,i.writeUint16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},i.writeUInt16=i.writeUint16,i.readUint16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),n&&(this.offset+=2),t},i.readUInt16=i.readUint16,i.writeInt32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},i.writeInt=i.writeInt32,i.readInt32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),t|=0,n&&(this.offset+=4),t},i.readInt=i.readInt32,i.writeUint32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},i.writeUInt32=i.writeUint32,i.readUint32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),n&&(this.offset+=4),t},i.readUInt32=i.readUint32,e&&(i.writeInt64=function(t,n){var r,o,i,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,o=t.low,i=t.high,this.littleEndian?(this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o,n+=4,this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i):(this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i,n+=4,this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o),s&&(this.offset+=8),this},i.writeLong=i.writeInt64,i.readInt64=function(t){var n,r,o,i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),o=new e(n,r,!1),i&&(this.offset+=8),o},i.readLong=i.readInt64,i.writeUint64=function(t,n){var r,o,i,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,o=t.low,i=t.high,this.littleEndian?(this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o,n+=4,this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i):(this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i,n+=4,this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o),s&&(this.offset+=8),this},i.writeUInt64=i.writeUint64,i.readUint64=function(t){var n,r,o,i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),o=new e(n,r,!0),i&&(this.offset+=8),o},i.readUInt64=i.readUint64),i.writeFloat32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,o(this.view,e,t,this.littleEndian,23,4),r&&(this.offset+=4),this},i.writeFloat=i.writeFloat32,i.readFloat32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,23,4),n&&(this.offset+=4),t},i.readFloat=i.readFloat32,i.writeFloat64=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=8)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=8,o(this.view,e,t,this.littleEndian,52,8),r&&(this.offset+=8),this},i.writeDouble=i.writeFloat64,i.readFloat64=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,52,8),n&&(this.offset+=8),t},i.readDouble=i.readFloat64,d.MAX_VARINT32_BYTES=5,d.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:1<<21>e?3:1<<28>e?4:5},d.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},d.zigZagDecode32=function(e){return 0|e>>>1^-(1&e)},i.writeVarint32=function(e,t){var n,r,o,i=void 0===t;if(i&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for((t+=r=d.calculateVarint32(e))>(o=this.buffer.byteLength)&&this.resize((o*=2)>t?o:t),t-=r,e>>>=0;e>=128;)n=128|127&e,this.view[t++]=n,e>>>=7;return this.view[t++]=e,i?(this.offset=t,this):r},i.writeVarint32ZigZag=function(e,t){return this.writeVarint32(d.zigZagEncode32(e),t)},i.readVarint32=function(e){var t,n,r,o,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}n=0,r=0;do{if(!this.noAssert&&e>this.limit)throw(o=Error("Truncated")).truncated=!0,o;t=this.view[e++],n<5&&(r|=(127&t)<<7*n),++n}while(0!=(128&t));return r|=0,i?(this.offset=e,r):{value:r,length:n}},i.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"===no(t)?t.value=d.zigZagDecode32(t.value):t=d.zigZagDecode32(t),t},e&&(d.MAX_VARINT64_BYTES=10,d.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,o=t.shiftRightUnsigned(56).toInt()>>>0;return 0==o?0==r?n<16384?n<128?1:2:1<<21>n?3:4:r<16384?r<128?5:6:1<<21>r?7:8:o<128?9:10},d.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},i.writeVarint64=function(t,n){var r,o,i,s,a,c=void 0===n;if(c&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}switch("number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),r=d.calculateVarint64(t),o=t.toInt()>>>0,i=t.shiftRightUnsigned(28).toInt()>>>0,s=t.shiftRightUnsigned(56).toInt()>>>0,(n+=r)>(a=this.buffer.byteLength)&&this.resize((a*=2)>n?a:n),n-=r,r){case 10:this.view[n+9]=1&s>>>7;case 9:this.view[n+8]=9!==r?128|s:127&s;case 8:this.view[n+7]=8!==r?128|i>>>21:127&i>>>21;case 7:this.view[n+6]=7!==r?128|i>>>14:127&i>>>14;case 6:this.view[n+5]=6!==r?128|i>>>7:127&i>>>7;case 5:this.view[n+4]=5!==r?128|i:127&i;case 4:this.view[n+3]=4!==r?128|o>>>21:127&o>>>21;case 3:this.view[n+2]=3!==r?128|o>>>14:127&o>>>14;case 2:this.view[n+1]=2!==r?128|o>>>7:127&o>>>7;case 1:this.view[n]=1!==r?128|o:127&o}return c?(this.offset+=r,this):r},i.writeVarint64ZigZag=function(e,t){return this.writeVarint64(d.zigZagEncode64(e),t)},i.readVarint64=function(t){var n,r,o,i,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}if(n=t,r=0,o=0,i=0,s=0,r=127&(s=this.view[t++]),128&s&&(r|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(o=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(i=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<7,128&s||this.noAssert&&void 0===s))))))))))throw Error("Buffer overrun");return a=e.fromBits(r|o<<28,o>>>4|i<<24,!1),c?(this.offset=t,a):{value:a,length:t-n}},i.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=d.zigZagDecode64(n.value):n=d.zigZagDecode64(n),n}),i.writeCString=function(e,n){var r,o,i,s=void 0===n;if(s&&(n=this.offset),o=e.length,!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;o>r;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return o=u.calculateUTF16asUTF8(t(e))[1],n+=o+1,i=this.buffer.byteLength,n>i&&this.resize((i*=2)>n?i:n),n-=o+1,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,s?(this.offset=n,this):o},i.readCString=function(e){var t,r,o,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,o=-1,u.decodeUTF8toUTF16(function(){if(0===o)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(o=this.view[e++])?null:o}.bind(this),r=n(),!0),i?(this.offset=e,r()):{string:r(),length:e-t}},i.writeIString=function(e,n){var r,o,i,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(o=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+r,i=this.buffer.byteLength,n>i&&this.resize((i*=2)>n?i:n),n-=4+r,this.littleEndian?(this.view[n+3]=255&r>>>24,this.view[n+2]=255&r>>>16,this.view[n+1]=255&r>>>8,this.view[n]=255&r):(this.view[n]=255&r>>>24,this.view[n+1]=255&r>>>16,this.view[n+2]=255&r>>>8,this.view[n+3]=255&r),n+=4,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==o+4+r)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+r));return s?(this.offset=n,this):n-o},i.readIString=function(e){var t,n,r,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=e,n=this.readUint32(e),r=this.readUTF8String(n,d.METRICS_BYTES,e+=4),e+=r.length,o?(this.offset=e,r.string):{string:r.string,length:e-t}},d.METRICS_CHARS="c",d.METRICS_BYTES="b",i.writeUTF8String=function(e,n){var r,o,i,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return o=n,r=u.calculateUTF16asUTF8(t(e))[1],n+=r,i=this.buffer.byteLength,n>i&&this.resize((i*=2)>n?i:n),n-=r,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),s?(this.offset=n,this):n-o},i.writeString=i.writeUTF8String,d.calculateUTF8Chars=function(e){return u.calculateUTF16asUTF8(t(e))[0]},d.calculateUTF8Bytes=function(e){return u.calculateUTF16asUTF8(t(e))[1]},d.calculateString=d.calculateUTF8Bytes,i.readUTF8String=function(e,t,r){var o,i,s,a,c;if("number"==typeof t&&(r=t,t=void 0),(o=void 0===r)&&(r=this.offset),void 0===t&&(t=d.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}if(s=0,a=r,t===d.METRICS_CHARS){if(i=n(),u.decodeUTF8(function(){return e>s&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++s,u.UTF8toUTF16(e,i)})),s!==e)throw RangeError("Illegal range: Truncated data, "+s+" == "+e);return o?(this.offset=r,i()):{string:i(),length:r-a}}if(t===d.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}if(c=r+e,u.decodeUTF8toUTF16(function(){return c>r?this.view[r++]:null}.bind(this),i=n(),this.noAssert),r!==c)throw RangeError("Illegal range: Truncated data, "+r+" == "+c);return o?(this.offset=r,i()):{string:i(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},i.readString=i.readUTF8String,i.writeVString=function(e,n){var r,o,i,s,a=void 0===n;if(a&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(i=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],o=d.calculateVarint32(r),n+=o+r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=o+r,n+=this.writeVarint32(r,n),u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==i+r+o)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+r+o));return a?(this.offset=n,this):n-i},i.readVString=function(e){var t,n,r,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,n=this.readVarint32(e),r=this.readUTF8String(n.value,d.METRICS_BYTES,e+=n.length),e+=r.length,o?(this.offset=e,r.string):{string:r.string,length:e-t}},i.append=function(e,t,n){var r,o,i;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof d||(e=d.wrap(e,t)),(o=e.limit-e.offset)<=0||((n+=o)>(i=this.buffer.byteLength)&&this.resize((i*=2)>n?i:n),n-=o,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=o,r&&(this.offset+=o)),this},i.appendTo=function(e,t){return e.append(this,t),this},i.assert=function(e){return this.noAssert=!e,this},i.capacity=function(){return this.buffer.byteLength},i.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},i.clone=function(e){var t=new d(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},i.compact=function(e,t){var n,r,o;if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return 0===e&&t===this.buffer.byteLength?this:0===(n=t-e)?(this.buffer=s,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this):(r=new ArrayBuffer(n),(o=new Uint8Array(r)).set(this.view.subarray(e,t)),this.buffer=r,this.view=o,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this)},i.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new d(0,this.littleEndian,this.noAssert);var n=t-e,r=new d(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},i.copyTo=function(e,t,n,r){var o,i,s;if(!this.noAssert&&!d.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(i=void 0===t)?e.offset:0|t,n=(o=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);return 0===(s=r-n)?e:(e.ensureCapacity(t+s),e.view.set(this.view.subarray(n,r),t),o&&(this.offset+=s),i&&(e.offset+=s),this)},i.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},i.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},i.flip=function(){return this.limit=this.offset,this.offset=0,this},i.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},i.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},i.LE=function(e){return this.littleEndian=void 0===e||!!e,this},i.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},i.prepend=function(e,t,n){var r,o,i,s,a;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof d||(e=d.wrap(e,t)),(o=e.limit-e.offset)<=0||((i=o-n)>0?(s=new ArrayBuffer(this.buffer.byteLength+i),(a=new Uint8Array(s)).set(this.view.subarray(n,this.buffer.byteLength),o),this.buffer=s,this.view=a,this.offset+=i,this.markedOffset>=0&&(this.markedOffset+=i),this.limit+=i,n+=i):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-o),e.offset=e.limit,r&&(this.offset-=o)),this},i.prependTo=function(e,t){return e.prepend(this,t),this},i.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},i.remaining=function(){return this.limit-this.offset},i.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},i.resize=function(e){var t,n;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(n=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=n),this},i.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},i.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},i.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},i.toBuffer=function(e){var t,n=this.offset,r=this.limit;if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||n>r||r>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+this.buffer.byteLength)}return e||0!==n||r!==this.buffer.byteLength?n===r?s:(t=new ArrayBuffer(r-n),new Uint8Array(t).set(new Uint8Array(this.buffer).subarray(n,r),0),t):this.buffer},i.toArrayBuffer=i.toBuffer,i.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},c=function(){var e,t,n={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],o=[];for(e=0,t=r.length;t>e;++e)o[r[e]]=e;return n.encode=function(e,t){for(var n,o;null!==(n=e());)t(r[63&n>>2]),o=(3&n)<<4,null!==(n=e())?(t(r[63&((o|=15&n>>4)|15&n>>4)]),o=(15&n)<<2,null!==(n=e())?(t(r[63&(o|3&n>>6)]),t(r[63&n])):(t(r[63&o]),t(61))):(t(r[63&o]),t(61),t(61))},n.decode=function(e,t){function n(e){throw Error("Illegal character code: "+e)}for(var r,i,s;null!==(r=e());)if(void 0===(i=o[r])&&n(r),null!==(r=e())&&(void 0===(s=o[r])&&n(r),t(i<<2>>>0|(48&s)>>4),null!==(r=e()))){if(void 0===(i=o[r])){if(61===r)break;n(r)}if(t((15&s)<<4>>>0|(60&i)>>2),null!==(r=e())){if(void 0===(s=o[r])){if(61===r)break;n(r)}t((3&i)<<6>>>0|s)}}},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},n}(),i.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var r;return c.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},d.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new d(e.length/4*3,n),o=0;return c.decode(t(e),(function(e){r.view[o++]=e})),r.limit=o,r},d.btoa=function(e){return d.fromBinary(e).toBase64()},d.atob=function(e){return d.fromBase64(e).toBinary()},i.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},d.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,o=e.length,i=new d(o,t);o>r;){if((n=e.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);i.view[r++]=n}return i.limit=o,i},i.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,o="",i="",s="";r>n;){if(-1!==n&&(o+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(i+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;o.length<51;)o+=" ";s+=o+i+"\n",o=i=""}o+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==o){for(;o.length<51;)o+=" ";s+=o+i+"\n"}return e?s:o},d.fromDebug=function(e,t,n){for(var r,o,i=e.length,s=new d(0|(i+1)/3,t,n),a=0,c=0,u=!1,l=!1,h=!1,f=!1,g=!1;i>a;){switch(r=e.charAt(a++)){case"!":if(!n){if(l||h||f){g=!0;break}l=h=f=!0}s.offset=s.markedOffset=s.limit=c,u=!1;break;case"|":if(!n){if(l||f){g=!0;break}l=f=!0}s.offset=s.limit=c,u=!1;break;case"[":if(!n){if(l||h){g=!0;break}l=h=!0}s.offset=s.markedOffset=c,u=!1;break;case"<":if(!n){if(l){g=!0;break}l=!0}s.offset=c,u=!1;break;case"]":if(!n){if(f||h){g=!0;break}f=h=!0}s.limit=s.markedOffset=c,u=!1;break;case">":if(!n){if(f){g=!0;break}f=!0}s.limit=c,u=!1;break;case"'":if(!n){if(h){g=!0;break}h=!0}s.markedOffset=c,u=!1;break;case" ":u=!1;break;default:if(!n&&u){g=!0;break}if(o=parseInt(r+e.charAt(a++),16),!n&&(isNaN(o)||o<0||o>255))throw TypeError("Illegal str: Not a debug encoded string");s.view[c++]=o,u=!0}if(g)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!n){if(!l||!f)throw TypeError("Illegal str: Missing offset or limit");if(c<s.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+i)}return s},i.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},d.fromHex=function(e,t,n){var r,o,i,s,a;if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(o=e.length,i=new d(0|o/2,t),s=0,a=0;o>s;s+=2){if(r=parseInt(e.substring(s,s+2),16),!n&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");i.view[a++]=r}return i.limit=a,i},u=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(192|31&n>>6),t(128|63&n)):n<65536?(t(224|15&n>>12),t(128|63&n>>6),t(128|63&n)):(t(240|7&n>>18),t(128|63&n>>12),t(128|63&n>>6),t(128|63&n)),n=null},decodeUTF8:function(e,t){for(var n,r,o,i,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(o=e()))&&s([n,r,o]),t((15&n)<<12|(63&r)<<6|63&o);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(o=e())||null===(i=e()))&&s([n,r,o,i]),t((7&n)<<18|(63&r)<<12|(63&o)<<6|63&i)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}(),i.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{u.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},d.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var o=new d(u.calculateUTF16asUTF8(t(e),!0)[1],n,r),i=0;return u.encodeUTF16toUTF8(t(e),(function(e){o.view[i++]=e})),o.limit=i,o},d}(t),r=function(t,n){var r,o,i={};return i.ByteBuffer=t,i.c=t,r=t,i.Long=n||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){var e={};return e.IS_NODE=!("object"!==("undefined"==typeof process?"undefined":no(process))||process+""!="[object process]"||process.browser),e.XHR=function(){var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=null;for(e=0;e<t.length;e++){try{n=t[e]()}catch(e){continue}break}if(!n)throw Error("XMLHttpRequest is not supported");return n},e.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE)if(n)g.readFile(t,(function(e,t){n(e?null:""+t)}));else try{return g.readFileSync(t)}catch(e){return null}else{var r=e.XHR();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){function n(e,n){var r=-1,o=1;if("-"==e.charAt(0)&&(o=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(o<0?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=0|o*r,!n&&r<0)throw Error("illegal id value: "+(o<0?"-":"")+e);return r}function r(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*parseInt(e,10);if(t.NUMBER_HEX.test(e))return n*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*parseInt(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*parseFloat(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function o(e,t,n){void 0===e[t]?e[t]=n:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n))}var i,s,a={},c=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},u=c.prototype;return u._readString=function(){var e,n='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;if(n.lastIndex=this.index-1,!(e=n.exec(this.source)))throw Error("unterminated string");return this.index=n.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,e[1]},u.next=function(){var e,n,r,o,i;if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;n=r,r=this.source.charAt(this.index)}while("*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;if(o=this.index,t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(o++)))for(;o<this.source.length&&!t.DELIM.test(this.source.charAt(o));)++o;return('"'===(i=this.source.substring(this.index,this.index=o))||"'"===i)&&(this._stringOpen=i),i},u.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},u.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},u.omit=function(e){return this.peek()===e&&(this.next(),!0)},u.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},a.Tokenizer=c,i=function(e){this.tn=new c(e),this.proto3=!1},(s=i.prototype).parse=function(){var e,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!r)throw Error("unexpected 'import'");"public"===(e=this.tn.peek())&&this.tn.next(),e=this._readString(),this.tn.skip(";"),n.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),r=!1;break;case"enum":this._parseEnum(n),r=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},i.parse=function(e){return new i(e).parse()},s._readString=function(){var e,t,n="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);n+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return n},s._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return r(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},s._parseOption=function(e,n){var r,o=this.tn.next(),i=!1;if("("===o&&(i=!0,o=this.tn.next()),!t.TYPEREF.test(o))throw Error("illegal option name: "+o);r=o,i&&(this.tn.skip(")"),r="("+r+")",o=this.tn.peek(),t.FQTYPEREF.test(o)&&(r+=o,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,r),n||this.tn.skip(";")},s._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)o(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?o(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},s._parseService=function(e){var n,r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);for(n={name:r,rpc:{},options:{}},this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},s._parseServiceRPC=function(e){var n,r,o="rpc",i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal rpc service method name: "+i);if(n=i,r={request:null,response:null,request_stream:!1,response_stream:!1,options:{}},this.tn.skip("("),"stream"===(i=this.tn.next()).toLowerCase()&&(r.request_stream=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal rpc service request type: "+i);if(r.request=i,this.tn.skip(")"),"returns"!==(i=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+i);if(this.tn.skip("("),"stream"===(i=this.tn.next()).toLowerCase()&&(r.response_stream=!0,i=this.tn.next()),r.response=i,this.tn.skip(")"),"{"===(i=this.tn.peek())){for(this.tn.next();"}"!==(i=this.tn.next());){if("option"!==i)throw Error("illegal rpc service token: "+i);this._parseOption(r)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[o]&&(e[o]={}),e[o][n]=r},s._parseMessage=function(e,r){var o=!!r,i=this.tn.next(),s={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(i))throw Error("illegal "+(o?"group":"message")+" name: "+i);for(s.name=i,o&&(this.tn.skip("="),r.id=n(this.tn.next()),s.isGroup=!0),"["===(i=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(i=this.tn.next());)if(t.RULE.test(i))this._parseMessageField(s,i);else if("oneof"===i)this._parseMessageOneOf(s);else if("enum"===i)this._parseEnum(s);else if("message"===i)this._parseMessage(s);else if("option"===i)this._parseOption(s);else if("service"===i)this._parseService(s);else if("extensions"===i)s.extensions=this._parseExtensionRanges();else if("reserved"===i)this._parseIgnored();else if("extend"===i)this._parseExtend(s);else{if(!t.TYPEREF.test(i))throw Error("illegal message token: "+i);if(!this.proto3)throw Error("illegal field rule: "+i);this._parseMessageField(s,"optional",i)}return this.tn.omit(";"),e.messages.push(s),s},s._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},s._parseMessageField=function(e,r,o){var i,s,a;if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);if(i={rule:r,type:"",name:"",options:{},id:0},"map"===r){if(o)throw Error("illegal type: "+o);if(this.tn.skip("<"),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field type: "+s);if(i.keytype=s,this.tn.skip(","),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field: "+s);if(i.type=s,this.tn.skip(">"),s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);i.name=s,this.tn.skip("="),i.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(i),this.tn.skip(";")}else if("group"===(o=void 0!==o?o:this.tn.next())){if(a=this._parseMessage(e,i),!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);i.type=a.name,i.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(o)&&!t.TYPEREF.test(o))throw Error("illegal message field type: "+o);if(i.type=o,s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);i.name=s,this.tn.skip("="),i.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(i),this.tn.skip(";")}return e.fields.push(i),i},s._parseMessageOneOf=function(e){var n,r,o,i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal oneof name: "+i);for(r=i,o=[],this.tn.skip("{");"}"!==(i=this.tn.next());)(n=this._parseMessageField(e,"optional",i)).oneof=r,o.push(n.id);this.tn.omit(";"),e.oneofs[r]=o},s._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},s._parseEnum=function(e){var r,o={name:"",values:[],options:{}},i=this.tn.next();if(!t.NAME.test(i))throw Error("illegal name: "+i);for(o.name=i,this.tn.skip("{");"}"!==(i=this.tn.next());)if("option"===i)this._parseOption(o);else{if(!t.NAME.test(i))throw Error("illegal name: "+i);this.tn.skip("="),r={name:i,id:n(this.tn.next(),!0)},"["===(i=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),o.values.push(r)}this.tn.omit(";"),e.enums.push(o)},s._parseExtensionRanges=function(){var t,n,o,i=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":o=e.ID_MIN;break;case"max":o=e.ID_MAX;break;default:o=r(t)}if(n.push(o),2===n.length)break;if("to"!==this.tn.peek()){n.push(o);break}this.tn.next()}i.push(n)}while(this.tn.omit(","));return this.tn.skip(";"),i},s._parseExtend=function(e){var n,r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);for(n={ref:r,fields:[]},this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},s.toString=function(){return"Parser at line "+this.tn.line},a.Parser=i,a}(i,i.Lang),i.Reflect=function(e){function n(t,n){if(t&&"number"==typeof t.low&&"number"==typeof t.high&&"boolean"==typeof t.unsigned&&t.low==t.low&&t.high==t.high)return new e.Long(t.low,t.high,void 0===n?t.unsigned:n);if("string"==typeof t)return e.Long.fromString(t,n||!1,10);if("number"==typeof t)return e.Long.fromNumber(t,n||!1);throw Error("not convertible to Long")}function o(t,n){var r=n.readVarint32(),i=7&r,s=r>>>3;switch(i){case e.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case e.WIRE_TYPES.BITS64:n.offset+=8;break;case e.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case e.WIRE_TYPES.STARTGROUP:o(s,n);break;case e.WIRE_TYPES.ENDGROUP:if(s===t)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+t+" expected)");case e.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+t+": "+i)}return!0}var i,s,a,c,u,d,l,h,f,g,p,v,_,E,m,T,I={},y=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},R=y.prototype;return R.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},R.toString=function(e){return(e?this.className+" ":"")+this.fqn()},R.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},I.T=y,i=function(e,t,n,r,o){y.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=o||"proto2"},(s=i.prototype=Object.create(y.prototype)).getChildren=function(e){var t,n,r;if(null==(e=e||null))return this.children.slice();for(t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},s.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof u.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof u.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.getChild=function(e){var t,n,r="number"==typeof e?"id":"name";for(t=0,n=this.children.length;n>t;++t)if(this.children[t][r]===e)return this.children[t];return null},s.resolve=function(e,t){var n,r="string"==typeof e?e.split("."):e,o=this,i=0;if(""===r[i]){for(;null!==o.parent;)o=o.parent;i++}do{do{if(!(o instanceof I.Namespace)){o=null;break}if(!((n=o.getChild(r[i]))&&n instanceof I.T&&(!t||n instanceof I.Namespace))){o=null;break}o=n,i++}while(i<r.length);if(null!=o)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=o);return o},s.qn=function(e){var t,n,r=[],o=e;do{r.unshift(o.name),o=o.parent}while(null!==o);for(t=1;t<=r.length;t++)if(n=r.slice(r.length-t),e===this.resolve(n,e instanceof I.Namespace))return n.join(".");return e.fqn()},s.build=function(){var e,t,n,r={},o=this.children;for(t=0,n=o.length;n>t;++t)(e=o[t])instanceof i&&(r[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt()}),r},s.buildOpt=function(){var e,t,n,r,o={},i=Object.keys(this.options);for(e=0,t=i.length;t>e;++e)n=i[e],r=this.options[i[e]],o[n]=r;return o},s.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},I.Namespace=i,a=function(t,n,r,o){if(this.type=t,this.resolvedType=n,this.isMapKey=r,this.syntax=o,r&&e.MAP_KEY_TYPES.indexOf(t)<0)throw Error("Invalid map key type: "+t.name)},c=a.prototype,a.defaultFieldValue=function(t){if("string"==typeof t&&(t=e.TYPES[t]),void 0===t.defaultValue)throw Error("default value for type "+t.name+" is not supported");return t==e.TYPES.bytes?new r(0):t.defaultValue},c.verifyValue=function(r){var o,i,s,a=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:return("number"!=typeof r||r==r&&r%1!=0)&&a(no(r),"not an integer"),r>4294967295?0|r:r;case e.TYPES.uint32:case e.TYPES.fixed32:return("number"!=typeof r||r==r&&r%1!=0)&&a(no(r),"not an integer"),r<0?r>>>0:r;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:if(e.Long)try{return n(r,!1)}catch(e){a(no(r),e.message)}else a(no(r),"requires Long.js");case e.TYPES.uint64:case e.TYPES.fixed64:if(e.Long)try{return n(r,!0)}catch(e){a(no(r),e.message)}else a(no(r),"requires Long.js");case e.TYPES.bool:return"boolean"!=typeof r&&a(no(r),"not a boolean"),r;case e.TYPES.float:case e.TYPES.double:return"number"!=typeof r&&a(no(r),"not a number"),r;case e.TYPES.string:return"string"==typeof r||r&&r instanceof String||a(no(r),"not a string"),""+r;case e.TYPES.bytes:return t.isByteBuffer(r)?r:t.wrap(r);case e.TYPES.enum:for(o=this.resolvedType.getChildren(e.Reflect.Enum.Value),s=0;s<o.length;s++){if(o[s].name==r)return o[s].id;if(o[s].id==r)return o[s].id}if("proto3"===this.syntax)return("number"!=typeof r||r==r&&r%1!=0)&&a(no(r),"not an integer"),(r>4294967295||r<0)&&a(no(r),"not in range for uint32"),r;a(r,"not a valid enum value");case e.TYPES.group:case e.TYPES.message:if(r&&"object"===no(r)||a(no(r),"object expected"),r instanceof this.resolvedType.clazz)return r;if(r instanceof e.Builder.Message){for(s in i={},r)r.hasOwnProperty(s)&&(i[s]=r[s]);r=i}return new this.resolvedType.clazz(r)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+r+" (undefined type "+this.type+")")},c.calculateLength=function(t,n){if(null===n)return 0;var o;switch(this.type){case e.TYPES.int32:return n<0?r.calculateVarint64(n):r.calculateVarint32(n);case e.TYPES.uint32:return r.calculateVarint32(n);case e.TYPES.sint32:return r.calculateVarint32(r.zigZagEncode32(n));case e.TYPES.fixed32:case e.TYPES.sfixed32:case e.TYPES.float:return 4;case e.TYPES.int64:case e.TYPES.uint64:return r.calculateVarint64(n);case e.TYPES.sint64:return r.calculateVarint64(r.zigZagEncode64(n));case e.TYPES.fixed64:case e.TYPES.sfixed64:return 8;case e.TYPES.bool:return 1;case e.TYPES.enum:return r.calculateVarint32(n);case e.TYPES.double:return 8;case e.TYPES.string:return o=r.calculateUTF8Bytes(n),r.calculateVarint32(o)+o;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");return r.calculateVarint32(n.remaining())+n.remaining();case e.TYPES.message:return o=this.resolvedType.calculate(n),r.calculateVarint32(o)+o;case e.TYPES.group:return(o=this.resolvedType.calculate(n))+r.calculateVarint32(t<<3|e.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")},c.encodeValue=function(t,n,o){var i,s;if(null===n)return o;switch(this.type){case e.TYPES.int32:n<0?o.writeVarint64(n):o.writeVarint32(n);break;case e.TYPES.uint32:o.writeVarint32(n);break;case e.TYPES.sint32:o.writeVarint32ZigZag(n);break;case e.TYPES.fixed32:o.writeUint32(n);break;case e.TYPES.sfixed32:o.writeInt32(n);break;case e.TYPES.int64:case e.TYPES.uint64:o.writeVarint64(n);break;case e.TYPES.sint64:o.writeVarint64ZigZag(n);break;case e.TYPES.fixed64:o.writeUint64(n);break;case e.TYPES.sfixed64:o.writeInt64(n);break;case e.TYPES.bool:"string"==typeof n?o.writeVarint32("false"===n.toLowerCase()?0:!!n):o.writeVarint32(n?1:0);break;case e.TYPES.enum:o.writeVarint32(n);break;case e.TYPES.float:o.writeFloat32(n);break;case e.TYPES.double:o.writeFloat64(n);break;case e.TYPES.string:o.writeVString(n);break;case e.TYPES.bytes:if(n.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+n.remaining()+" bytes remaining");i=n.offset,o.writeVarint32(n.remaining()),o.append(n),n.offset=i;break;case e.TYPES.message:s=(new r).LE(),this.resolvedType.encode(n,s),o.writeVarint32(s.offset),o.append(s.flip());break;case e.TYPES.group:this.resolvedType.encode(n,o),o.writeVarint32(t<<3|e.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+n+" (unknown type)")}return o},c.decode=function(t,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var o,i;switch(this.type){case e.TYPES.int32:return 0|t.readVarint32();case e.TYPES.uint32:return t.readVarint32()>>>0;case e.TYPES.sint32:return 0|t.readVarint32ZigZag();case e.TYPES.fixed32:return t.readUint32()>>>0;case e.TYPES.sfixed32:return 0|t.readInt32();case e.TYPES.int64:return t.readVarint64();case e.TYPES.uint64:return t.readVarint64().toUnsigned();case e.TYPES.sint64:return t.readVarint64ZigZag();case e.TYPES.fixed64:return t.readUint64();case e.TYPES.sfixed64:return t.readInt64();case e.TYPES.bool:return!!t.readVarint32();case e.TYPES.enum:return t.readVarint32();case e.TYPES.float:return t.readFloat();case e.TYPES.double:return t.readDouble();case e.TYPES.string:return t.readVString();case e.TYPES.bytes:if(i=t.readVarint32(),t.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+t.remaining());return(o=t.clone()).limit=o.offset+i,t.offset+=i,o;case e.TYPES.message:return i=t.readVarint32(),this.resolvedType.decode(t,i);case e.TYPES.group:return this.resolvedType.decode(t,-1,r)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(t){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return this.verifyValue(parseInt(t));case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return this.verifyValue(t);case e.TYPES.bool:return"true"===t;case e.TYPES.string:return this.verifyValue(t);case e.TYPES.bytes:return r.fromBinary(t)}},c.valueToString=function(t){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===e.TYPES.bytes?t.toString("binary"):t.toString()},I.Element=a,u=function(e,t,n,r,o,s){i.call(this,e,t,n,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!o,this._fields=null,this._fieldsById=null,this._fieldsByName=null},(d=u.prototype=Object.create(i.prototype)).build=function(n){var o,i,s,a;if(this.clazz&&!n)return this.clazz;for(o=function(e,n){function o(t,n,i,s){var a,c,u,d,l,h,f;if(null===t||"object"!==no(t))return s&&s instanceof e.Reflect.Enum&&null!==(a=e.Reflect.Enum.getName(s.object,t))?a:t;if(r.isByteBuffer(t))return n?t.toBase64():t.toBuffer();if(e.Long.isLong(t))return i?t.toString():e.Long.fromValue(t);if(Array.isArray(t))return c=[],t.forEach((function(e,t){c[t]=o(e,n,i,s)})),c;if(c={},t instanceof e.Map){for(d=(u=t.entries()).next();!d.done;d=u.next())c[t.keyElem.valueToString(d.value[0])]=o(d.value[1],n,i,t.valueElem.resolvedType);return c}for(f in l=t.$type,h=void 0,t)t.hasOwnProperty(f)&&(c[f]=l&&(h=l.getChild(f))?o(t[f],n,i,h.resolvedType):o(t[f],n,i));return c}var i,s,a=n.getChildren(e.Reflect.Message.Field),c=n.getChildren(e.Reflect.Message.OneOf),u=function t(o){var i,s,u,d;for(e.Builder.Message.call(this),i=0,s=c.length;s>i;++i)this[c[i].name]=null;for(i=0,s=a.length;s>i;++i)this[(u=a[i]).name]=u.repeated?[]:u.map?new e.Map(u):null,!u.required&&"proto3"!==n.syntax||null===u.defaultValue||(this[u.name]=u.defaultValue);if(arguments.length>0)if(1!==arguments.length||null===o||"object"!==no(o)||!("function"!=typeof o.encode||o instanceof t)||Array.isArray(o)||o instanceof e.Map||r.isByteBuffer(o)||o instanceof ArrayBuffer||e.Long&&o instanceof e.Long)for(i=0,s=arguments.length;s>i;++i)void 0!==(d=arguments[i])&&this.$set(a[i].name,d);else this.$set(o)},d=u.prototype=Object.create(e.Builder.Message.prototype);for(d.add=function(t,r,o){var i=n._fieldsByName[t];if(!o){if(!i)throw Error(this+"#"+t+" is undefined");if(!(i instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+i.toString(!0));if(!i.repeated)throw Error(this+"#"+t+" is not a repeated field");r=i.verifyValue(r,!0)}return null===this[t]&&(this[t]=[]),this[t].push(r),this},d.$add=d.add,d.set=function(t,r,o){var i,s,a;if(t&&"object"===no(t)){for(i in o=r,t)t.hasOwnProperty(i)&&void 0!==(r=t[i])&&this.$set(i,r,o);return this}if(s=n._fieldsByName[t],o)this[t]=r;else{if(!s)throw Error(this+"#"+t+" is not a field: undefined");if(!(s instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+s.toString(!0));this[s.name]=r=s.verifyValue(r)}return s&&s.oneof&&(a=this[s.oneof.name],null!==r?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===t&&(this[s.oneof.name]=null)),this},d.$set=d.set,d.get=function(t,r){if(r)return this[t];var o=n._fieldsByName[t];if(!(o&&o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: undefined");if(!(o instanceof e.Reflect.Message.Field))throw Error(this+"#"+t+" is not a field: "+o.toString(!0));return this[o.name]},d.$get=d.get,i=0;i<a.length;i++)(s=a[i])instanceof e.Reflect.Message.ExtensionField||n.builder.options.populateAccessors&&function(e){var t,r,o,i=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));i=i.substring(0,1).toUpperCase()+i.substring(1),t=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),r=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},o=function(){return this[e.name]},null===n.getChild("set"+i)&&(d["set"+i]=r),null===n.getChild("set_"+t)&&(d["set_"+t]=r),null===n.getChild("get"+i)&&(d["get"+i]=o),null===n.getChild("get_"+t)&&(d["get_"+t]=o)}(s);return d.encode=function(e,r){var o,i;"boolean"==typeof e&&(r=e,e=void 0),o=!1,e||(e=new t,o=!0),i=e.littleEndian;try{return n.encode(this,e.LE(),r),(o?e.flip():e).LE(i)}catch(t){throw e.LE(i),t}},u.encode=function(e,t,n){return new u(e).encode(t,n)},d.calculate=function(){return n.calculate(this)},d.encodeDelimited=function(e){var t,o=!1;return e||(e=new r,o=!0),t=(new r).LE(),n.encode(this,t).flip(),e.writeVarint32(t.remaining()),e.append(t),o?e.flip():e},d.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},d.toArrayBuffer=d.encodeAB,d.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},d.toBuffer=d.encodeNB,d.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},d.toBase64=d.encode64,d.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},d.toHex=d.encodeHex,d.toRaw=function(e,t){return o(this,!!e,!!t,this.$type)},d.encodeJSON=function(){return JSON.stringify(o(this,!0,!0,this.$type))},u.decode=function(e,t){var o,i;"string"==typeof e&&(e=r.wrap(e,t||"base64")),o=(e=r.isByteBuffer(e)?e:r.wrap(e)).littleEndian;try{return i=n.decode(e.LE()),e.LE(o),i}catch(t){throw e.LE(o),t}},u.decodeDelimited=function(e,t){var o,i,s;if("string"==typeof e&&(e=r.wrap(e,t||"base64")),(e=r.isByteBuffer(e)?e:r.wrap(e)).remaining()<1)return null;if(o=e.offset,i=e.readVarint32(),e.remaining()<i)return e.offset=o,null;try{return s=n.decode(e.slice(e.offset,e.offset+i).LE()),e.offset+=i,s}catch(t){throw e.offset+=i,t}},u.decode64=function(e){return u.decode(e,"base64")},u.decodeHex=function(e){return u.decode(e,"hex")},u.decodeJSON=function(e){return new u(JSON.parse(e))},d.toString=function(){return n.toString()},Object.defineProperty&&(Object.defineProperty(u,"$options",{value:n.buildOpt()}),Object.defineProperty(d,"$options",{value:u.$options}),Object.defineProperty(u,"$type",{value:n}),Object.defineProperty(d,"$type",{value:n})),u}(e,this),this._fields=[],this._fieldsById={},this._fieldsByName={},s=0,a=this.children.length;a>s;s++)if((i=this.children[s])instanceof p||i instanceof u||i instanceof E){if(o.hasOwnProperty(i.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+i.toString(!0)+" cannot override static property '"+i.name+"'");o[i.name]=i.build()}else if(i instanceof u.Field)i.build(),this._fields.push(i),this._fieldsById[i.id]=i,this._fieldsByName[i.name]=i;else if(!(i instanceof u.OneOf||i instanceof _))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=o},d.encode=function(e,t,n){var r,o,i,s,a,c=null;for(i=0,s=this._fields.length;s>i;++i)o=e[(r=this._fields[i]).name],r.required&&null===o?null===c&&(c=r):r.encode(n?o:r.verifyValue(o),t,e);if(null!==c)throw(a=Error("Missing at least one required field for "+this.toString(!0)+": "+c)).encoded=t,a;return t},d.calculate=function(e){for(var t,n,r=0,o=0,i=this._fields.length;i>o;++o){if(n=e[(t=this._fields[o]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},d.decode=function(t,n,r){var i,s,a,c,u,d,l,h,f,g,p,v;for(n="number"==typeof n?n:-1,u=t.offset,d=new this.clazz;t.offset<u+n||-1===n&&t.remaining()>0;){if(a=(i=t.readVarint32())>>>3,(s=7&i)===e.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(c=this._fieldsById[a])c.repeated&&!c.options.packed?d[c.name].push(c.decode(s,t)):c.map?(h=c.decode(s,t),d[c.name].set(h[0],h[1])):(d[c.name]=c.decode(s,t),c.oneof&&(null!==(f=d[c.oneof.name])&&f!==c.name&&(d[f]=null),d[c.oneof.name]=c.name));else switch(s){case e.WIRE_TYPES.VARINT:t.readVarint32();break;case e.WIRE_TYPES.BITS32:t.offset+=4;break;case e.WIRE_TYPES.BITS64:t.offset+=8;break;case e.WIRE_TYPES.LDELIM:l=t.readVarint32(),t.offset+=l;break;case e.WIRE_TYPES.STARTGROUP:for(;o(a,t););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(g=0,p=this._fields.length;p>g;++g)if(null===d[(c=this._fields[g]).name])if("proto3"===this.syntax)d[c.name]=c.defaultValue;else{if(c.required)throw(v=Error("Missing at least one required field for "+this.toString(!0)+": "+c.name)).decoded=d,v;e.populateDefaults&&null!==c.defaultValue&&(d[c.name]=c.defaultValue)}return d},I.Message=u,l=function(t,n,r,o,i,s,a,c,d,l){y.call(this,t,n,s),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=o||null,this.type=i,this.resolvedType=null,this.id=a,this.options=c||{},this.defaultValue=null,this.oneof=d||null,this.syntax=l||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof u.ExtensionField||(this.name=e.Util.toCamelCase(this.name))},(h=l.prototype=Object.create(y.prototype)).build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},h.verifyValue=function(t,n){var r,o,i;if(n=n||!1,r=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this),null===t)return this.required&&r(no(t),"required"),"proto3"===this.syntax&&this.type!==e.TYPES.message&&r(no(t),"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){for(Array.isArray(t)||(t=[t]),i=[],o=0;o<t.length;o++)i.push(this.element.verifyValue(t[o]));return i}return this.map&&!n?t instanceof e.Map?t:(t instanceof Object||r(no(t),"expected ProtoBuf.Map or raw object for map field"),new e.Map(this,t)):(!this.repeated&&Array.isArray(t)&&r(no(t),"no array expected"),this.element.verifyValue(t))},h.hasWirePresence=function(t,n){if("proto3"!==this.syntax)return null!==t;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case e.TYPES.int32:case e.TYPES.sint32:case e.TYPES.sfixed32:case e.TYPES.uint32:case e.TYPES.fixed32:return 0!==t;case e.TYPES.int64:case e.TYPES.sint64:case e.TYPES.sfixed64:case e.TYPES.uint64:case e.TYPES.fixed64:return 0!==t.low||0!==t.high;case e.TYPES.bool:return t;case e.TYPES.float:case e.TYPES.double:return 0!==t;case e.TYPES.string:return t.length>0;case e.TYPES.bytes:return t.remaining()>0;case e.TYPES.enum:return 0!==t;case e.TYPES.message:return null!==t;default:return!0}},h.encode=function(t,n,o){var i,s,a,c,u;if(null===this.type||"object"!==no(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return n;try{if(this.repeated)if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.ensureCapacity(n.offset+=1),s=n.offset,i=0;i<t.length;i++)this.element.encodeValue(this.id,t[i],n);a=n.offset-s,(c=r.calculateVarint32(a))>1&&(u=n.slice(s,n.offset),s+=c-1,n.offset=s,n.append(u)),n.writeVarint32(a,s-c)}else for(i=0;i<t.length;i++)n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t[i],n);else this.map?t.forEach((function(t,o){var i=r.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,o)+r.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);n.writeVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),n.writeVarint32(i),n.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,o,n),n.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,t,n)}),this):this.hasWirePresence(t,o)&&(n.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,t,n))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+e+")")}return n},h.calculate=function(t,n){var o,i,s;if(t=this.verifyValue(t),null===this.type||"object"!==no(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===t||this.repeated&&0==t.length)return 0;o=0;try{if(this.repeated)if(this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(o+=r.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),s=0,i=0;i<t.length;i++)s+=this.element.calculateLength(this.id,t[i]);o+=r.calculateVarint32(s),o+=s}else for(i=0;i<t.length;i++)o+=r.calculateVarint32(this.id<<3|this.type.wireType),o+=this.element.calculateLength(this.id,t[i]);else this.map?t.forEach((function(t,n){var i=r.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,n)+r.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,t);o+=r.calculateVarint32(this.id<<3|e.WIRE_TYPES.LDELIM),o+=r.calculateVarint32(i),o+=i}),this):this.hasWirePresence(t,n)&&(o+=r.calculateVarint32(this.id<<3|this.type.wireType),o+=this.element.calculateLength(this.id,t))}catch(e){throw Error("Illegal value for "+this.toString(!0)+": "+t+" ("+e+")")}return o},h.decode=function(t,n,r){var o,i,s,c,u,d,l;if(!(!this.map&&t==this.type.wireType||!r&&this.repeated&&this.options.packed&&t==e.WIRE_TYPES.LDELIM||this.map&&t==e.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+t+" ("+this.type.wireType+" expected)");if(t==e.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&e.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){for(i=n.readVarint32(),i=n.offset+i,s=[];n.offset<i;)s.push(this.decode(this.type.wireType,n,!0));return s}if(this.map){if(c=a.defaultFieldValue(this.keyType),o=a.defaultFieldValue(this.type),i=n.readVarint32(),n.remaining()<i)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+i+" required but got only "+n.remaining());for((u=n.clone()).limit=u.offset+i,n.offset+=i;u.remaining()>0;)if(t=7&(d=u.readVarint32()),1===(l=d>>>3))c=this.keyElement.decode(u,t,l);else{if(2!==l)throw Error("Unexpected tag in map field key/value submessage");o=this.element.decode(u,t,l)}return[c,o]}return this.element.decode(n,t,this.id)},I.Message.Field=l,f=function(e,t,n,r,o,i,s){l.call(this,e,t,n,null,r,o,i,s),this.extension},f.prototype=Object.create(l.prototype),I.Message.ExtensionField=f,g=function(e,t,n){y.call(this,e,t,n),this.fields=[]},I.Message.OneOf=g,p=function(e,t,n,r,o){i.call(this,e,t,n,r,o),this.className="Enum",this.object=null},p.getName=function(e,t){var n,r,o=Object.keys(e);for(r=0;r<o.length;++r)if(e[n=o[r]]===t)return n;return null},(p.prototype=Object.create(i.prototype)).build=function(t){var n,r,o,i;if(this.object&&!t)return this.object;for(n=new e.Builder.Enum,o=0,i=(r=this.getChildren(p.Value)).length;i>o;++o)n[r[o].name]=r[o].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},I.Enum=p,v=function(e,t,n,r){y.call(this,e,t,n),this.className="Enum.Value",this.id=r},v.prototype=Object.create(y.prototype),I.Enum.Value=v,_=function(e,t,n,r){y.call(this,e,t,n),this.field=r},_.prototype=Object.create(y.prototype),I.Extension=_,E=function(e,t,n,r){i.call(this,e,t,n,r),this.className="Service",this.clazz=null},(E.prototype=Object.create(i.prototype)).build=function(t){return this.clazz&&!t?this.clazz:this.clazz=function(e,t){var n,o=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},i=o.prototype=Object.create(e.Builder.Service.prototype),s=t.getChildren(e.Reflect.Service.RPCMethod);for(n=0;n<s.length;n++)!function(e){i[e.name]=function(n,o){try{try{n=e.resolvedRequestType.clazz.decode(r.wrap(n))}catch(e){if(!(e instanceof TypeError))throw e}if(null===n||"object"!==no(n))throw Error("Illegal arguments");n instanceof e.resolvedRequestType.clazz||(n=new e.resolvedRequestType.clazz(n)),this.rpcImpl(e.fqn(),n,(function(n,r){if(!n){try{r=e.resolvedResponseType.clazz.decode(r)}catch(e){}return r&&r instanceof e.resolvedResponseType.clazz?void o(null,r):void o(Error("Illegal response type received in service method "+t.name+"#"+e.name))}o(n)}))}catch(e){setTimeout(o.bind(this,e),0)}},o[e.name]=function(t,n,r){new o(t)[e.name](n,r)},Object.defineProperty&&(Object.defineProperty(o[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(i[e.name],"$options",{value:o[e.name].$options}))}(s[n]);return Object.defineProperty&&(Object.defineProperty(o,"$options",{value:t.buildOpt()}),Object.defineProperty(i,"$options",{value:o.$options}),Object.defineProperty(o,"$type",{value:t}),Object.defineProperty(i,"$type",{value:t})),o}(e,this)},I.Service=E,m=function(e,t,n,r){y.call(this,e,t,n),this.className="Service.Method",this.options=r||{}},(m.prototype=Object.create(y.prototype)).buildOpt=s.buildOpt,I.Service.Method=m,T=function(e,t,n,r,o,i,s,a){m.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=o,this.requestStream=i,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null},T.prototype=Object.create(m.prototype),I.Service.RPCMethod=T,I}(i),i.Builder=function(e,t,n){function r(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,r(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}var o=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},i=o.prototype;return o.isMessage=function(e){return"string"==typeof e.name&&(void 0===e.values&&void 0===e.rpc)},o.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},o.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},o.isService=function(e){return!("string"!=typeof e.name||"object"!==no(e.rpc)||!e.rpc)},o.isExtend=function(e){return"string"==typeof e.ref},i.reset=function(){return this.ptr=this.ns,this},i.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},i.create=function(t){var r,i,s,a,c;if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){if(i=t.shift(),o.isMessage(i)){if(s=new n.Message(this,this.ptr,i.name,i.options,i.isGroup,i.syntax),a={},i.oneofs&&Object.keys(i.oneofs).forEach((function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))}),this),i.fields&&i.fields.forEach((function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!==no(e.options))throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,i.syntax),t&&t.fields.push(e),s.addChild(e)}),this),c=[],i.enums&&i.enums.forEach((function(e){c.push(e)})),i.messages&&i.messages.forEach((function(e){c.push(e)})),i.services&&i.services.forEach((function(e){c.push(e)})),i.extensions&&(s.extensions="number"==typeof i.extensions[0]?[i.extensions]:i.extensions),this.ptr.addChild(s),c.length>0){r.push(t),t=c,c=null,this.ptr=s,s=null;continue}c=null}else if(o.isEnum(i))s=new n.Enum(this,this.ptr,i.name,i.options,i.syntax),i.values.forEach((function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))}),this),this.ptr.addChild(s);else if(o.isService(i))s=new n.Service(this,this.ptr,i.name,i.options),Object.keys(i.rpc).forEach((function(e){var t=i.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(s);else{if(!o.isExtend(i))throw Error("not a valid definition: "+JSON.stringify(i));if(s=this.ptr.resolve(i.ref,!0))i.fields.forEach((function(t){var r,o,i,a;if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions&&(r=!1,s.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r))throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)");o=t.name,this.options.convertFieldsToCamelCase&&(o=e.Util.toCamelCase(o)),i=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+o,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,i),i.extension=a,this.ptr.addChild(a),s.addChild(i)}),this);else if(!/\.?google\.protobuf\./.test(i.ref))throw Error("extended message "+i.ref+" is not defined")}i=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},i.import=function(t,n){var o,i,s,a,c,u,d,l,h="/";if("string"==typeof n){if(e.Util.IS_NODE,!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"===no(n)){if(o=n.root,e.Util.IS_NODE,(o.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(h="\\"),i=o+h+n.file,!0===this.files[i])return this.reset();this.files[i]=!0}if(t.imports&&t.imports.length>0){for(a=!1,"object"===no(n)?(this.importRoot=n.root,a=!0,s=this.importRoot,n=n.file,(s.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(h="\\")):"string"==typeof n?this.importRoot?s=this.importRoot:n.indexOf("/")>=0?""===(s=n.replace(/\/[^\/]*$/,""))&&(s="/"):n.indexOf("\\")>=0?(s=n.replace(/\\[^\\]*$/,""),h="\\"):s=".":s=null,c=0;c<t.imports.length;c++)if("string"==typeof t.imports[c]){if(!s)throw Error("cannot determine import root");if("google/protobuf/descriptor.proto"===(u=t.imports[c]))continue;if(u=s+h+u,!0===this.files[u])continue;if(/\.proto$/i.test(u)&&!e.DotProto&&(u=u.replace(/\.proto$/,".json")),null===(d=e.Util.fetch(u)))throw Error("failed to import '"+u+"' in '"+n+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(d+""),u):this.import(e.DotProto.Parser.parse(d),u)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[c],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+c+"."+n}))):this.import(t.imports[c],n+"_import"+c):this.import(t.imports[c]);a&&(this.importRoot=null)}return t.package&&this.define(t.package),t.syntax&&r(t),l=this.ptr,t.options&&Object.keys(t.options).forEach((function(e){l.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=l),t.enums&&(this.create(t.enums),this.ptr=l),t.services&&(this.create(t.services),this.ptr=l),t.extends&&this.create(t.extends),this.reset()},i.resolveAll=function(){var r;if(null==this.ptr||"object"===no(this.ptr.type))return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+no(this.ptr)+": "+this.ptr);return this.reset()},i.build=function(e){var t,n,r;if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},i.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},i.toString=function(){return"Builder"},o.Message=function(){},o.Enum=function(){},o.Service=function(){},o}(i,i.Lang,i.Reflect),i.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){var r,o,i,s;if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(r=Object.keys(n),o=0;o<r.length;o++)i=this.keyElem.valueFromString(r[o]),s=this.valueElem.verifyValue(n[r[o]]),this.map[this.keyElem.valueToString(i)]={key:i,value:s}},o=r.prototype;return o.clear=function(){this.map={}},o.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},o.entries=function(){var e,t,r=[],o=Object.keys(this.map);for(t=0;t<o.length;t++)r.push([(e=this.map[o[t]]).key,e.value]);return n(r)},o.keys=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].key);return n(t)},o.values=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].value);return n(t)},o.forEach=function(e,t){var n,r,o=Object.keys(this.map);for(r=0;r<o.length;r++)e.call(t,(n=this.map[o[r]]).value,n.key,this)},o.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},o.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map?this.map[t].value:void 0},o.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,i.Reflect),i.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,n)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,n){if(t&&"object"===no(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadProto(r,n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===no(e)?e.root+"/"+e.file:e);return null===r?null:i.loadProto(r,n,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===no(t)||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},i.loadJsonFile=function(e,t,n){if(t&&"object"===no(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===no(e)?e.root+"/"+e.file:e);return null===r?null:i.loadJson(JSON.parse(r),n,e)},o=e,i.loadProto(o,void 0,"").build("Modules").probuf}(n,t);return r}$r({target:"Array",proto:!0},{fill:eI}),PN("fill");var BN=function(){function e(e,t,n){this.pbmaps=e,this.logger=n,this.pbModules=DN(t)}return e.prototype.getModule=function(e){return new this.pbModules[e]},e.prototype.encode=function(e,t,n){var r=new this.pbModules[e];if(t)try{this.pbmaps[e].forEach((function(e){var n=t[e];void 0!==n&&r["set".concat(function(e,t,n){if(void 0===t||void 0===n)return e.toUpperCase();var r=e.slice(t,n);return e.replace(r,(function(e){return e.toUpperCase()}))}(e,0,1))](n)}))}catch(t){var o="pbname: ".concat(e,", stack: ").concat(t.stack);this.logger?this.logger.error(Dd.L_PB_ENCODE_E,o):null===console||void 0===console||console.error(Dd.L_PB_ENCODE_E,o)}return n?r:r.toArrayBuffer()},e.prototype.decode=function(e,t){var n=this.pbModules[e].decode(t);return this.fixInt64Values(n)},e.prototype.fixInt64Values=function(e){var t=this;if(e instanceof Array)return e.map((function(e){return t.fixInt64Values(e)}));if(!ul(e))return e;if(void 0!==e.low&&void 0!==e.high&&Object.prototype.hasOwnProperty.call(e,"unsigned")){var n=e.low;return n<0&&(n+=4294967296),n=n.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{".concat(n.length,"}$")),n),16)}for(var r in e)e[r]=this.fixInt64Values(e[r]);return e},e}(),VN=$r,xN=Pc.findIndex,GN=Zu,kN="findIndex",FN=!0;kN in[]&&Array(1)[kN]((function(){FN=!1})),VN({target:"Array",proto:!0,forced:FN},{findIndex:function(e){return xN(this,e,arguments.length>1?arguments[1]:void 0)}}),GN(kN),$r({target:"Number",stat:!0},{isInteger:IR});var HN=s,qN=R,KN=d,jN=i,YN=Oo,JN=Sr,QN=l,WN=xe,ZN=w,zN=Object.assign,XN=Object.defineProperty,$N=qN([].concat),eA=!zN||jN((function(){if(HN&&1!==zN({b:1},zN(XN({},"a",{enumerable:!0,get:function(){XN(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=zN({},e)[n]||YN(zN({},t)).join("")!=r}))?function(e,t){for(var n=WN(e),r=arguments.length,o=1,i=JN.f,s=QN.f;r>o;)for(var a,c=ZN(arguments[o++]),u=i?$N(YN(c),i(c)):YN(c),d=u.length,l=0;d>l;)a=u[l++],HN&&!KN(s,c,a)||(n[a]=c[a]);return n}:zN,tA=eA;$r({target:"Object",stat:!0,arity:2,forced:Object.assign!==tA},{assign:tA});var nA=function(){function e(e){this._context=e}return e.prototype.__getContext=function(){return this._context},e.prototype.createCodec=function(e,t){return this._context.createCodec(e,t)},e.prototype.refetchNaviInfo=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,this._context.refetchNaviInfo()]}))}))},e.prototype.getNaviInfo=function(){return this._context.getNaviInfoFromCache()},e.prototype.getCoreVersion=function(){return"5.7.2"},e.prototype.getAPIVersion=function(){return"5.7.2"},e.prototype.getAppkey=function(){return this._context.appkey},e.prototype.getCurrentId=function(){return this._context.getCurrentUserId()},e.prototype.getConnectionStatus=function(){return this._context.getConnectionStatus()},e.prototype.getDeviceId=function(){return this._context.getDeviceId()},e.prototype.sendMessage=function(e,t,n){return this._context.sendMessage(e,t,n)},e.prototype.registerMessageType=function(e,t,n,r){void 0===r&&(r=[]),this._context.registerMessageType(e,t,n,r)},e.prototype.getServerTime=function(){return this._context.getServerTime()},e.prototype.getOSInfo=function(){return this._context.getOSInfo()},e.prototype.getProcessInfo=function(){return this._context.getProcessInfo()},e.prototype.getMainProcessInfo=function(){return this._context.getMainProcessInfo()},e.prototype.setCallInfo=function(e,t,n){return this._context.setCallInfo(e,t,n)},e.prototype.createLogger=function(e,t){return this._context.createLogger(e,t)},e}(),rA=$r,oA=R,iA=Te,sA=xe,aA=dr,cA=Al,uA=po,dA=i,lA=JO,hA=Hc,fA=WO,gA=ZO,pA=ie,vA=XO,_A=[],EA=oA(_A.sort),mA=oA(_A.push),TA=dA((function(){_A.sort(void 0)})),IA=dA((function(){_A.sort(null)})),yA=hA("sort"),RA=!dA((function(){if(pA)return pA<70;if(!(fA&&fA>3)){if(gA)return!0;if(vA)return vA<603;var e,t,n,r,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)_A.push({k:t+r,v:n})}for(_A.sort((function(e,t){return t.v-e.v})),r=0;r<_A.length;r++)t=_A[r].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));rA({target:"Array",proto:!0,forced:TA||!IA||!yA||!RA},{sort:function(e){void 0!==e&&iA(e);var t=sA(this);if(RA)return void 0===e?EA(t):EA(t,e);var n,r,o=[],i=aA(t);for(r=0;r<i;r++)r in t&&mA(o,t[r]);for(lA(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:uA(t)>uA(n)?1:-1}}(e)),n=aA(o),r=0;r<n;)t[r]=o[r++];for(;r<i;)cA(t,r++);return t}});var CA=$r,SA=Pc.find,OA=Zu,NA="find",AA=!0;NA in[]&&Array(1)[NA]((function(){AA=!1})),CA({target:"Array",proto:!0,forced:AA},{find:function(e){return SA(this,e,arguments.length>1?arguments[1]:void 0)}}),OA(NA);var MA=s,UA=R,LA=Oo,wA=G,bA=UA(l.f),PA=UA([].push),DA=function(e){return function(t){for(var n,r=wA(t),o=LA(r),i=o.length,s=0,a=[];i>s;)n=o[s++],MA&&!bA(r,n)||PA(a,e?[n,r[n]]:r[n]);return a}},BA={entries:DA(!0),values:DA(!1)}.values;$r({target:"Object",stat:!0},{values:function(e){return BA(e)}});var VA={exports:{}},xA={},GA=N,kA=G,FA=zn.f,HA=sI,qA="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];xA.f=function(e){return qA&&"Window"==GA(e)?function(e){try{return FA(e)}catch(e){return HA(qA)}}(e):FA(kA(e))};var KA=i((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),jA=i,YA=Y,JA=N,QA=KA,WA=Object.isExtensible,ZA=jA((function(){WA(1)}))||QA?function(e){return!!YA(e)&&((!QA||"ArrayBuffer"!=JA(e))&&(!WA||WA(e)))}:WA,zA=!i((function(){return Object.isExtensible(Object.preventExtensions({}))})),XA=$r,$A=R,eM=mn,tM=Y,nM=Fe,rM=Lt.f,oM=zn,iM=xA,sM=ZA,aM=zA,cM=!1,uM=Ye("meta"),dM=0,lM=function(e){rM(e,uM,{value:{objectID:"O"+dM++,weakData:{}}})},hM=VA.exports={enable:function(){hM.enable=function(){},cM=!0;var e=oM.f,t=$A([].splice),n={};n[uM]=1,e(n).length&&(oM.f=function(n){for(var r=e(n),o=0,i=r.length;o<i;o++)if(r[o]===uM){t(r,o,1);break}return r},XA({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:iM.f}))},fastKey:function(e,t){if(!tM(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!nM(e,uM)){if(!sM(e))return"F";if(!t)return"E";lM(e)}return e[uM].objectID},getWeakData:function(e,t){if(!nM(e,uM)){if(!sM(e))return!0;if(!t)return!1;lM(e)}return e[uM].weakData},onFreeze:function(e){return aM&&cM&&sM(e)&&!nM(e,uM)&&lM(e),e}};eM[uM]=!0;var fM=$r,gM=r,pM=R,vM=jr,_M=Zn,EM=VA.exports,mM=Gv,TM=Sf,IM=q,yM=b,RM=Y,CM=i,SM=Kv,OM=_f,NM=au,AM=function(e,t,n){var r=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),i=r?"set":"add",s=gM[e],a=s&&s.prototype,c=s,u={},d=function(e){var t=pM(a[e]);_M(a,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(o&&!RM(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return o&&!RM(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!RM(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(vM(e,!IM(s)||!(o||a.forEach&&!CM((function(){(new s).entries().next()})))))c=n.getConstructor(t,e,r,i),EM.enable();else if(vM(e,!0)){var l=new c,h=l[i](o?{}:-0,1)!=l,f=CM((function(){l.has(1)})),g=SM((function(e){new s(e)})),p=!o&&CM((function(){for(var e=new s,t=5;t--;)e[i](t,t);return!e.has(-0)}));g||((c=t((function(e,t){TM(e,a);var n=NM(new s,e,c);return yM(t)||mM(t,n[i],{that:n,AS_ENTRIES:r}),n}))).prototype=a,a.constructor=c),(f||p)&&(d("delete"),d("has"),r&&d("get")),(p||h)&&d(i),o&&a.clear&&delete a.clear}return u[e]=c,fM({global:!0,constructor:!0,forced:c!=s},u),OM(c,e),o||n.setStrong(c,e,r),c},MM=Lt.f,UM=Qo,LM=GT,wM=Oc,bM=Sf,PM=b,DM=Gv,BM=Am,VM=Mm,xM=yf,GM=s,kM=VA.exports.fastKey,FM=bn.set,HM=bn.getterFor,qM={getConstructor:function(e,t,n,r){var o=e((function(e,o){bM(e,i),FM(e,{type:t,index:UM(null),first:void 0,last:void 0,size:0}),GM||(e.size=0),PM(o)||DM(o,e[r],{that:e,AS_ENTRIES:n})})),i=o.prototype,s=HM(t),a=function(e,t,n){var r,o,i=s(e),a=c(e,t);return a?a.value=n:(i.last=a={index:o=kM(t,!0),key:t,value:n,previous:r=i.last,next:void 0,removed:!1},i.first||(i.first=a),r&&(r.next=a),GM?i.size++:e.size++,"F"!==o&&(i.index[o]=a)),e},c=function(e,t){var n,r=s(e),o=kM(t);if("F"!==o)return r.index[o];for(n=r.first;n;n=n.next)if(n.key==t)return n};return LM(i,{clear:function(){for(var e=s(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,GM?e.size=0:this.size=0},delete:function(e){var t=this,n=s(t),r=c(t,e);if(r){var o=r.next,i=r.previous;delete n.index[r.index],r.removed=!0,i&&(i.next=o),o&&(o.previous=i),n.first==r&&(n.first=o),n.last==r&&(n.last=i),GM?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=s(this),r=wM(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),LM(i,n?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),GM&&MM(i,"size",{get:function(){return s(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",o=HM(t),i=HM(r);BM(e,t,(function(e,t){FM(this,{type:r,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=i(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?VM("keys"==t?n.key:"values"==t?n.value:[n.key,n.value],!1):(e.target=void 0,VM(void 0,!0))}),n?"entries":"values",!n,!0),xM(t)}};AM("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),qM);var KM,jM,YM,JM=Hi.charAt,QM=po,WM=bn,ZM=Am,zM=Mm,XM="String Iterator",$M=WM.set,eU=WM.getterFor(XM);ZM(String,"String",(function(e){$M(this,{type:XM,string:QM(e),index:0})}),(function(){var e,t=eU(this),n=t.string,r=t.index;return r>=n.length?zM(void 0,!0):(e=JM(n,r),t.index+=e.length,zM(e,!1))})),(0,My.exports)("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var tU,nU,rU,oU,iU="pgMsgP",sU="chatMsg",aU="pcMsgP",cU={PRIVATE:"ppMsgS",GROUP:"pgMsgS",CHATROOM:"chatMsgS"},uU="delMsg",dU="joinChrm",lU="joinChrmR",hU="exitChrm",fU="setKV",gU="delKV",pU="setKVS",vU="delKVS",_U="qryRelationR",EU="delRelation",mU="setSeAtt",TU={PRIVATE:"cleanPMsg",GROUP:"cleanGMsg",ULTRA_GROUP:"cleanGMsg",CUSTOMER_SERVICE:"cleanCMsg",SYSTEM:"cleanSMsg"},IU="qryPMsg",yU="qryGMsg",RU="qryCHMsg",CU="qryCMsg",SU="qrySMsg",OU=((KM={})["ppMsgP"]=Td.PRIVATE,KM[iU]=Td.GROUP,KM[sU]=Td.CHATROOM,KM[aU]=Td.CUSTOMER_SERVICE,KM),NU=((jM={})[Td.PRIVATE]=IU,jM[Td.GROUP]=yU,jM[Td.CHATROOM]=RU,jM[Td.CUSTOMER_SERVICE]=CU,jM[Td.SYSTEM]=SU,jM),AU=((YM={})[Td.PRIVATE]=TU.PRIVATE,YM[Td.GROUP]=TU.GROUP,YM[Td.ULTRA_GROUP]=TU.ULTRA_GROUP,YM[Td.CUSTOMER_SERVICE]=TU.CUSTOMER_SERVICE,YM[Td.SYSTEM]=TU.SYSTEM,YM),MU="1",UU="0",LU=1,wU=2,bU=3,PU=r.isFinite;$r({target:"Number",stat:!0},{isFinite:Number.isFinite||function(e){return"number"==typeof e&&PU(e)}}),function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(tU||(tU={})),function(e){e[e.SYMMETRIC=0]="SYMMETRIC",e[e.CONNECT=1]="CONNECT",e[e.CONN_ACK=2]="CONN_ACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUB_ACK=4]="PUB_ACK",e[e.QUERY=5]="QUERY",e[e.QUERY_ACK=6]="QUERY_ACK",e[e.QUERY_CONFIRM=7]="QUERY_CONFIRM",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUB_ACK=9]="SUB_ACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUB_ACK=11]="UNSUB_ACK",e[e.PING_REQ=12]="PING_REQ",e[e.PING_RESP=13]="PING_RESP",e[e.DISCONNECT=14]="DISCONNECT",e[e.RESERVER2=15]="RESERVER2"}(nU||(nU={})),function(e){e.PUB="pub",e.QUERY="qry"}(rU||(rU={})),function(e){e[e.V4=4]="V4",e[e.V3=3]="V3"}(oU||(oU={}));var DU,BU=function(){function e(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=tU.AT_LEAST_ONCE),void 0===r&&(r=!1),this._retain=!1,this.qos=tU.AT_LEAST_ONCE,this._dup=!1,this.syncMsg=!1;var o=e>0;e&&o&&1===arguments.length?(this._retain=(1&e)>0,this.qos=(6&e)>>1,this._dup=(8&e)>0,this.type=e>>4&15,this.syncMsg=8==(8&e)):(this.type=e,this._retain=t,this.qos=n,this._dup=r)}return e.prototype.encode=function(){var e=this.type<<4;return e|=this._retain?1:0,e|=this.qos<<1,e|=this._dup?8:0},e}(),VU=function(){function e(){}return e.writeUTF=function(e,t){var n=[],r=0;if(ol(e))for(var o=0,i=e.length;o<i;o++){var s=e.charCodeAt(o);s>=0&&s<=127?(r+=1,n.push(s)):s>=128&&s<=2047?(r+=2,n.push(192|31&s>>6),n.push(128|63&s)):s>=2048&&s<=65535&&(r+=3,n.push(224|15&s>>12),n.push(128|63&s>>6),n.push(128|63&s))}for(o=0,i=n.length;o<i;o++)n[o]>255&&(n[o]&=255);return t?n:r<=255?[0,r].concat(n):[r>>8,255&r].concat(n)},e.readUTF=function(e){for(var t,n,r=[],o=-1,i=e,s="";++o<i.length;){var a=Number(i[o]);if(a===(127&a)||(240==(240&a)?a=(a=(a=(a^=240)<<6|128^i[++o])<<6|128^i[++o])<<6|128^i[++o]:224==(224&a)?a=(a=(a^=224)<<6|128^i[++o])<<6|128^i[++o]:192==(192&a)&&(a=(a^=192)<<6|128^i[++o])),!Number.isFinite(a)||a<0||a>1114111||Math.floor(a)!==a)throw RangeError("Invalid code point: ".concat(a));a<=65535?r.push(a):(t=(a-=65536)>>10|55296,n=a%1024|56320,r.push(t,n)),(o+1===i.length||r.length>16384)&&(s+=String.fromCharCode.apply(null,r),r.length=0)}return s},e}(),xU=function(){function e(e){this._position=0,this._poolLen=0,this._pool=e,this._poolLen=e.length}return e.prototype.check=function(){return this._position>=this._pool.length},e.prototype.read2Byte=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<2;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0".concat(r)),t+=r.toString()}return parseInt(t,16)},e.prototype.readInt=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<4;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0".concat(r)),t+=r.toString()}return parseInt(t,16)},e.prototype.readLong=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<8;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0".concat(r)),t+=r}return parseInt(t,16)},e.prototype.readByte=function(){if(this.check())return-1;var e=this._pool[this._position++];return e>255&&(e&=255),e},e.prototype.readUTF=function(){if(this.check())return"";var e=this.readByte()<<8|this.readByte(),t=this._pool.subarray(this._position,this._position+=e);return VU.readUTF(t)},e.prototype.readAll=function(){return this._pool.subarray(this._position,this._poolLen)},e}(),GU=function(){function e(){this._pool=[],this._position=0,this._writen=0}return e.prototype.write=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")?this._pool=this._pool.concat(e):e>=0&&(e>255&&(e&=255),this._pool.push(e),this._writen++),e},e.prototype.writeArr=function(e){return this._pool=this._pool.concat(e),e},e.prototype.writeUTF=function(e){var t=VU.writeUTF(e);this._pool=this._pool.concat(t),this._writen+=t.length},e.prototype.getBytesArray=function(){return this._pool},e}(),kU=function(e,t){return e&&t?"".concat(t,"_").concat(e):e||Date.now()},FU=function(){function e(e){this.header=e,this.messageId=0,this.timestamp=0,this.syncMsg=!1,this.identifier=""}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return kU(e,t)},e.prototype.read=function(e,t,n,r){this.readMessage(e,t,n,r)},e.prototype.readMessage=function(e,t,n,r){return{stream:t,length:n}},e}(),HU=function(){function e(e){this.lengthSize=0,this.messageId=0,this.topic="",this.targetId="",this.identifier="",this._header=new BU(e,!1,tU.AT_MOST_ONCE,!1)}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return kU(e,t)},e.prototype.write=function(e){var t=this.getHeaderFlag();e.write(t),this.writeMessage(e)},e.prototype.setHeaderQos=function(e){this._header.qos=e},e.prototype.getHeaderFlag=function(){return this._header.encode()},e.prototype.getLengthSize=function(){return this.lengthSize},e.prototype.getBufferData=function(){var e=new GU;this.write(e);var t=e.getBytesArray();return new Int8Array(t)},e}(),qU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.status=null,t.userId=null,t.timestamp=0,t}return nc(t,e),t.prototype.readMessage=function(e,n,r,o){if(n.readByte(),this.status=+n.readByte(),r<=t.MESSAGE_LENGTH)return{stream:n,length:r};if(o===oU.V4){var i=n.readByte();1&i&&(this.userId=n.readUTF()),2&i&&n.readUTF(),4&i&&(this.timestamp=n.readLong()),8&i&&(this.messageId=n.read2Byte())}else{this.userId=n.readUTF();var s=n.readUTF();e.debug(Dd.O,"server sessionId -> ".concat(s)),this.timestamp=n.readLong()}return{stream:n,length:r}},t.MESSAGE_LENGTH=2,t}(FU),KU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.status=0,t}return nc(t,e),t.prototype.readMessage=function(e,t,n){return t.readByte(),this.status=+t.readByte(),{stream:t,length:n}},t.MESSAGE_LENGTH=2,t}(FU),jU=function(e){function t(){return e.call(this,nU.PING_REQ)||this}return nc(t,e),t.prototype.writeMessage=function(e){},t}(HU),YU=function(e){function t(t){return e.call(this,t)||this}return nc(t,e),t}(FU),JU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageId=0,t}return nc(t,e),t.prototype.readMessage=function(e,t,n){var r=256*t.readByte()+t.readByte();return this.messageId=parseInt(r.toString(),10),{stream:t,length:n}},t}(FU),QU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nc(t,e),t.prototype.writeMessage=function(e){var t=this.messageId,n=255&t,r=(65280&t)>>8;e.write(r),e.write(n)},t}(HU),WU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.topic="",t.targetId="",t.syncMsg=!1,t.identifier=rU.PUB,t}return nc(t,e),t.prototype.readMessage=function(t,n,r){return this.date=n.readInt(),this.topic=n.readUTF(),this.targetId=n.readUTF(),e.prototype.readMessage.call(this,t,n,r),this.data=n.readAll(),{stream:n,length:r}},t}(JU),ZU=function(e){function t(t,n,r){var o=e.call(this,nU.PUBLISH)||this;return o.syncMsg=!1,o.identifier=rU.PUB,o.topic=t,o.data=ol(n)?VU.writeUTF(n):n,o.targetId=r,o}return nc(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(QU),zU=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.status=0,t.date=0,t.millisecond=0,t.messageUId="",t.timestamp=0,t.identifier=rU.PUB,t.topic="",t.targetId="",t}return nc(t,e),t.prototype.readMessage=function(t,n,r){return e.prototype.readMessage.call(this,t,n,r),this.date=n.readInt(),this.status=256*n.readByte()+n.readByte(),this.millisecond=256*n.readByte()+n.readByte(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=n.readUTF(),{stream:n,length:r}},t}(JU),XU=function(e){function t(t){var n=e.call(this,nU.PUB_ACK)||this;return n.status=0,n.date=0,n.millisecond=0,n.messageUId="",n.timestamp=0,n.messageId=t,n}return nc(t,e),t.prototype.writeMessage=function(t){e.prototype.writeMessage.call(this,t)},t}(QU),$U=function(e){function t(t,n,r){var o=e.call(this,nU.QUERY)||this;return o.identifier=rU.QUERY,o.topic=t,o.data=ol(n)?VU.writeUTF(n):n,o.targetId=r,o}return nc(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(QU),eL=function(e){function t(t){var n=e.call(this,nU.QUERY_CONFIRM)||this;return n.messageId=t,n}return nc(t,e),t}(QU),tL=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.status=0,t.identifier=rU.QUERY,t.topic="",t.targetId="",t}return nc(t,e),t.prototype.readMessage=function(t,n,r){return e.prototype.readMessage.call(this,t,n,r),this.date=n.readInt(),this.status=256*n.readByte()+n.readByte(),this.data=n.readAll(),{stream:n,length:r}},t}(JU),nL=function(e,t,n){var r=new Uint8Array(t),o=new xU(r),i=o.readByte(),s=function(e,t){var n,r=e.type;switch(r){case nU.CONN_ACK:n=new qU(e);break;case nU.PUBLISH:(n=new WU(e)).syncMsg=e.syncMsg;break;case nU.PUB_ACK:n=new zU(e);break;case nU.QUERY_ACK:n=new tL(e);break;case nU.SUB_ACK:case nU.UNSUB_ACK:case nU.PING_RESP:n=new YU(e);break;case nU.DISCONNECT:n=new KU(e);break;default:n=new FU(e),t.error(Dd.O,"No support for deserializing ".concat(r," messages"))}return n}(new BU(i),e);return s.read(e,o,r.length-1,n),s};!function(e){e[e.ppMsgP=1]="ppMsgP",e[e.ppMsgN=2]="ppMsgN",e[e.ppMsgS=3]="ppMsgS",e[e.pgMsgP=4]="pgMsgP",e[e.chatMsg=5]="chatMsg",e[e.pcMsgP=6]="pcMsgP",e[e.qryPMsg=7]="qryPMsg",e[e.qryGMsg=8]="qryGMsg",e[e.qryCHMsg=9]="qryCHMsg",e[e.qryCMsg=10]="qryCMsg",e[e.qrySMsg=11]="qrySMsg",e[e.recallMsg=12]="recallMsg",e[e.prMsgS=13]="prMsgS",e[e.rrMsg=14]="rrMsg",e[e.rrList=15]="rrList",e[e.s_ntf=16]="s_ntf",e[e.s_msg=17]="s_msg",e[e.s_stat=18]="s_stat",e[e.s_cmd=19]="s_cmd",e[e.s_us=20]="s_us",e[e.pullUS=21]="pullUS",e[e.pgMsgS=22]="pgMsgS",e[e.chatMsgS=23]="chatMsgS",e[e.qrySessionsAtt=24]="qrySessionsAtt",e[e.pullMsg=25]="pullMsg",e[e.qrySessions=26]="qrySessions",e[e.delSessions=27]="delSessions",e[e.delMsg=28]="delMsg",e[e.updRRTime=29]="updRRTime",e[e.chrmPull=30]="chrmPull",e[e.joinChrm=31]="joinChrm",e[e.joinChrmR=32]="joinChrmR",e[e.exitChrm=33]="exitChrm",e[e.queryChrmI=34]="queryChrmI",e[e.setKV=35]="setKV",e[e.delKV=36]="delKV",e[e.pullKV=37]="pullKV",e[e.qryRelation=38]="qryRelation",e[e.delRelation=39]="delRelation",e[e.pullSeAtts=40]="pullSeAtts",e[e.setSeAtt=41]="setSeAtt",e[e.qnTkn=42]="qnTkn",e[e.qnUrl=43]="qnUrl",e[e.aliUrl=44]="aliUrl",e[e.s3Url=45]="s3Url",e[e.stcUrl=46]="stcUrl",e[e.cleanPMsg=47]="cleanPMsg",e[e.cleanGMsg=48]="cleanGMsg",e[e.cleanCMsg=49]="cleanCMsg",e[e.cleanSMsg=50]="cleanSMsg",e[e.rtcPing=51]="rtcPing",e[e.rtc_ntf=52]="rtc_ntf",e[e.rtcSetOutData=53]="rtcSetOutData",e[e.rtcQryUserOutData=54]="rtcQryUserOutData",e[e.addSeTag=55]="addSeTag",e[e.delSeTag=56]="delSeTag",e[e.addTag=57]="addTag",e[e.delTag=58]="delTag",e[e.disTag=59]="disTag",e[e.reportsdk=60]="reportsdk",e[e.pullUgSes=61]="pullUgSes",e[e.pullUgMsg=62]="pullUgMsg",e[e.ugMsg=63]="ugMsg",e[e.qryUgMsg=64]="qryUgMsg",e[e.updUgRTime=65]="updUgRTime",e[e.upMsgEx=66]="upMsgEx",e[e.modifyMsg=67]="modifyMsg",e[e.qryMsgChange=68]="qryMsgChange",e[e.qryMsg=69]="qryMsg",e[e.operate=70]="operate",e[e.s_opNtf=71]="s_opNtf",e[e.ugUnpushQuery=72]="ugUnpushQuery",e[e.ugUnpushSet=73]="ugUnpushSet",e[e.setRtcRoomId=74]="setRtcRoomId",e[e.qryUgUal=75]="qryUgUal"}(DU||(DU={}));var rL=DU,oL="outbox",iL="inbox",sL="broadcastbox",aL=function(e,t,n){return[e,t,n].join("_")},cL=function(){function e(e,t){this._runtime=e,this._appkey=t,this._users={}}return e.prototype._getMemData=function(e){return this._users[e]=this._users[e]||{inboxTime:0,outboxTime:0,broadcastSyncTime:0},this._users[e]},e.prototype.setInboxTime=function(e,t){var n=this._getMemData(t);if(!(n.inboxTime>e)){n.inboxTime=e;var r=aL(iL,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getInboxTime=function(e){var t=this._getMemData(e);if(0===t.inboxTime){var n=aL(iL,this._appkey,e);t.inboxTime=parseInt(this._runtime.localStorage.getItem(n),10)||0}return t.inboxTime},e.prototype.setBroadcastSyncTime=function(e,t){var n=this._getMemData(t);if(!(n.broadcastSyncTime>=e||ll(e))){n.broadcastSyncTime=e;var r=aL(sL,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getBroadcastSyncTime=function(e){var t=this._getMemData(e);if(!t||0===t.broadcastSyncTime){var n=aL(sL,this._appkey,e);t.broadcastSyncTime=parseInt(this._runtime.localStorage.getItem(n),10)||1}return t.broadcastSyncTime},e.prototype.setOutboxTime=function(e,t){var n=this._getMemData(t);if(!(n.outboxTime>=e)){n.outboxTime=e;var r=aL(oL,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getOutboxTime=function(e){var t=this._getMemData(e);if(0===t.outboxTime){var n=aL(oL,this._appkey,e);t.outboxTime=parseInt(this._runtime.localStorage.getItem(n),10)||0}return t.outboxTime},e}(),uL={_caches:{},set:function(e,t){this._caches[e]=t},get:function(e){return this._caches[e]||0},clear:function(e){this._caches[e]=0}},dL=function(){function e(e,t,n){this.logger=e,this._kvCaches={},this._chatroomId=t,this._currentUserId=n}return e.prototype._add=function(e){var t=e.key;e.isDeleted=!1,this._kvCaches[t]=e},e.prototype._remove=function(e){var t=e.key,n=this._kvCaches[t];n&&(n.isDeleted=!0,this._kvCaches[t]=n)},e.prototype._setEntry=function(e,t){var n=e.key,r=e.type,o=e.isOverwrite,i=e.userId,s=this._getSetUserId(n),a=r===Vd.DELETE,c=s===i,u=!this._isExisted(n),d=a?this._remove:this._add;(t||o||c||u)&&d.call(this,e)},e.prototype.getValue=function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.value},e.prototype.getVersion=function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.version},e.prototype.getAllValue=function(){var e={};for(var t in this._kvCaches)this._kvCaches[t].isDeleted||(e[t]=this._kvCaches[t].value);return e},e.prototype._getSetUserId=function(e){return(this._kvCaches[e]||{}).userId},e.prototype._isExisted=function(e){var t=this._kvCaches[e]||{},n=t.value,r=t.isDeleted;return n&&!r},e.prototype.setEntries=function(e){var t=this,n=e.kvEntries,r=e.isFullUpdate;n=n||[],(r=r||!1)&&this.clear(),n.forEach((function(e){t._setEntry(e,r)}))},e.prototype.clear=function(){this._kvCaches={}},e}(),lL=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._storeCaches={},this._engine=e}return e.prototype._startPull=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.chrmId,n=e.timestamp,(r=uL.get(t))>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullChatroomEntry(t,r)]);case 1:return o=a.sent(),i=o.code,s=o.data,this._isPulling=!1,i===Ed.SUCCESS?(uL.set(t,s.syncTime||0),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.reset=function(e){uL.clear(e);var t=this._storeCaches[e];null==t||t.clear()},e.prototype.pullEntry=function(e,t){this._pullQueue.push({chrmId:e,timestamp:t}),this._startPull()},e.prototype.setLocal=function(e,t,n){var r=this._storeCaches[e];gl(r)||(r=new dL(this._engine.getInnerLogger(),e,n)),r.setEntries(t),this._storeCaches[e]=r},e.prototype.getValue=function(e,t){var n=this._storeCaches[e];return n?n.getValue(t):null},e.prototype.getVersion=function(e,t){var n=this._storeCaches[e];return n?n.getVersion(t):null},e.prototype.getAll=function(e){var t=this._storeCaches[e],n={};return t&&(n=t.getAllValue()),n},e}(),hL=function(){function e(e,t,n,r,o){this._runtime=e,this._appkey=t,this._userId=n,this._canJoinMulipleChrm=r,this.logger=o,this._sessionKey="",this._joinedChrmsInfo={},this._sessionKey="sync-chrm-".concat(this._appkey,"-").concat(this._userId)}return e.prototype.set=function(e,t){void 0===t&&(t=10),this._canJoinMulipleChrm||(this._joinedChrmsInfo={}),this._joinedChrmsInfo[e]=t,this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo))},e.prototype.get=function(){var e,t;try{t=this._runtime.sessionStorage.getItem(this._sessionKey),e=JSON.parse(t||"{}")}catch(n){this.logger.error(Dd.O,"parse rejoined chrm infos error -> ".concat(t)),e={}}return e},e.prototype.remove=function(e){delete this._joinedChrmsInfo[e],gl(this._joinedChrmsInfo)?this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo)):this.clear()},e.prototype.clear=function(){this._joinedChrmsInfo={},this._runtime.sessionStorage.removeItem(this._sessionKey)},e}(),fL="converStatusChanged",gL=function(){function e(e,t,n){this._eventEmitter=new th,this._pullQueue=[],this._isPulling=!1,this._storagePullTimeKey="con-s-".concat(t,"-").concat(n),this._oldStorage=Xa(e.runtime),this._storage=new ec(e.runtime,this._storagePullTimeKey),this._appkey=t,this._currentUserId=n,this._engine=e,this.adaptOldStatus()}return e.prototype.adaptOldStatus=function(){try{if(this._storage.get(this._storagePullTimeKey)||0)return;var e=this._oldStorage.get(this._storagePullTimeKey)||0;if(!e)return;this._storage.set(this._storagePullTimeKey,e),this._oldStorage.remove(this._storagePullTimeKey)}catch(e){this._engine.getInnerLogger().error(Dd.A_CALLBACK_E,"adaptOldStatus error: ".concat(e.message))}},e.prototype._set=function(e){var t=this;if(!ll(e)&&Array.isArray(e)){var n=this._storage.get(this._storagePullTimeKey)||0,r=e.length;e.forEach((function(e,o){var i=e.updatedTime||0;n=i>n?i:n,e.conversationType=e.type,t._eventEmitter.emit(fL,{statusItem:e,isLastPull:o===r-1})})),this._storage.set(this._storagePullTimeKey,n)}},e.prototype._startPull=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r;return ic(this,(function(o){switch(o.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullConversationStatus(e)]);case 1:return t=o.sent(),n=t.code,r=t.data,n===Ed.SUCCESS?(this._isPulling=!1,this._set(r),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pull=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.watch=function(e){this._eventEmitter.on(fL,(function(t){e(t)}))},e.prototype.setConversationUpdatedTime=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;return e&&e>t?(this._storage.set(this._storagePullTimeKey,e),e):t},e.prototype.getConversationUpdatedTime=function(){return this._storage.get(this._storagePullTimeKey)||0},e}(),pL={c:{keyName:"unreadMessageCount",defaultVal:0},hm:{keyName:"hasMentioned",defaultVal:!1},m:{keyName:"mentionedInfo",defaultVal:null},t:{keyName:"lastUnreadTime",defaultVal:0},lt:{keyName:"lastReadTime",defaultVal:0},nc:{keyName:"notificationStatus",defaultVal:2},nl:{keyName:"notificationLevel",defaultVal:0},to:{keyName:"isTop",defaultVal:!1},tg:{keyName:"tags",defaultVal:{}},mc:{keyName:"unreadMentionedCount",defaultVal:0},st:{keyName:"lastMessageSentTime",defaultVal:0}},vL={};for(var _L in pL){var EL=pL[_L].keyName;vL[EL]=_L}var mL,TL=function(){function e(e,t,n,r){this._appkey=t,this._currentUserId=n,this.logger=r;var o="con-".concat(t,"-").concat(n);this.storage=new ec(e,o),this._localStore=new ec(e,"CONVER-".concat(t,"-").concat(n))}return e.prototype._getStoreKey=function(e,t,n){return"".concat(n,"_").concat(e,"_").concat(t)},e.prototype._getConOptionByKey=function(e){var t=(e=e||"").split("_");if(t.length>=2){var n=t.shift(),r=t.shift(),o=t.join("_");return{conversationType:Number(r),targetId:o,channelId:n}}return{conversationType:Td.PRIVATE,targetId:"",channelId:""}},e.prototype.updateMentionedData=function(e){var t=this,n=e.conversationType,r=e.targetId,o=e.messageType,i=e.isMentioned,s=e.content,a=e.senderUserId,c=e.channelId,u=this._getStoreKey(n,r,c),d=this._localStore.get(u)||{},l=vL.mentionedInfo,h=vL.hasMentioned,f=d[l]||{},g=f.userIdList||[],p=s.mentionedInfo;if(p){if(i&&n===Td.GROUP)(p.userIdList||[]).forEach((function(e){e===t._currentUserId&&g.indexOf(a)<0&&g.push(a)})),p.type===Ud.ALL&&g.indexOf(a)<0&&g.push(a);if(o===Cd.RECALL&&n===Td.GROUP){var v=g.indexOf(a);v>=0&&g.splice(v,1)}p={userIdList:g,type:(null==p?void 0:p.type)||f.type},0!==g.length?(d[l]=p,d[h]=!0):(delete d[l],delete d[h]),gl(d)?this._localStore.set(u,d):this._localStore.remove(u)}},e.prototype.set=function(e,t,n,r){var o=this._getStoreKey(e,t,r),i=this._localStore.get(o)||{};for(var s in n){var a=vL[s],c=n[s];if(!ll(a)&&!ll(c)&&"hasMentioned"!==s&&"MentionedInfo"!==s){if(c===pL[a].defaultVal||"tags"===s&&!gl(c))delete i[a];else if("tags"===s){var u=c;for(var d in u)u[d].isTop||delete u[d].isTop;i[a]=c}else i[a]=c;i.c||(delete i.t,delete i.hm,delete i.m,delete i.mc)}}var l=Object.keys(i);1===l.length&&l.includes("st")&&delete i.st,gl(i)?this._localStore.set(o,i):this._localStore.remove(o)},e.prototype.get=function(e,t,n){void 0===n&&(n="");var r=this._getStoreKey(e,t,n),o=this._localStore.get(r)||{},i={};for(var s in pL){var a=pL[s],c=a.keyName,u=a.defaultVal;i[c]=o[s]||LE(u)}return i},e.prototype.getValue=function(e){var t=this._localStore.getValues()||{},n=[];for(var r in t){var o=this._getConOptionByKey(r),i={conversationType:o.conversationType,targetId:o.targetId,channelId:o.channelId},s=t[r];for(var a in s)if(pL[a]){var c=pL[a],u=c.keyName,d=c.defaultVal;i[u]=s[a]||LE(d)}i=e?e(i):i,n.push(i)}return n},e.prototype.getValueForTag=function(){var e=this._localStore.getValues()||{},t={};for(var n in e){var r=this._getConOptionByKey(n),o=r.conversationType,i=r.targetId,s={},a=e[n];for(var c in a){var u=pL[c],d=u.keyName,l=u.defaultVal;s[d]=a[c]||LE(l)}for(var h in s.tags){ll(t[h])&&(t[h]=[]);var f=rc(rc({},s),{conversationType:o,targetId:i});delete f.tags,t[h].push(f)}}return t},e.prototype.adaptOldStore=function(){try{var e=this.storage.getValues();if(0===Object.keys(e).length)return;for(var t in e){var n="_".concat(t);this._localStore.set(n,e[t])}this.storage.clear()}catch(e){this.logger.error(Dd.O,"adaptOldStore error: ".concat(e.message))}},e.prototype.remove=function(e,t,n){var r=this._getStoreKey(e,t,n);this._localStore.remove(r)},e}(),IL=[Td.PRIVATE,Td.GROUP,Td.SYSTEM,Td.PUBLIC_SERVICE,Td.APP_PUBLIC_SERVICE],yL="conversationChanged",RL="conTagStatusChanged",CL=function(){function e(e,t,n,r,o){var i=this;this._updatedConversations={},this._conTagStatusChanged=!1,this._eventEmitter=new th,this._draftMap={},this._recallMsgTimeMap={},this._appkey=t,this._loginUserId=n,this._store=new TL(e.runtime,t,n,e.getInnerLogger()),this._statusManager=new gL(e,t,n),this._statusManager.watch((function(e){var t=e.statusItem,n=e.isLastPull;i.addStatus(t,n)})),this._eventEmitter.on(yL,(function(e){r(e)})),this._eventEmitter.on(RL,(function(){o()}));var s=this._store.getValue();s.length>1200&&(s=s.sort((function(e,t){var n=e.lastMessageSentTime,r=void 0===n?0:n,o=t.lastMessageSentTime;return(void 0===o?0:o)-r})),s.splice(1200,s.length).forEach((function(e){i._store.remove(e.conversationType,e.targetId,e.channelId)})))}return e.prototype._calcUnreadCount=function(e,t){var n=e.content,r=e.messageType,o=e.sentTime,i=e.isCounted,s=e.messageDirection,a=e.senderUserId,c=s===vd.SEND&&a===this._loginUserId,u=r===Cd.RECALL,d=ul(n),l=!1,h={},f=t.lastUnreadTime||0,g=t.lastReadTime||0,p=t.unreadMessageCount||0;if(f>o||c)return{hasChanged:l,localConversation:t,updateItems:h};if(i&&(t.unreadMessageCount=p+1,t.lastUnreadTime=o,l=!0),u&&d){var v="".concat(e.conversationType,"_").concat(e.channelId,"_").concat(e.targetId),_=!this._recallMsgTimeMap[v]||this._recallMsgTimeMap[v]&&!this._recallMsgTimeMap[v].find((function(e){return e===n.sentTime})),E=f>=n.sentTime;g&&(E=g<n.sentTime),E&&p&&_&&(this._recallMsgTimeMap[v]||(this._recallMsgTimeMap[v]=[]),this._recallMsgTimeMap[v].push(n.sentTime),t.unreadMessageCount=p-1,l=!0)}return l&&(h.unreadMessageCount={val:t.unreadMessageCount,time:o}),{hasChanged:l,localConversation:t,updateItems:h}},e.prototype._calcMentionedInfo=function(e,t){var n=e.content,r=(e.messageDirection,e.isMentioned),o=e.sentTime;vd.SEND;var i=ul(n),s=!1,a={};return r&&i&&n.mentionedInfo&&(t.hasMentioned=!0,s=!0,a.hasMentioned={val:!0,time:o},a.mentionedInfo={val:n.mentionedInfo,time:o}),{hasChanged:s,localConversation:t,updateItems:a}},e.prototype._calcMentionedCount=function(e,t){var n=e.content,r=e.messageDirection,o=!1;if(e.isMentioned&&r===vd.RECEIVE&&(null==n?void 0:n.mentionedInfo)){var i=n.mentionedInfo,s=i.type,a=i.userIdList;if(s===Ud.ALL||(a||[]).includes(this._loginUserId)){o=!0;var c=t.unreadMentionedCount||0;t.unreadMentionedCount=c+1}}return{hasChanged:o,localConversation:t}},e.prototype._setUpdatedConversation=function(e){if(ul(e)){var t=e.conversationType,n=e.targetId,r=e.channelId,o="".concat(t,"_").concat(n),i=this._store.get(t,n,r)||{};this._updatedConversations[o]=Object.assign(i,e)}},e.prototype._setConTagStatusChanged=function(e,t,n,r){var o=(this._store.get(e,t,r)||{}).tags||{};if(Object.keys(o).length===Object.keys(n).length){for(var i in o)if(!n[i]||!!o[i].isTop!=!!n[i].isTop)return void(this._conTagStatusChanged=!0)}else this._conTagStatusChanged=!0},e.prototype.addStatus=function(e,t){var n=e.conversationType,r=e.targetId,o=e.updatedTime,i=e.notificationStatus,s=e.notificationLevel,a=e.isTop,c=e.tags,u=e.channelId,d={},l={};if(n!==Td.ULTRA_GROUP){ll(i)||(l.notificationStatus={time:o,val:i}),ll(s)||(l.notificationLevel={time:o,val:s}),ll(a)||(l.isTop={time:o,val:a}),ll(c)||(l.tags={time:o,val:c},null==c||c.forEach((function(e){d[e.tagId]={isTop:e.isTop}}))),this._setConTagStatusChanged(n,r,d,u);var h=this._store.get(n,r,u).lastMessageSentTime||(new Date).getTime();this._store.set(n,r,{notificationStatus:i,notificationLevel:s,isTop:a,tags:d,lastMessageSentTime:h},u),this._setUpdatedConversation({conversationType:n,targetId:r,updatedItems:l,channelId:u}),t&&this._notifyConversationChanged()}},e.prototype._notifyConversationChanged=function(){var e=[];for(var t in this._updatedConversations)e.push(this._updatedConversations[t]);0!==e.length&&(this._eventEmitter.emit(yL,e),this._updatedConversations={},this._conTagStatusChanged&&(this._eventEmitter.emit(RL),this._conTagStatusChanged=!1))},e.prototype.setConversationCacheByMessage=function(e,t){var n=this,r=e.conversationType,o=e.isPersited,i=e.targetId,s=e.channelId,a=e.sentTime;if(IL.indexOf(r)>=0){var c=!1,u=this._store.get(r,i,s),d={};if(u.lastMessageSentTime=a,[this._calcUnreadCount,this._calcMentionedInfo,this._calcMentionedCount].forEach((function(t){var r=t.call(n,e,u),o=r.hasChanged,i=r.localConversation,s=r.updateItems;c=c||o,d=rc(rc({},d),s),u=LE(i)})),this._store.set(r,i,u,s),this._store.updateMentionedData(e),o){var l=this._store.get(r,i,s);l.updatedItems=rc({latestMessage:{time:e.sentTime,val:e}},d),l.latestMessage=e;var h=Object.assign(l,{conversationType:r,targetId:i,channelId:s});this._setUpdatedConversation(h)}(c||o)&&this._notifyConversationChanged()}},e.prototype.get=function(e,t,n){return void 0===n&&(n=""),this._store.get(e,t,n)},e.prototype.getAllUnreadCount=function(e,t,n){var r=this._store.getValue(),o=0;return r.forEach((function(e){var r=e.unreadMessageCount,i=e.notificationStatus,s=e.notificationLevel,a=e.conversationType;r=r||0,(n||1!==i||s===Ad.NOT_SET||s===Ad.ALL_MESSAGE)&&(t.length>0?t.includes(Number(a))&&(o+=Number(r)):o+=Number(r))})),o},e.prototype.getTotalUnreadCountByLevels=function(e,t,n){var r=this._store.getValue(),o=0;return r.forEach((function(r){var i=r.unreadMessageCount,s=r.notificationLevel,a=void 0===s?0:s,c=r.conversationType,u=r.unreadMentionedCount;e.includes(c)&&(0===t.length||t.includes(a))&&(o+=(n?u:i)||0)})),o},e.prototype.getUnreadCountByTag=function(e,t){var n=this._store.getValueForTag()[e]||[],r=0;return n.forEach((function(e){var n=e.unreadMessageCount,o=e.notificationStatus,i=e.notificationLevel;(t||1!==o||-1===i||0===i)&&(n=n||0,r+=Number(n))})),r},e.prototype.getUnreadCount=function(e,t,n){return this._store.get(e,t,n).unreadMessageCount||0},e.prototype.clearUnreadCount=function(e,t,n,r){void 0===r&&(r=!0);var o=this._store.get(e,t,n);o.lastReadTime=o.lastUnreadTime,this._recallMsgTimeMap["".concat(e,"_").concat(n,"_").concat(t)]=[];var i=o.unreadMessageCount,s=o.hasMentioned,a={};if(i&&(o.unreadMessageCount=0,a.unreadMessageCount={val:0,time:Date.now()}),s&&(o.hasMentioned=!1,o.unreadMentionedCount=0,o.mentionedInfo=void 0,a.hasMentioned={val:!1,time:Date.now()},a.mentionedInfo={val:void 0,time:Date.now()}),this._store.set(e,t,o,n),r&&0!==Object.keys(a).length){var c=Object.assign(o,{conversationType:e,targetId:t,channelId:n,updatedItems:a});this._setUpdatedConversation(c),this._notifyConversationChanged()}},e.prototype.clearAllUnreadCount=function(){var e=this;this._store.getValue().forEach((function(t){t.unreadMessageCount&&(t.unreadMessageCount=0,t.lastReadTime=t.lastUnreadTime,e._recallMsgTimeMap={},e._store.set(t.conversationType,t.targetId,t,t.channelId))}))},e.prototype.startPullConversationStatus=function(e){this._statusManager.pull(e)},e.prototype.setDraft=function(e,t,n,r){var o="".concat(e,"_").concat(t,"_").concat(r);this._draftMap[o]=n},e.prototype.getDraft=function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return this._draftMap[r]},e.prototype.clearDraft=function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);delete this._draftMap[r]},e.prototype.addTagStatus=function(e,t,n,r){void 0===r&&(r="");var o=this._store.get(e,t,r),i=o.tags;i=Object.assign(i,n);var s=o.lastMessageSentTime||(new Date).getTime();this._store.set(e,t,{tags:i,lastMessageSentTime:s},r)},e.prototype.deleteTagStatus=function(e,t,n,r){void 0===r&&(r="");var o=this._store.get(e,t,r).tags;n.forEach((function(e){delete o[e]})),this._store.set(e,t,{tags:o},r)},e.prototype.getConversationListForTag=function(){return this._store.getValueForTag()},e.prototype.getBlockConversationList=function(){return this._store.getValue().filter((function(e){return e.notificationStatus===Od.OPEN||e.notificationLevel&&e.notificationLevel>0})).map((function(e){return{conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId}}))},e.prototype.getTopConversationList=function(e,t){return(this._store.getValue()||{}).filter((function(n){return e.includes(n.conversationType)&&(ll(t)||t===n.channelId)&&n.isTop})).map((function(e){return{channelId:e.channelId,conversationType:e.conversationType,targetId:e.targetId,unreadMessageCount:e.unreadMessageCount||0,latestMessage:null,hasMentioned:e.hasMentioned||!1,mentionedInfo:e.mentionedInfo,notificationStatus:e.notificationStatus||0,notificationLevel:e.notificationLevel,isTop:e.isTop||!1,lastUnreadTime:e.lastUnreadTime||0,unreadMentionedCount:e.unreadMentionedCount||0}}))},e.prototype.adaptOldStore=function(){this._store.adaptOldStore()},e.prototype.getUnreadMentionedCount=function(e,t,n){return void 0===e&&(e=""),this.get(t,n,e).unreadMentionedCount||0},e.prototype.getAllUnreadMentionedCount=function(){var e=this._store.getValue(),t=0;return e.forEach((function(e){var n=e.unreadMentionedCount;n=n||0,t+=Number(n)})),t},e.prototype.getAllConversationState=function(){return this._store.getValue().filter((function(e){return e.unreadMessageCount||e.unreadMentionedCount})).map((function(e){return{conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId,unreadCount:e.unreadMessageCount||0,unreadMentionedCount:e.unreadMentionedCount||0}}))},e.prototype.getUnreadConversationList=function(e){return(this._store.getValue()||{}).filter((function(t){return e.includes(t.conversationType)&&t.unreadMessageCount&&t.unreadMessageCount>0})).map((function(e){return{channelId:e.channelId,conversationType:e.conversationType,targetId:e.targetId,unreadMessageCount:e.unreadMessageCount||0,latestMessage:null,hasMentioned:e.hasMentioned||!1,mentionedInfo:e.mentionedInfo,notificationStatus:e.notificationStatus||0,notificationLevel:e.notificationLevel,isTop:e.isTop||!1,lastUnreadTime:e.lastUnreadTime||0,unreadMentionedCount:e.unreadMentionedCount||0}}))},e.prototype.setConversationUpdatedTime=function(e){return this._statusManager.setConversationUpdatedTime(e)},e.prototype.getConversationUpdatedTime=function(){return this._statusManager.getConversationUpdatedTime()},e}(),SL=function(){function e(e,t,n,r){this._pullQueue=[],this._isPulling=!1,this._storageTagKey="tag-".concat(t,"-").concat(n),this._storagePullTimeKey="us-s-".concat(t,"-").concat(n),this._storage=Xa(e.runtime),this._engine=e,this._tagWatcherFunc=r}return e.prototype._updateTag=function(e){var t=e.tags,n={};t.forEach((function(e){n[e.tagId]={tagName:e.tagName,createdTime:e.createdTime}})),this._storage.set(this._storageTagKey,n),this._tagWatcherFunc()},e.prototype.addTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){var t,r=(null===(t=n[e.tagId])||void 0===t?void 0:t.createdTime)||e.createdTime||0;n[e.tagId]={tagName:e.tagName,createdTime:r}})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.deleteTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){delete n[e]})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.getTagsInfo=function(){return this._storage.get(this._storageTagKey)||{}},e.prototype.getTags=function(){var e=this._storage.get(this._storageTagKey)||{},t=[];for(var n in e)t.push({tagId:n,tagName:e[n].tagName,createdTime:e[n].createdTime,conversationCount:0});return t.sort((function(e,t){return(e.createdTime||0)-(t.createdTime||0)}))},e.prototype.getTagById=function(e){var t=this._storage.get(this._storageTagKey)||{};return t[e]?{tagId:e,tagName:t[e].tagName,createdTime:t[e].createdTime,conversationCount:0}:null},e.prototype._startPull=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullUserSettings(e)]);case 1:return t=c.sent(),n=t.code,r=t.data,n!==Ed.SUCCESS||ll(r)?(this._isPulling=!1,this._startPull()):(i=(o=r).settings,s=o.version,a=i.Tag,ll(a)||this._updateTag(a),this._storage.set(this._storagePullTimeKey,s),this._isPulling=!1,this._startPull()),[2]}}))}))},e.prototype.pullUserSettings=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.getVersion=function(){return this._storage.get(this._storagePullTimeKey)||0},e}(),OL=function(e){return e.replace(/@.+$/,"@")},NL=function(){function e(e,t,n){this.appkey=e,this.logger=t,this.navigators=n,this.crtRequest=null}return e.prototype.request=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this.crtRequest?[2,this.crtRequest]:(this.crtRequest=this.sendRequest(e,t,n,r),[4,this.crtRequest]);case 1:return o=a.sent(),i=o.code,s=o.data,this.crtRequest=null,[2,{code:i,data:s}]}}))}))},e.prototype.sendRequest=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d,l,h,f,g,p,v,_;return ic(this,(function(E){switch(E.label){case 0:return o=OL(e),!t&&(i=this.getNaviCache(o))&&(s=i.timestamp,a=i.naviInfo,n||Date.now()-s<ka)?(this.logger.info(Dd.L_REQUEST_T,JSON.stringify({fromCache:!0,naviInfo:a}),r),[2,{code:Ed.SUCCESS,data:a}]):(c=e.split("@"),u=c[1],d=u?u.split(";").map((function(e){return/^https?:/.test(e)?e:"https://".concat(e)})):[],l=this.navigators&&this.navigators.length>0?this.navigators.filter((function(e){return/^https?:\/\//.test(e)})):[],h=Ha,this.logger.info(Dd.L_GET_NAVI_T,JSON.stringify({token:e,customUris:l,defaultUris:h,dynamicUris:d}),r),f=sc(sc(sc([],l,!0),d,!0),h,!0),[4,this.requestHandler(f,e,r)]);case 1:return g=E.sent(),p=g.code,v=g.data,p!==Ed.SUCCESS?(this.logger.warn(Dd.L_GET_NAVI_R,p,r),[2,{code:p}]):(_=v,this.logger.info(Dd.L_GET_NAVI_R,JSON.stringify({naviInfo:_}),r),this.setNaviCache(o,_),[2,{code:p,data:_}])}}))}))},e.prototype.requestHandler=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:r=0,o=e.length,c.label=1;case 1:return r<o?[4,this.httpRequest(e[r],this.appkey,t,za,1e4,n)]:[3,4];case 2:if(i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS)return[2,{code:s,data:a}];c.label=3;case 3:return r+=1,[3,1];case 4:return[2,{code:Ed.RC_NAVI_REQ_FAILED}]}}))}))},e.prototype.transHttpCode=function(e){switch(e){case 401:case 403:return Ed.RC_CONN_TOKEN_INCORRECT;case 416:return Ed.RC_LICENSE_EXPIRED;default:return Ed.RC_NAVI_REQ_FAILED}},e.prototype.getNaviInfoFromCache=function(e){var t=this.getNaviCache(OL(e));return t?t.naviInfo:null},e.prototype.updateVoipCallInfo=function(e,t){var n=this.getNaviInfoFromCache(e);n&&this.setNaviCache(OL(e),rc(rc({},n),{voipCallInfo:t}))},e}(),AL=function(e){return["navi",e].join("_")},ML=function(e){function t(t,n,r,o,i){var s=e.call(this,t,n,i||[])||this;return s.runtime=r,s.miniCmpUris=o,s.miniCmpUris||(s.miniCmpUris=qa.join(",")),s}return nc(t,e),t.prototype.httpRequest=function(e,t,n,r,o,i){return oc(this,void 0,void 0,(function(){var s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return s="".concat(e,"/navi.js?appId=").concat(t,"&token=").concat(encodeURIComponent(n),"&callBack=x&v=").concat(r,"&r=").concat(Date.now()),this.logger.debug(Dd.L_REQUEST_T,"req navi => ".concat(s),i),[4,this.runtime.httpReq({url:s,timeout:o,dataType:"text"})];case 1:if(200!==(a=d.sent()).status)return this.logger.debug(Dd.L_REQUEST_R,"request navi failed: ".concat(a.status),i),[2,{code:this.transHttpCode(a.status)}];try{return 0===(c=a.data.match(/{[\d\D]+}/)[0]).indexOf('{\\"code\\":')&&(c=JSON.parse('"'.concat(c,'"'))),(u=JSON.parse(c)).protocol=/^https/.test(s)?"https":"http",this.runtime.useNavi||(u.server="",u.backupServer=this.miniCmpUris,u.logSwitch=0),[2,{code:Ed.SUCCESS,data:u}]}catch(e){this.logger.error(Dd.L_PARSE_NAVI_E,a.data,i)}return this.runtime.useNavi?[2,{code:Ed.RC_NAVI_REQ_FAILED}]:(u={code:200,protocol:"https",server:"",voipCallInfo:"",kvStorage:0,openHttpDNS:!1,historyMsg:!1,chatroomMsg:!1,uploadServer:"https://upload.qiniup.com",bosAddr:"https://gz.bcebos.com",location:"",monitor:0,joinMChrm:!1,openMp:0,openUS:0,grpMsgLimit:0,isFormatted:0,gifSize:2048,logSwitch:0,logPolicy:"",compDays:0,msgAck:"",activeServer:"",qnAddr:"",extkitSwitch:0,alone:!1,voipServer:"",offlinelogserver:"",backupServer:this.miniCmpUris},[2,{code:Ed.SUCCESS,data:u}])}}))}))},t.prototype.getNaviCache=function(e){var t,n=AL(this.appkey),r=this.runtime.localStorage;try{var o=r.getItem(n);t=o?JSON.parse(o):[]}catch(e){t=[]}return 0===t.length?null:t.find((function(t){return t.token===e}))||null},t.prototype.setNaviCache=function(e,t){var n,r=AL(this.appkey),o=this.runtime.localStorage;try{var i=o.getItem(r);n=i?JSON.parse(i):[]}catch(e){n=[]}var s=Date.now();n.length>0&&(n=n.filter((function(t){return s-t.timestamp<ka&&e!==t.token}))),n.push({timestamp:s,naviInfo:t,token:e}),o.setItem(r,JSON.stringify(n))},t}(NL),UL=function(e,t){return["send_msg",e,t].join("_")},LL=function(){function e(e,t){this._runtime=e,this._appkey=t,this._sendMessageMap={},this._userId=""}return e.prototype.init=function(e){this._userId=e;var t=UL(this._appkey,e);this._sendMessageMap=this._getLocalInfo(t)},e.prototype._getLocalInfo=function(e){var t=this._runtime.localStorage.getItem(e);try{return t?JSON.parse(t):{}}catch(e){return{}}},e.prototype.setMessage=function(e,t){this._sendMessageMap[e]=t;var n=UL(this._appkey,this._userId),r=this._getLocalInfo(n);r[e]=t,this._runtime.localStorage.setItem(n,JSON.stringify(r))},e.prototype.getSendMessageMap=function(){return this._sendMessageMap},e.prototype.removeByUID=function(e){delete this._sendMessageMap[e]},e.prototype.removeByTimestamp=function(e){var t=UL(this._appkey,this._userId),n=this._getLocalInfo(t);Object.keys(n).forEach((function(t){n[t]<e&&delete n[t]})),this._runtime.localStorage.setItem(t,JSON.stringify(n))},e}(),wL=function(e){var t="RCDeviceId",n=Xa(e),r="",o=n.get(t);return o?r=o:(r=Wh(),n.set(t,r)),r};(mL={})[Td.PRIVATE]=rL.qryPMsg,mL[Td.GROUP]=rL.qryGMsg,mL[Td.CHATROOM]=rL.qryCHMsg,mL[Td.CUSTOMER_SERVICE]=rL.qryCMsg,mL[Td.SYSTEM]=rL.qrySMsg;var bL=[rL[rL.recallMsg],rL[rL.ppMsgS],rL[rL.pgMsgS],rL[rL.ppMsgP],rL[rL.pgMsgP],rL[rL.chatMsg],rL[rL.pcMsgP],rL[rL.prMsgS],rL[rL.updUgRTime]],PL=function(){function e(e,t,n){this.ULTRA_GROUP_CONVERSATION="ultragroupconversation";var r="".concat(this.ULTRA_GROUP_CONVERSATION,"-").concat(t,"-").concat(n);this._localStore=new ec(e,r)}return e.prototype.set=function(e,t,n,r){var o=this._getStoreKey(e,t,r),i=this._localStore.get(o)||{};for(var s in n){var a=BL[s],c=n[s];if(!ll(a)&&!ll(c))c===DL[a].defaultVal?delete i[a]:i[a]=c}gl(i)?this._localStore.set(o,i):this._localStore.remove(o)},e.prototype.get=function(e,t,n){void 0===n&&(n="");var r=this._getStoreKey(e,t,n),o=this._localStore.get(r)||{},i={};for(var s in DL){var a=DL[s],c=a.keyName,u=a.defaultVal;i[c]=o[s]||LE(u)}return i},e.prototype._getStoreKey=function(e,t,n){return"".concat(n,"_").concat(e,"_").concat(t)},e}(),DL={nc:{keyName:"notificationStatus",defaultVal:2},nl:{keyName:"notificationLevel",defaultVal:0}},BL={};for(var VL in DL){var xL=DL[VL].keyName;BL[xL]=VL}var GL,kL=function(){function e(e,t,n){this._store=new PL(e.runtime,t,n)}return e.prototype.addUltraGroupStatus=function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,o=e.notificationLevel,i=e.channelId;t===Td.ULTRA_GROUP&&this._store.set(t,n,{notificationStatus:r,notificationLevel:o},i)},e.prototype.get=function(e,t,n){return void 0===n&&(n=""),this._store.get(e,t,n)},e}(),FL="UpStreamMessage",HL="PushExtra",qL="DownStreamMessage",KL="DownStreamMessages",jL="SessionsAttQryInput",YL="SessionsAttOutput",JL="SyncRequestMsg",QL="ChrmPullMsg",WL="NotifyMsg",ZL="HistoryMsgInput",zL="HistoryMsgOuput",XL="RelationQryInput",$L="RelationsOutput",ew="UnreadMsgInfo",tw="DeleteSessionsInput",nw="SessionInfo",rw="DeleteSessionsOutput",ow="RelationsInput",iw="DeleteMsgInput",sw="CleanHisMsgInput",aw="SessionMsgReadInput",cw="ChrmInput",uw="ChrmOutput",dw="QueryChatRoomInfoInput",lw="QueryChatRoomInfoOutput",hw="GetQNupTokenInput",fw="GetQNupTokenOutput",gw="GetQNdownloadUrlInput",pw="GetDownloadUrlInput",vw="GetQNdownloadUrlOutput",_w="GetDownloadUrlOutput",Ew="ChrmKVEntity",mw="SetChrmKV",Tw="SetChrmKVS",Iw="DeleteChrmKVS",yw="ChrmKVOutput",Rw="ChrmKVSOutput",Cw="ChrmKVSVersionEntity",Sw="ChrmKVSOutputEntity",Ow="QueryChrmKV",Nw="SetUserSettingInput",Aw="SetUserSettingOutput",Mw="PullUserSettingInput",Uw="PullUserSettingOutput",Lw="UserSettingNotification",ww="SessionReq",bw="SessionStates",Pw="SessionState",Dw="SessionStateItem",Bw="SessionStateModifyReq",Vw="SessionStateModifyResp",xw="GroupUnpushQuery",Gw="GroupUnpushSet",kw="QryRemindListReq",Fw="QryRemindListResp",Hw="GroupUnpushResult",qw="GrpReadReceiptMsg",Kw="GrpReadReceiptQryReq",jw="GrpReadReceiptQryResp",Yw="GrpMsgReadUser",Jw="SessionTagAddInput",Qw="SessionTagItem",Ww="SessionTagDelInput",Zw="SessionDisTagReq",zw="ReportSDKInput",Xw="ReportSDKOutput",$w="UltraGrpPullSes",eb="UltraGrpPullMsg",tb="MsgChangeReq",nb="QueryMsgChange",rb="MsgChange",ob="MsgChangeList",ib="MsgQuery",sb="MessageQueryInfo",ab="MsgQueryAck",cb="OperateStatus",ub="OperateStatusNotify",db="OperateInfo",lb="OperateSummary",hb="SetRtcRoomIdInput",fb="SetRtcRoomIdOutput";(GL={})[FL]=["sessionId","classname","content","pushText","userId","configFlag","clientUniqueId","appData","extraContent","pushExt","busChannel"],GL[KL]=["list","syncTime","finished","broadcastSyncTime"],GL[qL]=["fromUserId","type","groupId","classname","content","dataTime","status","msgId","extraContent","pushContent","configFlag","pushExt","busChannel","extStatus","toUserId","groupUnpush"],GL[HL]=["title","templateIdNoUse","pushId","pushConfigs","templateId"],GL[jL]=["nothing"],GL[YL]=["inboxTime","sendboxTime","totalUnreadCount"],GL[JL]=["syncTime","ispolling","isweb","isPullSend","isKeeping","sendBoxSyncTime","broadcastSyncTime"],GL[QL]=["syncTime","count"],GL[WL]=["type","time","chrmId"],GL[ZL]=["targetId","time","count","order","busChannel"],GL[zL]=["list","syncTime","hasMsg"],GL[XL]=["type","count","startTime","order"],GL[$L]=["info","isFinished"],GL[ew]=["msgId","msgTime","remindType"],GL[tw]=["sessions"],GL[nw]=["type","channelId","busChannel"],GL[rw]=["nothing"],GL[ow]=["type","msg","count","busChannel","startTime","endTime"],GL[iw]=["type","conversationId","msgs","busChannel"],GL[sw]=["targetId","dataTime","conversationType","busChannel"],GL[aw]=["type","msgTime","channelId","busChannel"],GL[cw]=["nothing"],GL[uw]=["nothing","sessionId","joinTime"],GL[dw]=["count","order"],GL[lw]=["userTotalNums","userInfos"],GL[hw]=["type","key","httpMethod","queryString"],GL[gw]=["type","key","fileName"],GL[pw]=["type","key","fileName"],GL[fw]=["deadline","token","bosToken","bosDate","path","osskeyId","ossPolicy","ossSign","ossBucketName"],GL[vw]=["downloadUrl"],GL[_w]=["downloadUrl"],GL[Ew]=["key","value","status","timestamp","uid","version"],GL[mw]=["entry","bNotify","notification","type"],GL[Tw]=["entry","bNotify","notification","type"],GL[Iw]=["entry","bNotify","notification","type"],GL[yw]=["entries","bFullUpdate","syncTime"],GL[Rw]=["timestamp","errorKeys","keysVersion"],GL[Cw]=["version","key"],GL[Sw]=["key","errorCode"],GL[Ow]=["timestamp"],GL[Nw]=["version","value"],GL[Aw]=["version","reserve"],GL[Mw]=["version","reserve"],GL[Uw]=["items","version"],GL.UserSettingItem=["targetId","type","key","value","version","status","tags"],GL[ww]=["time"],GL[bw]=["version","state"],GL[Pw]=["type","channelId","time","stateItem","busChannel"],GL[Dw]=["sessionStateType","value","tags"],GL[Bw]=["version","state"],GL[Vw]=["version"],GL[Gw]=["busChannel","unpushLevel"],GL[kw]=["groupId","busChannel","msgTime","size"],GL[xw]=["busChannel"],GL[Hw]=["groupId","busChannel","unpushLevel"],GL[qw]=["msgId","busChannel"],GL[Kw]=["msgId","busChannel"],GL[jw]=["totalMemberNum","list"],GL[Yw]=["readTime","userId"],GL[Jw]=["version","tags"],GL[Qw]=["tagId","name","createdTime","isTop"],GL[Ww]=["version","tags"],GL[Zw]=["tagId"],GL[Lw]=["version","reserve"],GL[zw]=["sdkInfo"],GL[Xw]=["nothing"],GL[$w]=["syncTime","isEraseMsgContent"],GL[eb]=["syncTime"],GL[tb]=["fromUserId","targetId","type","busChannel","msgUID","msgTime","content"],GL[nb]=["syncTime"],GL[ob]=["list","syncTime","hasNext"],GL[rb]=["targetId","type","time","changeType","msgUID","msgTime","busChannel","isAdmin","isDel","operatorId","subChangeType"],GL[ib]=["targetId","type","query"],GL[sb]=["msgTime","msgUID","busChannel"],GL[ab]=["list"],GL[cb]=["targetId","type","opType","busChannel"],GL[ub]=["type","notifyType","info","summary"],GL[db]=["targetId","busChannel","userId","opType","optime"],GL[lb]=["targetId","busChannel","count","opType"],GL[hb]=["rtcRoomId"],GL[fb]=["nothing"];var gb,pb="\npackage Modules;\nmessage probuf {\n  message SetUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusInput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusOutput\n  {\n    optional string status=1;\n    optional string subUserId=2;\n  }\n\n  message SubUserStatusInput\n  {\n    repeated string userid =1;\n  }\n\n  message SubUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n  message VoipDynamicInput\n  {\n    required int32  engineType = 1;\n    required string channelName = 2;\n    optional string channelExtra = 3;\n  }\n\n  message VoipDynamicOutput\n  {\n      required string dynamicKey=1;\n  }\n  message ".concat(WL," {\n    required int32 type = 1;\n    optional int64 time = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(JL," {\n    required int64 syncTime = 1;\n    required bool ispolling = 2;\n    optional bool isweb=3;\n    optional bool isPullSend=4;\n    optional bool isKeeping=5;\n    optional int64 sendBoxSyncTime=6;\n    optional int64 broadcastSyncTime=7;\n  }\n  message ").concat(FL," {\n    required int32 sessionId = 1;\n    required string classname = 2;\n    required bytes content = 3;\n    optional string pushText = 4;\n    optional string appData = 5;\n    repeated string userId = 6;\n    optional int64 delMsgTime = 7;\n    optional string delMsgId = 8;\n    optional int32 configFlag = 9;\n    optional int64 clientUniqueId = 10;\n    optional string extraContent = 11;\n    optional PushExtra pushExt = 12;\n    optional string busChannel = 13; // 该消息所属会话的业务标识\n  }\n  message ").concat(HL," {\n    optional string title = 1;\n    optional int32  templateIdNoUse= 2;\n    optional string pushId = 3;\n    optional string pushConfigs = 4;\n    optional string templateId = 5;\n  }\n  message ").concat(KL," {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    optional bool finished = 3;\n    optional int64 broadcastSyncTime = 4;\n  }\n  message ").concat(qL," {\n    required string fromUserId = 1;\n    required ChannelType type = 2;\n    optional string groupId = 3;\n    required string classname = 4;\n    required bytes content = 5;\n    required int64 dataTime = 6;\n    required int64 status = 7;\n    optional int64 extra = 8;\n    optional string msgId = 9;\n    optional int32 direction = 10;\n    optional int32 plantform =11;\n    optional int32 isRemoved = 12;\n    optional string source = 13;\n    optional int64 clientUniqueId = 14;\n    optional string extraContent = 15;\n    optional string pushContent = 16;\n    optional int32 configFlag = 17;\n    optional PushExtra pushExt = 18;\n    optional string busChannel = 19; // 该消息所属会话的业务标识，限制20字符以内\n    // 消息的扩展标记\n    // 第0位,表示送达状态: 0x01 表示已送达;\n    // 断档: 0x02 表示是否需要执行断档策略;\n    // 消息修改: 0x04 拉取历史消息时表示该消息是否修改过\n    // 0x08 每条消息携带的频道类型\n    optional int64 extStatus = 20;\n    repeated string toUserId = 21;  //指定接收者（限定群和讨论组）//增加聊天室定向成员\n    optional int32 groupUnpush = 22; //群聊默认免打扰级别\n  }\n  enum ChannelType {\n    PERSON = 1;\n    PERSONS = 2;\n    GROUP = 3;\n    TEMPGROUP = 4;\n    CUSTOMERSERVICE = 5;\n    NOTIFY = 6;\n    MC=7;\n    MP=8;\n    ULTRAGROUP = 10;\n  }\n  message CreateDiscussionInput {\n    optional string name = 1;\n  }\n  message CreateDiscussionOutput {\n    required string id = 1;\n  }\n  message ChannelInvitationInput {\n    repeated string users = 1;\n  }\n  message LeaveChannelInput {\n    required int32 nothing = 1;\n  }\n  message ChannelEvictionInput {\n    required string user = 1;\n  }\n  message RenameChannelInput {\n    required string name = 1;\n  }\n  message ChannelInfoInput {\n    required int32 nothing = 1;\n  }\n  message ChannelInfoOutput {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    required string channelName = 3;\n    required string adminUserId = 4;\n    repeated string firstTenUserIds = 5;\n    required int32 openStatus = 6;\n  }\n  message ChannelInfosInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message ChannelInfosOutput {\n    repeated ChannelInfoOutput channels = 1;\n    required int32 total = 2;\n  }\n  message MemberInfo {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n    required string extension = 4;\n  }\n  message GroupMembersInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message GroupMembersOutput {\n    repeated MemberInfo members = 1;\n    required int32 total = 2;\n  }\n  message GetUserInfoInput {\n    required int32 nothing = 1;\n  }\n  message GetUserInfoOutput {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n  }\n  message GetSessionIdInput {\n    required int32 nothing = 1;\n  }\n  message GetSessionIdOutput {\n    required int32 sessionId = 1;\n  }\n  enum FileType {\n    image = ").concat(gd.IMAGE,";\n    audio = ").concat(gd.AUDIO,";\n    video = ").concat(gd.VIDEO,";\n    file = ").concat(gd.FILE,";\n  }\n  message ").concat(hw," {\n    required FileType type = 1;\n    optional string key = 2;\n    optional string httpMethod = 3;\n    optional string queryString = 4;\n  }\n  message ").concat(gw," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string  fileName = 3;\n  }\n  message ").concat(pw," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string fileName = 3;\n   }\n  message ").concat(fw," {\n    required int64 deadline = 1;\n    required string token = 2;\n    optional string bosToken = 3;\n    optional string bosDate = 4;\n    optional string path = 5;\n    optional string osskeyId = 6;\n    optional string ossPolicy = 7;\n    optional string ossSign = 8;\n    optional string ossBucketName = 9;\n    optional string s3Credential = 10;\n    optional string s3Algorithm = 11;\n    optional string s3Date = 12;\n    optional string s3Policy = 13;\n    optional string s3Signature = 14;\n    optional string s3BucketName = 15;\n    optional string stcAuthorization = 16;\n    optional string stcContentSha256 = 17;\n    optional string stcDate = 18;\n    optional string stcBucketName = 19;\n  }\n  message ").concat(vw," {\n    required string downloadUrl = 1;\n  }\n  message ").concat(_w," {\n    required string downloadUrl = 1;\n  }\n  message Add2BlackListInput {\n    required string userId = 1;\n  }\n  message RemoveFromBlackListInput {\n    required string userId = 1;\n  }\n  message QueryBlackListInput {\n    required int32 nothing = 1;\n  }\n  message QueryBlackListOutput {\n    repeated string userIds = 1;\n  }\n  message BlackListStatusInput {\n    required string userId = 1;\n  }\n  message BlockPushInput {\n    required string blockeeId = 1;\n  }\n  message ModifyPermissionInput {\n    required int32 openStatus = 1;\n  }\n  message GroupInput {\n    repeated GroupInfo groupInfo = 1;\n  }\n  message GroupOutput {\n    required int32 nothing = 1;\n  }\n  message GroupInfo {\n    required string id = 1;\n    required string name = 2;\n  }\n  message GroupHashInput {\n    required string userId = 1;\n    required string groupHashCode = 2;\n  }\n  message GroupHashOutput {\n    required GroupHashType result = 1;\n  }\n  enum GroupHashType {\n    group_success = 0x00;\n    group_failure = 0x01;\n  }\n  message ").concat(cw," {\n    required int32 nothing = 1;\n  }\n  message ").concat(uw," {\n    required int32 nothing = 1;\n    optional string sessionId = 2;\n    optional int64 joinTime = 3;\n  }\n  message ").concat(QL," {\n    required int64 syncTime = 1;\n    required int32 count = 2;\n  }\n\n  message ChrmPullMsgNew\n  {\n    required int32 count = 1;\n    required int64 syncTime = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(XL,"\n  {\n    optional ChannelType type = 1;\n    optional int32 count = 2;\n    optional int64 startTime = 3;\n    optional int32 order = 4;\n  }\n  message ").concat(ow,"\n  {\n    required ChannelType type = 1;\n    optional DownStreamMessage msg =2;\n    optional int32 count = 3;\n    repeated string busChannel = 4;\n    optional int64 startTime = 5;\n    optional int64 endTime = 6;\n  }\n  message ").concat($L,"\n  {\n    repeated RelationInfo info = 1;\n    optional bool isFinished = 2;//是否结束\n  }\n  message RelationInfo\n  {\n    required ChannelType type = 1;\n    required string userId = 2;\n    optional DownStreamMessage msg =3;\n    optional int64 readMsgTime= 4;\n    optional int64 unreadCount= 5;\n    optional string busChannel = 6;//该消息所属会话的业务标识\n    optional int64 versionTime = 7;//会话项变更时间戳，注意:非排序时间戳\n    optional int64 remindCount = 8;//被@的未读数\n    optional int32 busChannelType = 9; // 0: 公有频道; 1: 私有频道;\n    optional ").concat(ew," msgInfo = 10;// 新增 首条未读消息信息，可为空\n  }\n  message ").concat(ew," //未读消息摘要信息\n  {\n    required string msgId = 1;  //消息唯一标示\n    required int64 msgTime= 2;//消息时间\n    optional int32 remindType= 3;//@类型。查询会话时无此字段。查询未读@列表时返回\n  }\n  message ").concat(kw," // 新增 查询未读@列表入参\n  {\n    required string groupId =  1; // 群 ID\n    optional string busChannel = 2; // 频道(channelId,可以为空)\n    optional int64 msgTime = 3; // 消息时间戳\n    optional int32 size = 4; // 单页长度，默认20，最大20\n  }\n  message ").concat(Fw," //查询未读@列表出参\n  {\n    repeated ").concat(ew," msgInfo = 1;  //未读@消息摘要列表\n  }\n  message RelationInfoReadTime\n  {\n    required ChannelType type = 1;\n    required int64 readMsgTime= 2;\n    required string targetId = 3;\n  }\n  message ").concat(sw,"\n  {\n      required string targetId = 1;\n      required int64 dataTime = 2;\n      optional int32 conversationType= 3;\n      optional string busChannel = 4; //该消息所属会话的业务标识，限制20字符以内\n  }\n  message HistoryMessageInput\n  {\n    required string targetId = 1;\n    required int64 dataTime =2;\n    required int32 size  = 3;\n  }\n\n  message HistoryMessagesOuput\n  {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    required int32 hasMsg = 3;\n  }\n  message ").concat(dw,"\n  {\n    required int32 count= 1;\n    optional int32 order= 2;\n  }\n\n  message ").concat(lw,"\n  {\n    optional int32 userTotalNums = 1;\n    repeated ChrmMember userInfos = 2;\n  }\n  message ChrmMember\n  {\n    required int64 time = 1;\n    required string id = 2;\n  }\n  message MPFollowInput\n  {\n    required string id = 1;\n  }\n\n  message MPFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MCFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MpInfo\n  {\n    required string mpid=1;\n    required string name = 2;\n    required string type = 3;\n    required int64 time=4;\n    optional string portraitUrl=5;\n    optional string extra =6;\n  }\n\n  message SearchMpInput\n  {\n    required int32 type=1;\n    required string id=2;\n  }\n\n  message SearchMpOutput\n  {\n    required int32 nothing=1;\n    repeated MpInfo info = 2;\n  }\n\n  message PullMpInput\n  {\n    required int64 time=1;\n    required string mpid=2;\n  }\n\n  message PullMpOutput\n  {\n    required int32 status=1;\n    repeated MpInfo info = 2;\n  }\n  message ").concat(ZL,"\n  {\n    optional string targetId = 1;\n    optional int64 time = 2;\n    optional int32 count  = 3;\n    optional int32 order = 4;\n    optional string busChannel = 5; //该消息所属会话的业务标识，限制20字符以内\n  }\n\n  message ").concat(zL,"\n  {\n    repeated DownStreamMessage list=1;\n    required int64 syncTime=2;\n    required int32 hasMsg=3;\n  }\n  message ").concat(jL,"{\n    required int32 nothing = 1;\n  }\n  message ").concat(YL,"{\n    required int64 inboxTime = 1;\n    required int64 sendboxTime = 2;\n    required int64 totalUnreadCount = 3;\n  }\n  message ").concat(aw,"\n  {\n    required ChannelType type = 1;\n    required int64 msgTime = 2;\n    required string channelId = 3;\n    optional string busChannel = 4;//该消息所属会话的业务标识\n  }\n  message SessionMsgReadOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(tw,"\n  {\n    repeated SessionInfo sessions = 1;\n  }\n  message ").concat(nw,"\n  {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional string busChannel = 3;//所属会话业务标识\n  }\n  message ").concat(rw,"\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(iw,"\n  {\n    optional ChannelType type = 1;\n    optional string conversationId = 2;\n    repeated DeleteMsg msgs = 3;\n    optional string busChannel = 4; //该消息所属会话的业务标识，限制20字符以内\n  }\n  message DeleteMsg\n  {\n    optional string msgId = 1;\n    optional int64 msgDataTime = 2;\n    optional int32 direct = 3;\n  }\n  message ChrmKVEntity {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n    optional int64 version = 6;\n  }\n  message ").concat(mw," {\n    required ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(Tw," {\n    repeated ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(Iw," {\n    repeated ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(yw," {\n    repeated ChrmKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3;\n  }\n  message ChrmKVSVersionEntity {\n    optional int64 version = 1;\n    optional string key = 2;\n  }\n\n  message ").concat(Rw," {\n    repeated ChrmKVSOutputEntity errorKeys = 1;\n    repeated ChrmKVSVersionEntity keysVersion = 2;\n  }\n  message ").concat(Sw,"\n  {\n    optional string key = 1;\n    optional int32 errorCode = 2;\n  }\n  message ").concat(Ow," {\n    required int64 timestamp = 1;\n  }\n  message ").concat(Nw," {\n    required int64 version=1;\n    required string value=2;\n  }\n  message ").concat(Aw," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(Mw," {\n    required int64 version=1;\n    optional bool reserve=2;\n  }\n  message ").concat(Uw," {\n    repeated UserSettingItem items = 1;\n    required int64 version=2;\n  }\n  message UserSettingItem {\n    required string targetId= 1;\n    required ChannelType type = 2;\n    required string key = 4;\n    required bytes value = 5;\n    required int64 version=6;\n    required int32 status=7;\n    repeated SessionTagItem tags= 8;\n  }\n  message ").concat(ww," {\n    required int64 time = 1;\n  }\n  message ").concat(bw," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(Pw," {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional int64 time = 3;\n    repeated SessionStateItem stateItem = 4;\n    optional string busChannel = 5;//该消息所属会话的业务标识\n  }\n  message ").concat(Dw," {\n    required SessionStateType sessionStateType = 1;\n    required string value = 2;\n    repeated SessionTagItem tags = 3;\n  }\n  enum SessionStateType {\n    IsSilent = 1;\n    IsTop = 2;\n    Tags = 3;\n  }\n  message ").concat(Bw," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(xw," {\n    optional string busChannel = 1;\n  }\n  message ").concat(Gw,"{\n    optional string busChannel = 1;\n    required int32 unpushLevel = 2;\n  }\n  message ").concat(Hw," {\n    required string groupId = 1;\n    optional string busChannel = 2;\n    required int32 unpushLevel = 3;\n  }\n  message ").concat(Vw," {\n    required int64 version=1;\n  }\n  message ").concat(qw," {\n    repeated string msgId=1; //已读消息ID\n    optional string channelId = 2; // 该消息所属会话的业务标识\n  }\n  message ").concat(Kw," {\n    repeated string msgId=1; //已读消息ID\n    optional string channelId = 2; // 该消息所属会话的业务标识\n  }\n  message ").concat(jw," {\n    required int32 totalMemberNum = 1;//群内总人数\n    repeated GrpMsgReadUser list = 2;//已读用户列表（list复类型）\n  }\n  message ").concat(Yw," {\n    required int64 readTime = 1;//已读时间\n    required string userId = 2;//已读用户id\n  }\n  message ").concat(Jw," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(Qw," {\n    required string tagId=1;\n    optional string name=2;\n    optional int64 createdTime=3;\n    optional bool isTop=4;\n  }\n  message ").concat(Ww," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(Zw," {\n    repeated string tagId=1;\n  }\n  message ").concat(Lw," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(zw,' {\n    required string sdkInfo=1; // 用户集成的 sdk 信息,json 格式 {"web-rtc": "4.0.3.7"}\n  }\n  message ').concat(Xw,"\n  {\n    optional int32 nothing=1; //占位\n  }\n  message ").concat($w,"\n  {\n      required int64 syncTime = 1;//同步时间戳\n      optional bool isEraseMsgContent = 2;//拉取会话时，是否屏蔽掉消息内容\n  }\n  message ").concat(eb,"\n  {\n    required int64 syncTime = 1;//同步时间戳\n  }\n  message  ").concat(tb,"\n  {\n    required string fromUserId = 1;//（谁发的）\n    required string targetId = 2;// 目标Id(超级群Id)\n    required ChannelType type = 3;//发送类型如：（P2P,GROUP,ULTRAGROUP）\n    required string msgUID = 4; // 扩展消息的内容体\n    required int64 msgTime = 5; //原始消息时间\n    optional string busChannel = 6; // 该消息所属会话的业务标识，限制20字符以内\n    optional string content = 7; // 即extraContent消息扩展内容,下表格说明\n  }\n  message ").concat(nb,"  //查询入参\n  {\n    required int64 syncTime = 1;//同步时间戳\n  }\n  message ").concat(ob,"  //应答结果\n  {\n    repeated MsgChange list = 1; //变更\n    required int64 syncTime = 2; //同步时间(用于下次同步入参)\n    optional bool  hasNext = 3 ;\n  }\n  message ").concat(rb,"  //变更详情\n  {\n    required string targetId = 1; //  目标Id(超级群Id)\n    required ChannelType type = 2; //  会话类型\n    required int64 time = 3;  // 变更时间\n    required int32 changeType = 4;  // 消息变更类型(1:扩展,2:修改,3:撤回,4:频道变更)\n    required string msgUID  = 5;  // 消息ID\n    required int64 msgTime = 6;  //  消息时间\n    optional string busChannel = 7; // 频道ID\n    optional bool isAdmin = 8; //是否为管理员，默认为 0, 设为 1 时, IMKit 收到此条消息后，小灰条默认显示为“管理员 撤回了一条消息”。\n    optional bool isDel = 9; //默认为 0 撤回该条消息同时，用户端将该条消息删除并替换为一条小灰条撤回提示消息；为 1 时，该条消息删除后，不替换为小灰条提示消息。\n    optional string operatorId = 10; // 消息变更的操作人 Id; subChangeType 为 5 时，operatorId 表示被踢出超级群私有频道白名单的用户\n    // 当 changeType 为 4 时，该参数有意义;\n    // 1: 删除频道;\n    // 2: 公有频道变为私有频道;\n    // 3: 私有频道变为公有频道;\n    // 4: 私有频道成员变更-加入, SDK 不通知业务层;\n    // 5: 私有频道成员变更-退出;\n    // 6: 公有频道变为私有频道，当前用户不在白名单中;\n    optional int32 subChangeType = 11;\n  }\n  message ").concat(ib,"  //请求\n  {\n    required string targetId = 1; //  目标Id(超级群Id)\n    required ChannelType type = 2; //  会话类型\n    repeated MessageQueryInfo query = 3; //\n  }\n  message MessageQueryInfo\n  {\n    required int64 msgTime = 1;  // 消息时间\n    required string msgUID  = 2;  // 消息ID\n    optional string busChannel = 3; // 频道ID\n  }\n  message ").concat(ab,"  //应答\n  {\n    repeated DownStreamMessage list = 1;//消息\n  }\n  message ").concat(cb,"  //客户端发送\n  {\n    optional string targetId =  1;// targetId\n    optional ChannelType type = 2;//发送会话类型如：（P2P,GROUP） \n    optional int32 opType = 3;  //0 , 正在输入, 1 正在XXX  \n    optional string busChannel = 4; // 频道(channelId,可以为空)\n  }\n  message ").concat(ub,"  //服务端发送\n  {\n      optional ChannelType type = 1;//发送会话类型如（P2P,GROUP） \n      optional int64 notifyType = 2; //0x1 表示明细, 0x2 表示汇总 0x3 表示明细+汇总\n      repeated OperateInfo info = 3 ; //明细列表 当notifyType 为 1和3时,有效\n      repeated OperateSummary summary = 4 ; //汇总列表, 当notifyType 为2和3 时,有效\n  }\n  message ").concat(db," {\n    // XX 正在做什么\n    optional string targetId = 1; // 超级群Id  会话id\n    optional string busChannel = 2; // 频道(channelId,可以为空)\n    optional string userId = 3; // userId\n    optional int32 opType = 4;  //0 , 正在输入, 1 正在XX \n    optional int64 optime = 5;  //服务端收到用户操作的上行时间. \n  }\n      \n  message ").concat(lb," {\n    // 几个人 正在干什么\n    optional string targetId = 1; // 超级群Id  会话id\n    optional string busChannel = 2; // 频道(channelId,可以为空)\n    optional int32 count  = 3; // 操作人数\n    optional int32 opType = 4; //0, 正在输入, 1 正在XX \n  }\n\n  message ").concat(hb,"\n  {\n    required string  rtcRoomId= 1;  //rtc房间ID;\n  }\n  message ").concat(fb,"\n  {\n    required int32 nothing = 1;   //用于占位\n  }\n}\n");e.LogL=void 0,(gb=e.LogL||(e.LogL={}))[gb.STATISTICS=-2]="STATISTICS",gb[gb.RECORD=-1]="RECORD",gb[gb.FATAL=0]="FATAL",gb[gb.ERROR=1]="ERROR",gb[gb.WARN=2]="WARN",gb[gb.INFO=3]="INFO",gb[gb.DEBUG=4]="DEBUG";var vb=function(t){return[e.LogL.DEBUG,e.LogL.INFO,e.LogL.WARN,e.LogL.ERROR].some((function(e){return e===t}))},_b=Wh(),Eb=Date.now(),mb=0,Tb=function(){function t(t,n,r){this._appkey=t,this._id=n,this._type=r,this.outputLevel=e.LogL.WARN,this.debug=this._log.bind(this,e.LogL.DEBUG),this.info=this._log.bind(this,e.LogL.INFO),this.warn=this._log.bind(this,e.LogL.WARN),this.error=this._log.bind(this,e.LogL.ERROR),this.__statistics=this._log.bind(this,e.LogL.STATISTICS)}return t.prototype._stdout=function(t,n,r,o,i){if(!(t<=e.LogL.FATAL)&&console&&!(t>this.outputLevel)){var s=["error","warn","info","debug"][t-1];null===console||void 0===console||console[s]("".concat(r,"[").concat(this._id,"][").concat(s.toUpperCase(),"]: ").concat(n," | ").concat(o," | ").concat(i))}},t.prototype.setOutputLevel=function(e){vb(e)&&(this.outputLevel=e)},t.prototype._log=function(t,n,r,o){var i=new Date;/^[\w-_]+$/.test(n)?(this._stdout(t,n,i.toISOString(),r,o),t!==e.LogL.DEBUG&&this.flush({time:+i,sessionId:_b,type:this._type,loggerId:this._id,tag:n,level:t,content:r,traceId:o})):this._stdout(e.LogL.ERROR,"L_LOG_TAG_INVALID_E",i.toISOString(),n,o)},t.prototype.createTraceId=function(){return"".concat(_b,"-").concat(++mb)},t.prototype.getSessionId=function(){return _b},t}(),Ib=null,yb="RC_LOGS",Rb="RC_CONF",Cb=null,Sb=function e(t){return oc(void 0,void 0,void 0,(function(){var n;return ic(this,(function(r){switch(r.label){case 0:return[4,Ib];case 1:return(n=r.sent())?[4,new Promise((function(e){var r=n.db.transaction(yb,"readwrite").objectStore(yb),o=IDBKeyRange.lowerBound(Date.now()-t),i=r.getAllKeys(o);i.onsuccess=function(){var t=i.result,n=t.length;if(n>0){var o=r.delete(IDBKeyRange.bound(t[0],t[n-1]));o.onsuccess=e,o.onerror=e}},i.onerror=e}))]:[2];case 2:return r.sent(),Cb=setTimeout((function(){return e(t)}),6e5),[2]}}))}))},Ob=function(e,t,n){void 0===n&&(n=168),Ib||("undefined"!=typeof window&&window&&window.indexedDB?Ib=new Promise((function(r){var o=window.indexedDB;o.databases&&o.databases().then((function(e){e.some((function(e){return"RC_ENGINE_DB"===e.name}))&&o.deleteDatabase("RC_ENGINE_DB")}));var i="RC_LOGS_".concat(e),s=o.open(i,1);s.onerror=function(e){t.error(Dd.L_LOGDB_OPEN_FAILED_E,e.target.error),r(null)},s.onsuccess=function(o){var i=o.target.result;i?(i.onclose=function(e){t.warn(Dd.L_LOGDB_CLOSED_S)},i.onerror=function(e){t.error(Dd.L_LOGDB_ERROR_E,e.target.error)},i.onabort=function(e){t.info(Dd.L_LOGDB_ABORT_S,e.target.error)},Sb(3600*Math.max(24,Math.min(168,n))*1e3),r({appkey:e,db:i})):r(null)},s.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(yb)&&t.deleteObjectStore(yb);var n=t.createObjectStore(yb,{autoIncrement:!0});n.createIndex("level","level",{unique:!1}),n.createIndex("time","time",{unique:!1}),(n=t.createObjectStore(Rb,{keyPath:"key"})).createIndex("key","key",{unique:!0})}})):t.warn(Dd.L_UNSUPPORT_INDEXDB_O))},Nb=function(){return oc(void 0,void 0,void 0,(function(){var e,t;return ic(this,(function(n){switch(n.label){case 0:return Ib?(Cb&&(clearTimeout(Cb),Cb=null),[4,Ib]):[2];case 1:return(e=n.sent())&&(t=e.db,e.appkey,t.close()),Ib=null,[2]}}))}))},Ab=[],Mb=!1,Ub=function e(t){return oc(void 0,void 0,void 0,(function(){var n;return ic(this,(function(r){switch(r.label){case 0:return Mb||0===Ab.length?[2]:(Mb=!0,n=Ab.splice(0),[4,new Promise((function(e){var r=t.transaction(yb,"readwrite");r.oncomplete=e,r.onabort=e;var o=r.objectStore(yb);n.forEach((function(e){try{o.add(e)}catch(t){null===console||void 0===console||console.error("write log failed ->",e)}}))}))]);case 1:return r.sent(),Mb=!1,setTimeout((function(){return e(t)})),[2]}}))}))},Lb=function(e){return oc(void 0,void 0,void 0,(function(){var t;return ic(this,(function(n){switch(n.label){case 0:return[4,Ib];case 1:return(t=n.sent())?(Ab.push(e),Ub(t.db),[2]):[2]}}))}))};function wb(e){return oc(this,void 0,void 0,(function(){var t;return ic(this,(function(n){switch(n.label){case 0:return[4,Ib];case 1:return(t=n.sent())?[2,new Promise((function(n){var r=t.db.transaction(Rb,"readonly").objectStore(Rb).get(e);r.onsuccess=function(e){var t;n({value:null===(t=r.result)||void 0===t?void 0:t.value,success:!0})},r.onerror=function(e){n({success:!1})}}))]:[2,{success:!1}]}}))}))}var bb,Pb,Db,Bb,Vb=0,xb="REPORT_SESSION",Gb=function(e,t){return oc(void 0,void 0,void 0,(function(){var n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return n="".concat(xb,"_").concat(e),[4,wb("".concat(xb,"_").concat(e))];case 1:return r=s.sent(),o=r.success,i=r.value,o?(t===(null==i?void 0:i.sessionId)||function(e,t){oc(this,void 0,void 0,(function(){var n,r;return ic(this,(function(o){switch(o.label){case 0:return[4,Ib];case 1:return(n=o.sent())?(r=n.db,r.transaction(Rb,"readwrite").objectStore(Rb).put({key:e,value:t}),[2,!0]):[2,!1]}}))}))}(n,{sessionId:t}),[2]):[2]}}))}))},kb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nc(t,e),t.prototype.flush=function(e){Lb(e)},t}(Tb),Fb=function(){function t(e,t,n,r,o){this.appkey=e,this.deviceId=t,this.deviceInfo=n,this.logDB=r,this.logger=o,this.userId="",this.timer=null,this.started=!1}return t.prototype.checkStart=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o;return ic(this,(function(i){if(this.started)return[2];if(this.userId=e.userId,!e.logSwitch)return[2];t=Wa;try{t=JSON.parse(e.logPolicy)}catch(t){this.logger.warn(Dd.L_REPORT_LOG_POLICY_E,JSON.stringify({policy:e.logPolicy}))}return this.started=!0,n=t.url,r=t.level,o=t.itv,t.times,this.realtimeReport(n,r,o),[2]}))}))},t.prototype.realtimeReport=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c,u,d,l,h,f,g,p=this;return ic(this,(function(v){switch(v.label){case 0:return r=Date.now(),o=this.logDB.getTimestamp4RealtimeLog()||Eb,i=Math.max(r-5e3,o),s=this.logger.createTraceId(),this.logger.info(Dd.L_REALTIME_LOG_T,JSON.stringify({startTime:o,endTime:i,level:t}),s),[4,this.logDB.getLogs(o,i,t,!0)];case 1:return a=v.sent(),c=a.dbReady,u=a.logs,c?[3,2]:(this.logger.warn(Dd.L_REALTIME_LOG_R,"db error",s),[3,6]);case 2:return 0!==u.length?[3,3]:(this.logger.info(Dd.L_REALTIME_LOG_R,"no logs",s),[3,6]);case 3:return this.logger.info(Dd.L_REALTIME_LOG_O,JSON.stringify({count:u.length}),s),[4,this.compressLogs(u)];case 4:return d=v.sent(),l=d.success,h=d.data,l||this.logger.warn(Dd.L_REALTIME_LOG_O,"compress failed",s),this.logger.info(Dd.L_REALTIME_LOG_O,"compress done",s),f=fl(e)?e:"https://".concat(e),f+="?version=".concat("5.7.2","&appkey=").concat(this.appkey,"&userId=").concat(this.userId,"&deviceId=").concat(this.deviceId,"&deviceInfo=").concat(this.deviceInfo,"&platform=Web"),[4,this.send({url:f,body:h,method:"POST"})];case 5:g=v.sent().status,this.logger.info(Dd.L_REALTIME_LOG_R,JSON.stringify({status:g}),s),200===g&&this.logDB.setTimestamp4RealtimeLog(u[u.length-1].time+1),v.label=6;case 6:return this.started&&!this.timer&&(this.timer=setTimeout((function(){return p.realtimeReport(e,t,n)}),1e3*n)),[2]}}))}))},t.prototype.report=function(t,n,r,o,i,s){return oc(this,void 0,void 0,(function(){var a,c,u,d,l,h,f,g,p,v;return ic(this,(function(_){switch(_.label){case 0:return"web"!==r.toLowerCase()?[2]:(a=this.logger.createTraceId(),this.logger.info(Dd.L_REPORT_FULL_LOG_T,JSON.stringify({startTime:t,endTime:n,logId:i,messageUId:s}),a),[4,this.logDB.getLogs(t,n,e.LogL.DEBUG,!1)]);case 1:return c=_.sent(),u=c.dbReady,d=c.logs,this.logger.info(Dd.L_REPORT_FULL_LOG_O,JSON.stringify({count:d.length}),a),l=fl(o)?o:"https://".concat(o),l+="?version=".concat("5.7.2","&appkey=").concat(this.appkey,"&userId=").concat(this.userId,"&deviceId=").concat(this.deviceId,"&deviceInfo=").concat(this.deviceInfo,"&platform=Web&logId=").concat(i),u?d.length>0?[4,this.compressLogs(d)]:[3,3]:[3,5];case 2:return f=_.sent(),g=f.success,p=f.data,h=g?p:"compress failed",[3,4];case 3:h="no data",_.label=4;case 4:return[3,6];case 5:h="no database",_.label=6;case 6:return this.logger.debug(Dd.L_REPORT_FULL_LOG_O,"compress done",a),[4,this.send({url:l,body:h,method:"POST"})];case 7:return v=_.sent().status,this.logger.info(Dd.L_REPORT_FULL_LOG_R,JSON.stringify({status:v}),a),[2]}}))}))},t.prototype.stop=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.started=!1},t}(),Hb=48,qb=64,Kb=80,jb=96,Yb="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Jb=Yb.length,Qb=function(e){for(var t={},n=0;n<e.length-1;n++){var r=e.charAt(n)+e.charAt(n+1);t.hasOwnProperty(r)?t[r].push(n):t[r]=[n]}for(var o=[],i=[],s=function(){if(i.length>0){var e=i.join("");if(i=[],e.length>26){var t=Zb(e.length),n=String.fromCharCode(Kb|t.length);o.push(n+t)}else{var r=String.fromCharCode(jb|e.length);o.push(r)}o.push(e)}},a=0;a<e.length;){var c=Wb(t,e,a);if(c.length<2)i.push(e.charAt(a++));else if(c.length<4)i.push(e.substr(a,c.length)),a+=c.length;else{var u=Zb(a-c.offset),d=Zb(c.length);if(u.length+d.length>=c.length)i.push(e.substr(a,c.length)),a+=c.length;else{s();var l=String.fromCharCode(qb|u.length<<2|d.length);o.push(l+u+d),a+=c.length}}}s();var h=Zb(e.length),f=String.fromCharCode(Hb|h.length);return o.push(f+h),o.join("")},Wb=function(e,t,n){var r={length:0,offset:-1};if(t.length,n>=t.length-1)return r;var o=e[t.charAt(n)+t.charAt(n+1)];if(o[0]===n)return r;for(var i=t.length-n,s=0,a=o.length;s<a;s++){var c=o[s],u=n-c;if(!(u>238327)){var d=Math.min(i,u);if(d<=r.length)break;if(!(r.length>2&&t.charAt(c+r.length-1)!==t.charAt(n+r.length-1))){for(var l=2,h=l;h<d&&t.charAt(c+h)===t.charAt(n+h);h++)l++;l>=r.length&&(r.length=l,r.offset=c)}}}return r},Zb=function(e){var t=[],n=0;do{n=e%Jb,t.push(Yb.charAt(n)),e=(e-n)/Jb}while(e>0);return t.join("")},zb=function(e){var t=e.sessionId,n=e.level,r=e.loggerId,o=e.traceId,i=e.time,s=e.tag,a=e.type,c=e.content,u=n<0?c||"":JSON.stringify({content:c,traceId:o,from:r});return u='"'.concat(u.replace(/"/g,'""'),'"'),"".concat(t,",").concat(i,",").concat(a,",").concat(n,",").concat(s,",").concat(u,"\n")},Xb=function(e){function t(t,n,r,o){var i=this,s=wL(n),a=function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,o={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var i in o)if(o.hasOwnProperty(i)){var s=r.match(o[i]);if(s){n=i,t=s[1]||s[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}}(n),c="".concat(a.type,"|").concat(a.version,"|").concat(r.getSessionId());return i=e.call(this,t,s,c,{setTimestamp4RealtimeLog:function(e){Vb=e},getTimestamp4RealtimeLog:function(){return Vb},getLogs:function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o;return ic(this,(function(i){switch(i.label){case 0:return[4,Ib];case 1:return(o=i.sent())?[2,new Promise((function(i){var s=o.db.transaction(yb,"readonly").objectStore(yb),a=[],c=IDBKeyRange.bound(e,t),u=s.index("time").openCursor(c);u.onsuccess=function(e){var t=e.target.result;if(t){var o=t.value;o.level<=n&&(r?o.sessionId===_b:o.level>=0)&&a.push(o),t.continue()}else i({dbReady:!0,logs:a})},u.onerror=function(e){i({dbReady:!1,logs:[]})}}))]:[2,{dbReady:!1,logs:[]}]}}))}))}},r)||this,i.runtime=n,i.clientReportLevel=o,vb(i.clientReportLevel)||(i.clientReportLevel=void 0),i}return nc(t,e),t.prototype.send=function(e){return this.runtime.httpReq(e)},t.prototype.checkStart=function(t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){switch(n.label){case 0:return[4,Gb(t.userId,this.logger.getSessionId())];case 1:return n.sent(),[2,e.prototype.checkStart.call(this,t)]}}))}))},t.prototype.compressLogs=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,{success:!0,data:Qb(e.map(zb).join(""))}]}))}))},t.prototype.isReporter=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){switch(e.label){case 0:return[4,(t=this.userId,n=this.logger.getSessionId(),oc(void 0,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return[4,wb("".concat(xb,"_").concat(t))];case 1:return e=i.sent(),r=e.success,o=e.value,[2,r&&(null==o?void 0:o.sessionId)===n]}}))})))];case 1:return[2,e.sent()]}var t,n}))}))},t.prototype.report=function(t,n,r,o,i,s){return oc(this,void 0,void 0,(function(){return ic(this,(function(a){switch(a.label){case 0:return[4,this.isReporter()];case 1:return a.sent()?[2,e.prototype.report.call(this,t,n,r,o,i,s)]:[2]}}))}))},t.prototype.realtimeReport=function(t,n,r){return oc(this,void 0,void 0,(function(){return ic(this,(function(o){return[2,e.prototype.realtimeReport.call(this,t,n,r)]}))}))},t}(Fb);!function(e){e[e.ACCEPTED=0]="ACCEPTED",e[e.UNACCEPTABLE_PROTOCOL_VERSION=1]="UNACCEPTABLE_PROTOCOL_VERSION",e[e.IDENTIFIER_REJECTED=2]="IDENTIFIER_REJECTED",e[e.SERVER_UNAVAILABLE=3]="SERVER_UNAVAILABLE",e[e.TOKEN_INCORRECT=4]="TOKEN_INCORRECT",e[e.NOT_AUTHORIZED=5]="NOT_AUTHORIZED",e[e.REDIRECT=6]="REDIRECT",e[e.PACKAGE_ERROR=7]="PACKAGE_ERROR",e[e.APP_BLOCK_OR_DELETE=8]="APP_BLOCK_OR_DELETE",e[e.BLOCK=9]="BLOCK",e[e.TOKEN_EXPIRE=10]="TOKEN_EXPIRE",e[e.DEVICE_ERROR=11]="DEVICE_ERROR",e[e.HOSTNAME_ERROR=12]="HOSTNAME_ERROR",e[e.HASOHTERSAMECLIENTONLINE=13]="HASOHTERSAMECLIENTONLINE",e[e.OUT_OF_LIMIT=14]="OUT_OF_LIMIT",e[e.IN_OTHER_CLUSTER=15]="IN_OTHER_CLUSTER",e[e.APP_AUTH_NOT_PASS=16]="APP_AUTH_NOT_PASS",e[e.OTP_USED=17]="OTP_USED",e[e.PLATFORM_ERROR=18]="PLATFORM_ERROR",e[e.ACCOUNT_CANCELLATION=19]="ACCOUNT_CANCELLATION",e[e.LICENSE_EXPIRED=20]="LICENSE_EXPIRED"}(bb||(bb={})),function(e){e[e.OTHER_DEVICE_LOGIN=1]="OTHER_DEVICE_LOGIN",e[e.BLOCK=2]="BLOCK",e[e.BLOCK_NEW=5]="BLOCK_NEW",e[e.REDIRECT_NEW=6]="REDIRECT_NEW",e[e.TOKEN_EXPIRED=7]="TOKEN_EXPIRED",e[e.ILLEGAL_PROTOCOL_VERSION=8]="ILLEGAL_PROTOCOL_VERSION",e[e.ACCOUNT_CANCELLATION=9]="ACCOUNT_CANCELLATION"}(Pb||(Pb={}));var $b,eP=((Db={})[Pb.OTHER_DEVICE_LOGIN]=Ed.RC_DISCONN_KICK,Db[Pb.BLOCK]=Ed.RC_DISCONN_EXCEPTION,Db[Pb.BLOCK_NEW]=Ed.RC_DISCONN_EXCEPTION,Db[Pb.REDIRECT_NEW]=Ed.RC_CONN_REDIRECTED,Db[Pb.TOKEN_EXPIRED]=Ed.RC_CONN_TOKEN_EXPIRED,Db[Pb.ILLEGAL_PROTOCOL_VERSION]=Ed.RC_CONN_PROTO_VERSION_ERROR,Db[Pb.ACCOUNT_CANCELLATION]=Ed.RC_ACCOUNT_CANCELLATION,Db),tP=((Bb={})[bb.ACCEPTED]=Ed.SUCCESS,Bb[bb.UNACCEPTABLE_PROTOCOL_VERSION]=Ed.RC_CONN_PROTO_VERSION_ERROR,Bb[bb.IDENTIFIER_REJECTED]=Ed.RC_CONN_IDENTIFIER_REJECTED,Bb[bb.SERVER_UNAVAILABLE]=Ed.RC_CONN_SERVER_UNAVAILABLE,Bb[bb.TOKEN_INCORRECT]=Ed.RC_CONN_TOKEN_INCORRECT,Bb[bb.NOT_AUTHORIZED]=Ed.RC_CONN_NOT_AUTHRORIZED,Bb[bb.REDIRECT]=Ed.RC_CONN_REDIRECTED,Bb[bb.PACKAGE_ERROR]=Ed.RC_CONN_PACKAGE_NAME_INVALID,Bb[bb.APP_BLOCK_OR_DELETE]=Ed.RC_CONN_APP_BLOCKED_OR_DELETED,Bb[bb.BLOCK]=Ed.RC_CONN_USER_BLOCKED,Bb[bb.TOKEN_EXPIRE]=Ed.RC_CONN_TOKEN_EXPIRED,Bb[bb.DEVICE_ERROR]=Ed.RC_CONN_DEVICE_ERROR,Bb[bb.HOSTNAME_ERROR]=Ed.RC_CONN_HOSTNAME_ERROR,Bb[bb.HASOHTERSAMECLIENTONLINE]=Ed.RC_DISCONN_SAME_CLIENT_ON_LINE,Bb[bb.OUT_OF_LIMIT]=Ed.RC_LISCENSE_COUNT_OUT_OF_LIMIT,Bb[bb.IN_OTHER_CLUSTER]=Ed.RC_CONN_WRONG_CLUSTER,Bb[bb.APP_AUTH_NOT_PASS]=Ed.RC_APP_AUTH_NOT_PASS,Bb[bb.OTP_USED]=Ed.RC_OTP_USED,Bb[bb.PLATFORM_ERROR]=Ed.RC_PLATFORM_ERROR,Bb[bb.ACCOUNT_CANCELLATION]=Ed.RC_ACCOUNT_CANCELLATION,Bb[bb.LICENSE_EXPIRED]=Ed.RC_LICENSE_EXPIRED,Bb),nP=function(e){return e===Ed.RC_CONN_REDIRECTED};e.RCConnectionStatus=void 0,($b=e.RCConnectionStatus||(e.RCConnectionStatus={}))[$b.CONNECTED=0]="CONNECTED",$b[$b.CONNECTING=1]="CONNECTING",$b[$b.DISCONNECTED=2]="DISCONNECTED",$b[$b.SUSPENDED=3]="SUSPENDED";var rP=function(){function t(t,n,r,o){this.appkey=t,this.navi=n,this.logger=r,this.listener=o,this.token="",this.reconnectKick=!1,this._crtConnectionStatus=e.RCConnectionStatus.DISCONNECTED,this._crtUserId="",this._crtConnectionTask=null,this.reconnectTimer=null,this._failedCount=0,this.ALLOW_FAILED_TIMES=2}return t.prototype.getToken=function(){return this.token},t.prototype.getCurrentUserId=function(){return this._crtUserId},t.prototype.setConnectionStatus=function(t,n){if(this._crtConnectionStatus!==t)switch(this._crtConnectionStatus=t,t){case e.RCConnectionStatus.CONNECTED:this.logger.info(Dd.L_CONNECT_S,t),this.checkAlive(),this.listener.onConnected();break;case e.RCConnectionStatus.CONNECTING:this.logger.warn(Dd.L_CONNECT_S,"status: ".concat(t,", code: ").concat(n)),this.listener.onConnecting();break;case e.RCConnectionStatus.SUSPENDED:this.logger.warn(Dd.L_CONNECT_S,"status: ".concat(t,", code: ").concat(n)),this.listener.onSuspend(n);break;default:this.logger.warn(Dd.L_CONNECT_S,"status: ".concat(t,", code: ").concat(n)),this.listener.onDisconnected(n)}},t.prototype.getConnectionStatus=function(){return this._crtConnectionStatus},t.prototype.connect=function(t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._crtConnectionStatus===e.RCConnectionStatus.CONNECTED?[2,{code:Ed.SUCCESS,data:this._crtUserId}]:this._crtConnectionTask?[2,this._crtConnectionTask]:(this.token=t,this.reconnectKick=n,this.setConnectionStatus(e.RCConnectionStatus.CONNECTING),[4,this.try2Connect(t,n,!1,r)]);case 1:return o=a.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?(this.setConnectionStatus(e.RCConnectionStatus.DISCONNECTED,i),[2,{code:i}]):(this.setConnectionStatus(e.RCConnectionStatus.CONNECTED),[2,{code:i,data:s}])}}))}))},t.prototype.try2Connect=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._crtConnectionTask?[2,this._crtConnectionTask]:(this._crtConnectionTask=this.createConnectionTask(e,t,n,r),[4,this._crtConnectionTask]);case 1:return o=a.sent(),i=o.code,s=o.data,this._crtConnectionTask=null,[2,{code:i,data:s}]}}))}))},t.prototype.createConnectionTask=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return[4,this.navi.request(e,n,!1,r)];case 1:return o=l.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?[2,{code:i}]:1===(a=s).type?[2,{code:Ed.PACKAGE_ENVIRONMENT_ERROR}]:(this.logger.info(Dd.L_CONNECT_T,JSON.stringify({token:e,reconnectKickEnable:t}),r),[4,this.connectWithToken(e.replace(/@.+$/,"@"),a,t,r)]);case 2:return c=l.sent(),u=c.code,d=c.data,nP(u)?(this.logger.warn(Dd.L_CONNECT_R,"redirect code: ".concat(u),r),[2,this.createConnectionTask(e,t,!0,r)]):u!==Ed.SUCCESS?(this.logger.warn(Dd.L_CONNECT_R,"code: ".concat(u),r),[2,{code:u}]):(this.logger.info(Dd.L_CONNECT_R,"userId: ".concat(d),r),this._crtUserId=d,[2,{code:u,data:d}])}}))}))},t.prototype.try2Reconnect=function(t,n){return oc(this,void 0,void 0,(function(){var r,o,i=this;return ic(this,(function(s){return r=this.logger.createTraceId(),this.logger.debug(Dd.T,"try2Reconnect -> ignoreNaviCache: ".concat(t,", reason: ").concat(n),r),this.stopReconnectTimer(),o=function(){return oc(i,void 0,void 0,(function(){var i;return ic(this,(function(s){switch(s.label){case 0:return this._crtConnectionStatus!==e.RCConnectionStatus.SUSPENDED?[2]:(this.setConnectionStatus(e.RCConnectionStatus.CONNECTING,n),[4,this.try2Connect(this.token,!0,t,r)]);case 1:return i=s.sent().code,this.reconnectTimer=null,i===Ed.SUCCESS?(this.setConnectionStatus(e.RCConnectionStatus.CONNECTED),[2]):[Ed.SERVER_UNAVAILABLE,Ed.TIMEOUT,Ed.RC_SOCKET_DISCONNECTED,Ed.RC_SOCKET_NOT_CREATED,Ed.RC_CONN_ACK_TIMEOUT,Ed.RC_TCP_RESET,Ed.RC_NAVI_REQ_FAILED].includes(i)?(this._crtConnectionStatus!==e.RCConnectionStatus.CONNECTING||(this.setConnectionStatus(e.RCConnectionStatus.SUSPENDED,i),this.reconnectTimer=setTimeout(o,5e3)),[2]):(this.setConnectionStatus(e.RCConnectionStatus.DISCONNECTED,i),[2])}}))}))},o(),[2]}))}))},t.prototype.onDisconnectByServer=function(t){if(nP(t))return this.setConnectionStatus(e.RCConnectionStatus.SUSPENDED,t),void this.try2Reconnect(!0,t);this.setConnectionStatus(e.RCConnectionStatus.DISCONNECTED,t)},t.prototype.onDisconenctUnusual=function(t){this.setConnectionStatus(e.RCConnectionStatus.SUSPENDED,t),this.try2Reconnect(!1,t)},t.prototype.checkAlive=function(){return oc(this,void 0,void 0,(function(){var t,n,r=this;return ic(this,(function(o){switch(o.label){case 0:return this._crtConnectionStatus!==e.RCConnectionStatus.CONNECTED?(this._failedCount=0,this.logger.debug(Dd.L_CHECK_ALIVE_IM_S,"stop ping because of no connection"),[2]):(t=this.logger.createTraceId(),this.logger.info(Dd.L_CHECK_ALIVE_IM_T,null,t),[4,this.sendPing(15e3)]);case 1:return(n=o.sent())===Ed.SUCCESS?(this.logger.info(Dd.L_CHECK_ALIVE_IM_R,n,t),this._failedCount=0,setTimeout((function(){return r.checkAlive()}),15e3),[2]):this._crtConnectionStatus!==e.RCConnectionStatus.CONNECTED?[2]:(this._failedCount+=1,this.logger.info(Dd.L_CHECK_ALIVE_IM_R,"code: ".concat(n,", count: ").concat(this._failedCount),t),this._failedCount<this.ALLOW_FAILED_TIMES?[2,this.checkAlive()]:(this._failedCount=0,this.logger.warn(Dd.L_CHECK_ALIVE_IM_S,"ping timeout, close connection to reconnect!"),this.close(!0,!1),this.setConnectionStatus(e.RCConnectionStatus.SUSPENDED,Ed.RC_PING_EXCEED_LIMIT),this.try2Reconnect(!1,Ed.RC_PING_EXCEED_LIMIT),[2]))}}))}))},t.prototype.disconnect=function(t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){switch(n.label){case 0:return this.stopReconnectTimer(),this._crtConnectionTask?[4,this._crtConnectionTask]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.setConnectionStatus(e.RCConnectionStatus.DISCONNECTED,2),this.close(!1,t),[2]}}))}))},t.prototype.stopReconnectTimer=function(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null)},t}(),oP=function(){function t(e){this.logger=e,this._codec=t.createPBCodec()}return t.createPBCodec=function(){var e=DN(pb);return e.getModule=function(t){var n=new e[t];return n.getArrayData=function(){var e=n.toArrayBuffer();return e=al(e)?[].slice.call(new Int8Array(e)):e},n},e},t.prototype.decodeByPBName=function(e,t,n){var r,o=this,i=e,s=((r={})[KL]=o._formatSyncMessages,r[qL]=o._formatReceivedMessage,r[FL]=o._formatSentMessage,r[zL]=o._formatHistoryMessages,r[$L]=o._formatConversationList,r[lw]=o._formatChatRoomInfos,r[yw]=o._formatChatRoomKVList,r[Uw]=o._formatUserSetting,r[bw]=o._formatConversationStatus,r[jw]=o._formatGrpReadReceiptQryResp,r[Aw]=o._formatSetUserSettingOutput,r[Lw]=o._formatUserSettingNotification,r[ob]=o._formatUltraMsgChangeList,r[ub]=o._formatUltraOperateStatusNotifyList,r[ab]=o._formatUltraMsgList,r[Fw]=o._formatUltraGroupUnreadMentionedList,r[uw]=o._formatChrmKVVersion,r)[t];try{i=e.length>0&&o._codec[t].decode(e),ul(i)&&(i=function(e){for(var t in e)ul(e[t])&&(e[t]=TE(e[t]));return e}(i)),dl(s)&&(i=s.call(this,i,n))}catch(e){this.logger.error(Dd.L_PB_DECODE_E,t)}return i},t.prototype._readBytes=function(e){var t=e.offset,n=e.buffer,r=e.limit;if(t)try{var o=al(n)?new Uint8Array(n):n;return VU.readUTF(o.subarray(t,r))}catch(e){this.logger.error(Dd.O,null==e?void 0:e.stack)}return e},t.prototype._formatBytes=function(e){if(!e)return e;var t=this._readBytes(e);try{t=t?JSON.parse(t):t}catch(e){this.logger.error(Dd.O,null==e?void 0:e.stack)}return t||e},t.prototype._formatSyncMessages=function(e,t){t=t||{};var n=this,r=e.list,o=e.syncTime,i=e.finished;return(ll(i)||null===i)&&(e.finished=!0),e.syncTime=TE(o),e.list=AE(r,(function(e){return n._formatReceivedMessage(e,t)})),e},t.prototype._formatReceivedMessage=function(t,n){if(!t)return t;var r=(n=n||{}).currentUserId,o=n.connectedTime,i=t.content,s=t.fromUserId,a=t.type,c=t.groupId,u=t.status,d=t.dataTime,l=t.classname,h=t.msgId,f=t.extraContent,g=t.pushContent,p=t.pushExt,v=t.configFlag,_=t.extStatus;t.toUserId,t.groupUnpush;var E=t.clientUniqueId,m=(t.direction||vd.RECEIVE)===vd.SEND,T=function(e){var t=to.READ;return{isPersited:!!(16&e),isCounted:!!(32&e),isMentioned:!!(64&e),disableNotification:!!(512&e),receivedStatus:t=2&e?to.RETRIEVED:t,canIncludeExpansion:!!(1024&e)}}(u),I=T.isPersited,y=T.isCounted,R=T.isMentioned,C=T.disableNotification,S=T.receivedStatus,O=T.canIncludeExpansion,N=!!(2&(_||0)),A=!!(4&(_||0)),M=!!(8&(_||0))?e.UltraGroupChannelType.PRIVATE:e.UltraGroupChannelType.PUBLIC,U=[Td.GROUP,Td.CHATROOM,Td.RTC_ROOM,Td.ULTRA_GROUP].indexOf(a)>-1?c:s,L=m?r:s,w=TE(d),b=w<o,P=a===Td.CHATROOM,D=this._formatBytes(i),B={};if(p&&(B=RE(this.logger,p.pushConfigs,p.pushId)),D.user){var V=D.user,x=V.portrait,G=V.portraitUri,k=x||G;k&&(D.user.portrait=D.user.portraitUri=k)}var F,H=rc(rc({},B),{pushTitle:null==p?void 0:p.title,pushContent:g,pushData:g,disablePushTitle:!!v&&Boolean(4&v),forceShowDetailContent:!!v&&Boolean(8&v),templateId:null==p?void 0:p.templateId}),q=m?vd.SEND:vd.RECEIVE;P&&s===r&&(q=vd.SEND),f&&(F={},F=DE(f));var K={conversationType:a,targetId:U,senderUserId:L,messageType:l,messageUId:h,isPersited:I,isCounted:y,isMentioned:R,sentTime:w,messageDirection:q,receivedTime:BE.getTime(),disableNotification:C,receivedStatus:S,canIncludeExpansion:O,content:D,expansion:F,configFlag:v,pushConfig:H,channelId:t.busChannel||"",isInterrupt:N,isModifyMessage:A,messageId:TE(E)||0,sentStatus:e.SentStatus.SENT};return a!==Td.ULTRA_GROUP&&(K.isOffLineMessage=b),a===Td.ULTRA_GROUP&&(K.channelType=M),K},t.prototype._formatSentMessage=function(e,t){var n,r=e.content,o=e.classname,i=e.sessionId,s=e.msgId,a=e.extraContent,c=e.pushExt,u=e.pushContent,d=e.configFlag,l=e.extStatus,h=e.clientUniqueId,f=t.signal,g=t.currentUserId,p=f.date,v=f.topic,_=f.targetId,E=!!(2&(l||0)),m=function(e){return{isPersited:!!(1&e),isCounted:!!(2&e),disableNotification:!!(32&e),canIncludeExpansion:!!(64&e)}}(i),T=m.isPersited,I=m.isCounted,y=m.disableNotification,R=m.canIncludeExpansion,C=OU[v]||Td.PRIVATE,S=UE(cU,v),O=this._formatBytes(r),N=_;o===Cd.RECALL&&(C=O.conversationType||C,N=O.targetId||_),a&&(n={},n=DE(a));var A={};c&&(A=RE(this.logger,c.pushConfigs,c.pushId));var M=rc(rc({},A),{pushTitle:null==c?void 0:c.title,pushContent:u,pushData:u,disablePushTitle:!!d&&Boolean(4&d),forceShowDetailContent:!!d&&Boolean(8&d),templateId:null==c?void 0:c.templateId});return{conversationType:C,targetId:N,messageType:o,messageUId:s,isPersited:T,isCounted:I,isStatusMessage:S,senderUserId:g,content:this._formatBytes(r),sentTime:1e3*p,receivedTime:BE.getTime(),messageDirection:vd.SEND,isOffLineMessage:!1,disableNotification:y,canIncludeExpansion:R,expansion:n,pushConfig:M,channelId:e.busChannel||"",isInterrupt:E,messageId:TE(h)||0}},t.prototype._formatHistoryMessages=function(e,t){var n=this,r=t.conversation||{},o=e.list,i=e.hasMsg,s=r.targetId,a=TE(e.syncTime),c=[];return NE(o,(function(e){var o=n._formatReceivedMessage(e,t);r.conversationType===Td.ULTRA_GROUP?o.targetId=e.groupId||r.targetId:o.targetId=s,c.push(o)}),{isReverse:!0}),{syncTime:a,list:c,hasMore:!!i}},t.prototype._formatUltraMsgChangeList=function(e){var t=e.list,n=e.syncTime,r=e.hasNext;return{syncTime:n,list:t&&t.map((function(e){var t=e.targetId,n=e.type,r=e.time,o=e.changeType,i=e.msgUID,s=e.msgTime,a=e.busChannel,c=e.isAdmin,u=e.isDel,d=e.operatorId,l=e.subChangeType;return{targetId:t,conversationType:n,changeType:o,messageUId:i,changeTime:TE(r),sendTime:TE(s),channelId:a||"",isAdmin:c,isDel:u,operatorId:d,subChangeType:l}})),hasNext:r}},t.prototype._formatUltraOperateStatusNotifyList=function(e){var t=e.type,n=e.notifyType,r=e.info,o=e.summary,i=[],s=[],a=2==(2&n),c=1==(1&n);return c&&Array.isArray(r)&&r.forEach((function(e){var t=e.targetId,n=e.busChannel,r=e.userId,o=e.opType,s=e.optime,a=TE(s);i.push({targetId:t,channelId:n,userId:r,operationType:o,operationTime:a})})),a&&Array.isArray(o)&&o.forEach((function(e){var t=e.targetId,n=e.busChannel,r=e.count,o=e.opType;s.push({targetId:t,channelId:n,count:r,operationType:o})})),{conversationType:t,info:i,summary:s,hasInfo:c,hasSummary:a}},t.prototype._formatUltraMsgList=function(e,t){var n=this,r=e.list;return{list:r&&r.map((function(e){return n._formatReceivedMessage(e,t)}))}},t.prototype._formatUltraGroupUnreadMentionedList=function(e){var t=e.msgInfo;return(void 0===t?[]:t).map((function(e){return{messageUId:e.msgId,senTtime:TE(e.msgTime),mentionedType:e.remindType}}))},t.prototype._formatConversationList=function(t,n){var r=this,o=t.info,i=n.afterDecode,s={list:(o=AE(o,(function(t){var o=t.msg,s=t.userId,a=t.type,c=t.unreadCount,u=t.busChannel,d=t.versionTime,l=t.remindCount,h=t.busChannelType;t.readMsgTime;var f=t.msgInfo,g=null;o&&((g=r._formatReceivedMessage(o,n)).targetId=s);var p={targetId:s,conversationType:a,unreadMessageCount:TE(c)||0,latestMessage:g||{},channelId:u||""};return a===Td.ULTRA_GROUP&&(p.versionTime=TE(d)||0,p.unreadMentionedCount=TE(l)||0,p.channelType=h||e.UltraGroupChannelType.PUBLIC,p.lastReadTime=0,f&&(p.firstUnreadMessage={sentTime:TE(f.msgTime)},p.lastReadTime=TE(f.msgTime)-1)),(null==i?void 0:i(p))||p})))||[]};return((null==n?void 0:n.conversationType)||Td.NONE)===Td.ULTRA_GROUP&&(s.isFinished=t.isFinished),s},t.prototype._formatSetUserSettingOutput=function(e){return e},t.prototype._formatChatRoomInfos=function(e){var t=e.userTotalNums,n=e.userInfos,r=AE(n,(function(e){var t=e.id,n=e.time;return{id:t,time:TE(n)}}));return{userCount:t,userInfos:r}},t.prototype._formatChatRoomKVList=function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return t=AE(t=t||[],(function(e){var t=e.key,n=e.value,r=e.status,o=e.timestamp,i=e.uid,s=e.version,a=function(e){return{isAutoDelete:!!(1&e),isOverwrite:!!(2&e),type:4&e?Vd.DELETE:Vd.UPDATE}}(r);return{key:t,value:n,isAutoDelete:a.isAutoDelete,isOverwrite:a.isOverwrite,type:a.type,userId:i,timestamp:TE(o),version:TE(s)}})),{kvEntries:t,isFullUpdate:n,syncTime:r}},t.prototype._formatUserSetting=function(e){var t=this,n=e.items,r=e.version,o={};return NE(n||[],(function(e){var n=e.key,r=e.version,i=e.value;e.version=TE(r),e.value=t._readBytes(i),"Tag"===n&&e.tags.forEach((function(e){e.createdTime=TE(e.createdTime),e.tagName=e.name})),o[n]=e})),{settings:o,version:r}},t.prototype._formatConversationStatus=function(e){var t=e.state,n=[];return NE(t,(function(e){var t=e.type,r=e.channelId,o=e.time,i=e.stateItem,s=e.busChannel,a=Od.CLOSE,c=Ad.NOT_SET,u=!1,d=[];NE(i,(function(e){var t=e.sessionStateType,n=e.value,r=e.tags;switch(t){case LU:a=n===MU?Od.OPEN:Od.CLOSE,c=Number(n)||Ad.NOT_SET;break;case wU:u=n===MU;break;case bU:d=r}})),n.push({conversationType:t,type:t,targetId:r,notificationStatus:a,notificationLevel:c,isTop:u,updatedTime:TE(o),tags:d,channelId:s||""})})),n},t.prototype._formatGrpReadReceiptQryResp=function(e){var t=e.totalMemberNum,n=e.list;return n.forEach((function(e){e.readTime=TE(e.readTime)})),{totalMemberCount:t,list:n}},t.prototype._formatUserSettingNotification=function(e){return e},t.prototype._formatChrmKVVersion=function(e){return e},t.prototype._formatRTCJoinedUserInfo=function(e){return(e.info||[]).map((function(e){return{deviceId:e.deviceId,roomId:e.roomId,joinTime:TE(e.joinTime)}}))},t.prototype.encodeServerConfParams=function(){var e=this._codec.getModule(jL);return e.setNothing(1),e.getArrayData()},t.prototype._getUpMsgModule=function(e,t){var n,r,o,i=e.conversationType,s=t.messageType,a=t.isMentioned,c=t.mentionedType,u=t.mentionedUserIdList,d=t.content,l=t.pushContent,h=t.pushData,f=t.directionalUserIdList,g=t.isFilerWhiteBlacklist,p=t.isVoipPush,v=t.canIncludeExpansion,_=t.expansion,E=t.pushConfig,m=t.channelId,T=t.messageId,I=void 0===T?0:T;[Td.GROUP,Td.ULTRA_GROUP].includes(i);var y=this._codec.getModule(FL),R=function(e){var t=e.isStatusMessage,n=e.isPersited,r=e.isCounted;t&&(n=r=!1);var o=0;return n&&(o|=1),r&&(o|=2),e.isMentioned&&(o|=4),e.disableNotification&&(o|=32),e.canIncludeExpansion&&(o|=64),o}(t),C=E||{},S=C.pushTitle,O=C.pushContent,N=C.pushData,A=C.iOSConfig,M=C.androidConfig,U=C.templateId,L=C.disablePushTitle,w=C.forceShowDetailContent,b=0;y.setSessionId(R),a&&d&&(d.mentionedInfo={userIdList:(null===(n=d.mentionedInfo)||void 0===n?void 0:n.userIdList)||u||[],type:(null===(r=d.mentionedInfo)||void 0===r?void 0:r.type)||c||Ud.ALL,mentionedContent:(null===(o=d.mentionedInfo)||void 0===o?void 0:o.mentionedContent)||""});var P=O||l||"",D=N||h||"";if(P&&y.setPushText(P),D&&y.setAppData(D),f&&y.setUserId(f),b|=p?1:0,b|=g?2:0,b|=L?4:0,b|=w?8:0,y.setConfigFlag(b),y.setClassname(s),d.user&&d.user.portraitUri&&(d.user.portrait=d.user.portraitUri),y.setContent(JSON.stringify(d)),v&&_){var B={};NE(_,(function(e,t){B[t]={v:e}})),y.setExtraContent(JSON.stringify(B))}if(E){var V=this._codec.getModule(HL);if(S&&V.setTitle(S),A&&M){var x=yE(A,M);V.setPushConfigs(x)}(null==M?void 0:M.notificationId)&&V.setPushId(null==M?void 0:M.notificationId),V.setTemplateId(U||""),y.setPushExt(V)}return y.setClientUniqueId(I),ll(m)||y.setBusChannel(m),y},t.prototype.encodeUpMsg=function(e,t){return this._getUpMsgModule(e,t).getArrayData()},t.prototype.encodeSyncMsg=function(e){var t=e.sendboxTime,n=e.inboxTime,r=e.broadcastSyncTime,o=this._codec.getModule(JL);return o.setIspolling(!1),o.setIsPullSend(!0),o.setSendBoxSyncTime(t),o.setSyncTime(n),o.setBroadcastSyncTime(r),o.getArrayData()},t.prototype.encodeChrmSyncMsg=function(e,t){e=e||0,t=t||0;var n=this._codec.getModule(QL);return n.setCount(t),n.setSyncTime(e),n.getArrayData()},t.prototype.encodeGetHistoryMsg=function(e,t){var n=t.count,r=t.order,o=t.timestamp,i=t.channelId,s=this._codec.getModule(ZL);return s.setTargetId(e),s.setTime(o),s.setCount(n),s.setOrder(r),s.setBusChannel(i||""),s.getArrayData()},t.prototype.encodeSuperSyncMsg=function(e){var t=this._codec.getModule(eb);return t.setSyncTime(e),t.getArrayData()},t.prototype.encodeGetConversationList=function(e){var t=(e=e||{}).count,n=e.startTime,r=this._codec.getModule(XL);return r.setType(1),r.setCount(t),r.setStartTime(n),r.getArrayData()},t.prototype.encodeOldConversationList=function(e){var t=(e=e||{}).count,n=e.type,r=e.startTime,o=e.order;t=t||0,r=r||0,o=o||0;var i=this._codec.getModule(XL);return i.setType(n),i.setCount(t),i.setStartTime(r),i.setOrder(o),i.getArrayData()},t.prototype.encodeRemoveOldConversationList=function(e){var t=(e=e||{}).conversationType,n=e.channelId,r=this._codec.getModule(ow);return r.setType(t),n&&r.setBusChannel([n]),r.getArrayData()},t.prototype.encodeRemoveConversationList=function(e){var t=this,n=this._codec.getModule(tw),r=[];return NE(e,(function(e){var n=e.conversationType,o=e.targetId,i=t._codec.getModule(nw);i.setType(n),i.setChannelId(o),r.push(i)})),n.setSessions(r),n.getArrayData()},t.prototype.encodeDeleteMessages=function(e,t,n,r){var o=this._codec.getModule(iw),i=[];return NE(n,(function(e){i.push({msgId:e.messageUId,msgDataTime:e.sentTime,direct:e.messageDirection})})),o.setType(e),o.setConversationId(t),o.setMsgs(i),o.setBusChannel(r),o.getArrayData()},t.prototype.encodeClearMessages=function(e,t,n,r){var o=this._codec.getModule(sw);return t=t||(new Date).getTime(),o.setDataTime(t),o.setTargetId(e),o.setBusChannel(n),o.setConversationType(r),o.getArrayData()},t.prototype.encodeClearUnreadCount=function(e,t){var n=e.conversationType,r=e.targetId,o=e.channelId,i=t.timestamp,s=this._codec.getModule(aw);return i=i||+new Date,s.setType(n),s.setChannelId(r),s.setMsgTime(i),s.setBusChannel(o),s.getArrayData()},t.prototype.encodeExpandUltraMessage=function(e,t){var n=e.targetId,r=e.conversationType,o=e.channelId,i=e.messageUId,s=e.sendTime,a=e.keys,c={mid:i,put:e.expansion,del:a,clear:e.removeAll?1:0},u=this._codec.getModule(tb);return u.setFromUserId(t),u.setTargetId(n),u.setType(r),u.setBusChannel(o||""),u.setMsgUID(i),u.setMsgTime(s),u.setContent(JSON.stringify(c)),u.getArrayData()},t.prototype.encodemodifyMessage=function(e,t){var n=e.targetId,r=e.conversationType,o=e.channelId,i=e.messageUId,s=e.sendTime,a=e.content,c=this._codec.getModule(tb);return c.setFromUserId(t),c.setTargetId(n),c.setType(r),c.setBusChannel(o||""),c.setMsgUID(i),c.setMsgTime(s),c.setContent(JSON.stringify(a)),c.getArrayData()},t.prototype.encodeQueryMsgChange=function(e){var t=this._codec.getModule(nb);return t.setSyncTime(e),t.getArrayData()},t.prototype.encodeMsgQuery=function(e){var t=e.targetId,n=e.conversationType,r=e.messages,o=this._codec.getModule(ib),i=r.map((function(e){return{msgTime:e.sendTime,msgUID:e.messageUId,busChannel:e.channelId}}));return o.setTargetId(t),o.setType(n),o.setQuery(i),o.getArrayData()},t.prototype.encodeUnreadMentionedMsgQuery=function(e){var t=e.targetId,n=e.channelId,r=e.sentTime,o=e.count,i=this._codec.getModule(kw);return i.setGroupId(t),i.setBusChannel(n),i.setMsgTime(r),i.setSize(o),i.getArrayData()},t.prototype.encodeOperateStatus=function(e,t,n,r){var o=this._codec.getModule(cb);return o.setTargetId(e),o.setType(t),o.setBusChannel(n),o.setOpType(r),o.getArrayData()},t.prototype.encodeJoinOrQuitChatRoom=function(){var e=this._codec.getModule(cw);return e.setNothing(1),e.getArrayData()},t.prototype.encodeGetChatRoomInfo=function(e,t){var n=this._codec.getModule(dw);return n.setCount(e),n.setOrder(t),n.getArrayData()},t.prototype.encodeSetUltraGroupDefaultNotificationLevel=function(e,t){var n=this._codec.getModule(Gw);return n.setUnpushLevel(e),n.setBusChannel(t),n.getArrayData()},t.prototype.encodeGetUltraGroupDefaultNotificationLevel=function(e){var t=this._codec.getModule(xw);return t.setBusChannel(e),t.getArrayData()},t.prototype.encodeGetFileToken=function(e,t,n,r){var o=this._codec.getModule(hw);return o.setType(e),o.setKey(t),o.setHttpMethod(n),o.setQueryString(r),o.getArrayData()},t.prototype.encodeGetFileUrl=function(e,t,n,r){var o=this._codec.getModule(e);return o.setType(t),o.setKey(n),r&&o.setFileName(r),o.getArrayData()},t.prototype.encodeModifyChatRoomKV=function(e,t,n){var r=this._codec.getModule(mw),o=t.key,i=t.value,s=t.notificationExtra,a=t.isSendNotification,c=t.type,u=t.timestamp,d=c||Vd.UPDATE,l=VE(t,d),h={key:o,value:i||"",uid:n,version:u};if(ll(l)||(h.status=l),r.setEntry(h),a){var f={conversationType:Td.CHATROOM,targetId:e},g={key:o,value:i,extra:s,type:d},p=this._getUpMsgModule(f,{messageType:Cd.CHRM_KV_NOTIFY,content:g,isPersited:!1,isCounted:!1});r.setNotification(p),r.setBNotify(!0),r.setType(Td.CHATROOM)}return r.getArrayData()},t.prototype.encodeModifyChatRoomKVS=function(e,t,n){var r=this._codec.getModule(Tw),o=t.entries,i=t.type||Vd.UPDATE,s=VE(t,i),a=[];return o.forEach((function(e){var t={key:e.key,value:e.value||"",uid:n,version:e.timestamp};ll(s)||(t.status=s),a.push(t)})),r.setEntry(a),r.getArrayData()},t.prototype.encodePullChatRoomKV=function(e){var t=this._codec.getModule(Ow);return t.setTimestamp(e),t.getArrayData()},t.prototype.encodePullUserSetting=function(e){var t=this._codec.getModule(Mw);return t.setVersion(e),t.getArrayData()},t.prototype.encodeGetConversationStatus=function(e){var t=this._codec.getModule(ww);return t.setTime(e),t.getArrayData()},t.prototype.encodeSetConversationStatus=function(e,t){var n=this,r=this._codec.getModule(Bw),o=BE.getTime(),i=[];return NE(e,(function(e){var t=n._codec.getModule(Pw),r=e.conversationType,s=e.targetId,a=e.notificationStatus,c=e.isTop,u=e.channelId,d=e.notificationLevel,l=[];t.setType(r),t.setChannelId(s),t.setTime(o),t.setBusChannel(u);var h=a===Od.OPEN,f={};ll(a)||(f[LU]=h),ll(d)||(f[LU]=d),ll(c)||(f[wU]=c),NE(f,(function(e,t){if(!ll(e)){var r=n._codec.getModule(Dw);e=e?MU:UU,ll(d)||Number(t)!==LU||(e=String(d)),r.setSessionStateType(Number(t)),r.setValue(e),l.push(r)}})),t.setStateItem(l),i.push(t)})),r.setVersion(t||o),r.setState(i),r.getArrayData()},t.prototype.encodeReadReceipt=function(e,t){var n=this._codec.getModule(qw);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},t.prototype.encodeCreateTag=function(e,t){var n=this,r=this._codec.getModule(Jw),o=[];return e.forEach((function(e){var t=n._codec.getModule(Qw);t.setTagId(e.tagId),t.setName(e.tagName),o.push(t)})),r.setTags(o),r.setVersion(t),r.getArrayData()},t.prototype.encodeMessageReader=function(e,t){var n=this._codec.getModule(qw);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},t.prototype.encodeRemoveTag=function(e,t){var n=this,r=this._codec.getModule(Ww),o=[];return e.forEach((function(e){var t=n._codec.getModule(Qw);t.setTagId(e),o.push(t)})),r.setTags(o),r.setVersion(t),r.getArrayData()},t.prototype.encodeDisConversationTag=function(e){var t=this._codec.getModule(Zw);return t.setTagId(e),t.getArrayData()},t.prototype.encodeUpdateConversationTag=function(e,t){var n=this,r=this._codec.getModule(Bw),o=[];return t.forEach((function(t){var r=n._codec.getModule(Pw),i=n._codec.getModule(Dw),s=[];e.forEach((function(e){var t=n._codec.getModule(Qw);t.setTagId(e.tagId),ll(e.isTop)||t.setIsTop(e.isTop),s.push(t)})),i.setSessionStateType(bU),i.setValue(JSON.stringify(s)),i.setTags(s),r.setType(t.conversationType),r.setChannelId(t.targetId),r.setTime(Date.now()),r.setStateItem([i]),o.push(r)})),r.setState(o),r.setVersion(BE.getTime()),r.getArrayData()},t.prototype.encodeReportSDKInfo=function(e){var t=this._codec.getModule(zw);return t.setSdkInfo(e),t.getArrayData()},t.prototype.encodeUltraGroup=function(e,t){var n=this._codec.getModule($w);return n.setSyncTime(e),n.setIsEraseMsgContent(t),n.getArrayData()},t.prototype.encodebindRTCRoomForChatroom=function(e){var t=this._codec.getModule(hb);return t.setRtcRoomId(e.rtcRoomId),t.getArrayData()},t}(),iP=function(e){function t(t,n,r,o,i){var s=e.call(this,t,n,r,i)||this;return s.runtime=o,s.wsListener=i,s._socket=null,s._connectedTime=0,s._localConnectedTime=0,s._idCount=0,s._generateMessageId=function(){return s._idCount>=65535&&(s._idCount=0),++s._idCount},s._messageIds={},s._syncMessageIds={},s.codec=new oP(s.logger),s}return nc(t,e),t.prototype.getConnectedTime=function(){return this._connectedTime},t.prototype.getLocalConnectedTime=function(){return this._localConnectedTime},t.prototype.getCrtServerTime=function(){return Date.now()-this._localConnectedTime+this._connectedTime},t.prototype.connectWithToken=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var n,o,i,s,a,c,u,d,l,h,f,g,p,v;return ic(this,(function(_){switch(_.label){case 0:if(n=[],o=t.server,i=t.backupServer,s=t.protocol,a=t.openAnti,o?n.push(o):this.logger.warn(Dd.L_NAVI_CONF_E,"`navi.server` invalid",r),null==i||i.split(",").forEach((function(e){n.indexOf(e)<0&&n.push(e)})),0===n.length)return this.logger.error(Dd.L_NAVI_CONF_E,"no service available",r),[2,{code:Ed.SERVER_UNAVAILABLE}];c=s.replace("http","ws"),u=1===a?oU.V4:oU.V3,d=0,_.label=1;case 1:return d<n.length?(l=n[d],h=function(e,t,n,r,o,i,s){return"".concat(e,"://").concat(t,"/websocket?appId=").concat(n,"&token=").concat(encodeURIComponent(r),"&sdkVer=").concat(za,"&pid=").concat(i,"&apiVer=").concat(o.isFromUniapp?"uniapp":"normal").concat(o.connectPlatform?"&platform=".concat(o.connectPlatform):"").concat(s?"&protocolVer=".concat(s):"")}(c,l,this.appkey,e,this.runtime,"",u),f=Date.now(),[4,this.connectWebSocket(h,u,r)]):[3,4];case 2:return g=_.sent(),p=g.code,v=g.data,p===Ed.RC_SOCKET_DISCONNECTED||p===Ed.TIMEOUT?[3,3]:p!==Ed.SUCCESS?[2,{code:p}]:(this._localConnectedTime=Math.floor((Date.now()+f)/2),this._socket=v.socket,[2,{code:p,data:v.userId}]);case 3:return d+=1,[3,1];case 4:return[2,{code:Ed.SERVER_UNAVAILABLE}]}}))}))},t.prototype.connectWebSocket=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return this.logger.debug(Dd.T,"connect start: ".concat(e),n),[2,new Promise((function(o){var i=r.runtime.createWebSocket(e);setTimeout((function(){return o({code:Ed.TIMEOUT})}),5e3),i.onOpen((function(){r.logger.debug(Dd.T,"socket open",n)})),i.onMessage((function(e){if("[object ArrayBuffer]"===Object.prototype.toString.call(e)){var s,a=nL(r.logger,e,t);if(a instanceof qU){var c=a.status;if(c!==bb.ACCEPTED)return r.logger.debug(Dd.T,"connect failed: ".concat(c),n),void o({code:(s=c,tP[s])});r.logger.debug(Dd.T,"connect success",n);var u=a.timestamp,d=a.userId,l=a.messageId;return r._connectedTime=u,r._idCount=l,void o({code:Ed.SUCCESS,data:{userId:d,socket:i}})}if(a instanceof KU){var h=a.status;return r.logger.debug(Dd.T,"recv disconnect signal -> status: ".concat(h)),void r.onRecvDisconnect(h,i)}if(a instanceof YU&&r._pingResolve)return r._pingResolve(Ed.SUCCESS),void(r._pingResolve=void 0);r._onReceiveSignal(a)}})),i.onClose((function(){r.logger.debug(Dd.T,"socket close",n);var e=Ed.RC_SOCKET_DISCONNECTED;o({code:e}),r.onSocketEnd(i,e)})),i.onError((function(e){r.logger.debug(Dd.T,"socket error",n);var t=Ed.RC_SOCKET_DISCONNECTED;o({code:t}),r.onSocketEnd(i,t)}))}))]}))}))},t.prototype._onReceiveSignal=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a=this;return ic(this,(function(c){switch(c.label){case 0:return t=e.messageId,e.header&&e.header.qos!==tU.AT_MOST_ONCE&&(e instanceof WU&&!e.syncMsg&&(this.logger.debug(Dd.O,"send pubAck -> ".concat(t," ").concat(e.topic)),this.sendOnly(new XU(t))),e instanceof tL&&(this.logger.debug(Dd.O,"send queryCon -> ".concat(t," ").concat(e.topic)),this.sendOnly(new eL(t)))),t>0&&(e instanceof zU||e instanceof tL)&&(this.logger.debug(Dd.O,"recv ack -> messageId: ".concat(t," ").concat(e.topic)),(n=this._messageIds[t])&&(n(e),delete this._messageIds[t]),(r=this._syncMessageIds[t])&&(delete this._syncMessageIds[t],r(e))),e instanceof WU?(o=e.syncMsg,i=e.topic,this.logger.debug(Dd.O,"recv PublishReader -> messageId: ".concat(t," ").concat(i)),i===dT?[2]:!o||function(e){return[rL.ppMsgS,rL.pgMsgS,rL.chatMsgS].map((function(e){return rL[e]})).indexOf(e)>=0}(i)?(this.wsListener.signal(e),[2]):[4,new Promise((function(e){a._syncMessageIds[t]=e}))]):[3,2];case 1:s=c.sent(),delete this._syncMessageIds[t],this.wsListener.signal(e,s),c.label=2;case 2:return[2]}}))}))},t.prototype.onRecvDisconnect=function(e,t){this._socket&&this._socket===t&&(this._socket=null,this.clearResolves(),this.onDisconnectByServer(function(e){return eP[e]}(e)))},t.prototype.onSocketEnd=function(e,t){this._socket&&this._socket===e&&(this._socket=null,this.clearResolves(),this.onDisconenctUnusual(t))},t.prototype.clearResolves=function(){for(var e in this._messageIds){var t=this._messageIds[e];delete this._messageIds[e],t(Ed.RC_SOCKET_DISCONNECTED)}},t.prototype.sendPing=function(e){var t=this;return new Promise((function(n){t._pingResolve=n,setTimeout((function(){return n(Ed.TIMEOUT)}),e),t.sendOnly(new jU)}))},t.prototype.sendOnly=function(e){this._socket&&((e instanceof ZU||e instanceof $U)&&(e.messageId=this._generateMessageId()),this._socket.send(e.getBufferData().buffer))},t.prototype.send=function(e,t,n,r){return void 0===r&&(r=3e4),oc(this,void 0,void 0,(function(){var o,i,s,a,c=this;return ic(this,(function(u){switch(u.label){case 0:return this._socket?(o=this._generateMessageId(),e.messageId=o,this._socket.send(e.getBufferData().buffer),[4,new Promise((function(e){c._messageIds[o]=e,setTimeout((function(){c._messageIds[o]&&delete c._messageIds[o],e()}),r)}))]):[2,{code:Ed.RC_NET_CHANNEL_INVALID}];case 1:return(i=u.sent())?i instanceof tL||i instanceof zU?(s=t&&i.data&&[Ed.SUCCESS,Ed.CHATROOM_KV_STORE_NOT_ALL_SUCCESS].indexOf(i.status)>=0,a=s?this.codec.decodeByPBName(i.data,t,n):i,0!==i.status?(this.logger.warn(Dd.O,"send failed -> message: ".concat(o,", respPBName: ").concat(t,", status: ").concat(i.status)),[2,{code:i.status,data:t&&i.data?a:null}]):[2,{code:Ed.SUCCESS,data:a}]):[2,{code:i}]:(this.logger.warn(Dd.O,"send timeout -> message: ".concat(o,", respPBName: ").concat(t,", timeout: ").concat(r)),[2,{code:Ed.TIMEOUT}])}}))}))},t.prototype.close=function(e){this._socket&&(this._socket.close(),this._socket=null),this.clearResolves()},t}(rP),sP=function(t,n,r,o,i,s,a){return{conversationType:t,targetId:n,senderUserId:s,messageDirection:vd.SEND,isCounted:!!r.isCounted,isMentioned:!!r.isMentioned,content:r.content,messageType:r.messageType,isOffLineMessage:!1,isPersited:!!r.isPersited,messageUId:o,sentTime:i,receivedTime:0,disableNotification:!!r.disableNotification,isStatusMessage:!!r.isStatusMessage,canIncludeExpansion:!!r.canIncludeExpansion,expansion:r.canIncludeExpansion?r.expansion:null,receivedStatus:to.UNREAD,pushConfig:r.pushConfig,channelId:r.channelId,isInterrupt:r.isInterrupt,messageId:a||0,sentStatus:e.SentStatus.SENT}},aP=function(e){return e.sort((function(e,t){var n,r,o=(null===(n=e.latestMessage)||void 0===n?void 0:n.sentTime)||0;return((null===(r=t.latestMessage)||void 0===r?void 0:r.sentTime)||0)-o}))},cP=function(t){function n(e,n,r,o){var i=t.call(this,e,n,r,o,new kb(o.appkey,"RC-E","IM"))||this;i._customMessageType={},i._reconnectTimer=-1,i._pullOfflineFinished=!1,i.currentUserId="",i._pullingMsg=!1,i._pullQueue=[],i._chrmsQueue={},i._latestSyncTimestamp=0,i._intervalTimer=-1,i._intervalTimerForChrmPull=-1,i._lastSyncUltraMsgTimeStamp=0,i._lastSyncUltraMsgLocalTimeStamp=0,i._ultraGroupTimer=-1,i._isUltraPulling=!1,i._ultraGroupTimeQue=[],i._isUltraGroupListExist=!1,i._ultraGroupMap={},i._ultraMsgMap={},i._pullUltraChangeMessageQue=[],i._isPullingUltraChangeMessage=!1,i._lastPullingUltraChangeMessageTime=0,i._ultraMsgChangeMap={};var s=o.appkey,a=o.logOutputLevel,c=o.logExpireTime,u=o.miniCMPProxy,d=o.navigators;return i.logger.setOutputLevel(a),Ob(s,i.logger,c),i.reporter=new Xb(s,i.runtime,i.logger,i._options.__reportLogLevel),i.navi=new ML(s,i.logger,e,u.join(","),d),i._letterbox=new cL(e,s),i._sendMessageStore=new LL(e,s),i._chrmEntryHandler=new lL(i),i._connMgr=new iP(s,i.navi,i.logger,i.runtime,{signal:i._signalHandler.bind(i),onConnected:i.onConnected.bind(i),onDisconnected:i.onDisconnected.bind(i),onConnecting:i._watcher.onConnecting,onSuspend:i._watcher.onSuspend}),i}return nc(n,t),n.prototype.onConnected=function(){var e=this.navi.getNaviInfoFromCache(this._connMgr.getToken()),t=this._connMgr.getCurrentUserId();this.currentUserId=t,this._pullOfflineFinished=!1,this._joinedChrmManager||(this._joinedChrmManager=new hL(this.runtime,this._appkey,this.currentUserId,e.joinMChrm,this.logger)),this._conversationManager||(this._conversationManager=new CL(this,this._appkey,this.currentUserId,this._watcher.conversation,this._watcher.conversationTag)),this._ultraGroupManager||(this._ultraGroupManager=new kL(this,this._appkey,this.currentUserId)),this._userSettingManager||(this._userSettingManager=new SL(this,this._appkey,this.currentUserId,this._watcher.tag)),this._watcher.onConnected(),this._conversationManager.startPullConversationStatus(0),this._conversationManager.adaptOldStore(),this._userSettingManager.pullUserSettings(0),this._sendMessageStore.init(this.currentUserId),this._rejoinChrm(),this._startSyncInterval(),1===e.ugMsg&&this._notificationOnline(),this.reporter.checkStart(e)},n.prototype.onDisconnected=function(e){this._resetMemoryState(),this._watcher.onDisconnected(e)},n.prototype.createLogger=function(e,t){return new kb(this._appkey,e,t)},n.prototype.refetchNaviInfo=function(){return this.navi.request(this._connMgr.getToken(),!0,!0,this.logger.createTraceId())},n.prototype.getNaviInfoFromCache=function(){return this.navi.getNaviInfoFromCache(this._connMgr.getToken())},n.prototype.getConnectedTime=function(){return this._connMgr.getConnectedTime()},n.prototype.getConnectionStatus=function(){return this._connMgr.getConnectionStatus()},n.prototype.connect=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._connMgr.connect(e,t,n)]}))}))},n.prototype._signalHandler=function(e,t){var n=e.syncMsg,r=e.topic;if(n)this._receiveSyncMsg(e,t);else{var o=this.logger.createTraceId();this.logger.debug(Dd.L_RECV_RMTP_O,r,o);var i=rL[r];if(i)switch(i){case rL.s_ntf:this._pullMsg(e);break;case rL.s_msg:this._receiveMsg(e);break;case rL.s_cmd:this._receiveStateNotify(e);break;case rL.s_us:this._receiveSettingNotify(e);break;case rL.rtc_ntf:this._receiveRtcKv(e.data);break;case rL.s_opNtf:this._pullOperateStatusNotify(e)}else this.logger.error(Dd.L_RECV_RMTP_E,r,o)}},n.prototype._receiveStateNotify=function(e){var t=this._connMgr.codec.decodeByPBName(e.data,WL),n=t.time,r=t.type,o=t.chrmId;switch(r){case 2:this._chrmEntryHandler.pullEntry(o,n);break;case 3:this._conversationManager.startPullConversationStatus(n);break;case 4:this._chrmEntryHandler.reset(o),this._watcher.chatroom({chatroomDestroyed:e.targetId});break;case 6:this._ultraGroupTimeQue.push(n),this._syncUltraMsg(this._lastSyncUltraMsgTimeStamp);break;case 7:this._pullUltraChangeMessageQue.push(n),this._pullUltraChangeMessageList(this._lastPullingUltraChangeMessageTime)}},n.prototype._receiveSettingNotify=function(e){var t=this._connMgr.codec.decodeByPBName(e.data,Lw).version;this._userSettingManager.pullUserSettings(t)},n.prototype._receiveMessageExpansion=function(e){var t=e.content,n=t.put,r=t.del,o=t.mid;n&&this._watcher.expansion({updatedExpansion:{messageUId:o,expansion:n}}),r&&this._watcher.expansion({deletedExpansion:{messageUId:o,deletedKeys:r}})},n.prototype._receiveSyncMsg=function(e,t){if(bL.includes(e.topic)){if(e.topic===rL[rL.updUgRTime]){var n=this._connMgr.codec.decodeByPBName(e.data,aw),r=n.channelId,o=n.busChannel,i=this._ultraGroupMap["".concat(o,"_").concat(r)];return i&&(i.unreadMessageCount=0,i.unreadMentionedCount=0,i.firstUnreadMessage&&(i.firstUnreadMessage=null),i.lastReadTime=t.timestamp,this._watcher.conversation(PE([i]))),void(t&&(this._ultraMsgMap[t.messageUId]=t.timestamp))}var s=this._connMgr.codec.decodeByPBName(e.data,FL,{currentUserId:this.currentUserId,signal:e});((s=this._handleMsgProperties(s)).conversationType!==Td.CHATROOM||this._chrmsQueue[s.targetId])&&(t&&(s.sentTime=t.timestamp,s.messageUId=t.messageUId),this.logger.info(Dd.L_RECV_MULTI_SYNC_MSG_O,JSON.stringify({messageUId:s.messageUId,messgeId:s.messageId,sentTime:s.sentTime})),this._pullingMsg?this._pullQueue.push((null==t?void 0:t.timestamp)||s.sentTime):(t&&this._sendMessageStore.setMessage(t.messageUId,t.timestamp),s.messageType!==Cd.EXPANSION_NOTIFY?(s.messageType===Cd.SYNC_READ_STATUS&&this._conversationManager.clearUnreadCount(s.conversationType,s.targetId,s.channelId),this._conversationManager.setConversationCacheByMessage(s,!0),this._batchMessage([s])):this._receiveMessageExpansion(s)))}},n.prototype._batchMessage=function(e){for(var t=this,n=[],r=[],o=e.length-1;o>=0;o-=1){var i=e[o];i.messageType!==Cd.LOG_COMMAND||"rongcloudsystem"!==i.senderUserId?n.unshift(i):r.unshift(i)}this._watcher.batchMessage(n),0!==r.length&&r.forEach((function(e){var n=e.content,r=n.startTime,o=n.endTime,i=n.platform,s=n.logId,a=n.uri;t.reporter.report(parseInt(r,10),parseInt(o,10),i,a,s,e.messageUId)}))},n.prototype._pullMsg=function(e){var t=this._connMgr.codec.decodeByPBName(e.data,WL),n=t.type,r=t.chrmId,o=t.time;if(this.logger.info(Dd.L_RECV_S_NTF_O,"type: ".concat(n,", chrmId: ").concat(n,", time: ").concat(o)),2===n){var i=this._chrmsQueue[r];if(!i)return;i.queue.push(o),this._pullChrmMsg(r)}else this._pullQueue.push(o),this._syncMsg()},n.prototype._startSyncInterval=function(){var e=this;this._stopSyncInterval();this._intervalTimer=setInterval((function(){Date.now()-e._latestSyncTimestamp>=18e4&&e._syncMsg()}),3e4),this._latestSyncTimestamp=Date.now(),this._syncMsg()},n.prototype._stopSyncInterval=function(){-1!==this._intervalTimer&&(clearInterval(this._intervalTimer),this._intervalTimer=-1)},Object.defineProperty(n.prototype,"_isConnected",{get:function(){return this._connMgr.getConnectionStatus()===e.RCConnectionStatus.CONNECTED},enumerable:!1,configurable:!0}),n.prototype._syncMsg=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r,o,i,s,a,c,u,d,l,h,f,g,p,v,_,E,m=this;return ic(this,(function(T){switch(T.label){case 0:return this._pullingMsg?[2]:this._isConnected?(this._pullingMsg=!0,e=this._letterbox.getOutboxTime(this.currentUserId),t=this._letterbox.getInboxTime(this.currentUserId),n=this._letterbox.getBroadcastSyncTime(this.currentUserId),r=this._connMgr.codec.encodeSyncMsg({sendboxTime:e,inboxTime:t,broadcastSyncTime:n}),o=new $U(rL[rL.pullMsg],r,this.currentUserId),i=this.logger.createTraceId(),this.logger.info(Dd.L_PULL_MSG_T,JSON.stringify({outboxTime:e,inboxTime:t,broadcastSyncTime:n}),i),[4,this._connMgr.send(o,KL,{connectedTime:this._connMgr.getConnectedTime(),currentUserId:this.currentUserId})]):(this._pullingMsg=!1,[2]);case 1:return s=T.sent(),a=s.code,c=s.data,this._latestSyncTimestamp=Date.now(),a!==Ed.SUCCESS||!c||ll(c.finished)||ll(c.list)||ll(c.syncTime)?(this.logger.warn(Dd.L_PULL_MSG_R,JSON.stringify({code:a,timestamp:this._latestSyncTimestamp}),i),this._pullingMsg=!1,[2]):(u=c.list,d=c.finished,l=c.syncTime,h=c.broadcastSyncTime,f=void 0===h?1:h,this.logger.info(Dd.L_PULL_MSG_R,JSON.stringify({syncTime:l,finished:d,messages:u.map((function(e){return{messageUId:e.messageUId,messageId:e.messageId,sentTime:e.sentTime}}))}),i),g=0,p=[],v=[],u.forEach((function(e){if((p.push(e.messageUId),e.messageDirection===vd.SEND)&&(g=Math.max(e.sentTime,g),m._sendMessageStore.getSendMessageMap()[e.messageUId]))return void m._sendMessageStore.removeByUID(e.messageUId);if(e.messageType!==Cd.DELIVERED&&e.messageType!==Cd.DELIVERED_MSG)if(e.messageType!==Cd.EXPANSION_NOTIFY){if(e.messageType===Cd.SYNC_READ_STATUS){if(e.senderUserId!==m.currentUserId)return;m._conversationManager.clearUnreadCount(e.conversationType,e.targetId,e.channelId)}var t=m._handleMsgProperties(e);m._conversationManager.setConversationCacheByMessage(t,!0),v.push(t)}else m._receiveMessageExpansion(e)})),this._batchMessage(v),this._letterbox.setInboxTime(l,this.currentUserId),this._letterbox.setOutboxTime(g,this.currentUserId),this._letterbox.setBroadcastSyncTime(f,this.currentUserId),this._sendMessageStore.removeByTimestamp(g),this._pullingMsg=!1,_=this._pullQueue.filter((function(e){return e>l})),this._pullQueue.length=0,(E=this._pullQueue).push.apply(E,_),d&&!this._pullOfflineFinished&&(this._pullOfflineFinished=!0,this._watcher.pullFinished()),this.logger.info(Dd.L_PULL_MSG_R,JSON.stringify({code:a,messageUIds:p.join(","),timestamp:this._latestSyncTimestamp,hasmore:!d,tmpPullQueue:_}),i),d?(this._pullQueue.length>0&&(this._pullQueue.length=0,this._syncMsg()),[2]):(this._syncMsg(),[2]))}}))}))},n.prototype._receiveMsg=function(e){if(this._isConnected){var t=this._connMgr.codec.decodeByPBName(e.data,qL,{currentUserId:this.currentUserId,connectedTime:this._connMgr.getConnectedTime()});if(t=this._handleMsgProperties(t),this.logger.info(Dd.L_RECV_S_MSG_O,JSON.stringify({messageUId:t.messageUId,messgeId:t.messageId,sentTime:t.sentTime})),t.messageType!==Cd.DELIVERED&&t.messageType!==Cd.DELIVERED_MSG){if(t.conversationType!==Td.RTC_ROOM){if(this._pullingMsg)return;if(this._pullQueue.length>0)return void this._syncMsg()}t.senderUserId===this.currentUserId&&this._sendMessageStore.setMessage(t.messageUId,t.sentTime),t.isStatusMessage||t.senderUserId===this.currentUserId||this._letterbox.setInboxTime(t.sentTime,this.currentUserId),t.messageType!==Cd.EXPANSION_NOTIFY?t.messageType===Cd.SYNC_READ_STATUS&&t.senderUserId!==this.currentUserId||(this._conversationManager.setConversationCacheByMessage(t,!0),this._batchMessage([t])):this._receiveMessageExpansion(t)}}},n.prototype._handleMsgProperties=function(e,t){void 0===t&&(t=!1);var n,r=e.messageType,o=e.isCounted,i=e.isPersited,s=e.isStatusMessage,a=r in Ja,c=r in this._customMessageType;if(n=a?rc(rc({},Ja[r]),{isStatusMessage:Qa.includes(r)}):c?this._customMessageType[r]:{isCounted:!hl(o)&&o,isPersited:!hl(i)&&i,isStatusMessage:!1},Object.assign(e,n),t&&!ll(s)&&(e.isStatusMessage=s),!t){var u=e.content.user;if(u){var d=u.portrait,l=u.portraitUri,h=d||l;h&&(u.portrait=u.portraitUri=h)}}return e},n.prototype.getHistoryMessage=function(e,t,n,r,o,i,s,a){var c;return void 0===i&&(i=""),oc(this,void 0,void 0,(function(){var s,u,d,l,h,f,g,p,v,_;return ic(this,(function(E){switch(E.label){case 0:return u=(s=this).currentUserId,d=s._connMgr,l=NU[e]||IU,h=1===r&&0===n,d?(f=d.codec.encodeGetHistoryMsg(t,{timestamp:n,count:h?2:r,order:o,channelId:i}),this.logger.info(Dd.L_GET_HISTORY_MSG_T,JSON.stringify({targetId:t,conversationType:e,channelId:i,timestamp:n,count:r,order:o}),a),[4,d.send(new $U(l,f,u),zL,{currentUserId:u,connectedTime:d.getConnectedTime(),conversation:{targetId:t}})]):[3,2];case 1:return g=E.sent(),(p=g.code)===Ed.SUCCESS&&f?(v=g.data,h&&2===v.list.length&&(v.hasMore=!0,0===o?v.list.shift():v.list.pop()),_=[],null===(c=v.list)||void 0===c||c.forEach((function(e){e&&_.push(e.messageUId)})),this.logger.info(Dd.L_GET_HISTORY_MSG_R,JSON.stringify({code:p,messageUIds:_.join(",")}),a),[2,{code:p,data:{list:v.list,hasMore:v.hasMore}}]):(this.logger.warn(Dd.L_GET_HISTORY_MSG_R,JSON.stringify({code:p,messageUIds:""}),a),[2,{code:p}]);case 2:return[2,{code:Ed.RC_NET_CHANNEL_INVALID}]}}))}))},n.prototype.reportSDKInfo=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._isConnected?(n=(t=this).currentUserId,r=t._connMgr,o=this.logger.createTraceId(),i=JSON.stringify(e),this.logger.debug(Dd.L_VER_REPORT_T,i,o),s=r.codec.encodeReportSDKInfo(i),a=new $U(rL[rL.reportsdk],s,n),[4,r.send(a)]):[2];case 1:return(c=u.sent().code)!==Ed.SUCCESS&&this.logger.warn(Dd.L_VER_REPORT_R,c,o),[2]}}))}))},n.prototype.deleteRemoteMessage=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return this._isConnected?(i=(o=this).currentUserId,s=o._connMgr,a=s.codec.encodeDeleteMessages(e,t,n,r),c=new $U(uU,a,i),[4,s.send(c)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return u=d.sent(),[2,u.code]}}))}))},n.prototype.deleteRemoteMessageByTimestamp=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return this._isConnected?(i=(o=this).currentUserId,s=o._connMgr,a=s.codec.encodeClearMessages(t,n,r,e),c=AU[e],u=new $U(c,a,i),[4,s.send(u)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return d=l.sent(),[2,d.code]}}))}))},n.prototype.getConversationList=function(e,t,n,r,o){return void 0===e&&(e=300),oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d,l,h=this;return ic(this,(function(f){switch(f.label){case 0:return this._isConnected?(i=(o=this).currentUserId,s=o._connMgr,t=t||Td.PRIVATE,a=s.codec.encodeOldConversationList({count:e,type:t,startTime:n,order:r}),c=new $U(_U,a,i),[4,s.send(c,$L,{currentUserId:i,connectedTime:s.getConnectedTime(),afterDecode:function(e){var t=e.conversationType,n=e.targetId,r=e.channelId,o=h._conversationManager.get(t,n,r);return Object.assign(e,o),e}})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return u=f.sent(),d=u.code,l=u.data,d!==Ed.SUCCESS?[2,{code:d}]:[2,{code:d,data:null==l?void 0:l.list}]}}))}))},n.prototype.removeConversation=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isConnected?(r=this._connMgr,o=r.codec.encodeRemoveOldConversationList({conversationType:e,channelId:n,targetId:t}),i=new $U(EU,o,t),[4,r.send(i)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return s=a.sent(),[2,s.code]}}))}))},n.prototype.getConversation=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return e!==Td.ULTRA_GROUP?[3,1]:(r=this._ultraGroupMap["".concat(n,"_").concat(t)])?[3,3]:[2,{code:Ed.CONVER_GET_ERROR}];case 1:return(o=this._conversationManager.get(e,t,n))?[4,this.getHistoryMessage(e,t,0,1,0)]:[2,{code:Ed.CONVER_GET_ERROR}];case 2:if(i=u.sent(),s=i.code,a=i.data,s!==Ed.SUCCESS)return[2,{code:Ed.CONVER_GET_ERROR}];c=(null==a?void 0:a.list[0])||null,r={conversationType:e,targetId:t,channelId:n,unreadMessageCount:o.unreadMessageCount||0,latestMessage:c,notificationStatus:o.notificationStatus||Od.CLOSE,notificationLevel:o.notificationLevel||Ad.NOT_SET,isTop:o.isTop||!1,lastUnreadTime:o.lastUnreadTime||0,unreadMentionedCount:o.unreadMentionedCount||0},u.label=3;case 3:return[2,{code:Ed.SUCCESS,data:r}]}}))}))},n.prototype.getAllConversationUnreadCount=function(e,t,n){var r=this._conversationManager.getAllUnreadCount(e,t,n);return Promise.resolve({code:Ed.SUCCESS,data:r})},n.prototype.getTotalUnreadCountByLevels=function(e,t,n){void 0===n&&(n=!1);var r=0;if(e.includes(Td.ULTRA_GROUP)){if(!this._isUltraGroupListExist)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});for(var o in this._ultraGroupMap){var i=this._ultraGroupMap[o];(0===t.length||t.includes(i.notificationLevel))&&(r+=n?i.unreadMentionedCount:i.unreadMessageCount)}}return r+=this._conversationManager.getTotalUnreadCountByLevels(e,t,n),Promise.resolve({code:Ed.SUCCESS,data:r})},n.prototype.getConversationUnreadCount=function(e,t,n){var r,o;return o=e===Td.ULTRA_GROUP?(null===(r=this._ultraGroupMap["".concat(n,"_").concat(t)])||void 0===r?void 0:r.unreadMessageCount)||0:this._conversationManager.getUnreadCount(e,t,n),Promise.resolve({code:Ed.SUCCESS,data:o})},n.prototype.clearConversationUnreadCount=function(e,t,n){return this._conversationManager.clearUnreadCount(e,t,n,!1),Promise.resolve(Ed.SUCCESS)},n.prototype.clearAllUnreadCount=function(){return this._conversationManager.clearAllUnreadCount(),Promise.resolve(Ed.SUCCESS)},n.prototype.getFirstUnreadMessage=function(e,t){throw new Error("Method not implemented.")},n.prototype.saveConversationMessageDraft=function(e,t,n,r){return this._conversationManager.setDraft(e,t,n,r),Promise.resolve(Ed.SUCCESS)},n.prototype.getConversationMessageDraft=function(e,t,n){var r=this._conversationManager.getDraft(e,t,n);return Promise.resolve({code:Ed.SUCCESS,data:r})},n.prototype.clearConversationMessageDraft=function(e,t,n){return this._conversationManager.clearDraft(e,t,n),Promise.resolve(Ed.SUCCESS)},n.prototype.pullConversationStatus=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d=this;return ic(this,(function(l){switch(l.label){case 0:return this._isConnected?(n=(t=this)._connMgr,r=t.currentUserId,o=n.codec.encodeGetConversationStatus(e),i=new $U(rL[rL.pullSeAtts],o,r),[4,n.send(i,bw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return s=l.sent(),a=s.code,c=s.data,this.logger.info(Dd.L_PULL_CONVERSATION_S,JSON.stringify({timestamp:e,userId:r})),a!==Ed.SUCCESS?[2,{code:a}]:(u=[],Array.isArray(c)&&c.forEach((function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,o=e.channelId,i=e.isTop,s=e.notificationLevel,a=e.updatedTime;a&&d._conversationManager.setConversationUpdatedTime(a);var c=d._ultraGroupMap["".concat(o,"_").concat(n)];t===Td.ULTRA_GROUP?c&&(void 0!==r&&(c.notificationStatus=r),void 0!==s&&(c.notificationLevel=s),void 0===s&&void 0===r||d._ultraGroupManager.addUltraGroupStatus(e),"boolean"==typeof i&&(c.isTop=i)):u.push(e)})),[2,{code:a,data:u}])}}))}))},n.prototype.batchSetConversationStatus=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d,l,h,f=this;return ic(this,(function(g){switch(g.label){case 0:return this._isConnected?(n=(t=this).currentUserId,r=t._connMgr,o=this._conversationManager.getConversationUpdatedTime(),i=r.codec.encodeSetConversationStatus(e,o),s=new $U(mU,i,n),[4,r.send(s,Vw)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return a=g.sent(),c=a.code,u=a.data,c!==Ed.SUCCESS?[2,c]:(d=u,this._conversationManager.setConversationUpdatedTime(d.version),l=[],e.forEach((function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,o=e.notificationLevel,i=e.channelId,s=e.isTop;if(t===Td.ULTRA_GROUP){var a=f._ultraGroupMap["".concat(i,"_").concat(n)];a&&(void 0!==r&&(a.notificationStatus=r),void 0!==o&&(a.notificationLevel=o),void 0===o&&void 0===r||f._ultraGroupManager.addUltraGroupStatus(a),void 0!==s&&(a.isTop=s),l.push(a))}else f._conversationManager.addStatus(rc(rc({},e),{updatedTime:d.version}),!0)})),l.length>0&&(h=PE(l),h=aP(h),this._watcher.conversation(h)),[2,c])}}))}))},n.prototype._joinChrm=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d,l,h;return ic(this,(function(f){switch(f.label){case 0:return this._isConnected?(o=this._connMgr,i=o.codec.encodeJoinOrQuitChatRoom(),a=new $U(s=n?lU:dU,i,e),this.logger.info(Dd.L_JOIN_CHATROOM_T,JSON.stringify({chatroomId:e,count:t,topic:s}),r),[4,o.send(a,uw)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return c=f.sent(),u=c.code,d=c.data,l=u===Ed.SUCCESS?"info":"warn",this.logger[l](Dd.L_JOIN_CHATROOM_R,JSON.stringify({code:u,timestamp:(new Date).getTime()}),r),u===Ed.SUCCESS&&(h=d.joinTime,this._chrmsQueue[e]||(this._chrmsQueue[e]={pulling:!1,queue:[],timestamp:0}),this._pullChrmMsg(e,t,h),this.getNaviInfoFromCache().kvStorage&&this._chrmEntryHandler.pullEntry(e,0),this._joinedChrmManager.set(e,t),this._startSyncIntervalForChrmPull()),[2,u]}}))}))},n.prototype._rejoinChrm=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:for(n in e=this._joinedChrmManager.get(),t=[],e)t.push(n);r=0,c.label=1;case 1:return r<t.length?(o=t[r],this.logger.info(Dd.L_REJOIN_CHATROOM_T,JSON.stringify({chatroomId:o,count:e[o]||10,topic:lU})),i=this.logger.createTraceId(),[4,this._joinChrm(o,e[o]||10,!0,i)]):[3,4];case 2:if(s=c.sent(),a=s===Ed.SUCCESS?"info":"warn",this.logger[a](Dd.L_REJOIN_CHATROOM_R,JSON.stringify({code:s,timestamp:(new Date).getTime()}),i),s===Ed.SUCCESS)return this._watcher.chatroom({rejoinedRoom:{chatroomId:o,count:e[o]}}),[2];s===Ed.RC_CHATROOM_USER_KICKED&&(this._joinedChrmManager.remove(o),delete this._chrmsQueue[o]),this._watcher.chatroom({rejoinedRoom:{chatroomId:o,errorCode:s}}),c.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},n.prototype._pullChrmMsg=function(e,t,n){return void 0===t&&(t=10),void 0===n&&(n=0),oc(this,void 0,void 0,(function(){var r,o,i,s,a,c,u,d,l,h,f,g,p;return ic(this,(function(v){switch(v.label){case 0:return this._isConnected?(r=this._chrmsQueue[e],o=r.pulling,i=r.timestamp,o?[2]:(r.pulling=!0,s=this._connMgr.codec.encodeChrmSyncMsg(n?0:i,t),a=new $U(rL[rL.chrmPull],s,e),this.logger.info(Dd.L_PULL_CHATROOM_MSG_T,JSON.stringify({chatroomId:e,timestamp:i})),[4,this._connMgr.send(a,KL,{connectedTime:this._connMgr.getConnectedTime(),currentUserId:this.currentUserId})])):[2];case 1:return c=v.sent(),u=c.code,d=c.data,r.pulling=!1,u===Ed.SUCCESS&&d?(l=d.list,h=d.syncTime,f=d.finished,r.timestamp=n?Math.max(h,n):h,r.queue=r.queue.filter((function(e){return e>h})),g=[],p=[],l.forEach((function(e){e.sentTime<i||(g.push(e.messageUId),p.push(e))})),this._batchMessage(p),this.logger.info(Dd.L_PULL_CHATROOM_MSG_R,JSON.stringify({code:u,timestamp:i,messageUIds:g.join(",")})),(!f||r.queue.length>0)&&this._pullChrmMsg(e),[2]):(this.logger.warn(Dd.L_PULL_CHATROOM_MSG_R,JSON.stringify({code:u,timestamp:i,messageUIds:""})),[2])}}))}))},n.prototype.joinChatroom=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._joinChrm(e,t,!1,n)]}))}))},n.prototype.joinExistChatroom=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._joinChrm(e,t,!0,n)]}))}))},n.prototype.quitChatroom=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return this._isConnected?(t=this._connMgr,n=t.codec.encodeJoinOrQuitChatRoom(),r=new $U(hU,n,e),[4,t.send(r)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return o=s.sent(),(i=o.code)===Ed.SUCCESS&&(delete this._chrmsQueue[e],this._chrmEntryHandler.reset(e),this._joinedChrmManager.remove(e)),[2,i]}}))}))},n.prototype.getChatroomInfo=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._isConnected?(r=this._connMgr,o=r.codec.encodeGetChatRoomInfo(t,n),i=new $U(rL[rL.queryChrmI],o,e),[4,r.send(i,lw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return s=u.sent(),a=s.code,c=s.data,a!==Ed.SUCCESS?[2,{code:a}]:[2,{code:a,data:c}]}}))}))},n.prototype.getChatroomHistoryMessages=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return this._isConnected?(o=this._connMgr,i=o.codec.encodeGetHistoryMsg(e,{timestamp:t,count:n,order:r}),s=new $U(RU,i,e),[4,o.send(s,zL,{conversation:{targetId:e}})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return a=d.sent(),c=a.code,u=a.data,c!==Ed.SUCCESS?[2,{code:c}]:[2,{code:c,data:{list:u.list,hasMore:u.hasMore}}]}}))}))},n.prototype._modifyChatroomKV=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return this._isConnected?(r=(n=this)._connMgr,o=n.currentUserId,i=this._chrmEntryHandler.getVersion(e,t.key),t.version=null==i?this.getServerTime():i,s=r.codec.encodeModifyChatRoomKV(e,t,o),a=t.type===Vd.UPDATE?fU:gU,c=new $U(a,s,e),[4,r.send(c,uw)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return u=l.sent(),(d=u.code)===Ed.SUCCESS?(this._chrmEntryHandler.setLocal(e,{kvEntries:[t],syncTime:(new Date).getTime()},o),[2,d]):[2,d]}}))}))},n.prototype._modifyChatroomKVS=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c,u,d,l,h,f,g=this;return ic(this,(function(p){switch(p.label){case 0:return this._isConnected?(r=(n=this)._connMgr,o=n.currentUserId,t.entries.forEach((function(t){var n=g._chrmEntryHandler.getVersion(e,t.key);t.version=null==n?g.getServerTime():n})),i=r.codec.encodeModifyChatRoomKVS(e,t,o),s=t.type===Vd.UPDATE?pU:vU,a=new $U(s,i,e),[4,r.send(a,Rw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return c=p.sent(),u=c.code,-1!==[Ed.SUCCESS,Ed.CHATROOM_KV_STORE_NOT_ALL_SUCCESS].indexOf(u)&&(l=[],delete(h=rc({},t)).entries,t.entries.forEach((function(e){l.push(rc(rc({},e),h))})),u===Ed.CHATROOM_KV_STORE_NOT_ALL_SUCCESS&&(f=c.data,d=f.errorKeys,f&&Array.isArray(f.errorKeys)&&f.errorKeys.forEach((function(e){var t=l.findIndex((function(t){return e.key===t.key}));-1!==t&&l.splice(t,1)}))),this._chrmEntryHandler.setLocal(e,{kvEntries:l,syncTime:(new Date).getTime()},o)),[2,{code:u,data:d}]}}))}))},n.prototype.setChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.UPDATE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},n.prototype.setChatroomEntries=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.UPDATE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKVS(e,t)]}))}))},n.prototype.forceSetChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.UPDATE,t.isOverwrite=!0,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},n.prototype.removeChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.DELETE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},n.prototype.removeChatroomEntries=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.DELETE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKVS(e,t)]}))}))},n.prototype.forceRemoveChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.type=Vd.DELETE,t.isOverwrite=!0,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},n.prototype.getChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return(n=this._chrmEntryHandler.getValue(e,t))?[2,{code:Ed.SUCCESS,data:n}]:this._isConnected?(r=this._connMgr,o=r.codec.encodePullChatRoomKV(0),i=new $U(rL[rL.pullKV],o,e),[4,r.send(i,yw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return s=u.sent(),(a=s.data)&&a.kvEntries&&a.kvEntries.length&&(c=a.kvEntries.find((function(e){return e.key===t})),void 0!==c)?[2,{code:Ed.SUCCESS,data:null==c?void 0:c.value}]:[2,{code:Ed.CHATROOM_KEY_NOT_EXIST}]}}))}))},n.prototype.getAllChatroomEntry=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return(t=this._chrmEntryHandler.getAll(e))&&Object.keys(t).length?[2,{code:Ed.SUCCESS,data:t}]:this._isConnected?(n=this._connMgr,t={},r=n.codec.encodePullChatRoomKV(0),o=new $U(rL[rL.pullKV],r,e),[4,n.send(o,yw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return i=a.sent(),(s=i.data)&&s.kvEntries&&s.kvEntries.length&&s.kvEntries.forEach((function(e){e.key&&(t[e.key]=e.value||"")})),[2,{code:Ed.SUCCESS,data:t}]}}))}))},n.prototype.pullChatroomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c,u,d,l,h,f;return ic(this,(function(g){switch(g.label){case 0:return this._isConnected?(r=(n=this)._connMgr,o=n.currentUserId,i=r.codec.encodePullChatRoomKV(t),s=new $U(rL[rL.pullKV],i,e),this.logger.info(Dd.L_PULL_CHATROOM_KV_T,JSON.stringify({chatroomId:e,timestamp:t})),[4,r.send(s,yw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return a=g.sent(),c=a.code,u=a.data,d=c===Ed.SUCCESS?"info":"warn",this.logger[d](Dd.L_PULL_CHATROOM_KV_R,JSON.stringify({code:c,timestamp:t})),c===Ed.SUCCESS?(this._chrmEntryHandler.setLocal(e,u,o),h=(l=u).kvEntries,l.syncTime,f=[],h.length>0&&(h.forEach((function(t){var n=t.key,r=t.value,o=t.type,i=t.timestamp;f.push({key:n,value:r,type:o,timestamp:i,chatroomId:e})})),this._watcher.chatroom({updatedEntries:f})),[2,{code:c,data:u}]):[2,{code:c}]}}))}))},n.prototype._startSyncIntervalForChrmPull=function(){var e=this;this._stopSyncIntervalForChrmPull(),this._intervalTimerForChrmPull=setInterval((function(){var t=Object.keys(e._chrmsQueue);0!==t.length&&e._isConnected?t.forEach((function(t){e._pullChrmMsg(t),e.getNaviInfoFromCache().kvStorage&&e._chrmEntryHandler.pullEntry(t,0)})):e._stopSyncIntervalForChrmPull()}),ja)},n.prototype._stopSyncIntervalForChrmPull=function(){"number"!=typeof this._intervalTimerForChrmPull&&(clearInterval(this._intervalTimerForChrmPull),this._intervalTimerForChrmPull=-1)},n.prototype.sendMessage=function(t,n,r,o,i){return oc(this,void 0,void 0,(function(){var s,a,c,u,d,l,h,f,g,p,v;return ic(this,(function(_){switch(_.label){case 0:return this._isConnected?(r=function(e,t){return"RC:SRSMsg"===e.messageType&&Object.assign(e,{directionalUserIdList:[t]}),e}(r,this.currentUserId),r=this._handleMsgProperties(r,!0),s=!![Td.PRIVATE,Td.GROUP].includes(t)&&r.isStatusMessage,a=s?function(e){var t;return(t={},t[Td.PRIVATE]=rL.ppMsgS,t[Td.GROUP]=rL.pgMsgS,t)[e]}(t):function(e){var t;return(t={},t[Td.PRIVATE]=rL.ppMsgP,t[Td.GROUP]=rL.pgMsgP,t[Td.CHATROOM]=rL.chatMsg,t[Td.CUSTOMER_SERVICE]=rL.pcMsgP,t[Td.RTC_ROOM]=rL.prMsgS,t)[e]}(t)||rL.ppMsgP,s&&(r.isPersited=!1,r.isCounted=!1),c=r.messageId?r.messageId:OE(),r.messageId=c,u=this._connMgr.codec.encodeUpMsg({conversationType:t,targetId:n},r),(d=new ZU(rL[a],u,n)).setHeaderQos(tU.AT_LEAST_ONCE),s?(this._connMgr.sendOnly(d),[2,{code:Ed.SUCCESS,data:sP(t,n,rc({},r),"",0,this.currentUserId,c)}]):(l=this._connMgr.getCrtServerTime(),h=sP(t,n,rc({},r),"",l,this.currentUserId,c),null==o||o(c),this.logger.info(Dd.L_SEND_MSG_T,JSON.stringify({messageType:r.messageType,conversationType:t,targetId:n,channelId:r.channelId}),i),[4,this._connMgr.send(d)])):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return f=_.sent(),g=f.code,p=f.data,g!==Ed.SUCCESS?(this.logger.warn(Dd.L_SEND_MSG_R,JSON.stringify({code:g,messageUId:h.messageUId,messageId:h.messageId}),i),h.sentStatus=e.SentStatus.FAILED,[2,{code:g,data:h}]):(this.logger.info(Dd.L_SEND_MSG_R,JSON.stringify({code:g,messageUId:null==p?void 0:p.messageUId,messageId:null==p?void 0:p.messageId}),i),v=p,this._sendMessageStore.setMessage(v.messageUId,v.timestamp),h.sentTime=v.timestamp,h.messageUId=v.messageUId,this._conversationManager.setConversationCacheByMessage(h,!0),[2,{code:Ed.SUCCESS,data:h}])}}))}))},n.prototype.recallMsg=function(e,t,n,r,o){var i;return oc(this,void 0,void 0,(function(){var s,a,c,u,d,l,h,f,g,p,v,_,E;return ic(this,(function(m){switch(m.label){case 0:return this._isConnected?(s=o.user,a=o.extra,c=o.isDelete,u={conversationType:e,targetId:t,messageUId:n,sentTime:r,channelId:o.channelId||"",isDelete:c||!1},s&&(u.user=s),a&&(u.extra=a),d={content:u,messageType:"RC:RcCmd",disableNotification:null==o?void 0:o.disableNotification,pushConfig:null==o?void 0:o.pushConfig,pushContent:(null===(i=o.pushConfig)||void 0===i?void 0:i.pushContent)||o.pushContent||"",channelId:o.channelId},l=rL[rL.recallMsg],h=this._connMgr.codec.encodeUpMsg({conversationType:e,targetId:t},d),(f=new ZU(l,h,this.currentUserId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(f)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return g=m.sent(),p=g.code,v=g.data,e===Td.ULTRA_GROUP&&this.logger.debug(Dd.L_RECALL_ULTRA_MSG_S,JSON.stringify({code:p,conversationType:e,targetId:t,channelId:o.channelId})),p!==Ed.SUCCESS?[2,{code:p}]:(_=v,e===Td.ULTRA_GROUP?(this._ultraMsgMap[_.messageUId]=_.timestamp,this._updateUltraGroupWhenRecallMsg(t,o.channelId||"",n),[2,{code:Ed.SUCCESS}]):(this._sendMessageStore.setMessage(_.messageUId,_.timestamp),E=sP(e,t,rc(rc({},d),{isPersited:!0}),_.messageUId,_.timestamp,this.currentUserId),this._conversationManager.setConversationCacheByMessage(E,!0),[2,{code:Ed.SUCCESS,data:E}]))}}))}))},n.prototype.sendReadReceiptMessage=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o;return ic(this,(function(i){return this._isConnected?(r=this._connMgr.codec.encodeReadReceipt(t,n),o=new $U(rL[rL.rrMsg],r,e),[2,this._connMgr.send(o)]):[2,{code:Ed.RC_NET_UNAVAILABLE}]}))}))},n.prototype.getMessageReader=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o;return ic(this,(function(i){return this._isConnected?(r=this._connMgr.codec.encodeMessageReader(t,n),o=new $U(rL[rL.rrList],r,e),[2,this._connMgr.send(o,jw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}]}))}))},n.prototype.pullUserSettings=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return this._isConnected?(t=this._connMgr.codec.encodePullUserSetting(e),n=new $U(rL[rL.pullUS],t,this.currentUserId),[4,this._connMgr.send(n,Uw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return r=s.sent(),o=r.code,i=r.data,o===Ed.SUCCESS&&this._naviChangeHandler(i),[2,{code:o,data:i}]}}))}))},n.prototype._naviChangeHandler=function(e){var t;if(e){var n=e.settings,r=null===(t=null==n?void 0:n.VoipInfo)||void 0===t?void 0:t.value;if(r){var o=this._connMgr.getToken();this.navi.updateVoipCallInfo(o,r);var i=this.navi.getNaviInfoFromCache(o);this._watcher.onNaviDataChange(rc({},i))}}else this.logger.warn(Dd.L_NOTIFY_NAVI_CHANGE_E,JSON.stringify({data:e}))},n.prototype.getFileToken=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return this._isConnected?(o=r&&"uploads"!==r?t||"":IE(e,t),i=this._connMgr.codec.encodeGetFileToken(e,o,n||"",r||""),s=new $U(rL[rL.qnTkn],i,this.currentUserId),[4,this._connMgr.send(s,fw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return a=d.sent(),c=a.code,u=a.data,u=Object.assign(u,{fileName:o}),c===Ed.SUCCESS?[2,{code:c,data:u}]:[2,{code:c}]}}))}))},n.prototype.getFileUrl=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d,l,h;return ic(this,(function(f){switch(f.label){case 0:return this._isConnected?(o="",i="",s="",t===wd.QINIU?(i=gw,s=vw):(i=pw,s=_w),o=t===wd.QINIU?rL[rL.qnUrl]:t===wd.AWS?rL[rL.s3Url]:t===wd.STC?rL[rL.stcUrl]:rL[rL.aliUrl],a=this._connMgr.codec.encodeGetFileUrl(i,e,n,r),c=new $U(o,a,this.currentUserId),[4,this._connMgr.send(c,s)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return u=f.sent(),d=u.code,l=u.data,h=l,d===Ed.SUCCESS?[2,{code:d,data:h}]:[2,{code:d}]}}))}))},n.prototype.disconnect=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){switch(e.label){case 0:return this.reporter.stop(),[4,this._connMgr.disconnect()];case 1:return e.sent(),this._resetMemoryState(),[2]}}))}))},n.prototype._resetMemoryState=function(){-1!==this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=-1),this._pullQueue.length=0,this._stopSyncInterval(),this.resetUltraGroupData(),this._joinedChrmManager&&this._joinedChrmManager.clear(),this._chrmsQueue={}},n.prototype.resetUltraGroupData=function(){this._stopUltraSyncInterval(),this._lastSyncUltraMsgTimeStamp=0,this._lastSyncUltraMsgLocalTimeStamp=0,this._isUltraPulling=!1,this._ultraGroupTimeQue=[],this._isUltraGroupListExist=!1,this._ultraGroupMap={}},n.prototype.registerMessageType=function(e,t,n,r,o){this._customMessageType[e]={isPersited:t,isCounted:n,isStatusMessage:o}},n.prototype.getServerTime=function(){return this._connMgr.getCrtServerTime()},n.prototype.getCurrentUserId=function(){return this.currentUserId},n.prototype.createTag=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isConnected?(t=this._userSettingManager.getVersion(),n=this._connMgr.codec.encodeCreateTag([e],t),r=new $U(rL[rL.addSeTag],n,this.currentUserId),[4,this._connMgr.send(r,Aw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return o=c.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?[2,{code:i}]:(a=s.version,this._userSettingManager.addTag([rc(rc({},e),{createdTime:a})],a),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.removeTag=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isConnected?(t=this._userSettingManager.getVersion(),n=this._connMgr.codec.encodeRemoveTag([e],t),r=new $U(rL[rL.delSeTag],n,this.currentUserId),[4,this._connMgr.send(r,Aw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return o=c.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?[2,{code:i}]:(a=s.version,this._userSettingManager.deleteTag([e],a),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.updateTag=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isConnected?(t=this._userSettingManager.getVersion(),n=this._connMgr.codec.encodeCreateTag([e],t),r=new $U(rL[rL.addSeTag],n,this.currentUserId),[4,this._connMgr.send(r,Aw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return o=c.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?[2,{code:i}]:(a=s.version,this._userSettingManager.addTag([e],a),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.getTagList=function(){return oc(this,void 0,void 0,(function(){var e,t;return ic(this,(function(n){return e=this._userSettingManager.getTags(),t=this._conversationManager.getConversationListForTag(),e.forEach((function(e){e.conversationCount=t[e.tagId]?t[e.tagId].length:0})),[2,{code:Ed.SUCCESS,data:e}]}))}))},n.prototype.addTagForConversations=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s=this;return ic(this,(function(a){switch(a.label){case 0:return this._isConnected?this._userSettingManager.getTagById(e)?(n=this._connMgr.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new $U(rL[rL.addTag],n,this.currentUserId),[4,this._connMgr.send(r)]):[2,{code:Ed.TAG_NOT_EXIST}]:[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return(o=a.sent().code)!==Ed.SUCCESS?[2,{code:o}]:((i={})[e]={},t.forEach((function(e){s._conversationManager.addTagStatus(e.conversationType,e.targetId,i,e.channelId)})),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.removeTagForConversations=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i=this;return ic(this,(function(s){switch(s.label){case 0:return this._isConnected?(n=this._connMgr.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new $U(rL[rL.delTag],n,this.currentUserId),[4,this._connMgr.send(r)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return(o=s.sent().code)!==Ed.SUCCESS?[2,{code:o}]:(t.forEach((function(t){i._conversationManager.deleteTagStatus(t.conversationType,t.targetId,[e],t.channelId)})),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.removeTagsForConversation=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._isConnected?(n=e.conversationType,r=e.targetId,o=e.channelId,i=t.map((function(e){return{tagId:e}})),s=this._connMgr.codec.encodeUpdateConversationTag(i,[e]),a=new $U(rL[rL.delTag],s,this.currentUserId),[4,this._connMgr.send(a)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return(c=u.sent().code)!==Ed.SUCCESS?[2,{code:c}]:(this._conversationManager.deleteTagStatus(n,r,t,o),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.getConversationListByTag=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c,u,d,l;return ic(this,(function(h){switch(h.label){case 0:return this._isConnected?(o=(r=this).currentUserId,i=r._connMgr,s=i.codec.encodeOldConversationList({count:n,type:Td.PRIVATE,startTime:t}),a=new $U(_U,s,o),[4,i.send(a,$L,{currentUserId:o,connectedTime:i.getConnectedTime()})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return c=h.sent(),u=c.code,d=c.data,u!==Ed.SUCCESS?[2,{code:u}]:(l=this._conversationHasTagFilter(e,null==d?void 0:d.list),[2,{code:u,data:l}])}}))}))},n.prototype._conversationHasTagFilter=function(e,t){var n=this,r=[],o=[];function i(e,t){return e.latestMessage&&t.latestMessage?e.latestMessage.sentTime-t.latestMessage.sentTime:0}return t.forEach((function(t){var i=t.conversationType,s=t.targetId,a=t.channelId,c=n._conversationManager.get(i,s,a),u=c.hasMentioned,d=c.mentionedInfo,l=c.lastUnreadTime,h=c.notificationStatus,f=c.isTop,g=c.tags,p=c.unreadMessageCount,v=g&&g[e];if(v){var _=rc(rc({},t),{hasMentioned:u,mentionedInfo:d,lastUnreadTime:l,notificationStatus:h,isTop:f,unreadMessageCount:p});v.isTop?r.push(rc(rc({},_),{isTopInTag:!0})):o.push(rc(rc({},_),{isTopInTag:!1}))}})),sc(sc([],r.sort(i),!0),o.sort(i),!0)},n.prototype.getUnreadCountByTag=function(e,t){return oc(this,void 0,void 0,(function(){var n;return ic(this,(function(r){return this._isConnected?(n=this._conversationManager.getUnreadCountByTag(e,t),[2,{code:Ed.SUCCESS,data:n}]):[2,{code:Ed.RC_NET_UNAVAILABLE}]}))}))},n.prototype.setConversationStatusInTag=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a,c,u,d,l,h;return ic(this,(function(f){switch(f.label){case 0:return this._isConnected?(r=t.targetId,o=t.conversationType,i=t.channelId,s=n.isTop,a=[{tagId:e,isTop:s}],(c=this._conversationManager.get(o,r,i)).tags&&Object.hasOwnProperty.call(c.tags,e)?(u=this._connMgr.codec.encodeUpdateConversationTag(a,[t]),d=new $U(rL[rL.addTag],u,this.currentUserId),[4,this._connMgr.send(d)]):[2,{code:Ed.NO_TAG_IN_CONVER}]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return(l=f.sent().code)!==Ed.SUCCESS?[2,{code:l}]:((h={})[e]={},s&&(h[e].isTop=!0),this._conversationManager.addTagStatus(o,r,h,i),[2,{code:Ed.SUCCESS}])}}))}))},n.prototype.getTagsForConversation=function(e){var t;return oc(this,void 0,void 0,(function(){var n,r,o,i;return ic(this,(function(s){if(!this._isConnected)return[2,{code:Ed.RC_NET_UNAVAILABLE}];if(n=this._conversationManager.get(e.conversationType,e.targetId,e.channelId),r=this._userSettingManager.getTagsInfo(),o=[],n.tags)for(i in n.tags)o.push({tagId:i,tagName:null===(t=r[i])||void 0===t?void 0:t.tagName});return[2,{code:Ed.SUCCESS,data:o}]}))}))},n.prototype.getBlockConversationList=function(){var e=this._conversationManager.getBlockConversationList();return Promise.resolve({code:Ed.SUCCESS,data:e})},n.prototype.getTopConversationList=function(e,t){var n=this._conversationManager.getTopConversationList(e,t);return Promise.resolve({code:Ed.SUCCESS,data:n})},n.prototype.getUnreadConversationList=function(e){return oc(this,void 0,void 0,(function(){var t;return ic(this,(function(n){return t=this._conversationManager.getUnreadConversationList(e),[2,Promise.resolve({code:Ed.SUCCESS,data:t})]}))}))},n.prototype.getUnreadMentionedCount=function(e){var t,n;return n=e.conversationType===Td.ULTRA_GROUP?(null===(t=this._ultraGroupMap["".concat(e.channelId,"_").concat(e.targetId)])||void 0===t?void 0:t.unreadMentionedCount)||0:this._conversationManager.getUnreadMentionedCount(e.channelId,e.conversationType,e.targetId),Promise.resolve({code:Ed.SUCCESS,data:n})},n.prototype.getAllUnreadMentionedCount=function(){var e=this._conversationManager.getAllUnreadMentionedCount();return Promise.resolve({code:Ed.SUCCESS,data:e})},n.prototype.getConversationNotificationLevel=function(e,t,n){if(!this._isUltraGroupListExist&&e===Td.ULTRA_GROUP)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});var r;if(!(r=e===Td.ULTRA_GROUP?this._ultraGroupManager.get(Td.ULTRA_GROUP,t,n):this._conversationManager.get(e,t,n)))return Promise.resolve({code:Ed.SUCCESS,data:Ad.NOT_SET});var o=r.notificationLevel;return ll(r.notificationLevel)&&!ll(r.notificationStatus)&&(o=Od.OPEN===r.notificationStatus?1:0),Promise.resolve({code:Ed.SUCCESS,data:o})},n.prototype.getConversationNotificationStatus=function(e,t,n){var r;return(r=e===Td.ULTRA_GROUP?this._ultraGroupManager.get(Td.ULTRA_GROUP,t,n):this._conversationManager.get(e,t,n))?Promise.resolve({code:Ed.SUCCESS,data:r.notificationStatus}):Promise.resolve({code:Ed.SUCCESS,data:Od.CLOSE})},n.prototype.getRemoteHistoryMessages=function(e,t,n,r,o,i){return this.getHistoryMessage(e,t,n,r,o,i)},n.prototype.getUltraGroupList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o;return ic(this,(function(i){return t=e.targetId,n=e.channelType,this._isUltraGroupListExist?(r=Object.values(this._ultraGroupMap).filter((function(e){return!(e.targetId!==t&&t||e.channelType!==n&&il(n))})),r=aP(r),o=PE(r),[2,{code:Ed.SUCCESS,data:o}]):[2,{code:Ed.METHOD_NOT_AVAILABLE}]}))}))},n.prototype.getBlockUltraGroupList=function(){if(!this._isUltraGroupListExist)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});var e=Object.values(this._ultraGroupMap),t=[];return e.forEach((function(e){(e.notificationStatus===Od.OPEN||e.notificationLevel>0)&&t.push({conversationType:Td.ULTRA_GROUP,targetId:e.targetId,channelId:e.channelId})})),Promise.resolve({code:Ed.SUCCESS,data:t})},n.prototype.getTopUltraGroupList=function(){if(!this._isUltraGroupListExist)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});var e=Object.values(this._ultraGroupMap),t=[];return e.forEach((function(e){!0===e.isTop&&t.push({conversationType:Td.ULTRA_GROUP,targetId:e.targetId,channelId:e.channelId})})),Promise.resolve({code:Ed.SUCCESS,data:t})},n.prototype.getUltraGroupUnreadMentionedCountByTargetId=function(e,t){if(!this._isUltraGroupListExist)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});var n=0;for(var r in this._ultraGroupMap){r.match(/_.*/g)[0].substring(1)!==e||t&&0!==t.length&&!t.includes(this._ultraGroupMap[r].notificationLevel)||(n+=this._ultraGroupMap[r].unreadMentionedCount)}return Promise.resolve({code:Ed.SUCCESS,data:n})},n.prototype.getUltraGroupUnreadCountByTargetId=function(e,t){var n=0;for(var r in this._ultraGroupMap){var o=this._ultraGroupMap[r];o.targetId!==e||t&&0!==t.length&&!t.includes(this._ultraGroupMap[r].notificationLevel)||(n+=o.unreadMessageCount||0)}return Promise.resolve({code:Ed.SUCCESS,data:n})},n.prototype.getAllUltraGroupUnreadCount=function(e){if(void 0===e&&(e=!1),!this._isUltraGroupListExist)return Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE});var t=0;for(var n in this._ultraGroupMap)t+=e?this._ultraGroupMap[n].unreadMentionedCount||0:this._ultraGroupMap[n].unreadMessageCount||0;return Promise.resolve({code:Ed.SUCCESS,data:t})},n.prototype.clearUltraUnreadcount=function(e,t){return void 0===t&&(t=""),oc(this,void 0,void 0,(function(){var n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isUltraGroupListExist?this._isConnected?(n=Date.now(),r=this._connMgr.codec.encodeClearUnreadCount({conversationType:Td.ULTRA_GROUP,targetId:e,channelId:t},{timestamp:n}),(o=new ZU(rL[rL.updUgRTime],r,this.currentUserId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(o)]):[2,Ed.RC_NET_UNAVAILABLE]:[2,Promise.resolve(Ed.METHOD_NOT_AVAILABLE)];case 1:return(i=a.sent().code)===Ed.SUCCESS&&((s=this._ultraGroupMap["".concat(t,"_").concat(e)])&&(s.unreadMessageCount=0,s.unreadMentionedCount=0,s.lastReadTime=n),s.firstUnreadMessage&&(s.firstUnreadMessage=null)),[2,i]}}))}))},n.prototype._getUltraGroupList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d,l,h,f,g=this;return ic(this,(function(p){switch(p.label){case 0:return this._isConnected?(!1,t=this._connMgr.codec.encodeUltraGroup(e,false),n=new $U(rL[rL.pullUgSes],t,this.currentUserId),[4,this._connMgr.send(n,$L,{currentUserId:this.currentUserId,conversationType:Td.ULTRA_GROUP})]):[2];case 1:return r=p.sent(),o=r.code,i=r.data,o===Ed.SUCCESS&&i?(a=i.list,c=i.isFinished,a.forEach((function(e){e.notificationStatus=Od.CLOSE,e.notificationLevel=Ad.NOT_SET,e.isTop=!1,g._ultraGroupMap["".concat(e.channelId,"_").concat(e.targetId)]=e,g._ultraGroupManager.addUltraGroupStatus(e)})),!1!==c?[3,2]:(u=a.length>0&&a[a.length-1].versionTime||0,this._getUltraGroupList(u),[3,4])):(this.logger.warn(Dd.L_ULTRA_SYNC_DONE_S,"Pull ultra group conversation failured, code: ".concat(o,", try again")),s=setTimeout((function(){g._getUltraGroupList(e),clearTimeout(s)}),3e3),[2]);case 2:return this.logger.info(Dd.L_ULTRA_SYNC_DONE_S,"Pull ultra group conversation success"),[4,this.pullConversationStatus(0)];case 3:d=p.sent(),l=d.code,h=d.data,l!==Ed.SUCCESS&&this.logger.warn(Dd.O,"pullConversationStatus fail code: ".concat(l,", data: ").concat(h)),f=Object.values(this._ultraGroupMap),f=aP(f),this._isUltraGroupListExist=!0,this._watcher.ultraGroupEnable(PE(f)),this._syncUltraMsg(this._lastSyncUltraMsgTimeStamp),p.label=4;case 4:return[2]}}))}))},n.prototype._startUltraSyncInterval=function(){var e=this;this._lastSyncUltraMsgLocalTimeStamp=Date.now(),function t(){e._ultraGroupTimer=setTimeout((function(){Date.now()-e._lastSyncUltraMsgLocalTimeStamp>=18e4&&e._syncUltraMsg(e._lastSyncUltraMsgTimeStamp),e._stopUltraSyncInterval(),t()}),3e4)}()},n.prototype._stopUltraSyncInterval=function(){-1!==this._ultraGroupTimer&&(clearTimeout(this._ultraGroupTimer),this._ultraGroupTimer=-1)},n.prototype._notificationOnline=function(){return oc(this,void 0,void 0,(function(){var e,t,n,r=this;return ic(this,(function(o){switch(o.label){case 0:return this._isConnected?[4,this._fetchUltraMsg(0)]:[2];case 1:return e=o.sent(),t=e.code,n=e.data,t===Ed.SUCCESS&&n?(this.logger.info(Dd.L_NOTIFY_ULTRA_ONLINE_S,"Notify ultra group online success."),this._getUltraGroupList(0),-1===this._ultraGroupTimer&&this._startUltraSyncInterval(),[2]):(this.logger.warn(Dd.L_NOTIFY_ULTRA_ONLINE_S,"Notify ultra group online failured, try again."),setTimeout((function(){r._notificationOnline()}),3e3),[2])}}))}))},n.prototype._fetchUltraMsg=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return t=this._connMgr.codec.encodeSuperSyncMsg(e),n=new $U(rL[rL.pullUgMsg],t,this.currentUserId),r=this.logger.createTraceId(),this.logger.info(Dd.L_PULL_ULTRA_MSG_T,JSON.stringify({timestamp:e}),r),[4,this._connMgr.send(n,KL,{currentUserId:this.currentUserId,conversation:{conversationType:Td.ULTRA_GROUP}})];case 1:return o=d.sent(),i=o.code,s=o.data,i===Ed.SUCCESS&&s?(a=s.list,c=s.syncTime,u=a.map((function(e){return e.messageUId})).join(","),this.logger.info(Dd.L_PULL_ULTRA_MSG_R,JSON.stringify({code:i,messageUIds:u,timestamp:e,syncTime:c}),r)):this.logger.warn(Dd.L_PULL_ULTRA_MSG_R,JSON.stringify({code:i,timestamp:e}),r),[2,{code:i,data:s}]}}))}))},n.prototype._syncUltraMsg=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d,l=this;return ic(this,(function(h){switch(h.label){case 0:return this._isConnected?this._isUltraPulling?[2]:(this._isUltraPulling=!0,[4,this._fetchUltraMsg(e)]):[2];case 1:return t=h.sent(),n=t.code,r=t.data,this._lastSyncUltraMsgLocalTimeStamp=Date.now(),this._isUltraPulling=!1,n===Ed.SUCCESS&&r?(o=r.list,i=r.syncTime,s=r.finished,a=[],c={},u=[],o.forEach((function(e){var t,n,r,o=e.targetId,s=e.content,d=e.messageType,h=e.messageUId,f=e.channelId,g=e.isCounted,p=e.channelType;e.isMentioned;var v=e.sentTime,_=e.senderUserId;if(a.push(h),l._ultraMsgMap[h])delete l._ultraMsgMap[h];else{var E=0;((null===(t=null==s?void 0:s.mentionedInfo)||void 0===t?void 0:t.type)===Ud.ALL||(null===(r=null===(n=null==s?void 0:s.mentionedInfo)||void 0===n?void 0:n.userIdList)||void 0===r?void 0:r.includes(l.currentUserId)))&&(E=1);var m=l._ultraGroupMap["".concat(f,"_").concat(o)];if(m)g&&_!==l.currentUserId&&(d===Cd.RECALL?m.unreadMessageCount>0&&(m.unreadMessageCount-=1):(m.unreadMessageCount+=1,m.unreadMentionedCount+=E,m.firstUnreadMessage||(m.firstUnreadMessage={sentTime:v}))),m.versionTime=i,m.latestMessage=e,m.channelType=p,c["".concat(f,"_").concat(o)]=m,l._ultraGroupManager.addUltraGroupStatus(m);else{var T={conversationType:Td.ULTRA_GROUP,targetId:o,channelId:f,unreadMessageCount:g&&_!==l.currentUserId?1:0,unreadMentionedCount:g&&_!==l.currentUserId?E:0,versionTime:i,latestMessage:e,notificationStatus:Od.CLOSE,notificationLevel:Ad.NOT_SET,isTop:!1,channelType:p,firstUnreadMessage:{sentTime:v}};l._ultraGroupMap["".concat(f,"_").concat(o)]=T,c["".concat(f,"_").concat(o)]=T,l._ultraGroupManager.addUltraGroupStatus(T)}u.push(e)}})),Object.keys(c).length>0&&(this.logger.debug(Dd.O,"notice ultragroups"),d=Object.values(c),d=aP(d),this._watcher.conversation(PE(d))),this.logger.debug(Dd.O,"notice ultragroup message"),this._batchMessage(u),this._ultraGroupTimeQue=this._ultraGroupTimeQue.filter((function(e){return e>i})),this._lastSyncUltraMsgTimeStamp=i,(!s||this._ultraGroupTimeQue.length>0)&&this._syncUltraMsg(i),[2]):[2]}}))}))},n.prototype.sendUltraMessage=function(t,n,r,o){return oc(this,void 0,void 0,(function(){var i,s,a,c,u,d,l,h,f,g,p;return ic(this,(function(v){switch(v.label){case 0:return this._isConnected?("RC:SRSMsg"===n.messageType&&this.logger.warn(Dd.O,"ultra group -> direction message convert to message"),n=this._handleMsgProperties(n,!0),i=n.messageId?n.messageId:OE(),n.messageId=i,s=this._connMgr.codec.encodeUpMsg({conversationType:Td.ULTRA_GROUP,targetId:t},n),(a=new ZU(rL[rL.ugMsg],s,t)).setHeaderQos(tU.AT_LEAST_ONCE),c=this._connMgr.getCrtServerTime(),u=sP(Td.ULTRA_GROUP,t,rc({},n),"",c,this.currentUserId,i),r&&r(i),this.logger.info(Dd.L_SEND_MSG_T,JSON.stringify({messageType:n.messageType,conversationType:Td.ULTRA_GROUP,targetId:t,channelId:n.channelId}),o),[4,this._connMgr.send(a)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return d=v.sent(),l=d.code,h=d.data,l!==Ed.SUCCESS?(this.logger.warn(Dd.L_SEND_MSG_R,JSON.stringify({code:l,messageUId:u.messageUId,messageId:u.messageId}),o),u.sentStatus=e.SentStatus.FAILED,[2,{code:l,data:u}]):(this.logger.info(Dd.L_SEND_MSG_R,JSON.stringify({code:l,messageUId:null==h?void 0:h.messageUId,messageId:null==h?void 0:h.messageId}),o),f=h,u.sentTime=f.timestamp,u.messageUId=f.messageUId,this._ultraMsgMap[f.messageUId]=f.timestamp,g=n.channelId||"",(p=this._ultraGroupMap["".concat(g,"_").concat(t)])?(p.latestMessage=u,il(p.channelType)&&(u.channelType=p.channelType)):(p={conversationType:Td.ULTRA_GROUP,targetId:t,channelId:g,unreadMessageCount:0,unreadMentionedCount:0,versionTime:u.sentTime,latestMessage:u,notificationStatus:Od.CLOSE,notificationLevel:Ad.NOT_SET,isTop:!1},this._ultraGroupMap["".concat(g,"_").concat(t)]=p,this._ultraGroupManager.addUltraGroupStatus(p)),this._watcher.conversation(PE([p])),[2,{code:l,data:u}])}}))}))},n.prototype.sendUltraGroupTypingStatus=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isConnected?(n=e.conversationType,r=e.channelId,o=e.targetId,i=this._connMgr.codec.encodeOperateStatus(o,n,r||"",t||0),(s=new ZU(rL[rL.operate],i,o)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(s)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return(a=c.sent().code)!==Ed.SUCCESS?[2,{code:a,msg:Ed[a]}]:[2,{code:a}]}}))}))},n.prototype.getUltraGroupMessageListByMessageUId=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return this._isConnected?e.messages&&e.messages.length<1||e.messages&&e.messages.length>20?[2,{code:Ed.MSG_LIMIT_ERROR}]:(t={},e.messages.forEach((function(e){t[e.messageUId]=void 0})),n=this._connMgr.codec.encodeMsgQuery(e),(r=new $U(rL[rL.qryMsg],n,this.currentUserId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(r,ab,{connectedTime:this._connMgr.getConnectedTime(),currentUserId:this.currentUserId})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return o=c.sent(),i=o.code,s=o.data,i!==Ed.SUCCESS?[2,{code:i,msg:Ed[i]}]:(a=(s||{}).list,Array.isArray(a)&&a.forEach((function(e){var n=e.messageUId;t[n]=e})),[2,{code:0,data:t}])}}))}))},n.prototype._pullOperateStatusNotify=function(e){if(this._isConnected){var t=this._connMgr.codec.decodeByPBName(e.data,ub),n=t.conversationType,r=t.info,o=t.summary;this.logger.debug(Dd.O,"s_opNtf -> type: ".concat(n,", info: ").concat(r,", summary: ").concat(o)),this._watcher.operateStatus(t)}},n.prototype.expandUltraMessage=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o;return ic(this,(function(i){switch(i.label){case 0:return this._isConnected?(t=this._connMgr.codec.encodeExpandUltraMessage(e,this.currentUserId),(n=new $U(rL[rL.upMsgEx],t,e.targetId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(n)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return r=i.sent(),o=r.code,r.data,o!==Ed.SUCCESS?[2,{code:o,msg:Ed[o]}]:[2,{code:o}]}}))}))},n.prototype.modifyMessage=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isConnected?(t=this._connMgr.codec.encodemodifyMessage(e,this.currentUserId),(n=new $U(rL[rL.modifyMsg],t,e.targetId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(n)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return r=a.sent(),o=r.code,i=r.data,o!==Ed.SUCCESS?[2,{code:o,msg:Ed[o]}]:(s=i,this._ultraMsgMap[s.messageUId]=s.timestamp,[2,{code:o}])}}))}))},n.prototype._pullUltraChangeMessageList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return this._isConnected?this._isPullingUltraChangeMessage?[2]:(this._isPullingUltraChangeMessage=!0,t=this._connMgr.codec.encodeQueryMsgChange(e),(n=new $U(rL[rL.qryMsgChange],t,this.currentUserId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(n,ob)]):[2];case 1:return r=l.sent(),o=r.code,i=r.data,this._isPullingUltraChangeMessage=!1,o===Ed.SUCCESS&&i?(s=i.hasNext,a=i.list,c=(null==i?void 0:i.syncTime)||0,this._ultraChannelTypeChangeNotice(a),this._ultraChannelUserKickedNotice(a),this._ultraChannelDeleteNotice(a),this._ultraRecalledNotice(a),this._ultraMsgUpdateNotice([Qd.MSG_EXPANSION,Qd.MSG_MODIFY],a),u=this._pullUltraChangeMessageQue.filter((function(e){return e>c})),this._pullUltraChangeMessageQue.length=0,(d=this._pullUltraChangeMessageQue).push.apply(d,u),s?this._pullUltraChangeMessageList(c):this._lastPullingUltraChangeMessageTime=c,[2]):[2]}}))}))},n.prototype._ultraChannelTypeChangeNotice=function(t){var n=this,r=[];t.forEach((function(t){var o=t.targetId,i=t.changeType,s=t.subChangeType,a=t.channelId,c=void 0===a?"":a;if(i===Qd.CHANNEL_CHANGE&&n._ultraGroupMap["".concat(c,"_").concat(o)]){var u=Wd.PUBLIC_TO_PRIVATE,d=Wd.PRIVATE_TO_PUBLIC,l=Wd.PUBLIC_TO_PRIVATE_USER_NOT_IN;s===d&&(n._ultraGroupMap["".concat(c,"_").concat(o)].channelType=e.UltraGroupChannelType.PUBLIC),s===u&&(n._ultraGroupMap["".concat(c,"_").concat(o)].channelType=e.UltraGroupChannelType.PRIVATE);var h=n._ultraGroupMap["".concat(c,"_").concat(o)].channelType,f=void 0===h?e.UltraGroupChannelType.PUBLIC:h;[u,d,l].includes(s)&&r.push({targetId:o,channelId:c,changeType:s,channelType:f}),s===l&&delete n._ultraGroupMap["".concat(c,"_").concat(o)]}})),r.length>0&&this._watcher.ultraGroupChannelChangeType(r)},n.prototype._ultraChannelDeleteNotice=function(t){var n=this,r=[];Array.isArray(t)&&t.forEach((function(t){var o=t.targetId,i=t.sendTime,s=t.changeType,a=t.subChangeType,c=t.channelId,u=void 0===c?"":c;if(s===Qd.CHANNEL_CHANGE&&n._ultraGroupMap["".concat(u,"_").concat(o)]){var d=n._ultraGroupMap["".concat(u,"_").concat(o)].channelType,l=void 0===d?e.UltraGroupChannelType.PUBLIC:d;a===Wd.CHANNEL_DELETE&&(r.push({targetId:o,channelId:u,channelType:l,deleteTime:i}),delete n._ultraGroupMap["".concat(u,"_").concat(o)])}})),r.length>0&&this._watcher.ultraGroupChannelDelete(r)},n.prototype._ultraChannelUserKickedNotice=function(t){var n=this,r=[];t.forEach((function(t){var o=t.targetId,i=t.changeType,s=t.operatorId,a=t.subChangeType,c=t.channelId,u=void 0===c?"":c;i===Qd.CHANNEL_CHANGE&&n._ultraGroupMap["".concat(u,"_").concat(o)]&&(a===Wd.CHANNEL_USER_KICKED&&r.push({targetId:o,channelId:u,userId:s,channelType:e.UltraGroupChannelType.PRIVATE}),s===n.currentUserId&&a===Wd.CHANNEL_USER_KICKED&&delete n._ultraGroupMap["".concat(u,"_").concat(o)])})),r.length>0&&this._watcher.ultraGroupChannelUserKicked(r)},n.prototype._ultraRecalledNotice=function(e){var t=this,n=[];e.forEach((function(e){var r=e.targetId,o=e.conversationType,i=e.sendTime,s=e.messageUId,a=e.changeType,c=e.operatorId,u=e.channelId,d=void 0===u?"":u;a===Qd.MSG_RECALL&&(t._updateUltraGroupWhenRecallMsg(r,d,s,i),n.push({targetId:r,conversationType:o,sendTime:i,messageUId:s,senderUserId:c,channelId:d}))})),n.length>0&&this._watcher.ultraGroupMessageRecalled(n)},n.prototype._ultraMsgUpdateNotice=function(e,t){var n=this;if(!!t.find((function(t){return e.includes(t.changeType)}))){var r={};t.forEach((function(t){var o=t.targetId,i=t.conversationType,s=t.sendTime,a=t.messageUId,c=t.changeType,u=t.channelId,d=void 0===u?"":u,l="".concat(i,"_").concat(o),h="".concat(a,"_").concat(d,"_").concat(s),f=r[l];if(f)f.add(h);else{var g=new Set([h]);r[l]=g}e.includes(c)&&(n._ultraMsgChangeMap[a]=c)}));var o=function(e){var t=e.split("_"),n=t.shift(),o=t.join("_"),s=r[e],a=[];s.forEach((function(e){var t=e.split("_"),n=t[0],r=t[1],o=t[2];a.push({sendTime:Number(o),messageUId:n,channelId:r})}));var c={targetId:o,conversationType:Number(n),messages:a};i._pullUltraMessageList(c)},i=this;for(var s in r)o(s)}},n.prototype._pullUltraMessageList=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u=this;return ic(this,(function(d){switch(d.label){case 0:return this._isConnected?(t=this._connMgr.codec.encodeMsgQuery(e),(n=new $U(rL[rL.qryMsg],t,this.currentUserId)).setHeaderQos(tU.AT_LEAST_ONCE),[4,this._connMgr.send(n,ab,{connectedTime:this._connMgr.getConnectedTime(),currentUserId:this.currentUserId})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return r=d.sent(),o=r.code,i=r.data,o!==Ed.SUCCESS?[2,{code:o,msg:Ed[o]}]:(s=(i||{}).list,a=[],c=[],Array.isArray(s)&&s.forEach((function(e){var t=e.targetId,n=e.channelId,r=e.messageUId,o=u._ultraGroupMap["".concat(n,"_").concat(t)];o&&o.latestMessage.messageUId===e.messageUId&&(o.latestMessage=e);var i=u._ultraMsgChangeMap["".concat(r)];i===Qd.MSG_EXPANSION?a.push(e):i===Qd.MSG_MODIFY&&c.push(e)})),a.length>0&&this._watcher.ultraGroupMessageExpansionUpdated(a||[]),c.length>0&&this._watcher.ultraGroupMessageModified(c||[]),[2])}}))}))},n.prototype.getUltraHistoryMsg=function(e,t,n){var r;return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return this._isConnected?(o=this._connMgr.codec.encodeGetHistoryMsg(e,t),i=new $U(rL[rL.qryUgMsg],o,this.currentUserId),this.logger.info(Dd.L_GET_HISTORY_MSG_T,JSON.stringify({targetId:e,conversationType:Td.ULTRA_GROUP,channelId:t.channelId,timestamp:null==t?void 0:t.timestamp,count:null==t?void 0:t.count}),n),[4,this._connMgr.send(i,zL,{currentUserId:this.currentUserId,conversation:{conversationType:Td.ULTRA_GROUP,targetId:e}})]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return s=d.sent(),a=s.code,c=s.data,a===Ed.SUCCESS&&c?(u=[],null===(r=c.list)||void 0===r||r.forEach((function(e){e&&u.push(e.messageUId)})),this.logger.info(Dd.L_GET_HISTORY_MSG_R,JSON.stringify({code:a,messageUIds:u.join(",")}),n),[2,{code:a,data:c}]):(this.logger.warn(Dd.L_GET_HISTORY_MSG_R,JSON.stringify({code:a,messageUIds:""}),n),[2,{code:a}])}}))}))},n.prototype.setUltraGroupDefaultNotificationLevel=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return this._isUltraGroupListExist?this._isConnected?(r=this._connMgr.codec.encodeSetUltraGroupDefaultNotificationLevel(t,n),o=new $U(rL[rL.ugUnpushSet],r,e),[4,this._connMgr.send(o)]):[2,{code:Ed.RC_NET_UNAVAILABLE}]:[2,Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE})];case 1:return i=a.sent(),s=i.code,Ed.SUCCESS,[2,{code:s}]}}))}))},n.prototype.getUltraGroupDefaultNotificationLevel=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._isUltraGroupListExist?this._isConnected?(n=this._connMgr,r=n.codec.encodeGetUltraGroupDefaultNotificationLevel(t),o=new $U(rL[rL.ugUnpushQuery],r,e),[4,n.send(o,Hw)]):[2,{code:Ed.RC_NET_UNAVAILABLE}]:[2,Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE})];case 1:return i=u.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?(c=a.unpushLevel,[2,{code:s,data:c}]):[2,{code:s}]}}))}))},n.prototype._updateUltraGroupWhenRecallMsg=function(e,t,n,r){var o="".concat(t,"_").concat(e);if(this._ultraGroupMap[o]){var i=this._ultraGroupMap[o],s=i.latestMessage;i.lastReadTime,s&&s.messageUId===n&&(i.latestMessage=null)}},n.prototype.getAllConversationState=function(){return Promise.resolve({code:Ed.SUCCESS,data:this._conversationManager.getAllConversationState()})},n.prototype.getUltraGroupUnreadMentionedMessages=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return this._isConnected?this._isUltraGroupListExist?(t=this._connMgr.codec.encodeUnreadMentionedMsgQuery(e),n=new $U(rL[rL.qryUgUal],t,this.currentUserId),[4,this._connMgr.send(n,Fw)]):[2,Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE})]:[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return r=s.sent(),o=r.code,i=r.data,o===Ed.SUCCESS&&i?[2,{code:o,data:i}]:[2,{code:o}]}}))}))},n.prototype.getUltraGroupFirstUnreadMessageTimestamp=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o;return ic(this,(function(i){return this._isConnected?this._isUltraGroupListExist?(t=e.targetId,n=e.channelId,r=this._ultraGroupMap["".concat(n,"_").concat(t)]||{},o=r.firstUnreadMessage||null,[2,{code:Ed.SUCCESS,data:o}]):[2,Promise.resolve({code:Ed.METHOD_NOT_AVAILABLE})]:[2,{code:Ed.RC_NET_UNAVAILABLE}]}))}))},n.prototype.bindRTCRoomForChatroom=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o;return ic(this,(function(i){switch(i.label){case 0:return this._isConnected?(t=e.chatRoomId,n=this._connMgr.codec.encodebindRTCRoomForChatroom(e),r=new $U(rL[rL.setRtcRoomId],n,t),[4,this._connMgr.send(r)]):[2,Ed.RC_NET_UNAVAILABLE];case 1:return o=i.sent(),[2,o.code]}}))}))},n.prototype.rtcSignaling=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._isConnected?(o=r instanceof ArrayBuffer?Array.prototype.slice.call(new Int8Array(r)):r,i=n?new $U(t,o,e):new ZU(t,o,e),[4,this._connMgr.send(i)]):[2,{code:Ed.RC_NET_UNAVAILABLE}];case 1:return s=u.sent(),a=s.code,c=s.data,[2,{code:a,buffer:null==c?void 0:c.data}]}}))}))},n.prototype.rtcPing=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return r=NT(this.rtcCodec,t,n),[4,this.rtcSignaling(e,rL[rL.rtcPing],!0,r)];case 1:return o=c.sent(),i=o.code,s=o.buffer,(a=s?this.rtcCodec.decode(tT.RtcOutput,s):null).version=TE(a.version),[2,{code:i,data:a}]}}))}))},n.prototype.getDeviceId=function(){return wL(this.runtime)},n.prototype.getOSInfo=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,{code:Ed.NOT_SUPPORT}]}))}))},n.prototype.getProcessInfo=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,{code:Ed.NOT_SUPPORT}]}))}))},n.prototype.getMainProcessInfo=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,{code:Ed.NOT_SUPPORT}]}))}))},n.prototype.destroy=function(){Nb()},n.prototype.callExtra=function(e){return Promise.resolve({code:Ed.EXTRA_METHOD_UNDEFINED})},n.prototype.getConversationListWithAllChannel=function(){throw new Error("Method not implemented.")},n.prototype.getConversationListWithAllChannelByPage=function(e,t){throw new Error("Method not implemented.")},n.prototype.getConversationsByPage=function(e,t,n,r){throw new Error("Method not implemented.")},n.prototype.getHistoryMessagesByObjectNames=function(e,t,n,r,o,i,s){throw new Error("Method not implemented.")},n.prototype.clearConversations=function(){throw new Error("Method not implemented.")},n.prototype.setUserStatusListener=function(e,t){throw new Error("Method not implemented.")},n.prototype.setUserStatus=function(e){throw new Error("Method not implemented.")},n.prototype.subscribeUserStatus=function(e){throw new Error("Method not implemented.")},n.prototype.getUserStatus=function(e){throw new Error("Method not implemented.")},n.prototype.addToBlacklist=function(e){throw new Error("Method not implemented.")},n.prototype.removeFromBlacklist=function(e){throw new Error("Method not implemented.")},n.prototype.getBlacklist=function(){throw new Error("Method not implemented.")},n.prototype.getBlacklistStatus=function(e){throw new Error("Method not implemented.")},n.prototype.insertMessage=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.batchInsertMessage=function(e,t){throw new Error("Method not implemented.")},n.prototype.getMessageCount=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.deleteMessages=function(e){throw new Error("Method not implemented.")},n.prototype.deleteMessagesByTimestamp=function(e,t,n,r,o){throw new Error("Method not implemented.")},n.prototype.clearMessages=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.getMessage=function(e){throw new Error("Method not implemented.")},n.prototype.setMessageContent=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.setMessageSearchField=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.searchConversationByContent=function(e,t,n,r){throw new Error("Method not implemented.")},n.prototype.searchConversationByContentWithAllChannel=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.searchMessageByContent=function(e,t,n,r,o,i){throw new Error("Method not implemented.")},n.prototype.searchMessageByContentWithAllChannel=function(e,t,n,r,o){throw new Error("Method not implemented.")},n.prototype.searchMessageByContentInTimeRangeWithAllChannel=function(e,t,n,r,o,i,s){throw new Error("Method not implemented.")},n.prototype.getUnreadMentionedMessages=function(e,t){throw new Error("Method not implemented.")},n.prototype.setMessageSentStatus=function(e,t){throw new Error("Method not implemented.")},n.prototype.updateMessageReceiptStatus=function(e,t,n,r){throw new Error("Method not implemented.")},n.prototype.setMessageReceivedStatus=function(e,t){throw new Error("Method not implemented.")},n.prototype.clearData=function(){throw new Error("Method not implemented.")},n.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){throw new Error("Method not implemented.")},n.prototype.setCallInfo=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.getGroupMessageDeliverList=function(e,t,n){throw new Error("Method not implemented.")},n.prototype.getPrivateMessageDeliverTime=function(e,t){throw new Error("Method not implemented.")},n.prototype.setCheckDuplicateMessage=function(e){throw new Error("Method not implemented.")},n.prototype.setProxy=function(e){return new Promise((function(e){e({code:Ed.NOT_SUPPORT})}))},n.prototype.getProxy=function(){return new Promise((function(e){e({code:Ed.NOT_SUPPORT})}))},n.prototype.testProxy=function(e,t){return new Promise((function(e){e({status:Ed.NOT_SUPPORT})}))},n}(MT),uP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nc(t,e),t.prototype.joinRTCRoom=function(e,t,n,r,o,i){return this._context.joinRTCRoom(e,t,n,r,o,i)},t.prototype.quitRTCRoom=function(e){return this._context.quitRTCRoom(e)},t.prototype.rtcPing=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){switch(r.label){case 0:return[4,this._context.rtcPing(e,t,n)];case 1:return[2,r.sent().code]}}))}))},t.prototype.rtcPingResVersion=function(e,t,n){return this._context.rtcPing(e,t,n)},t.prototype.getRTCRoomInfo=function(e){return this._context.getRTCRoomInfo(e)},t.prototype.getRTCUserInfoList=function(e){return this._context.getRTCUserInfoList(e)},t.prototype.getRTCUserInfo=function(e){return this._context.getRTCUserInfo(e)},t.prototype.setRTCUserInfo=function(e,t,n){return this._context.setRTCUserInfo(e,t,n)},t.prototype.removeRTCUserInfo=function(e,t){return this._context.removeRTCUserInfo(e,t)},t.prototype.setRTCData=function(e,t,n,r,o,i){return this._context.setRTCData(e,t,n,r,o,i)},t.prototype.setRTCTotalRes=function(e,t,n,r,o){return this._context.setRTCTotalRes(e,t,n,r,o)},t.prototype.setRTCCDNUris=function(e,t,n){return this._context.setRTCCDNUris(e,t,n)},t.prototype.getRTCData=function(e,t,n,r){return this._context.getRTCData(e,t,n,r)},t.prototype.removeRTCData=function(e,t,n,r,o){return this._context.removeRTCData(e,t,n,r,o)},t.prototype.setRTCOutData=function(e,t,n,r){return this._context.setRTCOutData(e,t,n,r)},t.prototype.getRTCOutData=function(e,t){return this._context.getRTCOutData(e,t)},t.prototype.getRTCToken=function(e,t,n){return this._context.getRTCToken(e,t,n)},t.prototype.setRTCState=function(e,t){return this._context.setRTCState(e,t)},t.prototype.getRTCUserList=function(e){return this._context.getRTCUserList(e)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._context.joinLivingRoomAsAudience(e,t,n)},t.prototype.quitLivingRoomAsAudience=function(e){return this._context.quitLivingRoomAsAudience(e)},t.prototype.rtcIdentityChange=function(e,t,n){return this._context.rtcIdentityChange(e,t,n)},t.prototype.requestRoomPK=function(e){return this._context.requestRoomPK(e)},t.prototype.cancelRoomPK=function(e){return this._context.cancelRoomPK(e)},t.prototype.responseRoomPK=function(e){return this._context.responseRoomPK(e)},t.prototype.endRoomPK=function(e){return this._context.endRoomPK(e)},t.prototype.registerRTCSignalListener=function(e){this._context.registerRTCSignalingListener(e)},t.prototype.rtcSignaling=function(e,t,n,r){return this._context.rtcSignaling(e,t,n,r)},t.prototype.getRTCJoinedUserInfo=function(e){return this._context.getRTCJoinedUserInfo(e)},t}(nA);function dP(e){return rc({},e)}var lP,hP,fP,gP=function(){function t(t,n){var r,o,i;this._runtime=t,this._token="",this._pluginContextQueue=[],this._pluginInstanseMap={},this._versionInfo={},this._typingInfo={},this._compatibleMessageProccessor=((r={})[Cd.CHATROOM_JOIN]=this._processChatrormMessage.bind(this),r[Cd.CHATROOM_LEFT]=this._processChatrormMessage.bind(this),r[Cd.CHATROOM_MERGE_CHANGE]=this._processChrmMemChangeMessage.bind(this),r[Cd.TYPING_STATUS]=this._processTypingStatusMessage.bind(this),r[Cd.INTERCEPT]=this._processInterceptMessage.bind(this),r),this._messageProccessor=((o={})[Cd.READ_RECEIPT]=this._processReadReceiptMessage.bind(this),o[Cd.READ_RECEIPT_REQUEST]=this._processReadReceiptRequestMessage.bind(this),o[Cd.READ_RECEIPT_RESPONSE]=this._processReadReceiptResponseMessage.bind(this),o),this._watcher={message:void 0,batchMessage:void 0,conversationState:void 0,chatroomState:void 0,connection:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0,pullFinished:void 0,readReceiptReceived:void 0,messageReceiptRequest:void 0,messageReceiptResponse:void 0,typingState:void 0,messageBlocked:void 0,ultraGroupEnable:void 0,operateStatus:void 0,ultraGroupMessageExpansionUpdated:void 0,ultraGroupMessageModified:void 0,ultraGroupMessageRecalled:void 0,messageDelivered:void 0,groupMessageDeliveredStatus:void 0,ultraGroupChannelChangeType:void 0,ultraGroupChannelUserKicked:void 0,ultraGroupChannelDelete:void 0},this._typingInternalTimer=-1,this._typingExpireTime=2e3,this._typingChangedList=[],this._registerMessageSearchPropsMapping={},this.getChatRoomHistoryMessages=this.getChatroomHistoryMessages,this._options=rc({},n),this.appkey=this._options.appkey,this._options.typingExpireTime&&(this._options.typingExpireTime<2e3?this._typingExpireTime=2e3:this._options.typingExpireTime>6e3?this._typingExpireTime=6e3:this._typingExpireTime=this._options.typingExpireTime),this._options.navigators=this._options.navigators.filter((function(e){return/^https?:\/\//.test(e)})),this._options.navigators=this._options.navigators.map((function(e){return e.replace(/\/$/g,"")})),0===this._options.navigators.length&&(i=this._options.navigators).push.apply(i,Ha);var s={onConnected:this._onConnectionStatusChange.bind(this,e.RCConnectionStatus.CONNECTED),onConnecting:this._onConnectionStatusChange.bind(this,e.RCConnectionStatus.CONNECTING),onSuspend:this._onConnectionStatusChange.bind(this,e.RCConnectionStatus.SUSPENDED),onDisconnected:this._onConnectionStatusChange.bind(this,e.RCConnectionStatus.DISCONNECTED),batchMessage:this._batchMessageReceiver.bind(this),chatroom:this._chatroomInfoListener.bind(this),conversation:this._conversationInfoListener.bind(this),expansion:this._expansionInfoListener.bind(this),tag:this._tagListener.bind(this),conversationTag:this._conversationTagListener.bind(this),onRTCDataChange:this._rtcDataChange.bind(this),pullFinished:this._pullFinishedListener.bind(this),ultraGroupEnable:this._ultraGroupEnableListener.bind(this),operateStatus:this._operateStatusListener.bind(this),ultraGroupMessageExpansionUpdated:this._ultraGroupMessageExpansionUpdatedListener.bind(this),ultraGroupMessageModified:this._ultraGroupMessageModifiedListener.bind(this),ultraGroupMessageRecalled:this._ultraGroupMessageRecalledListener.bind(this),messageDelivered:this._messageDeliveredListerer.bind(this),groupMessageDeliveredStatus:this._groupMessageDeliveredStatusListerer.bind(this),callInfo:this._callInfoListener.bind(this),ultraGroupChannelChangeType:this._ultraGroupChannelChangeTypeListener.bind(this),ultraGroupChannelUserKicked:this._ultraGroupChannelUserKickedListener.bind(this),ultraGroupChannelDelete:this._ultraGroupChannelDeleteListener.bind(this),onNaviDataChange:this._naviDataChange.bind(this)};this._rtcCodec=this.createCodec(ST,OT),this._engine=wE()?new RCCppEngine(t,this._rtcCodec,s,this._options):new cP(t,this._rtcCodec,s,this._options),this.logger=this._engine.getInnerLogger()}return t.init=function(e,n){return this._context?(this._context.logger.warn(Dd.A_INIT_REPEAT_O),this._context):(this._context=new t(e,n),this._context.logger.info(Dd.L_INIT_O,JSON.stringify({appkey:n.appkey,navigators:n.navigators,typingExpireTime:n.typingExpireTime})),this._context.logger.warn(Dd.L_IMSDK_VER_O,JSON.stringify({commitId:"198acd040765e3df6c49ede5d005fecdc6872348",version:"5.7.2"})),this._context)},t.destroy=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){switch(e.label){case 0:return this._context?(this._context.logger.info(Dd.L_DESTROY_O),[4,this._context._destroy()]):[2];case 1:return e.sent(),this._context=void 0,[2]}}))}))},t.prototype.createCodec=function(e,t){return new BN(e,t)},t.prototype.install=function(e,t){var n=this.logger.createTraceId();if(this.logger.info(Dd.L_INSTALL_PLUGIN_T,JSON.stringify({tag:e.tag}),n),this._pluginInstanseMap[e.tag])return this.logger.warn(Dd.L_INSTALL_PLUGIN_R,"repeat install",n),this._pluginInstanseMap[e.tag];var r="RCRTC"===e.tag?new uP(this):new nA(this),o=null;try{if(!e.verify(this._runtime))return null;o=e.setup(r,this._runtime,t)}catch(e){this.logger.error(Dd.L_INSTALL_PLUGIN_R,null==e?void 0:e.stack,n)}return["RCRTC","RCCall"].includes(e.tag)&&e.version&&e.name&&(this._versionInfo[e.name]=e.version),o&&(this._pluginContextQueue.push(r),this._pluginInstanseMap[e.tag]=o),o},t.prototype._onConnectionStatusChange=function(t,n){var r,o,i,s;this.logger.warn(Dd.A_CONNECT_S,"status: ".concat(t,", code: ").concat(n)),null===(o=(r=this._watcher).connection)||void 0===o||o.call(r,t,n),this._pluginContextQueue.forEach((function(e){var r;null===(r=e.onconnectionstatechange)||void 0===r||r.call(e,t,n)}));var a=t===e.RCConnectionStatus.CONNECTING||t===e.RCConnectionStatus.CONNECTED?t:n;null===(s=null===(i=this._watcher.rtcInnerWatcher)||void 0===i?void 0:i.status)||void 0===s||s.call(i,a)},t.prototype._processChatrormMessage=function(e){var t;if("function"==typeof this._watcher.chatroomState)return this._watcher.chatroomState({userChange:{users:(t={},t[e.senderUserId]="RC:ChrmQuitNtf"===e.messageType?kd.QUIT:kd.JOIN,t),chatroomId:e.targetId}}),!0},t.prototype._processChrmMemChangeMessage=function(e){if("function"==typeof this._watcher.chatroomState){var t={};Array.isArray(e.content.userList)&&e.content.userList.forEach((function(e){t[e.userId]=e.status})),this._watcher.chatroomState({userChange:{users:t,chatroomId:e.targetId}})}return!0},t.prototype._processTypingStatusMessage=function(e){if(this._addTypingInfo(dP(e)),this._watcher.typingState)return!0},t.prototype._processInterceptMessage=function(t){var n={conversationType:t.conversationType,targetId:t.targetId,channelId:t.channelId||"",blockType:t.content.interceptType,blockedMessageUId:t.content.msgUId,extra:t.content.extra};if(t.conversationType===Td.ULTRA_GROUP){var r=t.content.sourceType;if(n.sourceType=r,(r===e.MessageBlockSourceType.MSG_EXPANSION||r===e.MessageBlockSourceType.MSG_MODIFY)&&t.content.sourceContent)try{n.sourceContent=JSON.parse(t.content.sourceContent)}catch(e){this.logger.warn(Dd.L_CALLBACK_E,JSON.stringify({source:"message.content.sourceContent",msg:e.message}))}}return this._MessageBlockedListener(n),!0},t.prototype._processReadReceiptMessage=function(e){"function"==typeof this._watcher.readReceiptReceived&&this._watcher.readReceiptReceived({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.content.messageUId,e.content.lastMessageSendTime)},t.prototype._processReadReceiptRequestMessage=function(e){"function"==typeof this._watcher.messageReceiptRequest&&this._watcher.messageReceiptRequest({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.content.messageUId,e.senderUserId)},t.prototype._processReadReceiptResponseMessage=function(e){var t,n=null===(t=e.content)||void 0===t?void 0:t.receiptMessageDic,r=this._engine.getCurrentUserId();n&&Array.isArray(n[r])&&"function"==typeof this._watcher.messageReceiptResponse&&this._watcher.messageReceiptResponse({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.senderUserId,n[r])},t.prototype._messageReceiver=function(e,t,n){var r,o,i,s,a=this;if((e.conversationType===Td.RTC_ROOM||Object.prototype.hasOwnProperty.call(rl,e.messageType))&&this._watcher.rtcInnerWatcher&&this._watcher.rtcInnerWatcher.message)this._watcher.rtcInnerWatcher.message(dP(e));else if(!(null===(o=(r=this._compatibleMessageProccessor)[e.messageType])||void 0===o?void 0:o.call(r,e))&&!this._pluginContextQueue.some((function(t){if(!t.onmessage)return!1;try{return t.onmessage(dP(e))}catch(e){return a.logger.error(Dd.A_MSG_LISTENER_E,null==e?void 0:e.stack),!1}}))){if(null===(s=(i=this._watcher).message)||void 0===s||s.call(i,dP(e),t,n),!this._messageProccessor[e.messageType])return e;this._messageProccessor[e.messageType](e)}},t.prototype._batchMessageReceiver=function(e,t,n){var r=this,o=[];e.forEach((function(e){var i=r._messageReceiver(e,t,n);i&&o.push(i)})),o.length&&this._watcher.batchMessage&&(this.logger.debug(Dd.L_BATCH_MESSAGE_O,o.map((function(e){return e.messageUId})).join(",")),this._watcher.batchMessage(o))},t.prototype._chatroomInfoListener=function(e){var t,n;null===(n=(t=this._watcher).chatroomState)||void 0===n||n.call(t,e)},t.prototype._conversationInfoListener=function(e){var t,n;null===(n=(t=this._watcher).conversationState)||void 0===n||n.call(t,e)},t.prototype._expansionInfoListener=function(e){var t,n;null===(n=(t=this._watcher).expansion)||void 0===n||n.call(t,e)},t.prototype._tagListener=function(){var e,t;null===(t=(e=this._watcher).tag)||void 0===t||t.call(e)},t.prototype._conversationTagListener=function(){var e,t;null===(t=(e=this._watcher).conversationTagChanged)||void 0===t||t.call(e)},t.prototype._typingStatusListener=function(e){var t,n;null===(n=(t=this._watcher).typingState)||void 0===n||n.call(t,e)},t.prototype._pullFinishedListener=function(){var e,t;null===(t=(e=this._watcher).pullFinished)||void 0===t||t.call(e)},t.prototype._MessageBlockedListener=function(e){var t,n;null===(n=(t=this._watcher).messageBlocked)||void 0===n||n.call(t,e)},t.prototype._messageDeliveredListerer=function(e){var t,n;null===(n=(t=this._watcher).messageDelivered)||void 0===n||n.call(t,e)},t.prototype._groupMessageDeliveredStatusListerer=function(e){var t,n;null===(n=(t=this._watcher).groupMessageDeliveredStatus)||void 0===n||n.call(t,e)},t.prototype._callInfoListener=function(e){var t=this;this._pluginContextQueue.forEach((function(n){try{n.onCallInfo&&n.onCallInfo(e)}catch(e){t.logger.warn(Dd.L_CALLBACK_E,null==e?void 0:e.stack)}}))},t.prototype._ultraGroupEnableListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupEnable)||void 0===n||n.call(t,e)},t.prototype._operateStatusListener=function(e){var t,n;null===(n=(t=this._watcher).operateStatus)||void 0===n||n.call(t,e)},t.prototype._ultraGroupMessageExpansionUpdatedListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupMessageExpansionUpdated)||void 0===n||n.call(t,e)},t.prototype._ultraGroupMessageModifiedListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupMessageModified)||void 0===n||n.call(t,e)},t.prototype._ultraGroupMessageRecalledListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupMessageRecalled)||void 0===n||n.call(t,e)},t.prototype._ultraGroupChannelChangeTypeListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupChannelChangeType)||void 0===n||n.call(t,e)},t.prototype._ultraGroupChannelUserKickedListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupChannelUserKicked)||void 0===n||n.call(t,e)},t.prototype._ultraGroupChannelDeleteListener=function(e){var t,n;null===(n=(t=this._watcher).ultraGroupChannelDelete)||void 0===n||n.call(t,e)},t.prototype._rtcDataChange=function(e,t){this._pluginContextQueue.forEach((function(n){var r;null===(r=n.onrtcdatachange)||void 0===r||r.call(n,e,t)}))},t.prototype._naviDataChange=function(e){this._pluginContextQueue.forEach((function(t){var n;null===(n=t.onnavidatachange)||void 0===n||n.call(t,e)}))},t.prototype.assignWatcher=function(e){var t=this;Object.keys(this._watcher).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t._watcher[n]=dl(r)||ul(r)?r:void 0}}))},t.prototype._resetWatcher=function(){var e=this;Object.keys(this._watcher).forEach((function(t){e._watcher[t]=void 0}))},t.prototype._addTypingInfo=function(e){var t=e.senderUserId,n=e.conversationType,r=e.targetId,o=e.content,i=e.channelId,s=o.typingContentType,a=i||"",c="".concat(n,"#").concat(r,"#").concat(a);this._typingInfo[c]||(this._typingInfo[c]=[]);var u=this._typingInfo[c].findIndex((function(e){return e.userId===t}));u>=0&&this._typingInfo[c][u].messageType===s?this._typingInfo[c][u].timestamp=Date.now():(u>=0&&this._typingInfo[c].splice(u,1),this._typingInfo[c].push({userId:t,messageType:s,timestamp:Date.now()}),this._typingChangedList.includes(c)||this._typingChangedList.push(c),this._startCheckTypingInfo())},t.prototype._startCheckTypingInfo=function(){var e=this;-1===this._typingInternalTimer&&0!==Object.keys(this._typingInfo).length&&(this._typingInternalTimer=setInterval((function(){for(var t in e._typingInfo){var n=e._typingInfo[t].length;e._typingInfo[t]=e._typingInfo[t].filter((function(t){return Date.now()-t.timestamp<e._typingExpireTime})),e._typingInfo[t].length===n||e._typingChangedList.includes(t)||e._typingChangedList.push(t),0===e._typingInfo[t].length&&delete e._typingInfo[t]}if(e._typingChangedList.length>0){var r=e._typingChangedList.map((function(t){return{conversationType:Number(t.split("#")[0]),targetId:t.split("#")[1],channelId:t.split("#")[2],list:e._typingInfo[t]||[]}}));e._typingStatusListener(r),e._typingChangedList=[]}0===Object.keys(e._typingInfo).length&&(clearInterval(e._typingInternalTimer),e._typingInternalTimer=-1)}),500))},t.prototype.getConnectedTime=function(){return this._engine.getConnectedTime()},t.prototype.getServerTime=function(){return this._engine.getServerTime()},t.prototype.getDeviceId=function(){return this._engine.getDeviceId()},t.prototype.getCurrentUserId=function(){return this._engine.getCurrentUserId()},t.prototype.getConnectionStatus=function(){return this._engine.getConnectionStatus()},Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),t.prototype.refetchNaviInfo=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,this._engine.refetchNaviInfo()]}))}))},t.prototype.connect=function(e,t,n){var r,o;return oc(this,void 0,void 0,(function(){var i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return this._token=e,[4,this._engine.connect(e,t,n)];case 1:return i=u.sent(),s=i.code,a=i.data,s!==Ed.SUCCESS?[2,{code:s}]:(1!==this._engine.getNaviInfoFromCache().type&&(c=Eh.getInfo(),null===(o=(r=this._engine).reportSDKInfo)||void 0===o||o.call(r,c)),[2,{code:s,userId:a}])}}))}))},t.prototype.disconnect=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){switch(n.label){case 0:return clearInterval(this._typingInternalTimer),this._typingInternalTimer=-1,this._typingInfo={},[4,this._engine.disconnect(e)];case 1:return n.sent(),this._pluginContextQueue.forEach((function(e){if(e.ondisconnect)try{e.ondisconnect()}catch(e){t.logger.error(Dd.L_CALLBACK_E,null==e?void 0:e.stack)}})),[2,Promise.resolve()]}}))}))},t.prototype.reconnect=function(e){return this.connect(this.token,!!e,this.logger.createTraceId())},t.prototype._getTokenWithoutNavi=function(){return this._token.replace(/@.+$/,"@")},t.prototype.getNaviInfoFromCache=function(){return this._engine.getNaviInfoFromCache()},t.prototype.registerMessageType=function(e,t,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=!1),sl(r)&&r.length>0&&(this._registerMessageSearchPropsMapping[e]=r),this._engine.registerMessageType(e,t,n,r,o)},t.prototype.registerRTCSignalingListener=function(e){this._engine.registerRTCSignalingListener(e)},t.prototype.checkSearchPropsMsg=function(e,t){var n=this._registerMessageSearchPropsMapping[e],r={};return n&&ul(t)&&Object.keys(t).forEach((function(e){if(n.includes(e)){var o=t[e];il(o)&&(o>-Math.pow(2,64)&&o<Math.pow(2,64)&&Number.isInteger(o)||(r[e]=o))}})),Object.keys(r).length>0?{msg:JSON.stringify(r),code:Ed.SEARCH_PROPS_LIMIT_ERROR}:{code:Ed.SUCCESS}},t.prototype.sendMessage=function(e,t,n,r,o){var i=this.checkSearchPropsMsg(n.messageType,n.content),s=i.code,a=i.msg;if(s!==Ed.SUCCESS)return Promise.resolve({code:s,msg:a});if(e!==Td.ULTRA_GROUP){var c=this.getNaviInfoFromCache();if(1===((null==c?void 0:c.grpRRVer)||0)&&n.messageType===Cd.READ_RECEIPT_RESPONSE)return Promise.resolve({code:Ed.READ_RECEIPT_ERROR})}var u=n.canIncludeExpansion,d=void 0!==u&&u,l=n.expansion;if(d){var h=Tl(l),f=h.isIllgalEx,g=h.isExKeyOrValLengthExceedLimit;if(h.isExceedLimit||g)return Promise.resolve({code:Ed.EXPANSION_LIMIT_EXCEET});if(f)return Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER})}return function(e,t){void 0===t&&(t="utf-8");var n,r=0;if("utf-16"===t)for(var o=0,i=e.length;o<i;o++)r+=(n=e.charCodeAt(o))<=65535?2:4;else for(o=0,i=e.length;o<i;o++)r+=(n=e.charCodeAt(o))<127?1:n<=2047?2:n<=65535?3:4;return r}(JSON.stringify(n.content))>Ka?Promise.resolve({code:Ed.RC_MSG_CONTENT_EXCEED_LIMIT}):e===Td.ULTRA_GROUP?this._engine.sendUltraMessage(t,n,r,o):this._engine.sendMessage(e,t,n,r,o)},t.prototype.sendExpansionMessage=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a,c,u,d,l;return ic(this,(function(h){switch(h.label){case 0:return t=e.channelId,n=e.conversationType,r=e.targetId,o=e.messageUId,i=e.keys,s=e.expansion,a=e.removeAll,e.canIncludeExpansion?(c=Tl(s),u=c.isIllgalEx,d=c.isExKeyOrValLengthExceedLimit,c.isExceedLimit||d?[2,Promise.resolve({code:Ed.EXPANSION_LIMIT_EXCEET})]:u?[2,Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER})]:(l={mid:o},s&&(l.put=s),i&&(l.del=i),a&&(l.removeAll=1),[4,this._engine.sendMessage(n,r,{content:l,messageType:Cd.EXPANSION_NOTIFY,channelId:t})])):[2,{code:Ed.MESSAGE_KV_NOT_SUPPORT}];case 1:return[2,{code:h.sent().code}]}}))}))},t.prototype.sendReadReceiptMessage=function(e,t,n){return oc(this,void 0,void 0,(function(){var r;return ic(this,(function(o){return r=this.getNaviInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Ed.READ_RECEIPT_ERROR,msg:"The read receipt switch is not on, please call the sendMessage method!"}]:[2,this._engine.sendReadReceiptMessage(e,t,n)]}))}))},t.prototype.getMessageReader=function(e,t,n){return oc(this,void 0,void 0,(function(){var r;return ic(this,(function(o){return r=this.getNaviInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Ed.READ_RECEIPT_ERROR}]:[2,this._engine.getMessageReader(e,t,n)]}))}))},t.prototype._destroy=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){switch(t.label){case 0:return this._resetWatcher(),this._engine.destroy(),[4,this.disconnect()];case 1:return t.sent(),this._pluginContextQueue.forEach((function(t){if(t.ondestroy)try{t.ondestroy()}catch(t){e.logger.error(Dd.L_CALLBACK_E,null==t?void 0:t.stack)}})),this._pluginContextQueue.length=0,this._pluginInstanseMap={},[2]}}))}))},t.prototype.getHistoryMessage=function(e,t,n,r,o,i,s,a){if(void 0===n&&(n=0),void 0===r&&(r=20),void 0===o&&(o=0),void 0===i&&(i=""),void 0===s&&(s=""),e===Td.ULTRA_GROUP){var c={timestamp:n,count:r,order:o,channelId:i};return this._engine.getUltraHistoryMsg(t,c,a)}return this._engine.getHistoryMessage(e,t,n,r,o,i,s||"",a)},t.prototype.getHistoryMessagesByObjectNames=function(e,t,n,r,o,i,s){return this._engine.getHistoryMessagesByObjectNames(e,t,n,r,o,i,s)},t.prototype.getConversationList=function(e,t,n,r,o){if(void 0===e&&(e=300),void 0===o&&(o=""),t===Td.ULTRA_GROUP){var i=Ed.METHOD_NOT_SUPPORT;return Promise.resolve({code:i,msg:Ed[i]})}return this._engine.getConversationList(e,t,n,r,o)},t.prototype.getConversationsByPage=function(e,t,n,r){return this._engine.getConversationsByPage(e,t,n,r)},t.prototype.getConversation=function(e,t,n){return this._engine.getConversation(e,t,n)},t.prototype.removeConversation=function(e,t,n){return void 0===n&&(n=""),e===Td.ULTRA_GROUP?Promise.resolve(Ed.METHOD_NOT_SUPPORT):this._engine.removeConversation(e,t,n)},t.prototype.getUltraGroupList=function(e){return this._engine.getUltraGroupList(e)},t.prototype.getBlockUltraGroupList=function(){return this._engine.getBlockUltraGroupList()},t.prototype.getTopUltraGroupList=function(){return this._engine.getTopUltraGroupList()},t.prototype.clearUnreadCount=function(e,t,n){return void 0===n&&(n=""),e===Td.ULTRA_GROUP?this._engine.clearUltraUnreadcount(t,n):this._engine.clearConversationUnreadCount(e,t,n)},t.prototype.clearAllUnreadCount=function(){return this._engine.clearAllUnreadCount()},t.prototype.getUnreadCount=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationUnreadCount(e,t,n)},t.prototype.getTotalUnreadCount=function(e,t,n){if(t&&t.includes(Td.ULTRA_GROUP)){var r=Ed.METHOD_NOT_SUPPORT;return Promise.resolve({code:r,msg:Ed[r]})}return this._engine.getAllConversationUnreadCount(e,t&&t.length>0?t:[Td.PRIVATE,Td.GROUP,Td.SYSTEM,Td.PUBLIC_SERVICE],!!n)},t.prototype.getTotalUnreadCountByLevels=function(e,t,n){return this._engine.getTotalUnreadCountByLevels(e,t,n)},t.prototype.getFirstUnreadMessage=function(e,t,n){return void 0===n&&(n=""),this._engine.getFirstUnreadMessage(e,t,n)},t.prototype.setConversationNotificationLevel=function(e,t,n,r){return void 0===r&&(r=""),oc(this,void 0,void 0,(function(){var o;return ic(this,(function(i){return o=[{conversationType:e,targetId:t,notificationLevel:n,channelId:r}],[2,this._engine.batchSetConversationStatus(o)]}))}))},t.prototype.setConversationStatus=function(e,t,n,r,o){if(void 0===o&&(o=""),e===Td.ULTRA_GROUP&&void 0!==n)return Promise.resolve(Ed.METHOD_NOT_SUPPORT);var i=[{conversationType:e,targetId:t,isTop:n,notificationStatus:r,channelId:o}];return this._engine.batchSetConversationStatus(i)},t.prototype.saveConversationMessageDraft=function(e,t,n,r){return void 0===r&&(r=""),this._engine.saveConversationMessageDraft(e,t,n,r)},t.prototype.getConversationMessageDraft=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationMessageDraft(e,t,n)},t.prototype.clearConversationMessageDraft=function(e,t,n){return void 0===n&&(n=""),this._engine.clearConversationMessageDraft(e,t,n)},t.prototype.recallMessage=function(e,t,n,r,o){return this._engine.recallMsg(e,t,n,r,o)},t.prototype.deleteRemoteMessage=function(e,t,n,r){return void 0===r&&(r=""),e===Td.ULTRA_GROUP?Promise.resolve(Ed.METHOD_NOT_SUPPORT):this._engine.deleteRemoteMessage(e,t,n,r)},t.prototype.deleteRemoteMessageByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.deleteRemoteMessageByTimestamp(e,t,n,r)},t.prototype.joinChatroom=function(e,t,n){return void 0===t&&(t=10),this._engine.joinChatroom(e,t,n)},t.prototype.joinExistChatroom=function(e,t,n){return void 0===t&&(t=10),this._engine.joinExistChatroom(e,t,n)},t.prototype.quitChatroom=function(e){return this._engine.quitChatroom(e)},t.prototype.getChatroomInfo=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this._engine.getChatroomInfo(e,t,n)},t.prototype.setChatroomEntry=function(e,t){var n=t.key,r=t.value;return CE(n)&&SE(r)?this._engine.setChatroomEntry(e,t):Promise.resolve(Ed.BIZ_ERROR_INVALID_PARAMETER)},t.prototype.setChatroomEntries=function(e,t){for(var n=0;n<t.entries.length;n++){var r=t.entries[n],o=r.key,i=r.value;if(!CE(o)||!SE(i))return Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER})}var s=rc(rc({},t),{isOverwrite:t.isForce});return this._engine.setChatroomEntries(e,s)},t.prototype.forceSetChatroomEntry=function(e,t){var n=t.key,r=t.value;return CE(n)&&SE(r)?this._engine.forceSetChatroomEntry(e,t):Promise.resolve(Ed.BIZ_ERROR_INVALID_PARAMETER)},t.prototype.removeChatroomEntry=function(e,t){var n=t.key;return CE(n)?this._engine.removeChatroomEntry(e,t):Promise.resolve(Ed.BIZ_ERROR_INVALID_PARAMETER)},t.prototype.removeChatroomEntries=function(e,t){for(var n=0;n<t.entries.length;n++){var r=t.entries[n].key;if(!CE(r))return Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER})}return this._engine.removeChatroomEntries(e,t)},t.prototype.forceRemoveChatroomEntry=function(e,t){var n=t.key;return CE(n)?this._engine.forceRemoveChatroomEntry(e,t):Promise.resolve(Ed.BIZ_ERROR_INVALID_PARAMETER)},t.prototype.getChatroomEntry=function(e,t){return this._engine.getChatroomEntry(e,t)},t.prototype.getAllChatroomEntries=function(e){return this._engine.getAllChatroomEntry(e)},t.prototype.getChatroomHistoryMessages=function(e,t,n,r){return void 0===t&&(t=20),void 0===n&&(n=0),void 0===r&&(r=0),this._engine.getChatroomHistoryMessages(e,r,t,n)},t.prototype.getFileToken=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return o=this.getNaviInfoFromCache(),i=(null==o?void 0:o.bosAddr)||"",s=(null==o?void 0:o.uploadServer)||"",a=(null==o?void 0:o.ossConfig)||"",[4,this._engine.getFileToken(e,t,n,r)];case 1:return c=l.sent(),u=c.code,d=c.data,u===Ed.SUCCESS&&d?[2,Promise.resolve(Object.assign(d,{bos:i,qiniu:s,ossConfig:a}))]:[2,Promise.reject(u)]}}))}))},t.prototype.getFileUrl=function(e,t,n,r,o){return void 0===o&&(o=wd.QINIU),oc(this,void 0,void 0,(function(){var i,s,a;return ic(this,(function(c){switch(c.label){case 0:return(null==r?void 0:r.isBosRes)?[2,Promise.resolve(r)]:[4,this._engine.getFileUrl(e,o,t,n)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS?[2,Promise.resolve(a)]:[2,Promise.reject(s)]}}))}))},t.prototype.createTag=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.createTag(e)]}))}))},t.prototype.removeTag=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.removeTag(e)]}))}))},t.prototype.updateTag=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.updateTag(e)]}))}))},t.prototype.getTagList=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,this._engine.getTagList()]}))}))},t.prototype.addTagForConversations=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return t.length>1e3?[2,Promise.reject(Ed.CONVER_OUT_LIMIT_ERROR)]:[2,this._engine.addTagForConversations(e,t)]}))}))},t.prototype.removeTagForConversations=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.removeTagForConversations(e,t)]}))}))},t.prototype.removeTagsForConversation=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.removeTagsForConversation(e,t)]}))}))},t.prototype.getConversationListByTag=function(e,t,n,r){return oc(this,void 0,void 0,(function(){return ic(this,(function(o){return[2,this._engine.getConversationListByTag(e,t,n,r)]}))}))},t.prototype.getUnreadCountByTag=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.getUnreadCountByTag(e,t)]}))}))},t.prototype.setConversationStatusInTag=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.setConversationStatusInTag(e,t,n)]}))}))},t.prototype.getTagsForConversation=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.getTagsForConversation(e)]}))}))},t.prototype.getBlockConversationList=function(){return this._engine.getBlockConversationList()},t.prototype.getTopConversationList=function(e,t){return e&&0!==e.length||(e=[Td.PRIVATE,Td.CHATROOM,Td.GROUP,Td.SYSTEM,Td.APP_PUBLIC_SERVICE,Td.PUBLIC_SERVICE]),this._engine.getTopConversationList(e,t)},t.prototype.getUnreadConversationList=function(e){return e&&0!==e.length||(e=[Td.PRIVATE,Td.CHATROOM,Td.GROUP,Td.SYSTEM,Td.APP_PUBLIC_SERVICE,Td.PUBLIC_SERVICE]),this._engine.getUnreadConversationList(e)},t.prototype.getUnreadMentionedCount=function(e){return this._engine.getUnreadMentionedCount(e)},t.prototype.getAllUnreadMentionedCount=function(){return this._engine.getAllUnreadMentionedCount()},t.prototype.sendUltraGroupTypingStatus=function(e){if(e.conversationType!==Td.ULTRA_GROUP){var t=Ed.METHOD_ONLY_SUPPORT_ULTRA_GROUP;return Promise.resolve({code:t,msg:Ed[t]})}return this._engine.sendUltraGroupTypingStatus(e)},t.prototype.getUltraGroupMessageListByMessageUId=function(e){return this._engine.getUltraGroupMessageListByMessageUId(e)},t.prototype.expandUltraMessage=function(e){return oc(this,void 0,void 0,(function(){var t,n,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return e.channelId,t=e.conversationType,e.targetId,e.messageUId,e.keys,n=e.expansion,e.removeAll,r=e.canIncludeExpansion,t!==Td.ULTRA_GROUP?[2,{code:o=Ed.METHOD_ONLY_SUPPORT_ULTRA_GROUP,msg:Ed[o]}]:r?(i=Tl(n),s=i.isIllgalEx,a=i.isExKeyOrValLengthExceedLimit,i.isExceedLimit||a?[2,{code:Ed.EXPANSION_LIMIT_EXCEET}]:s?[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[4,this._engine.expandUltraMessage(e)]):[2,{code:Ed.MESSAGE_KV_NOT_SUPPORT}];case 1:return[2,{code:c.sent().code}]}}))}))},t.prototype.modifyMessage=function(e){return oc(this,void 0,void 0,(function(){var t;return ic(this,(function(n){switch(n.label){case 0:return e.conversationType!==Td.ULTRA_GROUP?[2,{code:t=Ed.METHOD_ONLY_SUPPORT_ULTRA_GROUP,msg:Ed[t]}]:[4,this._engine.modifyMessage(e)];case 1:return[2,{code:n.sent().code}]}}))}))},t.prototype.getUltraGroupUnreadMentionedCountByTargetId=function(e,t){return this._engine.getUltraGroupUnreadMentionedCountByTargetId(e,t)},t.prototype.getUltraGroupUnreadCountByTargetId=function(e,t){return this._engine.getUltraGroupUnreadCountByTargetId(e,t)},t.prototype.getAllUltraGroupUnreadCount=function(e){return void 0===e&&(e=!1),this._engine.getAllUltraGroupUnreadCount(e)},t.prototype.getAllConversationState=function(){return this._engine.getAllConversationState()},t.prototype.getUltraGroupUnreadMentionedMessages=function(e){return this._engine.getUltraGroupUnreadMentionedMessages(e)},t.prototype.getUltraGroupFirstUnreadMessageTimestamp=function(e){return this._engine.getUltraGroupFirstUnreadMessageTimestamp(e)},t.prototype.callExtra=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this._engine).callExtra.apply(t,sc([e],n,!1))},t.prototype.getOSInfo=function(){return this._engine.getOSInfo()},t.prototype.getProcessInfo=function(){return this._engine.getProcessInfo()},t.prototype.getMainProcessInfo=function(){return this._engine.getMainProcessInfo()},t.prototype.setCallInfo=function(e,t,n){return this._engine.setCallInfo(e,t,n)},t.prototype.getGroupMessageDeliverList=function(e,t,n){return void 0===n&&(n=""),this._engine.getGroupMessageDeliverList(e,t,n)},t.prototype.getPrivateMessageDeliverTime=function(e,t){return void 0===t&&(t=""),this._engine.getPrivateMessageDeliverTime(e,t)},t.prototype.clearConversations=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.clearConversations(e,t)]}))}))},t.prototype.setUserStatusListener=function(e,t){var n=this;return this._engine.setUserStatusListener(e,(function(e){try{t(e)}catch(e){n.logger.error(Dd.L_CALLBACK_E,null==e?void 0:e.stack)}}))},t.prototype.addToBlacklist=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.addToBlacklist(e)]}))}))},t.prototype.removeFromBlacklist=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.removeFromBlacklist(e)]}))}))},t.prototype.getBlacklist=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,this._engine.getBlacklist()]}))}))},t.prototype.getBlacklistStatus=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.getBlacklistStatus(e)]}))}))},t.prototype.insertMessage=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i;return ic(this,(function(s){return r=this.checkSearchPropsMsg(n.messageType,n.content),o=r.code,i=r.msg,o!==Ed.SUCCESS?[2,Promise.resolve({code:o,msg:i})]:[2,this._engine.insertMessage(e,t,n)]}))}))},t.prototype.batchInsertMessage=function(e,t){return this._engine.batchInsertMessage(e,t)},t.prototype.getMessageCount=function(e,t,n){return void 0===n&&(n=""),oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.getMessageCount(e,t,n)]}))}))},t.prototype.deleteMessages=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.deleteMessages(e)]}))}))},t.prototype.deleteMessagesByTimestamp=function(e,t,n,r,o){return void 0===o&&(o=""),oc(this,void 0,void 0,(function(){return ic(this,(function(i){return[2,this._engine.deleteMessagesByTimestamp(e,t,n,r,o)]}))}))},t.prototype.clearMessages=function(e,t,n){return void 0===n&&(n=""),oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.clearMessages(e,t,n)]}))}))},t.prototype.getMessage=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.getMessage(e)]}))}))},t.prototype.setMessageContent=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.setMessageContent(e,t,n)]}))}))},t.prototype.setMessageSearchField=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.setMessageSearchField(e,t,n)]}))}))},t.prototype.setMessageSentStatus=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.setMessageSentStatus(e,t)]}))}))},t.prototype.setMessageReceivedStatus=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return[2,this._engine.setMessageReceivedStatus(e,t)]}))}))},t.prototype.setMessageStatusToRead=function(e,t,n,r){return oc(this,void 0,void 0,(function(){return ic(this,(function(o){return[2,this._engine.updateMessageReceiptStatus(e,t,n,r)]}))}))},t.prototype.setUserStatus=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.setUserStatus(e)]}))}))},t.prototype.subscribeUserStatus=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.subscribeUserStatus(e)]}))}))},t.prototype.getUserStatus=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return[2,this._engine.getUserStatus(e)]}))}))},t.prototype.searchConversationByContent=function(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=""),oc(this,void 0,void 0,(function(){return ic(this,(function(o){return[2,this._engine.searchConversationByContent(e,t,n,r)]}))}))},t.prototype.searchConversationByContentWithAllChannel=function(e,t,n){return void 0===t&&(t=[]),oc(this,void 0,void 0,(function(){return ic(this,(function(r){return[2,this._engine.searchConversationByContentWithAllChannel(e,t,n)]}))}))},t.prototype.searchMessageByContent=function(e,t,n,r,o,i,s){return void 0===s&&(s=""),oc(this,void 0,void 0,(function(){return ic(this,(function(a){return[2,this._engine.searchMessageByContent(e,t,n,r,o,i,s)]}))}))},t.prototype.searchMessageByContentWithAllChannel=function(e,t,n,r,o){return oc(this,void 0,void 0,(function(){return ic(this,(function(i){return[2,this._engine.searchMessageByContentWithAllChannel(e,t,n,r,o)]}))}))},t.prototype.searchMessageByContentInTimeRangeWithAllChannel=function(e,t,n,r,o,i,s){return oc(this,void 0,void 0,(function(){return ic(this,(function(a){return[2,this._engine.searchMessageByContentInTimeRangeWithAllChannel(e,t,n,r,o,i,s)]}))}))},t.prototype.getUnreadMentionedMessages=function(e,t,n){return void 0===n&&(n=""),this._engine.getUnreadMentionedMessages(e,t,n)},t.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.clearUnreadCountByTimestamp(e,t,n,r)},t.prototype.getUltraGroupDefaultNotificationLevel=function(e,t){return void 0===t&&(t=""),this._engine.getUltraGroupDefaultNotificationLevel(e,t)},t.prototype.setUltraGroupDefaultNotificationLevel=function(e,t,n){return void 0===n&&(n=""),this._engine.setUltraGroupDefaultNotificationLevel(e,t,n)},t.prototype.getConversationNotificationLevel=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationNotificationLevel(e,t,n)},t.prototype.getConversationNotificationStatus=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationNotificationStatus(e,t,n)},t.prototype.getRemoteHistoryMessages=function(e,t,n,r,o,i){return this._engine.getRemoteHistoryMessages(e,t,n,r,o,i)},t.prototype.getConversationListWithAllChannel=function(){return this._engine.getConversationListWithAllChannel()},t.prototype.getConversationListWithAllChannelByPage=function(e,t){return this._engine.getConversationListWithAllChannelByPage(e,t)},t.prototype.clearData=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,this._engine.clearData()]}))}))},t.prototype.createLogger=function(e,t){return this._engine.createLogger(e,t)},t.prototype.setCheckDuplicateMessage=function(e){return this._engine.setCheckDuplicateMessage(e)},t.prototype.rtcSignaling=function(e,t,n,r){return this._engine.rtcSignaling(e,t,n,r)},t.prototype.joinRTCRoom=function(e,t,n,r,o,i){return this._engine.joinRTCRoom(e,t,n,r,o,i)},t.prototype.quitRTCRoom=function(e){return this._engine.quitRTCRoom(e)},t.prototype.rtcPing=function(e,t,n){return this._engine.rtcPing(e,t,n)},t.prototype.getRTCRoomInfo=function(e){return this._engine.getRTCRoomInfo(e)},t.prototype.getRTCUserInfoList=function(e){return this._engine.getRTCUserInfoList(e)},t.prototype.getRTCUserInfo=function(e){return this._engine.getRTCUserInfo(e)},t.prototype.setRTCUserInfo=function(e,t,n){return this._engine.setRTCUserInfo(e,t,n)},t.prototype.removeRTCUserInfo=function(e,t){return this._engine.removeRTCUserInfo(e,t)},t.prototype.setRTCData=function(e,t,n,r,o,i){return this._engine.setRTCData(e,t,n,r,o,i)},t.prototype.setRTCTotalRes=function(e,t,n,r,o){return void 0===o&&(o=""),this._engine.setRTCTotalRes(e,t,n,r,o)},t.prototype.setRTCCDNUris=function(e,t,n){return this._engine.setRTCCDNUris(e,t,n)},t.prototype.getRTCData=function(e,t,n,r){return this._engine.getRTCData(e,t,n,r)},t.prototype.removeRTCData=function(e,t,n,r,o){return this._engine.removeRTCData(e,t,n,r,o)},t.prototype.setRTCOutData=function(e,t,n,r){return this._engine.setRTCOutData(e,t,n,r)},t.prototype.getRTCOutData=function(e,t){return this._engine.getRTCOutData(e,t)},t.prototype.getRTCToken=function(e,t,n){return this._engine.getRTCToken(e,t,n)},t.prototype.setRTCState=function(e,t){return this._engine.setRTCState(e,t)},t.prototype.getRTCUserList=function(e){return this._engine.getRTCUserList(e)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._engine.joinLivingRoomAsAudience(e,t,n)},t.prototype.quitLivingRoomAsAudience=function(e){return this._engine.quitLivingRoomAsAudience(e)},t.prototype.rtcIdentityChange=function(e,t,n){return this._engine.rtcIdentityChange(e,t,n)},t.prototype.getRTCJoinedUserInfo=function(e){return this._engine.getRTCJoinedUserInfo(e)},t.prototype.requestRoomPK=function(e){return this._engine.requestRoomPK(e)},t.prototype.cancelRoomPK=function(e){return this._engine.cancelRoomPK(e)},t.prototype.responseRoomPK=function(e){return this._engine.responseRoomPK(e)},t.prototype.endRoomPK=function(e){return this._engine.endRoomPK(e)},t.prototype.bindRTCRoomForChatroom=function(e){return this._engine.bindRTCRoomForChatroom(e)},t.prototype.setProxy=function(e){return this._engine.setProxy(e)},t.prototype.getProxy=function(){return this._engine.getProxy()},t.prototype.testProxy=function(e,t){return this._engine.testProxy(e,t)},t}();!function(e){e.GET="GET",e.POST="POST"}(lP||(lP={})),function(e){e.WIFI="wifi",e.FOUR_G="4g",e.THREE_G="3g",e.TWO_G="2g",e.FIVE_G="2g",e.THREE_GENT="3gnet",e.UNKONWN="unknown"}(hP||(hP={})),function(e){e[e.add=1]="add",e[e.update=2]="update",e[e.delete=3]="delete"}(fP||(fP={}));var pP=Za,vP=Object.freeze({__proto__:null,DelayTimer:BE,AEngine:MT,Codec:BN,version:pP,APIContext:gP,PluginContext:nA,RTCPluginContext:uP,get StoreKeys(){return Kd},get UltraGroupChannelType(){return e.UltraGroupChannelType},get UltraGroupChannelChangeType(){return e.UltraGroupChannelChangeType},get UltraMsgChangeType(){return Qd},get UltraMsgSubChangeType(){return Wd},get RTCMode(){return Zd},get LiveType(){return zd},get LiveRole(){return Xd},CallLibMsgType:rl,get RTCApiType(){return el},get RTCIdentityChangeType(){return tl},get RTCJoinType(){return nl},FileType:gd,MessageDirection:vd,ErrorCode:Ed,ConversationType:Td,ConnectionStatus:yd,ReceivedStatus:to,MessageType:Cd,NotificationStatus:Od,NotificationLevel:Ad,MentionedType:Ud,UploadMethod:wd,ChatroomEntryType:Vd,get LogLevel(){return e.LogLevel},get LogSource(){return Pd},get LogTagId(){return Dd},ChatroomUserChangeType:kd,MessageBlockType:Hd,get MessageBlockSourceType(){return e.MessageBlockSourceType},OperateStatus:$d,get SentStatus(){return e.SentStatus},get HttpMethod(){return lP},get NetworkType(){return hP},get TagChangeType(){return fP},isString:ol,isBoolean:function(e){return"boolean"==typeof e},isNumber:il,isArray:sl,isArrayBuffer:al,notEmptyString:cl,notEmptyArray:function(e){return sl(e)&&e.length>0},isObject:ul,isFunction:dl,isUndefined:ll,isNull:hl,isHttpUrl:fl,notEmptyObject:gl,isValidConversationType:pl,isValidNotificationLevel:vl,isValidChannelId:_l,isTypeInConversationList:El,isValidFileType:ml,isValidExpansion:Tl,engineLogger:Mh,Logger:Ah,logger:Nh,getUUID:Qh,getUUID22:Wh,get AssertRules(){return Jh},RCAssertError:df,assert:lf,validate:hf,getUploadFileName:IE,getMimeKey:function(e){var t="application/octet-stream";switch(e){case gd.IMAGE:t="image/jpeg";break;case gd.AUDIO:t="audio/amr";break;case gd.VIDEO:t="video/3gpp";break;case gd.SIGHT:t="video/mpeg4";break;case gd.COMBINE_HTML:t="text/html"}return t},pushConfigsToJSON:yE,pushJSONToConfigs:RE,isValidChrmEntryKey:CE,isValidChrmEntryValue:SE,getClientMessageId:OE,AppStorage:ec,todo:function(e){return new ac(e)},appendUrl:Zc,EventEmitter:th,VersionManage:Eh,forEach:NE,map:AE,indexOf:ME,isInclude:function(e,t){return-1!==ME(e,t)},isInObject:UE,cloneByJSON:LE,usingCppEngine:wE,getBrowser:function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,o={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var i in o)if(o.hasOwnProperty(i)){var s=r.match(o[i]);if(s){n=i,t=s[1]||s[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}},clone:PE,NAVI_CACHE_DURATION:ka,HTTP_TIMEOUT:Fa,NAVI_REQ_TIMEOUT:1e4,WEB_SOCKET_TIMEOUT:5e3,PUBLIC_CLOUD_NAVI_URIS:Ha,MINI_SOCKET_CONNECT_URIS:qa,IM_SIGNAL_TIMEOUT:3e4,IM_PING_INTERVAL_TIME:15e3,IM_PING_TIMEOUT:15e3,IM_PING_MIN_TIMEOUT:2e3,MAX_MESSAGE_CONTENT_BYTES:Ka,IM_CHATROOM_PULL_INTERVAL_TIME:ja,STORAGE_ROOT_KEY:Ya,MAX_MESSAGE_EXPANSION_KEY_LENGTH:32,MAX_MESSAGE_EXPANSION_VAL_LENGTH:4096,SEND_MESSAGE_TYPE_OPTION:Ja,CPP_PROTOCAL_MSGTYPE_OPTION:{"RC:DizNtf":{isCounted:!1,isPersited:!1}},STATUS_MESSAGE:Qa,REAT_TIME_LOG_SIZE:20971520,DB_LOG_MAX_SIZE:1e5,DB_LOG_FLUSH_FREQUENCY:3e3,ONE_LOG_SIZE_MAX:1e3,DEFAULT_LOG_POLICY:Wa,VERSION:Za,FORMATED_VERSION:za,BasicLogger:Tb,IndexDBLogger:kb,BasicReporter:Fb,IndexDBReporter:Xb,get LogL(){return e.LogL},initLogDB:Ob,deInitLogDB:Nb,transcsv:zb,BasicNavi:NL,WebSocketNavi:ML,AConnectionMgr:rP,get RCConnectionStatus(){return e.RCConnectionStatus},isConnnectAck:function(e){return Object.keys(tP).some((function(t){return tP[t]===e}))},isDisconnectedByServer:function(e){return Object.keys(eP).some((function(t){return eP[t]===e}))}});("undefined"!=typeof globalThis?globalThis:global||self).RCEngine=vP;var _P=function(){return!("undefined"==typeof uni||!function(e){for(var t=["request","getSystemInfo"],n=0,r=t.length;n<r;n++)if(!e[t[n]])return!1;return!0}(uni))},EP=_P();var mP,TP={tag:"browser",httpReq:function(e){var t=e.method||lP.GET,n=e.timeout||Fa,r=e.headers,o=e.query,i=e.body,s=Zc(e.url,o);return new Promise((function(e){var o,a=(o="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&o?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),c="[object XDomainRequest]"===Object.prototype.toString.call(a);if(a.open(t,s),r&&a.setRequestHeader)for(var u in r)a.setRequestHeader(u,r[u]);if(c){a.timeout=n,a.onload=function(){e({data:a.responseText,status:a.status||200})},a.onerror=function(){e({status:a.status||0})},a.ontimeout=function(){e({status:a.status||0})};var d="object"===no(i)?JSON.stringify(i):i;a.send(d)}else a.onreadystatechange=function(){4===a.readyState&&e({data:a.responseText,status:a.status})},a.onerror=function(){e({status:a.status||0})},setTimeout((function(){a.abort(),e({status:a.status||0})}),n),a.send(i)}))},localStorage:null===window||void 0===window?void 0:window.localStorage,sessionStorage:null===window||void 0===window?void 0:window.sessionStorage,useNavi:!0,connectPlatform:"",isFromUniapp:EP,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,r=t.reason;e(n,r)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close()}}},getNetworkType:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e.type,n=e.effectiveType,r=t||n||hP.UNKONWN;return new Promise((function(e){e(r)}))}},IP=_P(),yP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return wx[e].apply(wx,t)}catch(e){null===console||void 0===console||console.error(e)}}},RP={setItem:yP("setStorageSync"),getItem:yP("getStorageSync"),removeItem:yP("removeStorageSync"),clear:yP("clearStorageSync")},CP={tag:"wechat",httpReq:function(e){var t=e.method||lP.GET,n=e.timeout||Fa,r=e.headers,o=e.query,i=e.body,s=Zc(e.url,o);return new Promise((function(e){wx.request({url:s,method:t,header:r,timeout:n,data:i,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:Ed.RC_HTTP_REQ_FAIL})}})}))},localStorage:RP,sessionStorage:RP,useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:IP,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},getNetworkType:function(){return new Promise((function(e){wx.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))}},SP=_P(),OP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{if("setStorageSync"===e)return my[e]({key:t[0],data:JSON.parse(t[1])});if("clearStorageSync"===e)return my[e]();if("removeStorageSync"===e)return my[e]({key:t[0]});var r=my[e]({key:t[0]}).data;return r?JSON.stringify(r):r}catch(e){}}},NP={setItem:OP("setStorageSync"),getItem:OP("getStorageSync"),removeItem:OP("removeStorageSync"),clear:OP("clearStorageSync")},AP={tag:"alipay",httpReq:function(e){var t=e.method||lP.GET,n=e.timeout||Fa,r=e.headers,o=e.query,i=e.body,s=Zc(e.url,o),a=e.dataType||"json";return new Promise((function(e){my.request({url:s,method:t,headers:r,timeout:n,data:i,dataType:a,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:Ed.RC_HTTP_REQ_FAIL})}})}))},localStorage:NP,sessionStorage:NP,useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:SP,createWebSocket:function(e){return my.connectSocket({url:e}),{onClose:function(e){my.onSocketClose(e)},onError:function(e){my.onSocketError((function(t){e(t.errMsg)}))},onMessage:function(e){my.onSocketMessage((function(t){t.isBuffer?e(my.base64ToArrayBuffer(t.data)):e(t.data)}))},onOpen:function(e){my.onSocketOpen(e)},send:function(e){my.sendSocketMessage({data:my.arrayBufferToBase64(e),isBuffer:!0})},close:function(){my.closeSocket()}}},getNetworkType:function(){return new Promise((function(e){my.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))}},MP=_P(),UP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return tt[e].apply(tt,t)}catch(e){}}},LP={setItem:UP("setStorageSync"),getItem:UP("getStorageSync"),removeItem:UP("removeStorageSync"),clear:UP("clearStorageSync")},wP={tag:"toutiao",useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:MP,localStorage:LP,sessionStorage:LP,httpReq:function(e){return new Promise((function(t){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){t({status:Ed.RC_HTTP_REQ_FAIL})}})}))},createWebSocket:function(e,t){var n=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},getNetworkType:function(){return new Promise((function(e){tt.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))}},bP=_P(),PP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return swan[e].apply(swan,t)}catch(e){}}},DP={setItem:PP("setStorageSync"),getItem:PP("getStorageSync"),removeItem:PP("removeStorageSync"),clear:PP("clearStorageSync")},BP={tag:"baidu",useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:bP,localStorage:DP,sessionStorage:DP,httpReq:function(e){return new Promise((function(t,n){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){t({status:Ed.RC_HTTP_REQ_FAIL})}})}))},createWebSocket:function(e,t){var n=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},getNetworkType:function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,new Promise((function(e){swan.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))]}))}))}},VP=_P(),xP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return jd[e].apply(jd,t)}catch(e){null===console||void 0===console||console.error(e)}}},GP={setItem:xP("setStorageSync"),getItem:xP("getStorageSync"),removeItem:xP("removeStorageSync"),clear:xP("clearStorageSync")},kP={tag:"jingdong",httpReq:function(e){var t=e.method||lP.GET,n=e.timeout||Fa,r=e.headers,o=e.query,i=e.body,s=Zc(e.url,o);return new Promise((function(e){jd.request({url:s,method:t,headers:r,timeout:n,data:i,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:Ed.RC_HTTP_REQ_FAIL})}})}))},localStorage:GP,sessionStorage:GP,useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:VP,createWebSocket:function(e,t){return jd.connectSocket({url:e,protocols:t}),{onClose:function(e){jd.onSocketClose((function(t){e(t.code,t.reason)}))},onError:function(e){jd.onSocketError((function(t){e(t.errMsg)}))},onMessage:function(e){jd.onSocketMessage((function(t){e(t.data)}))},onOpen:function(e){jd.onSocketOpen(e)},send:function(e){jd.sendSocketMessage({data:e})},close:function(e,t){jd.closeSocket({code:e,reason:t})}}},getNetworkType:function(){return new Promise((function(e){jd.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))}},FP=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return uni[e].apply(uni,t)}catch(e){null===console||void 0===console||console.error(e)}}},HP={setItem:FP("setStorageSync"),getItem:FP("getStorageSync"),removeItem:FP("removeStorageSync"),clear:FP("clearStorageSync")},qP={tag:"uniapp",httpReq:function(e){var t=e.method||lP.GET,n=e.timeout||Fa,r=e.headers,o=e.query,i=e.body,s=Zc(e.url,o);return new Promise((function(e){uni.request({url:s,method:t,header:r,timeout:n,data:i,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:Ed.RC_HTTP_REQ_FAIL})}})}))},localStorage:HP,sessionStorage:HP,useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},r=uni.connectSocket(n);return{onClose:function(e){r.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){e(t.data)}))},onOpen:function(e){r.onOpen(e)},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},getNetworkType:function(){return new Promise((function(e){uni.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(hP.UNKONWN)}})}))}},KP=function(e){return e&&e.request&&e.getSystemInfo},jP="undefined"!=typeof uni&&KP(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return qP;case"mp-jd":return kP;case"mp-baidu":return BP;case"mp-toutiao":return wP;case"mp-alipay":return AP;case"mp-weixin":return CP;default:return TP}}():"undefined"!=typeof jd&&KP(jd)?kP:"undefined"!=typeof my&&KP(my)?AP:"undefined"!=typeof tt&&KP(tt)?wP:"undefined"!=typeof swan&&KP(swan)?BP:"undefined"!=typeof wx&&KP(wx)?CP:TP;function YP(e){var t=e.conversationType,n=e.channelId,r=e.messageType,o=e.content,i=e.senderUserId,s=e.targetId,a=e.sentTime,c=e.receivedTime,u=e.messageUId,d=e.messageDirection,l=e.isPersited,h=e.isCounted,f=e.isOffLineMessage,g=e.canIncludeExpansion,p=e.expansion,v=e.receivedStatus,_=e.disableNotification,E=e.isMentioned,m=e.isStatusMessage,T=e.readReceiptInfo,I=e.pushConfig,y=e.messageId,R=e.isInterrupt,C=e.isModifyMessage,S=e.channelType,O=e.sentStatus;v||(v=to.UNREAD);var N={messageType:r,channelId:n||"",content:o,senderUserId:i,targetId:s,conversationType:t,sentTime:a,receivedTime:c,messageUId:u,messageDirection:d,isPersited:l,isCounted:h,isMentioned:E,disableNotification:_,isStatusMessage:m,canIncludeExpansion:g,expansion:p,receivedStatus:v,readReceiptInfo:T,pushConfig:I,messageId:y,isInterrupt:R,isModifyMessage:C,sentStatus:O};return t!==Td.ULTRA_GROUP&&(N.isOffLineMessage=f),t===Td.ULTRA_GROUP&&il(S)&&(N.channelType=S),N}function JP(e){var t=e.conversationType,n=e.targetId,r=e.latestMessage,o=e.unreadMessageCount,i=e.hasMentioned,s=e.mentionedInfo,a=e.lastUnreadTime,c=e.notificationStatus,u=e.notificationLevel,d=e.isTop,l=e.channelId,h=e.unreadMentionedCount,f=e.matchCount;return{conversationType:t,targetId:n,latestMessage:r&&YP(r),unreadMessageCount:o,hasMentioned:i,mentionedInfo:i?{type:null==s?void 0:s.type,userIdList:null==s?void 0:s.userIdList}:void 0,lastUnreadTime:a,notificationStatus:c,notificationLevel:u,isTop:d,channelId:l,unreadMentionedCount:h,matchCount:f}}function QP(e,t){null===console||void 0===console||console.warn("Method '".concat(e,"' is deprecated, please use '").concat(t,"' instead"))}e.Events=void 0,(mP=e.Events||(e.Events={})).CONNECTING="CONNECTING",mP.CONNECTED="CONNECTED",mP.DISCONNECT="DISCONNECT",mP.SUSPEND="SUSPEND",mP.MESSAGES="MESSAGES",mP.READ_RECEIPT_RECEIVED="READ_RECEIPT_RECEIVED",mP.MESSAGE_RECEIPT_REQUEST="MESSAGE_RECEIPT_REQUEST",mP.MESSAGE_RECEIPT_RESPONSE="MESSAGE_RECEIPT_RESPONSE",mP.CONVERSATION="CONVERSATION",mP.CHATROOM="CHATROOM",mP.EXPANSION="EXPANSION",mP.PULL_OFFLINE_MESSAGE_FINISHED="PULL_OFFLINE_MESSAGE_FINISHED",mP.TAG="TAG",mP.CONVERSATION_TAG="CONVERSATION_TAG",mP.TYPING_STATUS="TYPING_STATUS",mP.MESSAGE_BLOCKED="MESSAGE_BLOCKED",mP.ULTRA_GROUP_ENABLE="ULTRA_GROUP_ENABLE",mP.OPERATE_STATUS="OPERATE_STATUS",mP.ULTRA_GROUP_MESSAGE_EXPANSION_UPDATED="ULTRA_GROUP_MESSAGE_EXPANSION_UPDATED",mP.ULTRA_GROUP_MESSAGE_MODIFIED="ULTRA_GROUP_MESSAGE_MODIFIED",mP.ULTRA_GROUP_MESSAGE_RECALLED="ULTRA_GROUP_MESSAGE_RECALLED",mP.ULTRA_GROUP_CHANNEL_TYPE_CHANGE="ULTRA_GROUP_CHANNEL_TYPE_CHANGE",mP.ULTRA_GROUP_CHANNEL_DELETE="ULTRA_GROUP_CHANNEL_DELETE",mP.ULTRA_GROUP_CHANNEL_USER_KICKED="ULTRA_GROUP_CHANNEL_USER_KICKED",mP.PRIVATE_MESSAGE_DELIVERED="PRIVATE_MESSAGE_DELIVERED",mP.GROUP_MESSAGE_DELIVERED="GROUP_MESSAGE_DELIVERED";var WP=new th,ZP={connection:function(t,n){switch(t){case e.RCConnectionStatus.CONNECTED:WP.emit(e.Events.CONNECTED);break;case e.RCConnectionStatus.CONNECTING:WP.emit(e.Events.CONNECTING);break;case e.RCConnectionStatus.SUSPENDED:WP.emit(e.Events.SUSPEND,n);break;case e.RCConnectionStatus.DISCONNECTED:WP.emit(e.Events.DISCONNECT,n)}},batchMessage:function(t){WP.emit(e.Events.MESSAGES,{messages:t.map((function(e){return YP(e)}))})},typingState:function(t){WP.emit(e.Events.TYPING_STATUS,{status:t})},readReceiptReceived:function(t,n,r){WP.emit(e.Events.READ_RECEIPT_RECEIVED,{conversation:t,messageUId:n,sentTime:r})},messageReceiptRequest:function(t,n,r){WP.emit(e.Events.MESSAGE_RECEIPT_REQUEST,{conversation:t,messageUId:n,senderUserId:r})},messageReceiptResponse:function(t,n,r){WP.emit(e.Events.MESSAGE_RECEIPT_RESPONSE,{conversation:t,receivedUserId:n,messageUIdList:r})},conversationState:function(t){var n=t.map((function(e){var t=e.conversationType,n={conversationType:t,latestMessage:e.latestMessage?YP(e.latestMessage):null,targetId:e.targetId,unreadMessageCount:e.unreadMessageCount,unreadMentionedCount:e.unreadMentionedCount,notificationStatus:e.notificationStatus,notificationLevel:e.notificationLevel,lastUnreadTime:e.lastUnreadTime,channelId:e.channelId};return t===Td.ULTRA_GROUP?(n.versionTime=e.versionTime,{conversation:n}):(n.hasMentioned=e.hasMentioned,n.mentionedInfo=e.mentionedInfo,n.isTop=e.isTop,{conversation:n,updatedItems:e.updatedItems})}));WP.emit(e.Events.CONVERSATION,{conversationList:n})},chatroomState:function(t){WP.emit(e.Events.CHATROOM,t)},expansion:function(t){WP.emit(e.Events.EXPANSION,t)},pullFinished:function(){WP.emit(e.Events.PULL_OFFLINE_MESSAGE_FINISHED)},tag:function(){WP.emit(e.Events.TAG)},conversationTagChanged:function(){WP.emit(e.Events.CONVERSATION_TAG)},messageBlocked:function(t){WP.emit(e.Events.MESSAGE_BLOCKED,t)},messageDelivered:function(t){WP.emit(e.Events.PRIVATE_MESSAGE_DELIVERED,t)},groupMessageDeliveredStatus:function(t){WP.emit(e.Events.GROUP_MESSAGE_DELIVERED,t)},ultraGroupEnable:function(t){WP.emit(e.Events.ULTRA_GROUP_ENABLE,t.map((function(e){return JP(e)})))},operateStatus:function(t){WP.emit(e.Events.OPERATE_STATUS,t)},ultraGroupMessageExpansionUpdated:function(t){WP.emit(e.Events.ULTRA_GROUP_MESSAGE_EXPANSION_UPDATED,t.map((function(e){return YP(e)})))},ultraGroupMessageModified:function(t){WP.emit(e.Events.ULTRA_GROUP_MESSAGE_MODIFIED,t.map((function(e){return YP(e)})))},ultraGroupMessageRecalled:function(t){WP.emit(e.Events.ULTRA_GROUP_MESSAGE_RECALLED,t.map((function(e){return YP(e)})))},ultraGroupChannelChangeType:function(t){WP.emit(e.Events.ULTRA_GROUP_CHANNEL_TYPE_CHANGE,t)},ultraGroupChannelUserKicked:function(t){WP.emit(e.Events.ULTRA_GROUP_CHANNEL_USER_KICKED,t)},ultraGroupChannelDelete:function(t){WP.emit(e.Events.ULTRA_GROUP_CHANNEL_DELETE,t)}};Eh.add("imlib-next","5.7.2");var zP=null,XP=null,$P=null;function eD(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){switch(e.label){case 0:return zP?($P.info(Dd.A_DESTROY_O),[4,gP.destroy()]):[2];case 1:return e.sent(),XP=null,zP=null,$P=null,[2]}}))}))}function tD(e){if(!zP)throw new Error("Not initialized yet!");return e(zP,$P,XP)}function nD(e){return zP?e(zP,$P,XP):Promise.resolve({code:Ed.BIZ_ERROR_CLIENT_NOT_INIT})}function rD(){WP.clear()}var oD={TIMEOUT:{code:-1,msg:"Network timeout"},SDK_INTERNAL_ERROR:{code:-2,msg:"SDK internal error"},PARAMETER_ERROR:{code:-3,msg:"Please check the parameters, the {param} expected a value of {expect} but received {current}"},REJECTED_BY_BLACKLIST:{code:405,msg:"Blacklisted by the other party"},SEND_TOO_FAST:{code:20604,msg:"Sending messages too quickly"},NOT_IN_GROUP:{code:22406,msg:"Not in group"},ULTRA_GROUP_USER_NOT_IN_PRIVATE_CHANNEL:{code:Ed.ULTRA_GROUP_USER_NOT_IN_PRIVATE_CHANNEL,msg:"ultra group user not in private channel"},FORBIDDEN_IN_GROUP:{code:22408,msg:"Forbbiden from speaking in the group"},NOT_IN_CHATROOM:{code:23406,msg:"Not in chatRoom"},FORBIDDEN_IN_CHATROOM:{code:23408,msg:"Forbbiden from speaking in the chatRoom"},KICKED_FROM_CHATROOM:{code:23409,msg:"Kicked out and forbbiden from joining the chatRoom"},CHATROOM_NOT_EXIST:{code:23410,msg:"ChatRoom does not exist"},CHATROOM_IS_FULL:{code:23411,msg:"ChatRoom members exceeded"},PARAMETER_INVALID_CHATROOM:{code:23412,msg:"Invalid chatRoom parameters"},ROAMING_SERVICE_UNAVAILABLE_CHATROOM:{code:23414,msg:"ChatRoom message roaming service is not open, Please go to the developer to open this service"},RECALLMESSAGE_PARAMETER_INVALID:{code:25101,msg:"Invalid recall message parameter"},ROAMING_SERVICE_UNAVAILABLE_MESSAGE:{code:25102,msg:"Single group chat roaming service is not open, Please go to the developer to open this service"},PUSHSETTING_PARAMETER_INVALID:{code:26001,msg:"Invalid push parameter"},OPERATION_BLOCKED:{code:20605,msg:"Operation is blocked"},OPERATION_NOT_SUPPORT:{code:20606,msg:"Operation is not supported"},MSG_BLOCKED_SENSITIVE_WORD:{code:21501,msg:"The sent message contains sensitive words"},REPLACED_SENSITIVE_WORD:{code:21502,msg:"Sensitive words in the message have been replaced"},NOT_CONNECTED:{code:30001,msg:"Please connect successfully first"},NAVI_REQUEST_ERROR:{code:30007,msg:"Navigation http request failed"},CMP_REQUEST_ERROR:{code:30010,msg:"CMP sniff http request failed"},CONN_APPKEY_FAKE:{code:31002,msg:"Your appkey is fake"},CONN_MINI_SERVICE_NOT_OPEN:{code:31003,msg:"Mini program service is not open, Please go to the developer to open this service"},CONN_ACK_TIMEOUT:{code:31e3,msg:"Connection ACK timeout"},CONN_TOKEN_INCORRECT:{code:31004,msg:"Your token is not valid or expired"},CONN_NOT_AUTHRORIZED:{code:31005,msg:"AppKey and Token do not match"},CONN_REDIRECTED:{code:31006,msg:"Connection redirection"},CONN_APP_BLOCKED_OR_DELETED:{code:31008,msg:"AppKey is banned or deleted"},CONN_USER_BLOCKED:{code:31009,msg:"User blocked"},CONN_DOMAIN_INCORRECT:{code:31012,msg:"Connect domain error, Please check the set security domain"},ROAMING_SERVICE_UNAVAILABLE:{code:33007,msg:"Roaming service cloud is not open, Please go to the developer to open this service"},RC_CONNECTION_EXIST:{code:34001,msg:"Connection already exists"},CHATROOM_KV_EXCEED:{code:23423,msg:"ChatRoom KV setting exceeds maximum"},CHATROOM_KV_OVERWRITE_INVALID:{code:23424,msg:"ChatRoom KV already exists"},CHATROOM_KV_STORE_NOT_OPEN:{code:23426,msg:"ChatRoom KV storage service is not open, Please go to the developer to open this service"},CHATROOM_KEY_NOT_EXIST:{code:23427,msg:"ChatRoom key does not exist"},MSG_KV_NOT_SUPPORT:{code:34008,msg:"The message cannot be extended"},SEND_MESSAGE_KV_FAIL:{code:34009,msg:"Sending RC expansion message fail"},EXPANSION_LIMIT_EXCEET:{code:34010,msg:"The message expansion size is beyond the limit"},ILLGAL_PARAMS:{code:33003,msg:"Incorrect parameters passed in while calling the interface"},UPLOAD_FILE_FAILED:{code:35020,msg:"File upload failed"},CHATROOM_KV_STORE_NOT_ALL_SUCCESS:{code:23428,msg:"Chatroom kv store not all success"},CHATROOM_KV_STORE_OUT_LIMIT:{code:23429,msg:"Chatroom kv's length is out of limit"},TAG_EXISTS:{code:33101,msg:"The tag already exists"},TAG_NOT_EXIST:{code:33100,msg:"The tag does not exist"},NOT_SUPPORT:{code:Ed.NOT_SUPPORT,msg:"The method is not supported in a browser!"}},iD={};for(var sD in oD){var aD=oD[sD].code;iD[aD]=sD}oD.ROAMING_SERVICE_UNAVAILABLE.code;var cD=function(e,t,n){void 0===n&&(n="");var r="conversationType:".concat(t.conversationType,",targetId:").concat(t.targetId);return e.debug(Dd.O,"".concat(n," -> ").concat(r)),r},uD=function(e,t,n,r){return void 0===r&&(r=""),oc(void 0,void 0,void 0,(function(){var o,i;return ic(this,(function(s){switch(s.label){case 0:return o=cD(e,t,r),[4,n()];case 1:return(i=s.sent())!==Ed.SUCCESS?(e.warn(Dd.O,"".concat(r," fail -> ").concat(i," : ").concat(iD[i]," , ").concat(o)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))};var dD=function(e){return!!(hf("options.key",e.key,Jh.STRING,!0)&&hf("options.value",e.value,Jh.STRING,!0)&&hf("options.isAutoDelete",e.isAutoDelete,Jh.BOOLEAN)&&hf("options.isSendNotification",e.isSendNotification,Jh.BOOLEAN)&&hf("options.notificationExtra",e.notificationExtra,Jh.STRING))},lD=function(e){return hf("options.key",e.key,Jh.STRING,!0)&&hf("options.isSendNotification",e.isSendNotification,Jh.BOOLEAN)&&hf("options.notificationExtra",e.notificationExtra,Jh.STRING)};var hD=function(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0),this.messageType=e,this.content=t,this.isPersited=n,this.isCounted=r};function fD(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);return function(r){return new hD(e,r,t,n)}}var gD=fD("RC:ImgMsg"),pD=fD("RC:HQVCMsg"),vD=fD("RC:SightMsg"),_D=fD("RC:TxtMsg"),ED=fD("RC:CombineMsg"),mD=fD("RC:FileMsg"),TD=fD("RC:GIFMsg"),ID=fD("RC:VcMsg"),yD=fD("RC:LBSMsg"),RD=fD("RC:ReferenceMsg"),CD=fD("RC:ImgTextMsg"),SD=i,OD=ot("iterator"),ND=!SD((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[OD]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),AD=zt.exports,MD=Lt,UD=Bt,LD=Sv,wD=Oc,bD=d,PD=xe,DD=function(e,t,n,r){try{return r?t(UD(n)[0],n[1]):t(n)}catch(t){LD(e,"throw",t)}},BD=cv,VD=As,xD=dr,GD=gs,kD=Iv,FD=gv,HD=Array,qD=function(e){var t=PD(e),n=VD(this),r=arguments.length,o=r>1?arguments[1]:void 0,i=void 0!==o;i&&(o=wD(o,r>2?arguments[2]:void 0));var s,a,c,u,d,l,h=FD(t),f=0;if(!h||this===HD&&BD(h))for(s=xD(t),a=n?new this(s):HD(s);s>f;f++)l=i?o(t[f],f):t[f],GD(a,f,l);else for(d=(u=kD(t,h)).next,a=n?new this:[];!(c=bD(d,u)).done;f++)l=i?DD(u,o,[c.value,f],!0):c.value,GD(a,f,l);return a.length=f,a},KD=R,jD=2147483647,YD=/[^\0-\u007E]/,JD=/[.\u3002\uFF0E\uFF61]/g,QD="Overflow: input needs wider integers to process",WD=RangeError,ZD=KD(JD.exec),zD=Math.floor,XD=String.fromCharCode,$D=KD("".charCodeAt),eB=KD([].join),tB=KD([].push),nB=KD("".replace),rB=KD("".split),oB=KD("".toLowerCase),iB=function(e){return e+22+75*(e<26)},sB=function(e,t,n){var r=0;for(e=n?zD(e/700):e>>1,e+=zD(e/t);e>455;)e=zD(e/35),r+=36;return zD(r+36*e/(e+38))},aB=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var o=$D(e,n++);if(o>=55296&&o<=56319&&n<r){var i=$D(e,n++);56320==(64512&i)?tB(t,((1023&o)<<10)+(1023&i)+65536):(tB(t,o),n--)}else tB(t,o)}return t}(e);var n,r,o=e.length,i=128,s=0,a=72;for(n=0;n<e.length;n++)(r=e[n])<128&&tB(t,XD(r));var c=t.length,u=c;for(c&&tB(t,"-");u<o;){var d=jD;for(n=0;n<e.length;n++)(r=e[n])>=i&&r<d&&(d=r);var l=u+1;if(d-i>zD((jD-s)/l))throw WD(QD);for(s+=(d-i)*l,i=d,n=0;n<e.length;n++){if((r=e[n])<i&&++s>jD)throw WD(QD);if(r==i){for(var h=s,f=36;;){var g=f<=a?1:f>=a+26?26:f-a;if(h<g)break;var p=h-g,v=36-g;tB(t,XD(iB(g+p%v))),h=zD(p/v),f+=36}tB(t,XD(iB(h))),a=sB(s,l,u==c),s=0,u++}}s++,i++}return eB(t,"")},cB=$r,uB=r,dB=d,lB=R,hB=s,fB=ND,gB=Zn,pB=GT,vB=_f,_B=cm,EB=bn,mB=Sf,TB=q,IB=Fe,yB=Oc,RB=ho,CB=Bt,SB=Y,OB=po,NB=Qo,AB=E,MB=Iv,UB=gv,LB=Bf,wB=JO,bB=ot("iterator"),PB="URLSearchParams",DB=PB+"Iterator",BB=EB.set,VB=EB.getterFor(PB),xB=EB.getterFor(DB),GB=Object.getOwnPropertyDescriptor,kB=function(e){if(!hB)return uB[e];var t=GB(uB,e);return t&&t.value},FB=kB("fetch"),HB=kB("Request"),qB=kB("Headers"),KB=HB&&HB.prototype,jB=qB&&qB.prototype,YB=uB.RegExp,JB=uB.TypeError,QB=uB.decodeURIComponent,WB=uB.encodeURIComponent,ZB=lB("".charAt),zB=lB([].join),XB=lB([].push),$B=lB("".replace),eV=lB([].shift),tV=lB([].splice),nV=lB("".split),rV=lB("".slice),oV=/\+/g,iV=Array(4),sV=function(e){return iV[e-1]||(iV[e-1]=YB("((?:%[\\da-f]{2}){"+e+"})","gi"))},aV=function(e){try{return QB(e)}catch(t){return e}},cV=function(e){var t=$B(e,oV," "),n=4;try{return QB(t)}catch(e){for(;n;)t=$B(t,sV(n--),aV);return t}},uV=/[!'()~]|%20/g,dV={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},lV=function(e){return dV[e]},hV=function(e){return $B(WB(e),uV,lV)},fV=_B((function(e,t){BB(this,{type:DB,iterator:MB(VB(e).entries),kind:t})}),"Iterator",(function(){var e=xB(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),gV=function(e){this.entries=[],this.url=null,void 0!==e&&(SB(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===ZB(e,0)?rV(e,1):e:OB(e)))};gV.prototype={type:PB,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,o,i,s,a,c=UB(e);if(c)for(n=(t=MB(e,c)).next;!(r=dB(n,t)).done;){if(i=(o=MB(CB(r.value))).next,(s=dB(i,o)).done||(a=dB(i,o)).done||!dB(i,o).done)throw JB("Expected sequence with length 2");XB(this.entries,{key:OB(s.value),value:OB(a.value)})}else for(var u in e)IB(e,u)&&XB(this.entries,{key:u,value:OB(e[u])})},parseQuery:function(e){if(e)for(var t,n,r=nV(e,"&"),o=0;o<r.length;)(t=r[o++]).length&&(n=nV(t,"="),XB(this.entries,{key:cV(eV(n)),value:cV(zB(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],XB(n,hV(e.key)+"="+hV(e.value));return zB(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var pV=function(){mB(this,vV);var e=arguments.length>0?arguments[0]:void 0;BB(this,new gV(e))},vV=pV.prototype;if(pB(vV,{append:function(e,t){LB(arguments.length,2);var n=VB(this);XB(n.entries,{key:OB(e),value:OB(t)}),n.updateURL()},delete:function(e){LB(arguments.length,1);for(var t=VB(this),n=t.entries,r=OB(e),o=0;o<n.length;)n[o].key===r?tV(n,o,1):o++;t.updateURL()},get:function(e){LB(arguments.length,1);for(var t=VB(this).entries,n=OB(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){LB(arguments.length,1);for(var t=VB(this).entries,n=OB(e),r=[],o=0;o<t.length;o++)t[o].key===n&&XB(r,t[o].value);return r},has:function(e){LB(arguments.length,1);for(var t=VB(this).entries,n=OB(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){LB(arguments.length,1);for(var n,r=VB(this),o=r.entries,i=!1,s=OB(e),a=OB(t),c=0;c<o.length;c++)(n=o[c]).key===s&&(i?tV(o,c--,1):(i=!0,n.value=a));i||XB(o,{key:s,value:a}),r.updateURL()},sort:function(){var e=VB(this);wB(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=VB(this).entries,r=yB(e,arguments.length>1?arguments[1]:void 0),o=0;o<n.length;)r((t=n[o++]).value,t.key,this)},keys:function(){return new fV(this,"keys")},values:function(){return new fV(this,"values")},entries:function(){return new fV(this,"entries")}},{enumerable:!0}),gB(vV,bB,vV.entries,{name:"entries"}),gB(vV,"toString",(function(){return VB(this).serialize()}),{enumerable:!0}),vB(pV,PB),cB({global:!0,constructor:!0,forced:!fB},{URLSearchParams:pV}),!fB&&TB(qB)){var _V=lB(jB.has),EV=lB(jB.set),mV=function(e){if(SB(e)){var t,n=e.body;if(RB(n)===PB)return t=e.headers?new qB(e.headers):new qB,_V(t,"content-type")||EV(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),NB(e,{body:AB(0,OB(n)),headers:AB(0,t)})}return e};if(TB(FB)&&cB({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return FB(e,arguments.length>1?mV(arguments[1]):{})}}),TB(HB)){var TV=function(e){return mB(this,KB),new HB(e,arguments.length>1?mV(arguments[1]):{})};KB.constructor=TV,TV.prototype=KB,cB({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:TV})}}var IV,yV=$r,RV=s,CV=ND,SV=r,OV=Oc,NV=R,AV=Zn,MV=function(e,t,n){return n.get&&AD(n.get,t,{getter:!0}),n.set&&AD(n.set,t,{setter:!0}),MD.f(e,t,n)},UV=Sf,LV=Fe,wV=eA,bV=qD,PV=sI,DV=Hi.codeAt,BV=function(e){var t,n,r=[],o=rB(nB(oB(e),JD,"."),".");for(t=0;t<o.length;t++)n=o[t],tB(r,ZD(YD,n)?"xn--"+aB(n):n);return eB(r,".")},VV=po,xV=_f,GV=Bf,kV={URLSearchParams:pV,getState:VB},FV=bn,HV=FV.set,qV=FV.getterFor("URL"),KV=kV.URLSearchParams,jV=kV.getState,YV=SV.URL,JV=SV.TypeError,QV=SV.parseInt,WV=Math.floor,ZV=Math.pow,zV=NV("".charAt),XV=NV(/./.exec),$V=NV([].join),ex=NV(1..toString),tx=NV([].pop),nx=NV([].push),rx=NV("".replace),ox=NV([].shift),ix=NV("".split),sx=NV("".slice),ax=NV("".toLowerCase),cx=NV([].unshift),ux="Invalid scheme",dx="Invalid host",lx="Invalid port",hx=/[a-z]/i,fx=/[\d+-.a-z]/i,gx=/\d/,px=/^0x/i,vx=/^[0-7]+$/,_x=/^\d+$/,Ex=/^[\da-f]+$/i,mx=/[\0\t\n\r #%/:<>?@[\\\]^|]/,Tx=/[\0\t\n\r #/:<>?@[\\\]^|]/,Ix=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,yx=/[\t\n\r]/g,Rx=function(e){var t,n,r,o;if("number"==typeof e){for(t=[],n=0;n<4;n++)cx(t,e%256),e=WV(e/256);return $V(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,o=0,i=0;i<8;i++)0!==e[i]?(o>n&&(t=r,n=o),r=null,o=0):(null===r&&(r=i),++o);return o>n&&(t=r,n=o),t}(e),n=0;n<8;n++)o&&0===e[n]||(o&&(o=!1),r===n?(t+=n?":":"::",o=!0):(t+=ex(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},Cx={},Sx=wV({},Cx,{" ":1,'"':1,"<":1,">":1,"`":1}),Ox=wV({},Sx,{"#":1,"?":1,"{":1,"}":1}),Nx=wV({},Ox,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ax=function(e,t){var n=DV(e,0);return n>32&&n<127&&!LV(t,e)?e:encodeURIComponent(e)},Mx={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Ux=function(e,t){var n;return 2==e.length&&XV(hx,zV(e,0))&&(":"==(n=zV(e,1))||!t&&"|"==n)},Lx=function(e){var t;return e.length>1&&Ux(sx(e,0,2))&&(2==e.length||"/"===(t=zV(e,2))||"\\"===t||"?"===t||"#"===t)},bx=function(e){return"."===e||"%2e"===ax(e)},Px={},Dx={},Bx={},Vx={},xx={},Gx={},kx={},Fx={},Hx={},qx={},Kx={},jx={},Yx={},Jx={},Qx={},Wx={},Zx={},zx={},Xx={},$x={},eG={},tG=function(e,t,n){var r,o,i,s=VV(e);if(t){if(o=this.parse(s))throw JV(o);this.searchParams=null}else{if(void 0!==n&&(r=new tG(n,!0)),o=this.parse(s,null,r))throw JV(o);(i=jV(new KV)).bindURL(this),this.searchParams=i}};tG.prototype={type:"URL",parse:function(e,t,n){var r,o,i,s,a,c=this,u=t||Px,d=0,l="",h=!1,f=!1,g=!1;for(e=VV(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=rx(e,Ix,"")),e=rx(e,yx,""),r=bV(e);d<=r.length;){switch(o=r[d],u){case Px:if(!o||!XV(hx,o)){if(t)return ux;u=Bx;continue}l+=ax(o),u=Dx;break;case Dx:if(o&&(XV(fx,o)||"+"==o||"-"==o||"."==o))l+=ax(o);else{if(":"!=o){if(t)return ux;l="",u=Bx,d=0;continue}if(t&&(c.isSpecial()!=LV(Mx,l)||"file"==l&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=l,t)return void(c.isSpecial()&&Mx[c.scheme]==c.port&&(c.port=null));l="","file"==c.scheme?u=Jx:c.isSpecial()&&n&&n.scheme==c.scheme?u=Vx:c.isSpecial()?u=Fx:"/"==r[d+1]?(u=xx,d++):(c.cannotBeABaseURL=!0,nx(c.path,""),u=Xx)}break;case Bx:if(!n||n.cannotBeABaseURL&&"#"!=o)return ux;if(n.cannotBeABaseURL&&"#"==o){c.scheme=n.scheme,c.path=PV(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,u=eG;break}u="file"==n.scheme?Jx:Gx;continue;case Vx:if("/"!=o||"/"!=r[d+1]){u=Gx;continue}u=Hx,d++;break;case xx:if("/"==o){u=qx;break}u=zx;continue;case Gx:if(c.scheme=n.scheme,o==IV)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=PV(n.path),c.query=n.query;else if("/"==o||"\\"==o&&c.isSpecial())u=kx;else if("?"==o)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=PV(n.path),c.query="",u=$x;else{if("#"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=PV(n.path),c.path.length--,u=zx;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=PV(n.path),c.query=n.query,c.fragment="",u=eG}break;case kx:if(!c.isSpecial()||"/"!=o&&"\\"!=o){if("/"!=o){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,u=zx;continue}u=qx}else u=Hx;break;case Fx:if(u=Hx,"/"!=o||"/"!=zV(l,d+1))continue;d++;break;case Hx:if("/"!=o&&"\\"!=o){u=qx;continue}break;case qx:if("@"==o){h&&(l="%40"+l),h=!0,i=bV(l);for(var p=0;p<i.length;p++){var v=i[p];if(":"!=v||g){var _=Ax(v,Nx);g?c.password+=_:c.username+=_}else g=!0}l=""}else if(o==IV||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(h&&""==l)return"Invalid authority";d-=bV(l).length+1,l="",u=Kx}else l+=o;break;case Kx:case jx:if(t&&"file"==c.scheme){u=Wx;continue}if(":"!=o||f){if(o==IV||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()){if(c.isSpecial()&&""==l)return dx;if(t&&""==l&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(l))return s;if(l="",u=Zx,t)return;continue}"["==o?f=!0:"]"==o&&(f=!1),l+=o}else{if(""==l)return dx;if(s=c.parseHost(l))return s;if(l="",u=Yx,t==jx)return}break;case Yx:if(!XV(gx,o)){if(o==IV||"/"==o||"?"==o||"#"==o||"\\"==o&&c.isSpecial()||t){if(""!=l){var E=QV(l,10);if(E>65535)return lx;c.port=c.isSpecial()&&E===Mx[c.scheme]?null:E,l=""}if(t)return;u=Zx;continue}return lx}l+=o;break;case Jx:if(c.scheme="file","/"==o||"\\"==o)u=Qx;else{if(!n||"file"!=n.scheme){u=zx;continue}if(o==IV)c.host=n.host,c.path=PV(n.path),c.query=n.query;else if("?"==o)c.host=n.host,c.path=PV(n.path),c.query="",u=$x;else{if("#"!=o){Lx($V(PV(r,d),""))||(c.host=n.host,c.path=PV(n.path),c.shortenPath()),u=zx;continue}c.host=n.host,c.path=PV(n.path),c.query=n.query,c.fragment="",u=eG}}break;case Qx:if("/"==o||"\\"==o){u=Wx;break}n&&"file"==n.scheme&&!Lx($V(PV(r,d),""))&&(Ux(n.path[0],!0)?nx(c.path,n.path[0]):c.host=n.host),u=zx;continue;case Wx:if(o==IV||"/"==o||"\\"==o||"?"==o||"#"==o){if(!t&&Ux(l))u=zx;else if(""==l){if(c.host="",t)return;u=Zx}else{if(s=c.parseHost(l))return s;if("localhost"==c.host&&(c.host=""),t)return;l="",u=Zx}continue}l+=o;break;case Zx:if(c.isSpecial()){if(u=zx,"/"!=o&&"\\"!=o)continue}else if(t||"?"!=o)if(t||"#"!=o){if(o!=IV&&(u=zx,"/"!=o))continue}else c.fragment="",u=eG;else c.query="",u=$x;break;case zx:if(o==IV||"/"==o||"\\"==o&&c.isSpecial()||!t&&("?"==o||"#"==o)){if(".."===(a=ax(a=l))||"%2e."===a||".%2e"===a||"%2e%2e"===a?(c.shortenPath(),"/"==o||"\\"==o&&c.isSpecial()||nx(c.path,"")):bx(l)?"/"==o||"\\"==o&&c.isSpecial()||nx(c.path,""):("file"==c.scheme&&!c.path.length&&Ux(l)&&(c.host&&(c.host=""),l=zV(l,0)+":"),nx(c.path,l)),l="","file"==c.scheme&&(o==IV||"?"==o||"#"==o))for(;c.path.length>1&&""===c.path[0];)ox(c.path);"?"==o?(c.query="",u=$x):"#"==o&&(c.fragment="",u=eG)}else l+=Ax(o,Ox);break;case Xx:"?"==o?(c.query="",u=$x):"#"==o?(c.fragment="",u=eG):o!=IV&&(c.path[0]+=Ax(o,Cx));break;case $x:t||"#"!=o?o!=IV&&("'"==o&&c.isSpecial()?c.query+="%27":c.query+="#"==o?"%23":Ax(o,Cx)):(c.fragment="",u=eG);break;case eG:o!=IV&&(c.fragment+=Ax(o,Sx))}d++}},parseHost:function(e){var t,n,r;if("["==zV(e,0)){if("]"!=zV(e,e.length-1))return dx;if(t=function(e){var t,n,r,o,i,s,a,c=[0,0,0,0,0,0,0,0],u=0,d=null,l=0,h=function(){return zV(e,l)};if(":"==h()){if(":"!=zV(e,1))return;l+=2,d=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=n=0;n<4&&XV(Ex,h());)t=16*t+QV(h(),16),l++,n++;if("."==h()){if(0==n)return;if(l-=n,u>6)return;for(r=0;h();){if(o=null,r>0){if(!("."==h()&&r<4))return;l++}if(!XV(gx,h()))return;for(;XV(gx,h());){if(i=QV(h(),10),null===o)o=i;else{if(0==o)return;o=10*o+i}if(o>255)return;l++}c[u]=256*c[u]+o,2!=++r&&4!=r||u++}if(4!=r)return;break}if(":"==h()){if(l++,!h())return}else if(h())return;c[u++]=t}else{if(null!==d)return;l++,d=++u}}if(null!==d)for(s=u-d,u=7;0!=u&&s>0;)a=c[u],c[u--]=c[d+s-1],c[d+--s]=a;else if(8!=u)return;return c}(sx(e,1,-1)),!t)return dx;this.host=t}else if(this.isSpecial()){if(e=BV(e),XV(mx,e))return dx;if(t=function(e){var t,n,r,o,i,s,a,c=ix(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(o=c[r]))return e;if(i=10,o.length>1&&"0"==zV(o,0)&&(i=XV(px,o)?16:8,o=sx(o,8==i?1:2)),""===o)s=0;else{if(!XV(10==i?_x:8==i?vx:Ex,o))return e;s=QV(o,i)}nx(n,s)}for(r=0;r<t;r++)if(s=n[r],r==t-1){if(s>=ZV(256,5-t))return null}else if(s>255)return null;for(a=tx(n),r=0;r<n.length;r++)a+=n[r]*ZV(256,3-r);return a}(e),null===t)return dx;this.host=t}else{if(XV(Tx,e))return dx;for(t="",n=bV(e),r=0;r<n.length;r++)t+=Ax(n[r],Cx);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return LV(Mx,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&Ux(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,o=e.host,i=e.port,s=e.path,a=e.query,c=e.fragment,u=t+":";return null!==o?(u+="//",e.includesCredentials()&&(u+=n+(r?":"+r:"")+"@"),u+=Rx(o),null!==i&&(u+=":"+i)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+$V(s,"/"):"",null!==a&&(u+="?"+a),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw JV(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new nG(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+Rx(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(VV(e)+":",Px)},getUsername:function(){return this.username},setUsername:function(e){var t=bV(VV(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=Ax(t[n],Nx)}},getPassword:function(){return this.password},setPassword:function(e){var t=bV(VV(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=Ax(t[n],Nx)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?Rx(e):Rx(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Kx)},getHostname:function(){var e=this.host;return null===e?"":Rx(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,jx)},getPort:function(){var e=this.port;return null===e?"":VV(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=VV(e))?this.port=null:this.parse(e,Yx))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+$V(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Zx))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=VV(e))?this.query=null:("?"==zV(e,0)&&(e=sx(e,1)),this.query="",this.parse(e,$x)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=VV(e))?("#"==zV(e,0)&&(e=sx(e,1)),this.fragment="",this.parse(e,eG)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var nG=function(e){var t=UV(this,rG),n=GV(arguments.length,1)>1?arguments[1]:void 0,r=HV(t,new tG(e,!1,n));RV||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},rG=nG.prototype,oG=function(e,t){return{get:function(){return qV(this)[e]()},set:t&&function(e){return qV(this)[t](e)},configurable:!0,enumerable:!0}};if(RV&&(MV(rG,"href",oG("serialize","setHref")),MV(rG,"origin",oG("getOrigin")),MV(rG,"protocol",oG("getProtocol","setProtocol")),MV(rG,"username",oG("getUsername","setUsername")),MV(rG,"password",oG("getPassword","setPassword")),MV(rG,"host",oG("getHost","setHost")),MV(rG,"hostname",oG("getHostname","setHostname")),MV(rG,"port",oG("getPort","setPort")),MV(rG,"pathname",oG("getPathname","setPathname")),MV(rG,"search",oG("getSearch","setSearch")),MV(rG,"searchParams",oG("getSearchParams")),MV(rG,"hash",oG("getHash","setHash"))),AV(rG,"toJSON",(function(){return qV(this).serialize()}),{enumerable:!0}),AV(rG,"toString",(function(){return qV(this).serialize()}),{enumerable:!0}),YV){var iG=YV.createObjectURL,sG=YV.revokeObjectURL;iG&&AV(nG,"createObjectURL",OV(iG,YV)),sG&&AV(nG,"revokeObjectURL",OV(sG,YV))}xV(nG,"URL"),yV({global:!0,constructor:!0,forced:!CV,sham:!RV},{URL:nG}),AM("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),qM);var aG,cG,uG=qD;$r({target:"Array",stat:!0,forced:!Kv((function(e){Array.from(e)}))},{from:uG});var dG={qiniu:function(e,t,n,r){tD((function(o){var i=o.getNaviInfoFromCache();if(1===(null==i?void 0:i.type)&&t.chunk_size&&r.size>t.chunk_size){var s=Qh();s+=r.name.substr(r.name.lastIndexOf(".")),r.uniqueName=s,EG(r,t,n)}else _G(e,t,n,r)}))},baidu:function(e,t,n,r){if(r.size>hG)throw new Error("the file size is over 5GB!");var o=t||{};t=t||cG;var i=new XMLHttpRequest,s=gG();if(!o.uploadHost.bos&&!o.bosUploadPath)return;var a=s+lG[0][1]+o.bosUploadPath;lG.shift();var c=o.bosHeader||{},u={filename:t.uniqueValue||r.uniqueName,name:r.name,downloadUrl:a,isBosRes:!0};i.upload&&t.support_options&&(i.upload.onprogress=function(e){n.onProgress(e.loaded,e.total,!0)});i.onreadystatechange=function(){if(4===i.readyState)if(JSON.parse(i.responseText||"{}").filename=t.uniqueValue,200===i.status){n.onCompleted(u,!0)}else lG.length?dG[lG[0][0]](e,t,n,r):n.onError("upload fail")},i.open(t.method,a,!0),i.setRequestHeader("authorization",c.bosToken),i.setRequestHeader("x-bce-date",c.bosDate),i.send(r)},aliyun:function(e,t,n,r){if(r.size>hG)throw new Error("the file size is over 5GB!");var o=new FormData;o.set("file",e.get("file")),o.set("key",e.get("key")),o.set("token",e.get("token"));var i=lG[0][1];lG.shift(),e=e||aG,t=(t=t||{})||cG;var s=new XMLHttpRequest,a=gG(),c="".concat(a+t.ossBucketName,".").concat(i);s.upload&&t.support_options&&(s.upload.onprogress=function(e){n.onProgress(e.loaded,e.total)});s.onreadystatechange=function(){if(4===s.readyState){var e=JSON.parse(s.responseText||"{}");e.name=t.uniqueValue,e.filename=t.uploadFileName,e.uploadMethod=wd?wd.ALI:"",200===s.status?n.onCompleted(e):lG.length?dG[lG[0][0]](o,t,n,r):n.onError("upload fail")}},s.open(t.method,c,!0),console.log("ali:url",c);var u=t.aliHeader||{};e.set("OSSAccessKeyId",u.osskeyId),e.set("policy",u.ossPolicy),e.set("Signature",u.ossSign),e.set("success_action_status",200),e.delete("key"),e.append("key",t.uploadFileName),e.delete("file"),e.append("file",r),s.send(e)},s3:function(e,t,n,r){var o=new FormData,i=new XMLHttpRequest,s=gG(),a=t.contentDisposition,c=lG[0][1],u="".concat(s+t.s3BucketName,".").concat(c);console.log("uploadS3:url",u),lG.shift(),i.upload&&t.support_options&&(i.upload.onprogress=function(e){n.onProgress(e.loaded,e.total)});i.onreadystatechange=function(){if(4===i.readyState){var o=JSON.parse(i.responseText||"{}");if(o.name=t.uniqueValue,o.filename=t.uploadFileName,o.uploadMethod=wd.AWS,200===i.status||204===i.status)n.onCompleted(o);else if(lG.length){var s=new FormData;s.set("file",e.get("file")),s.set("key",e.get("key")),s.set("token",e.get("token")),dG[lG[0][0]](s,t,n,r)}else n.onError("upload fail")}},i.open(t.method,u,!0);var d=t?t.s3Header:{},l=r&&r.type;a?o.set("Content-Disposition","".concat(a,";")):o.set("Content-Disposition","text/html"===l?"inline;":"attachment;");o.set("Content-Type",l),o.set("x-amz-credential",d.s3Credential),o.set("x-amz-algorithm",d.s3Algorithm),o.set("x-amz-date",d.s3Date),o.set("policy",d.s3Policy),o.set("x-amz-signature",d.s3Signature),o.set("key",t.uploadFileName),o.set("file",r),i.send(o)},stc:function(e,t,n,r){var o=new XMLHttpRequest,i=t.contentDisposition,s=lG[0][1],a="https://".concat(s,"/").concat(t.stcBucketName,"/").concat(t.uploadFileName);lG.shift(),o.upload&&t.support_options&&(o.upload.onprogress=function(e){n.onProgress(e.loaded,e.total)});o.onreadystatechange=function(){if(4===o.readyState){var i=JSON.parse(o.responseText||"{}");if(i.name=t.uniqueValue,i.filename=t.uploadFileName,i.uploadMethod=wd?wd.STC:"",200===o.status||204===o.status)n.onCompleted(i);else if(lG.length){var s=new FormData;s.set("file",e.get("file")),s.set("key",e.get("key")),s.set("token",e.get("token")),dG[lG[0][0]](s,t,n,r)}else n.onError("upload fail")}},o.open("PUT",a,!0);var c=t?t.stcHeader:{};o.setRequestHeader("Content-Type",r.type),i?o.setRequestHeader("Content-Disposition","".concat(i,";")):o.setRequestHeader("Content-Disposition","text/html"===r.type?"inline;":"attachment;");o.setRequestHeader("Authorization",c.stcAuthorization),o.setRequestHeader("x-amz-content-sha256",c.stcContentSha256),o.setRequestHeader("x-amz-date",c.stcDate),o.send(r)}},lG=[],hG=5368709120,fG="https://";function gG(){var e=fG;return"http:"!==location.protocol&&"file:"!==location.protocol||(e="http://"),e}var pG,vG=(pG="RC-upload-",{get:function(e){e=pG+e;var t=localStorage.getItem(e);if(t)return null!==(t=JSON.parse(t||"{}"))&&t.type&&t.data?t.data:null},set:function(e,t){var n=localStorage;e=pG+e,t={data:t,type:no(t),updateTime:Date.now()},n.setItem(e,JSON.stringify(t))},remove:function(e){e=pG+e,localStorage.removeItem(e)}});function _G(e,t,n,r){var o=fG+t.uploadHost.qiniu,i=(/http/.test(lG[0][1])?"":gG())+lG[0][1]||o;t.isChunk||lG.shift();var s=new XMLHttpRequest;s.upload&&t.support_options&&(s.upload.onprogress=function(e){n.onProgress(e.loaded,e.total)}),s.onreadystatechange=function(){if(4===s.readyState){var o=JSON.parse(s.responseText||"{}");o.filename=t.uniqueValue,o.uploadMethod=wd?wd.QINIU:"",200===s.status||204===s.status?n.onCompleted(o):lG.length?dG[lG[0][0]](e,t,n,r):n.onError("upload fail")}},s.open(t.method,i,!0),n.onOpen(s),t.stream&&s.setRequestHeader("authorization","UpToken ".concat(t.multi_parmas.token)),function(e,t){for(var n in e)t(n,e[n])}(t.headers,(function(e,t){s.setRequestHeader(e,t)})),s.send(e)}function EG(e,t,n,r){var o=0,i=r||Qh(),s=vG.get(i);s&&(e.uniqueName=s.sessionId,o=s.offset);var a=Math.min(t.chunk_size,e.size-o),c=e.slice(o,o+a),u=e.uniqueName;t.multi_parmas.name=u,t.filesize=e.size;var d="bytes=".concat(o,"-").concat(o+a);t.headers={Range:d,"X-File-TransactionId":u,"X-File-Total-Size":e.size},t.isChunk=!0,c.name=e.name,c=function(e,t,n){var r=new FormData;for(var o in t.unique_key&&r.append(t.unique_key,n),r.append(t.file_data_name,e,e.name),t.multi_parmas){var i=t.multi_parmas[o];r.append(o,i)}return r}(c,t,e.uniqueName),_G(c,t,{onCompleted:function(r){o+=a;var s=e.uniqueName;vG.set(i,{offset:o,sessionId:s}),o<e.size?EG(e,t,n,i):(o=0,vG.remove(i),n.onCompleted(r))},onError:function(e){console.error(e),n.onError(e)},onProgress:function(e,r){var i=e+o;n.onProgress(i,t.filesize)},onOpen:function(e){n.onOpen(e)}},e)}function mG(e,t,n,r){var o,i,s=t&&t.type||"text/plain",a=s.indexOf("image")>-1?1:4,c=n.contentDisposition,u=Math.ceil(t.size/n.stc_chunk_size),d=n&&JSON.parse(n.ossConfig?n.ossConfig:"");Array.isArray(d)||(d=[]);var l=d.find((function(e){return Object.keys(e).includes("stc")})),h="uploads";e.getFileToken(a,o,"POST",h).then((function(e){o=e.fileName,i="https://".concat(l.stc,"/").concat(n.stcBucketName,"/").concat(o),console.log("uploadStcMultipart:url",i);var a=new XMLHttpRequest;a.open("POST","".concat(i,"?").concat(h),!0),c?a.setRequestHeader("Content-Disposition","".concat(c,";")):a.setRequestHeader("Content-Disposition","text/html"===t.type?"inline;":"attachment;"),a.setRequestHeader("Authorization",e&&e.stcAuthorization),a.setRequestHeader("x-amz-content-sha256",e&&e.stcContentSha256),a.setRequestHeader("x-amz-date",e&&e.stcDate),a.setRequestHeader("Content-Type",s),a.send(),a.onreadystatechange=function(){if(4===a.readyState){var e=a.response.match(/(?:<UploadId>)(\S*?)(?:<\/UploadId>)/);console.log("uploadId",e),200===a.status||204===a.status?function(e){for(var t=[],n=1;n<=u;n++)t.push(v(e,n));p(e,t)}(Array.isArray(e)&&e[1]):r.onError("uploadStcMultipart:did not get uploadId")}}}),(function(e){r.onError("uploadStcMultipart:".concat(e))}));var f=[],g=new Map;function p(c,d){d&&Array.isArray(d)&&0!==d.length&&Promise.all(d).then((function(){var d="uploadId=".concat(c);if(g.size===u)e.getFileToken(a,o,"POST",d).then((function(e){console.log("onSuccess",e),console.log("onSuccess:uploadId",c);var o=new XMLHttpRequest;o.open("POST","".concat(i,"?").concat(d),!0),o.setRequestHeader("Authorization",e&&e.stcAuthorization),o.setRequestHeader("x-amz-content-sha256",e&&e.stcContentSha256),o.setRequestHeader("x-amz-date",e&&e.stcDate),o.setRequestHeader("Content-Type",s);var a="<CompleteMultipartUpload xmlns='http://s3.amazonaws.com/doc/2006-03-01/'>",u=Array.from(g.keys()||[]).sort((function(e,t){return e-t}));console.log("keys",u),u.forEach((function(e){a+="<Part><ETag>".concat(g.get(e),"</ETag><PartNumber>").concat(e,"</PartNumber></Part>")})),a+="</CompleteMultipartUpload>",o.send(a),console.log("xml",a),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status||204===o.status){var e={name:t.name,filename:n.uploadFileName,uploadMethod:wd.STC};r.onCompleted(e)}else r.onError("uploadStcMultipart:upload does not end")}}),(function(e){r.onError("uploadStcMultipart:".concat(e))}));else{for(var l=[],h=0,_=f;h<_.length;h++){var E=_[h];l.push(v(c,E))}p(c,l)}}),(function(e){console.error(e),r.onError("uploadStcMultipart: chunkFiles upload failed and those will reupload");for(var t=[],n=0,o=f;n<o.length;n++){var i=o[n];t.push(v(c,i))}p(c,t)}))}function v(r,c){return new Promise((function(u,d){var l="partNumber=".concat(c,"&uploadId=").concat(r);e.getFileToken(a,o,"PUT",l).then((function(e){console.log("signature ".concat(c," onSuccess"),e);var r=t&&t.slice((c-1)*n.stc_chunk_size,c*n.stc_chunk_size);console.log("fileChunk:size",r.size);var o=new XMLHttpRequest;o.open("PUT","".concat(i,"?").concat(l),!0),o.setRequestHeader("Authorization",e&&e.stcAuthorization),o.setRequestHeader("x-amz-content-sha256",e&&e.stcContentSha256),o.setRequestHeader("x-amz-date",e&&e.stcDate),o.setRequestHeader("Content-Type",s),o.send(r),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status||204===o.status){var e=o.getResponseHeader("etag");console.log("etag:".concat(c),e),g.set(c,e),u(e)}else f.includes(c)||f.push(c),d(c)}}),(function(e){console.log("getETags:签名验证失败"),f.includes(c)||f.push(c),d(c)}))}))}}var TG={form:function(e,t){var n=new FormData;if(t.unique_key){var r=e.name.substr(e.name.lastIndexOf(".")),o=IG()+r;n.append(t.unique_key,o),t.uniqueValue=o}return n.append(t.file_data_name,e),yG(t.multi_parmas,(function(e,t){n.append(e,t)})),n},json:function(e,t){var n={};if(t.unique_key){var r=e.name.substr(e.name.lastIndexOf(".")),o=IG()+r;n[t.unique_key]=o,t.uniqueValue=o}return n[t.file_data_name]=e,yG(t.multi_parmas,(function(e,t){n[e]=t})),JSON.stringify(n)},data:function(e,t){return e}};function IG(){var e=(new Date).getTime();return"xxxxxx4xxxyxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function yG(e,t){for(var n in e)t(n,e[n])}var RG,CG=0,SG=function(){function e(e){this.options=function(e){var t={domain:"",method:"POST",file_data_name:"file",unique_key:"key",base64_size:4194304,chunk_size:4194304,bos_chunk_size:4294967296,stc_chunk_size:10485760,headers:{},multi_parmas:{},query:{},support_options:!0,data:TG.form,genUId:IG};if(!e||!e.domain)throw new Error("domain is null");for(var n in e)t[n]=e[n];return t}(e)}return e.prototype.setOptions=function(e){var t=this;yG(e,(function(e,n){t.options[e]=n}))},e.prototype.upload=function(e,t,n,r){if(n){var o=this;!function(e,t,n,r,o){aG=n,cG=r,lG=[];var i,s=e.getNaviInfoFromCache();if(1===(null==s?void 0:s.type)&&t.uploadDomain)lG=[["qiniu",t.uploadDomain]];else if(r.ossConfig){var a,c,u=JSON.parse(r.ossConfig),d="",l=[];u.forEach((function(e){var t=Number(e.p)-1;for(var n in e)"aliyun"===n&&(d=e[n]),"s3"===n&&(a=e[n]),"stc"===n&&(c=e[n]),"p"!==n&&(l[t]=[n,e[n]])})),l.forEach((function(e){e&&lG.push(e)})),u.length!==lG.length&&(lG=[["qiniu",r.domain],["baidu",r.uploadHost.bos],["aliyun",d],["s3",a],["stc",c]])}else lG=[["qiniu",r.domain],["baidu",r.uploadHost.bos]];if(r.ossConfig){var h=r&&JSON.parse(r.ossConfig);Array.isArray(h)||(h=[]),i=h.find((function(e){return Object.keys(e).includes("stc")}))}if(i&&1===parseInt(i.p,10)&&n.size>=4194304)mG(e,n,r,o);else{var f=r.data(n,r);dG[lG[0][0]](f,r,o,n)}}(e,t,n,this.options,{onProgress:function(e,t,n){(RG=e,n)?RG=CG+e/t*(t-CG):CG=RG;r.onProgress(RG,t)},onCompleted:function(e){r.onCompleted(e)},onError:function(e){r.onError(e)},onOpen:function(e){o.xhr=e}})}else r.onError("upload file is null.")},e.prototype.cancel=function(){var e;null===(e=this.xhr)||void 0===e||e.abort()},e}();var OG,NG,AG={init:function(e){return new SG(e)},dataType:TG,resize:function(e,t,n){e.type;var r=document.createElement("canvas"),o=new FileReader;o.readAsDataURL(e),o.onload=function(e){var o=e.target.result,i=new Image;i.src=o;var s=i.width,a=i.height,c=function(e,t){var n=1,r=e.width,o=t.maxWidth||0;o>0&&r>o&&(n=o/r);var i=e.height,s=t.maxHeight||0;if(s>0&&i>s){var a=s/i;n=Math.min(n,a)}var c=t.maxSize||0,u=Math.ceil(e.size/1e3);if(u>c){var d=c/u;n=Math.min(n,d)}return n}({width:s,height:a,size:e.total},t),u=o;c<1&&(u=function(e,t,n){r.width=t,r.height=n;var o=r.getContext("2d");return o.drawImage(e,0,0,t,n),r.toDataURL("image/jpg")}(i,s*c,a*c)),n(u)}},Upload:SG},MG=function(e,t,n){var r=document.createElement("canvas"),o=r.getContext("2d"),i=new Image,s="string"==typeof e;i.onload=function(s){var a=function(e,t,n){var r,o,i,s=e<t,a=0,c=0;return(s?t/e:e/t)>n.scale?(s?(o=100,c=((i=t/(r=e/100))-n.maxHeight)/2):(i=100,a=((o=e/(r=t/100))-n.maxWidth)/2),{w:o,h:i,x:-a,y:-c}):(s?(r=t/n.maxHeight,i=n.maxHeight,o=e/r):(r=e/n.maxWidth,o=n.maxWidth,i=t/r),{w:o,h:i,x:-a,y:-c})}(i.width,i.height,t);r.width=a.w>t.maxWidth?t.maxWidth:a.w,r.height=a.h>t.maxHeight?t.maxHeight:a.h,o.drawImage(i,a.x,a.y,a.w,a.h);var c=r.toDataURL("string"==typeof e?"image/jpg":e.type,t.quality);c=c.replace(/data:image\/[^;]+;base64,/,""),n(c)},i.src=s?"data:image/jpg;base64,".concat(e):function(e){var t=window.URL||window.webkitURL;return t?t.createObjectURL(e):""}(e)},UG=function(e,t){var n=e.file,r=e.compress;MG(n,r,t)},LG=function(e,t){if(e.getToken)e.getToken((function(n,r){r=r||{},e.multi_parmas=e.multi_parmas||{},e.multi_parmas.token=n,e.uploadHost=e.uploadHost||{},e.uploadHost.bos=r.bos,e.ossConfig=r.ossConfig,e.bosHeader=e.bosHeader||{},e.bosHeader.bosDate=r.bosDate,e.bosHeader.bosToken=r.bosToken,e.bosUploadPath=r.path,e.aliHeader={},e.aliHeader.osskeyId=r.osskeyId,e.aliHeader.ossPolicy=r.ossPolicy,e.aliHeader.ossSign=r.ossSign,e.ossBucketName=r.ossBucketName,e.uploadFileName=r.fileName,e.s3Header={},e.s3Header.s3Credential=r.s3Credential,e.s3Header.s3Algorithm=r.s3Algorithm,e.s3Header.s3Date=r.s3Date,e.s3Header.s3Policy=r.s3Policy,e.s3Header.s3Signature=r.s3Signature,e.s3BucketName=r.s3BucketName,e.stcHeader={},e.stcHeader.stcAuthorization=r.stcAuthorization,e.stcHeader.stcContentSha256=r.stcContentSha256,e.stcHeader.stcDate=r.stcDate,e.stcBucketName=r.stcBucketName,e.headers=e.headers||{},e.base64&&(e.headers["Content-type"]="application/octet-stream",e.headers.Authorization="UpToken ".concat(n));var o=AG.init(e);t(o)}));else{e.headers=e.headers||{},e.base64&&(e.headers["Content-type"]="application/octet-stream");var n=AG.init(e);t(n)}},wG=function(e,t,n,r,o){r.upload(e,t,n.file,{onError:function(e){o.onError(e)},onProgress:function(e,t){o.onProgress(e,t)},onCompleted:function(e){e.filename=e.filename||e.hash;var t=n.compressThumbnail||UG;n.compress?t(n,(function(t){e.thumbnail=t,o.onCompleted(e)})):o.onCompleted(e)}})},bG=function(){function e(e){this.instance=e}return e.prototype.upload=function(e,t,n,r){wG(e,t,{file:n},this.instance,r)},e.prototype.cancel=function(){this.instance.cancel()},e}(),PG=function(){function e(e,t){this.instance=e,this.cfg=t}return e.prototype.upload=function(e,t,n,r){var o={file:n,compress:this.cfg};wG(e,t,o,this.instance,r)},e.prototype.cancel=function(){this.instance.cancel()},e}(),DG=function(e,t){LG(e,(function(e){var n=new bG(e);t(n)}))},BG=function(e,t){LG(e,(function(n){var r,o,i,s,a={maxHeight:(null===(r=e.thumbnailConfig)||void 0===r?void 0:r.maxHeight)||160,maxWidth:(null===(o=e.thumbnailConfig)||void 0===o?void 0:o.maxWidth)||160,quality:(null===(i=e.thumbnailConfig)||void 0===i?void 0:i.quality)||.5,scale:(null===(s=e.thumbnailConfig)||void 0===s?void 0:s.scale)||2.4},c=new PG(n,a);t(c)}))};AG.dataType;function VG(e,t,n,r,o,i,s){var a,c=this;void 0===o&&(o=gd.FILE),a=o===gd.IMAGE?gd.IMAGE:gd.FILE;var u=e.getNaviInfoFromCache();if(!NG&&(NG="upload.qiniup.com",u&&u.ossConfig))try{var d=JSON.parse(u.ossConfig).find((function(e){return void 0!==e.qiniu}));d&&(NG=d.qiniu)}catch(e){}var l=rc({domain:NG,getToken:function(t){e.getFileToken(a).then((function(e){t(e.token,e)})).catch((function(e){i.onFail(e)}))}},s);(a===gd.IMAGE?BG:DG)(l,(function(t){t.upload(e,n,r,{onProgress:function(e,t){var n,r=Math.floor(e/t*100);null===(n=i.onProgress)||void 0===n||n.call(i,r)},onCompleted:function(e){return oc(c,void 0,void 0,(function(){return ic(this,(function(t){return 1===(null==u?void 0:u.type)?function(e,t,n,r,o,i){var s={type:r.type,name:o.rc_url.file_name,downloadUrl:e.uploadDomain+o.rc_url.path};if(t===gd.AUDIO)return void xG(r).then((function(e){i.onSuccess(rc(rc({},s),e))}));t===gd.IMAGE&&(s.thumbnail=o.thumbnail);i.onSuccess(s)}(n,o,0,r,e,i):function(e,t,n,r,o){kG(t,r.filename,r.name,r,r.uploadMethod).then((function(i){if(0===i.code){var s=i.data;s.type=n.type,s.name=r.name||r.filename,e!==gd.AUDIO?(t===gd.IMAGE&&(s.thumbnail=r.thumbnail),o.onSuccess(s)):xG(n).then((function(e){o.onSuccess(rc(rc({},s),e))}))}else o.onFail(i)})).catch((function(e){o.onFail(e)}))}(o,a,r,e,i),[2]}))}))},onError:function(e){i.onFail(e)}})}))}function xG(e){return new Promise((function(t){if("function"!=typeof e.arrayBuffer){var n=new FileReader;n.onload=function(){n.result?GG(n.result).then((function(e){t(e)}),(function(){t({})})):t({})},n.onerror=function(){t({duration:0})},n.readAsArrayBuffer(e)}else e.arrayBuffer().then(GG).then((function(e){t(e)}))}))}function GG(e){return OG=OG||new AudioContext,new Promise((function(t,n){OG.decodeAudioData(e,(function(e){t({duration:e.duration,length:e.length})}),n)}))}function kG(e,t,n,r,o){return hf("fileType",e,ml,!0)&&hf("filename",t,Jh.STRING)&&hf("saveName",n,Jh.STRING)&&hf("serverType",o,Jh.NUMBER)?nD((function(i){return new Promise((function(s){i.getFileUrl(e,t,n,r,o).then((function(e){s({code:Ed.SUCCESS,data:e})})).catch((function(e){s({code:e})}))}))})):Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER})}function FG(t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return[2,nD((function(i,s){return oc(o,void 0,void 0,(function(){var o,a,c,u,d,l,h,f,g,p,v,_,E;return ic(this,(function(m){switch(m.label){case 0:return r=r||{},n instanceof hD==!1?(s.warn(Dd.O,"send message fail -> message parameter is not an instance of BaseMessage"),[2,oD.ILLGAL_PARAMS]):hf("conversation",t,Jh.OBJECT,!0)?(o=t.conversationType,a=t.targetId,c=t.channelId,hf("conversation.targetId",a,Jh.STRING,!0)&&hf("conversation.conversationType",o,Jh.NUMBER,!0)&&hf("conversation.channelId",c,Jh.CHANNEL_ID)&&hf("options.isStatusMessage",null==r?void 0:r.isStatusMessage,Jh.BOOLEAN)&&hf("options.disableNotification",null==r?void 0:r.disableNotification,Jh.BOOLEAN)&&hf("options.pushContent",null==r?void 0:r.pushContent,Jh.STRING)&&hf("options.pushData",null==r?void 0:r.pushData,Jh.STRING)&&hf("options.isMentioned",null==r?void 0:r.isMentioned,Jh.BOOLEAN)&&hf("options.mentionedType",null==r?void 0:r.mentionedType,Jh.NUMBER)&&hf("options.mentionedUserIdList",null==r?void 0:r.mentionedUserIdList,Jh.ARRAY)&&hf("options.directionalUserIdList",null==r?void 0:r.directionalUserIdList,Jh.ARRAY)&&hf("options.isVoipPush",null==r?void 0:r.isVoipPush,Jh.BOOLEAN)&&hf("options.canIncludeExpansion",null==r?void 0:r.canIncludeExpansion,Jh.BOOLEAN)&&hf("options.expansion",null==r?void 0:r.expansion,Jh.OBJECT)&&hf("options.pushConfig",null==r?void 0:r.pushConfig,Jh.OBJECT)&&hf("options.messageId",null==r?void 0:r.messageId,Jh.NUMBER)?(u="conversationType:".concat(o,",targetId:").concat(a),s.debug(Dd.O,"send message  ->".concat(u)),d=function(e,t,n){var r=e.isStatusMessage,o=e.disableNotification,i=e.pushContent,s=e.pushData,a=e.isMentioned,c=e.mentionedType,u=e.mentionedUserIdList,d=e.directionalUserIdList,l=e.isVoipPush,h=e.canIncludeExpansion,f=e.expansion,g=e.isFilerWhiteBlacklist,p=e.pushConfig,v=e.messageId,_=n.channelId;return rc({isStatusMessage:r,disableNotification:o,pushContent:i,pushData:s,isMentioned:a,mentionedType:c,mentionedUserIdList:u,directionalUserIdList:d,isVoipPush:l,canIncludeExpansion:h,expansion:f,isFilerWhiteBlacklist:g,pushConfig:p,channelId:_||"",messageId:v},t)}(r,n,t),l={isMentioned:!!r.isMentioned,content:n.content,messageType:n.messageType,isPersited:n.isPersited||!1,isCounted:n.isCounted||!1,disableNotification:!!(null==r?void 0:r.disableNotification),canIncludeExpansion:!!(null==r?void 0:r.canIncludeExpansion),expansion:(null==r?void 0:r.expansion)||null,conversationType:t.conversationType,targetId:t.targetId,channelId:t.channelId,senderUserId:i.getCurrentUserId(),messageUId:"",messageDirection:vd.SEND,receivedTime:0,isStatusMessage:r.isStatusMessage||!1,receivedStatus:to.UNREAD,isOffLineMessage:!1,pushConfig:null==r?void 0:r.pushConfig,sentStatus:e.SentStatus.SENDING},o!==Td.ULTRA_GROUP&&(l.isOffLineMessage=!1),h=s.createTraceId(),f=function(e){l.messageId=e;try{(null==r?void 0:r.onSendBefore)&&r.onSendBefore(YP(l))}catch(e){s.error(Dd.O,'Callback method "onSendBefore" execution error.\n'.concat(null==e?void 0:e.stack),h)}},s.info(Dd.A_SEND_MSG_T,JSON.stringify({messageType:n.messageType,conversationType:o,targetId:a,channelId:c}),h),[4,i.sendMessage(o,a,d,f,h)]):[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]):[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}];case 1:return g=m.sent(),p=g.code,v=g.data,_=p===Ed.SUCCESS?"info":"warn",s[_](Dd.A_SEND_MSG_R,JSON.stringify({code:p,messageUId:v?v.messageUId:"",messageId:v?v.messageId:""}),h),p===Ed.SUCCESS?(E=YP(v),[2,{code:p,data:E}]):(s.warn(Dd.O,"send message fail ->".concat(p,":").concat(iD[p],",").concat(u)),l.sentTime=(null==v?void 0:v.sentTime)||0,l.sentStatus=null==v?void 0:v.sentStatus,[2,{code:p,msg:iD[p],data:YP(l)}])}}))}))}))]}))}))}function HG(e,t){return function(n,r,o,i){if(!hf("sendOptions.contentDisposition",null==i?void 0:i.contentDisposition,(function(e){return["inline","attachment"].includes(e)})))return Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER});var s={contentDisposition:null==i?void 0:i.contentDisposition};if(i&&"thumbnailConfig"in i){var a=null==i?void 0:i.thumbnailConfig;if(!(hf("sendOptions.maxHeight",null==a?void 0:a.maxHeight,Jh.NUMBER)&&hf("sendOptions.maxWidth",null==a?void 0:a.maxWidth,Jh.NUMBER)&&hf("sendOptions.quality",null==a?void 0:a.quality,Jh.NUMBER)&&hf("sendOptions.scale",null==a?void 0:a.scale,Jh.NUMBER)))return Promise.resolve({code:Ed.BIZ_ERROR_INVALID_PARAMETER});s.thumbnailConfig=a}return nD((function(a,c,u){return new Promise((function(d){var l=c.createTraceId();c.info(Dd.L_MEDIA_UPLOAD_T,JSON.stringify({filesize:r.file.size,type:e}),l),VG(a,0,u,r.file,e,{onProgress:null==o?void 0:o.onProgress,onSuccess:function(e){var s,a=(null===(s=null==o?void 0:o.onComplete)||void 0===s?void 0:s.call(o,{url:e.downloadUrl}))||t(e,r);e&&e.downloadUrl&&c.info(Dd.L_MEDIA_UPLOAD_R,JSON.stringify({downurl:e.downloadUrl,code:Ed.SUCCESS}),l),FG(n,a,i).then(d)},onFail:function(e){c.warn(Dd.L_MEDIA_UPLOAD_R,JSON.stringify({code:Ed.UPLOAD_FILE_FAILED}),l),d({code:Ed.UPLOAD_FILE_FAILED,msg:e||Ed[Ed.UPLOAD_FILE_FAILED]})}},s)}))}))}}var qG=HG(gd.FILE,(function(e,t){return new mD({name:e.name,size:t.file.size,type:(n=e.name,r=n.match(/\.(\w+)$/),r?r[1]:"bin"),fileUrl:e.downloadUrl,user:t.user,extra:t.extra});var n,r})),KG=HG(gd.IMAGE,(function(e,t){return new gD({content:e.thumbnail,imageUri:e.downloadUrl,user:t.user,extra:t.extra})})),jG=HG(gd.AUDIO,(function(e,t){return new pD({remoteUrl:e.downloadUrl,duration:e.duration,type:e.type,user:t.user,extra:t.extra})})),YG=HG(gd.SIGHT,(function(e,t){return new vD({sightUrl:e.downloadUrl,content:t.thumbnail,duration:t.duration,size:t.file.size||e.size,name:t.name||e.name,user:t.user,extra:t.extra})}));HG(gd.COMBINE_HTML,(function(e,t){return new ED({remoteUrl:e.downloadUrl,nameList:t.nameList,summaryList:t.summaryList,conversationType:t.conversationType,user:t.user,extra:t.extra})}));var JG=Object.freeze({__proto__:null,getAllConversationList:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?hf("channelId",e,Jh.CHANNEL_ID)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return r.info(Dd.O,"getAllConversationList -> channelId: ".concat(e)),ll(e)?[4,n.getConversationListWithAllChannel()]:[3,2];case 1:return t=a.sent(),[3,4];case 2:return[4,n.getConversationList(void 0,void 0,void 0,void 0,e)];case 3:t=a.sent(),a.label=4;case 4:return o=t.code,i=t.data,o===Ed.SUCCESS&&i?(s=i.map((function(e){return JP(e)})),[2,{code:o,data:s}]):(r.warn(Dd.O,"getAllConversationList fail -> code: ".concat(o," channelId: ").concat(e)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},getConversationList:function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return wE()?hf("startTime",e,Jh.NUMBER,!0)&&hf("count",t,Jh.NUMBER,!0)&&hf("channelId",n,Jh.CHANNEL_ID)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return r="startTime: ".concat(e,", count: ").concat(t,", channelId: ").concat(n),i.info(Dd.O,"getConversationList -> ".concat(r)),ll(n)?[4,o.getConversationListWithAllChannelByPage(e,t)]:[3,2];case 1:return s=l.sent(),[3,4];case 2:return a=[1,2,3,5,6,7,8],[4,o.getConversationsByPage(a,e,t,n)];case 3:s=l.sent(),l.label=4;case 4:return c=s.code,u=s.data,c===Ed.SUCCESS&&u?(d=u.map((function(e){return JP(e)})),[2,{code:c,data:d}]):(i.warn(Dd.O,"getConversationList fail -> code: ".concat(c," ").concat(r)),[2,{code:c,msg:iD[c]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},searchConversationByContent:function e(t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return wE()?hf("keyword",t,Jh.STRING,!0)&&hf("messageTypes",n,Jh.ARRAY,!0)&&hf("channelId",r,Jh.CHANNEL_ID)&&!n.some((function(e){return!hf("messageType",e,Jh.STRING,!0)}))?[2,nD((function(i,s){return oc(o,void 0,void 0,(function(){var o,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return o="keyword: ".concat(t,", messageTypes: ").concat(JSON.stringify(n),", channelId: ").concat(r),s.info(Dd.O,"searchConversationByContent -> ".concat(e)),ll(r)?[4,i.searchConversationByContentWithAllChannel(t,n)]:[3,2];case 1:return a=l.sent(),[3,4];case 2:return[4,i.searchConversationByContent(t,n,r)];case 3:a=l.sent(),l.label=4;case 4:return c=a.code,u=a.data,c===Ed.SUCCESS&&u?(d=u.map((function(e){return JP(e)})),[2,{code:c,data:d}]):(s.warn(Dd.O,"searchConversationByContent fail -> code: ".concat(c," ").concat(o)),[2,{code:c,msg:iD[c]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},searchMessages:function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("keyword",t,Jh.STRING,!0)&&hf("startTime",n,Jh.NUMBER,!0)&&hf("count",r,Jh.NUMBER,!0)?[2,nD((function(i,s){return oc(o,void 0,void 0,(function(){var o,a,c,u,d,l,h,f,g,p;return ic(this,(function(v){switch(v.label){case 0:return o="conversation: ".concat(JSON.stringify(e),", keyword: ").concat(t,", timestamp: ").concat(n,", count: ").concat(r),s.info(Dd.O,"searchMessages -> ".concat(o)),a=e.targetId,c=e.conversationType,u=e.channelId,ll(u)?[4,i.searchMessageByContentWithAllChannel(c,a,t,n,r)]:[3,2];case 1:return d=v.sent(),[3,4];case 2:return 0,[4,i.searchMessageByContent(c,a,t,n,r,0,u)];case 3:d=v.sent(),v.label=4;case 4:return l=d.code,h=d.data,l===Ed.SUCCESS&&h?(f=h.messages,g=h.count,p=f.map((function(e){return YP(e)})),[2,{code:l,data:{messages:p,count:g}}]):(s.warn(Dd.O,"searchMessages fail -> code: ".concat(l," ").concat(o)),[2,{code:l,msg:iD[l]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},searchMessageInTimeRange:function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("option",t,Jh.OBJECT,!0)&&hf("option.keyword",t.keyword,Jh.STRING,!0)&&hf("option.startTime",t.startTime,Jh.NUMBER,!0)&&hf("option.endTime",t.endTime,Jh.NUMBER,!0)&&hf("option.offset",t.offset,Jh.NUMBER)&&hf("option.limit",t.limit,Jh.NUMBER)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h,f,g;return ic(this,(function(p){switch(p.label){case 0:return n="conversation: ".concat(JSON.stringify(e),", option: ").concat(JSON.stringify(t)),o.info(Dd.O,"searchMessageInTimeRange -> ".concat(n)),i=e.conversationType,s=e.targetId,a=t.keyword,c=t.startTime,u=t.endTime,d=t.offset,l=t.limit,d=d||0,l=l||5,[4,r.searchMessageByContentInTimeRangeWithAllChannel(i,s,a,c,u,d,l)];case 1:return h=p.sent(),f=h.code,g=h.data,f===Ed.SUCCESS&&g?[2,{code:f,data:{messages:g.messages.map((function(e){return YP(e)}))}}]:(o.warn(Dd.O,"searchMessageInTimeRange fail -> code: ".concat(f,", ").concat(n)),[2,{code:f}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},getHistoryMessagesByMessageTypes:function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("option",t,Jh.OBJECT,!0)&&hf("option.count",t.count,Jh.NUMBER)&&hf("option.timestamp",t.timestamp,Jh.NUMBER)&&hf("option.order",t.order,(function(e){return[0,1].includes(e)}))&&hf("option.messageTypes",t.messageTypes,Jh.ARRAY,!0)&&!t.messageTypes.some((function(e){return!hf("option.messageType",e,Jh.STRING,!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h,f,g,p,v,_,E;return ic(this,(function(m){switch(m.label){case 0:return n=t.count,i=t.timestamp,s=t.order,a=t.messageTypes,c="conversation: ".concat(JSON.stringify(e),", option: ").concat(JSON.stringify(t)),o.info(Dd.O,"getHistoryMessagesByMessageTypes -> ".concat(c)),u=e.conversationType,d=e.targetId,l=e.channelId,n||(n=20),i||(i=0),s||(s=0),l||(l=""),[4,r.getHistoryMessagesByObjectNames(u,d,i,n,a,s,l)];case 1:return h=m.sent(),f=h.code,g=h.data,f===Ed.SUCCESS?(v=(p=g).list,_=p.hasMore,E=v.map((function(e){return YP(e)})),[2,{code:f,data:{messages:E,hasMore:_,list:E}}]):(o.warn(Dd.O,"getHistoryMessagesByMessageTypes fail -> code: ".concat(f," ").concat(c)),[2,{code:f,msg:iD[f]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},setMessageStatusToRead:function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("timestamp",t,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return n="conversation: ".concat(JSON.stringify(e),", timestamp: ").concat(t),o.info(Dd.O,"updateSentMsgReceiptStatus -> ".concat(n)),i=e.conversationType,s=e.targetId,a=e.channelId,[4,r.setMessageStatusToRead(i,s,t,a)];case 1:return[2,c.sent()]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},setMessageReceivedStatus:function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("messageId",e,Jh.NUMBER,!0)&&hf("receivedStatus",t,(function(e){return!ll(to[e])}),!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){return ic(this,(function(n){switch(n.label){case 0:return o.info(Dd.O,"setMessageReceivedStatus -> messageId: ".concat(e,", receivedStatus: ").concat(t)),[4,r.setMessageReceivedStatus(e,t)];case 1:return[2,{code:n.sent()}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},setMessageSentStatus:function(t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return wE()?hf("messageId",t,Jh.NUMBER,!0)&&hf("sentStatus",n,(function(t){return!ll(e.SentStatus[t])}),!0)?[2,nD((function(e,o){return oc(r,void 0,void 0,(function(){return ic(this,(function(r){switch(r.label){case 0:return o.info(Dd.O,"setMessageSentStatus ->messageId: ".concat(t,", sentStatus: ").concat(n)),[4,e.setMessageSentStatus(t,n)];case 1:return[2,{code:r.sent()}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},setMessageContent:function(e,t,n){return void 0===n&&(n=""),oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return wE()?hf("messageId",e,Jh.NUMBER,!0)&&hf("content",t,Jh.OBJECT,!0)&&hf("messageType",n,Jh.ONLY_STRING,!0)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){return ic(this,(function(r){switch(r.label){case 0:return i.info(Dd.O,"setMessageSentStatus ->messageId: ".concat(e,", messageType: ").concat(n)),[4,o.setMessageContent(e,t,n)];case 1:return[2,{code:r.sent()}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},deleteMessages:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?!hf("messageIds",e,Jh.ARRAY,!0)||e.some((function(e){return!hf("messageId",e,Jh.NUMBER,!0)}))?[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){return ic(this,(function(t){switch(t.label){case 0:return r.info(Dd.O,"deleteMessages ->messageIds: ".concat(JSON.stringify(e))),[4,n.deleteMessages(e)];case 1:return[2,{code:t.sent()}]}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},clearMessages:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return t=e.conversationType,o=e.targetId,i=e.channelId,r.info(Dd.O,"clearMessages ->targetId:".concat(o,",conversationType:").concat(t)),[4,n.clearMessages(t,o,i)];case 1:return(s=a.sent())===Ed.SUCCESS?[2,{code:s}]:(r.warn(Dd.O,"clearMessages ->code:".concat(s,",targetId:").concat(o)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},deleteMessagesByTimestamp:function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s=this;return ic(this,(function(a){return wE()?(r=e.conversationType,o=e.targetId,i=e.channelId,hf("conversationType",r,Jh.NUMBER,!0)&&hf("targetId",o,Jh.STRING,!0)&&hf("timestamp",t,Jh.NUMBER,!0)&&hf("cleanSpace",n,Jh.BOOLEAN)?[2,nD((function(e,a){return oc(s,void 0,void 0,(function(){var s;return ic(this,(function(c){switch(c.label){case 0:return[4,e.deleteMessagesByTimestamp(r,o,t,n,i)];case 1:return(s=c.sent())===Ed.SUCCESS?[2,{code:s}]:(a.warn(Dd.O,"deleteMessagesByTimestamp ->code:".concat(s,",targetId:").concat(o)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]):[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},insertMessage:function(e,t,n){return void 0===n&&(n={}),oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("message",t,Jh.OBJECT,!0)&&hf("options",n,Jh.OBJECT)&&hf("options.isUnread",null==n?void 0:n.isUnread,Jh.BOOLEAN)&&hf("options.searchContent",null==n?void 0:n.searchContent,Jh.STRING)&&(t instanceof hD||hf("message.senderUserId",t.senderUserId,Jh.STRING,!0)&&hf("message.messageType",t.messageType,Jh.STRING,!0)&&hf("message.content",t.content,Jh.OBJECT,!0)&&hf("message.messageDirection",t.messageDirection,Jh.NUMBER,!0)&&hf("message.canIncludeExpansion",t.canIncludeExpansion,Jh.BOOLEAN)&&hf("message.expansion",t.expansion,Jh.OBJECT)&&hf("message.disableNotification",t.disableNotification,Jh.BOOLEAN)&&hf("message.sentTime",t.sentTime,Jh.NUMBER)&&hf("message.sentStatus",t.sentStatus,Jh.NUMBER))?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a,c,u,d,l,h,f,g,p,v,_,E,m;return ic(this,(function(T){switch(T.label){case 0:return r="",s=1,d=!1,h=t.messageType,f=t.content,t instanceof hD||(r=t.senderUserId,s=t.messageDirection,d=t.canIncludeExpansion,l=t.expansion,u=t.disableNotification,a=t.sentTime,c=t.sentStatus),i.info(Dd.O,"insertMessage ->targetId:".concat(e.targetId,",conversationType:").concat(e.conversationType)),g=n.isUnread,p=n.searchContent,v={senderUserId:r,messageType:h,content:f,messageDirection:s,sentTime:a,sentStatus:c,searchContent:p,isUnread:g,messageUId:"",disableNotification:u,canIncludeExpansion:d,expansionMsg:JSON.stringify(l),channelId:e.channelId||""},[4,o.insertMessage(e.conversationType,e.targetId,v)];case 1:return _=T.sent(),E=_.code,m=_.data,E===Ed.SUCCESS?[2,{code:E,data:YP(m)}]:(i.warn(Dd.O,"insertMessage ->code:".concat(E,",targetId:").concat(e.targetId)),[2,{code:E,msg:iD[E]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},batchInsertMessage:function(e,t){var n,r;return oc(this,void 0,void 0,(function(){var o,i=this;return ic(this,(function(s){if(!wE())return[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}];if(!hf("messages",e,(function(e){return sl(e)&&!(e.length<=0||e.length>=500)}),!0)||!hf("checkDuplicate",t,Jh.BOOLEAN))return[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}];for(o in e)if(!(hf("message",e[o],Jh.OBJECT,!0)&&hf("message.conversationType",e[o].conversationType,(function(e){return[Td.PRIVATE,Td.DISCUSSION,Td.GROUP,Td.CUSTOMER_SERVICE,Td.SYSTEM,Td.APP_PUBLIC_SERVICE,Td.PUBLIC_SERVICE].includes(e)}),!0)&&hf("message.targetId",e[o].targetId,Jh.STRING,!0)&&hf("message.senderUserId",e[o].senderUserId,Jh.STRING,!0)&&hf("message.messageType",e[o].messageType,Jh.STRING,!0)&&hf("message.content",e[o].content,Jh.OBJECT,!0)&&hf("message.messageDirection",e[o].messageDirection,Jh.NUMBER,!0)&&hf("message.canIncludeExpansion",e[o].canIncludeExpansion,Jh.BOOLEAN)&&hf("message.expansion",e[o].expansion,Jh.OBJECT)&&hf("message.disableNotification",e[o].disableNotification,Jh.BOOLEAN)&&hf("message.sentTime",e[o].sentTime,Jh.NUMBER)&&hf("message.sentStatus",e[o].sentStatus,Jh.NUMBER)&&hf("options.isUnread",null===(n=e[o])||void 0===n?void 0:n.isUnread,Jh.BOOLEAN)&&hf("options.searchContent",null===(r=e[o])||void 0===r?void 0:r.searchContent,Jh.STRING)))return[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER,msg:String(o)}];return[2,nD((function(n){return oc(i,void 0,void 0,(function(){var r,o,i;return ic(this,(function(s){switch(s.label){case 0:return[4,n.batchInsertMessage(e,t)];case 1:return r=s.sent(),o=r.code,i=r.data,o===Ed.SUCCESS?[2,{code:o,data:i}]:[2,{code:o,msg:iD[o]}]}}))}))}))]}))}))},getMessageCount:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?[2,nD((function(n){return oc(t,void 0,void 0,(function(){var t,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t=e.conversationType,r=e.targetId,o=e.channelId,[4,n.getMessageCount(t,r,o)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS?[2,{code:s,data:a}]:[2,{code:s,msg:iD[s]}]}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},getPrivateMessageDeliverTime:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?hf("messageUId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return[4,n.getPrivateMessageDeliverTime(e)];case 1:return t=s.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?[2,{code:o,data:i}]:(r.warn(Dd.A_GET_PRIVATE_MESSAGE_DELIVER_TIME_E,"code:".concat(o,",messageUId:").concat(e)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},getGroupMessageDeliverList:function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("targetId",e,Jh.STRING,!0)&&hf("messageUId",t,Jh.STRING,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,r.getGroupMessageDeliverList(e,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(o.warn(Dd.A_GET_GROUP_MESSAGE_DELIVER_LIST_E,"code:".concat(i,", targetId:").concat(e," messageUId:").concat(t)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},setCheckDuplicateMessage:function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?hf("enableCheck",e,Jh.BOOLEAN)?[2,nD((function(n){return oc(t,void 0,void 0,(function(){return ic(this,(function(t){switch(t.label){case 0:return[4,n.setCheckDuplicateMessage(e)];case 1:return[2,{code:t.sent().code}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},clearLocalData:function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return wE()?[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return n.info(Dd.O,"clearLocalData ->"),[4,t.clearData()];case 1:return e=i.sent(),r=e.code,o=e.data,[2,{code:r,data:o}]}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))}}),QG=function(e,t,n){this.type=e,this.userIdList=t,this.mentionedContent=n};e.BaseMessage=hD,e.ChatroomEntryType=Vd,e.ChatroomUserChangeType=kd,e.CombineMessage=ED,e.ConnectType={COMET:"comet",WEBSOCKET:"websocket"},e.ConnectionStatus=yd,e.ConversationType=Td,e.ErrorCode=Ed,e.FileMessage=mD,e.FileType=gd,e.GIFMessage=TD,e.HQVoiceMessage=pD,e.ImageMessage=gD,e.LocationMessage=yD,e.MentionedInfoBody=QG,e.MentionedType=Ud,e.MessageBlockType=Hd,e.MessageDirection=vd,e.MessageType={TEXT:"RC:TxtMsg",VOICE:"RC:VcMsg",HQ_VOICE:"RC:HQVCMsg",IMAGE:"RC:ImgMsg",GIF:"RC:GIFMsg",RICH_CONTENT:"RC:ImgTextMsg",LOCATION:"RC:LBSMsg",FILE:"RC:FileMsg",SIGHT:"RC:SightMsg",COMBINE:"RC:CombineMsg",CHRM_KV_NOTIFY:"RC:chrmKVNotiMsg",LOG_COMMAND:"RC:LogCmdMsg",EXPANSION_NOTIFY:"RC:MsgExMsg",REFERENCE:"RC:ReferenceMsg",RECALL_MESSAGE_TYPE:"RC:RcCmd"},e.NotificationLevel=Ad,e.NotificationStatus=Od,e.ReceivedStatus=to,e.ReferenceMessage=RD,e.RichContentMessage=CD,e.SightMessage=vD,e.TextMessage=_D,e.UploadMethod=wd,e.VoiceMessage=ID,e.__addSDKVersion=function(e,t){Eh.add(e,t)},e.addConversationsToTag=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("tagId",e,Jh.STRING,!0)&&hf("conversations",t,Jh.ARRAY,!0)&&!t.some((function(e){return!hf("conversation",e,Jh.CONVERSATION,!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n;return ic(this,(function(i){switch(i.label){case 0:return o.info(Dd.O,"addTagForConversations ->tagId:".concat(e)),[4,r.addTagForConversations(e,t)];case 1:return(n=i.sent().code)===Ed.SUCCESS?[2,{code:n}]:(o.warn(Dd.O,"addTagForConversations ->code:".concat(n,",tagId:").concat(e)),[2,{code:n,msg:iD[n]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.addEventListener=function(e,t,n){WP.on(e,t,n)},e.addTag=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("tag.tagId",e.tagId,Jh.STRING,!0)&&hf("tag.tagId",e.tagId,(function(e){return e.length<=10}))&&hf("tag.tagName",e.tagName,(function(e){return e.length<=15}))&&hf("tag.tagName",e.tagName,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(o){switch(o.label){case 0:return r.info(Dd.O,"createTag ->tagId:".concat(e.tagId,",tagName:").concat(e.tagName)),[4,n.createTag(e)];case 1:return(t=o.sent().code)===Ed.SUCCESS?[2,{code:t}]:(r.warn(Dd.O,"createTag ->code:".concat(t,",tagId:").concat(e.tagId)),[2,{code:t,msg:iD[t]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.addToBlacklist=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("userId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){return ic(this,(function(t){switch(t.label){case 0:return r.info(Dd.O,"addToBlacklist -> userId: ".concat(e)),[4,n.addToBlacklist(e)];case 1:return[2,{code:t.sent()}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.bindRTCRoomForChatroom=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("option.chatRoomId",e.chatRoomId,Jh.STRING,!0)&&hf("option.rtcRoomId",e.rtcRoomId,Jh.STRING,!0)?[2,nD((function(n){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(r){switch(r.label){case 0:return[4,n.bindRTCRoomForChatroom(e)];case 1:return[2,{code:t=r.sent(),msg:iD[t]}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.clearAllMessagesUnreadStatus=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){return ic(this,(function(e){switch(e.label){case 0:return[4,t.clearAllUnreadCount()];case 1:return[2,{code:e.sent()}]}}))}))}))]}))}))},e.clearEventListeners=rD,e.clearHistoryMessages=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("timestamp",t,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),o.debug(Dd.O,"clear message ->".concat(n)),[4,r.deleteRemoteMessageByTimestamp(e.conversationType,e.targetId,t,e.channelId)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"clear message ->".concat(i,":").concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:Ed.SUCCESS}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.clearMessages=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return QP("RongIMLib.clearMessages","RongIMLib.ElectronExtension.clearMessages"),wE()?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return t=e.conversationType,o=e.targetId,i=e.channelId,r.info(Dd.O,"clearMessages ->targetId:".concat(o,",conversationType:").concat(t)),[4,n.clearMessages(t,o,i)];case 1:return(s=a.sent())===Ed.SUCCESS?[2,{code:s}]:(r.warn(Dd.O,"clearMessages ->code:".concat(s,",targetId:").concat(o)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.clearMessagesUnreadStatus=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o;return ic(this,(function(i){switch(i.label){case 0:return[4,n.clearUnreadCount(e.conversationType,e.targetId,e.channelId)];case 1:return t=i.sent(),o="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),r.debug(Dd.O,"clear unreadMsgNum ->".concat(o)),t!==Ed.SUCCESS?(r.warn(Dd.O,"clear unreadMsgNum fail ->".concat(t,":").concat(iD[t],",").concat(o)),[2,{code:t,msg:iD[t]}]):[2,{code:t}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.clearTextMessageDraft=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o;return ic(this,(function(i){switch(i.label){case 0:return t="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),r.debug(Dd.O,"delete draft  ->".concat(t)),[4,n.clearConversationMessageDraft(e.conversationType,e.targetId,e.channelId)];case 1:return(o=i.sent())===Ed.SUCCESS?[2,{code:o}]:(r.warn(Dd.O,"delete draft fail ->".concat(o,":").concat(iD[o],",").concat(t)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.clearUnreadCountByTimestamp=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("timestamp",t,Jh.NUMBER)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return n=e.conversationType,i=e.targetId,s=e.channelId,o.info(Dd.O,"clearUnreadCountByTimestamp ->targetId:".concat(i,",conversationType:").concat(n)),[4,r.clearUnreadCountByTimestamp(n,i,t,s)];case 1:return(a=c.sent())===Ed.SUCCESS?[2,{code:a}]:(o.warn(Dd.O,"clearUnreadCountByTimestamp ->code:".concat(a,",targetId:").concat(i)),[2,{code:a,msg:iD[a]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.connect=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return hf("token",e,Jh.STRING,!0)&&hf("reconnectKickEnable",t,Jh.BOOLEAN)?(n=o.createTraceId(),o.info(Dd.A_CONNECT_T,JSON.stringify({token:e,reconnectKickEnable:t}),n),[4,r.connect(e,!!t,n)]):[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}];case 1:return i=a.sent(),s=i.code===Ed.SUCCESS?"info":"warn",o[s](Dd.A_CONNECT_R,JSON.stringify({code:i.code,userId:i.userId}),n),i.code===Ed.SUCCESS?[2,{code:i.code,data:{userId:i.userId}}]:[2,{code:i.code,msg:iD[i.code]}]}}))}))}))]}))}))},e.deleteLocalMessagesByTimestamp=function(e,t,n){return oc(this,void 0,void 0,(function(){var r,o,i,s=this;return ic(this,(function(a){return QP("RongIMLib.deleteLocalMessagesByTimestamp","RongIMLib.ElectronExtension.deleteMessagesByTimestamp"),wE()?(r=e.conversationType,o=e.targetId,i=e.channelId,hf("conversationType",r,Jh.NUMBER,!0)&&hf("targetId",o,Jh.STRING,!0)&&hf("timestamp",t,Jh.NUMBER,!0)&&hf("cleanSpace",n,Jh.BOOLEAN)?[2,nD((function(a,c){return oc(s,void 0,void 0,(function(){var s;return ic(this,(function(u){switch(u.label){case 0:return[4,a.deleteMessagesByTimestamp(r,o,t,n,i)];case 1:return s=u.sent(),c.debug(Dd.A_DELETE_MESSAGES_S,JSON.stringify({code:s,conversationType:r,targetId:o,channelId:i,timestamp:t})),s===Ed.SUCCESS?[2,{code:s}]:(c.warn(Dd.O,"deleteLocalMessagesByTimestamp ->code:".concat(s,",targetId:").concat(e.targetId)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]):[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.deleteMessages=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("options",t,(function(e){return sl(e)&&e.length}),!0)&&!t.some((function(e){return!hf("options.messageUId",e.messageUId,Jh.STRING,!0)||!hf("options.sentTime",e.sentTime,Jh.NUMBER,!0)||!hf("options.messageDirection",e.messageDirection,(function(e){return 1===e||2===e}),!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),o.debug(Dd.O,"delete messages ->".concat(n)),[4,r.deleteRemoteMessage(e.conversationType,e.targetId,t,e.channelId)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"delete message fail ->".concat(i,":").concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:Ed.SUCCESS}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.destroy=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return zP?(rD(),[2,eD()]):[2]}))}))},e.disconnect=function(e){return Rh(Dd.A_DISCONNECT_O,{}),tD((function(t){return t.disconnect(e)}))},e.electronExtension=JG,e.forceRemoveChatRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&lD(t)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="id:".concat(e),o.info(Dd.O,"force remove chatroom entry ->".concat(n)),[4,r.forceRemoveChatroomEntry(e,t)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"force remove chatroom entry fail ->code+:".concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.forceSetChatRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&dD(t)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"force set chatroom entry ->".concat(n)),[4,r.forceSetChatroomEntry(e,t)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"force set chatroom entry fail ->code+:".concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getAllChatRoomEntries=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("targetId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return t="id:".concat(e),r.debug(Dd.O,"get all chatroom entries->".concat(t)),[4,n.getAllChatroomEntries(e)];case 1:return o=a.sent(),i=o.code,s=o.data,i===Ed.SUCCESS&&s?[2,{code:i,data:s}]:(r.warn(Dd.O,"get all chatroom entries fail ->code+:".concat(iD[i],",").concat(t)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getAllConversationState=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,nD((function(e){return e.getAllConversationState()}))]}))}))},e.getAllUltraGroupUnreadCount=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return e="getAllUltraGroupUnreadCount",[4,t.getAllUltraGroupUnreadCount()];case 1:return r=s.sent(),o=r.code,i=r.data,n.debug(Dd.O,e),o===Ed.SUCCESS?[2,{code:o,data:i}]:(n.warn(Dd.O,"".concat(e," fail ->").concat(o,": ").concat(iD[o])),[2,{code:o,msg:iD[o]}])}}))}))}))]}))}))},e.getAllUltraGroupUnreadMentionedCount=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return e="getAllUltraGroupUnreadMentionedCount",!0,[4,t.getAllUltraGroupUnreadCount(true)];case 1:return r=s.sent(),o=r.code,i=r.data,n.debug(Dd.O,e),o===Ed.SUCCESS?[2,{code:o,data:i}]:(n.warn(Dd.O,"".concat(e," fail ->").concat(o,": ").concat(iD[o])),[2,{code:o,msg:iD[o]}])}}))}))}))]}))}))},e.getAllUnreadMentionedCount=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,nD((function(e,t){return t.debug(Dd.O,"getAllUnreadMentionedCount"),e.getAllUnreadMentionedCount()}))]}))}))},e.getBlacklist=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return n.info(Dd.O,"getBlacklist -> "),[4,t.getBlacklist()];case 1:return e=i.sent(),r=e.code,o=e.data,r===Ed.SUCCESS&&o?[2,{code:r,data:o}]:(n.warn(Dd.O,"getBlacklist fail -> code: ".concat(r)),[2,{code:r}])}}))}))}))]}))}))},e.getBlacklistStatus=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("userId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return r.info(Dd.O,"getBlacklistStatus -> userId: ".concat(e)),[4,n.getBlacklistStatus(e)];case 1:return t=s.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?[2,{code:o,data:0===i}]:(r.warn(Dd.O,"getBlacklistStatus fail -> code: ".concat(o,",  userId: ").concat(e)),[2,{code:o}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getBlockUltraGroupList=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return[4,t.getBlockUltraGroupList()];case 1:return e=i.sent(),r=e.code,o=e.data,r===Ed.SUCCESS?[2,{code:Ed.SUCCESS,data:o}]:(n.warn(Dd.O,"get block ultragroup  ->".concat(r,":").concat(iD[r])),[2,{code:r,msg:iD[r]}])}}))}))}))]}))}))},e.getBlockedConversationList=function(){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){return[2,nD((function(e){return e.getBlockConversationList()}))]}))}))},e.getChatRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("key",t,(function(e){return ol(e)&&/[\w+=-]+/.test(e)&&e.length<=128}),!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"get chatroom entry->".concat(n)),[4,r.getChatroomEntry(e,t)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?[2,{code:s,data:a}]:(o.warn(Dd.O,"get chatroom entry fail ->code+:".concat(iD[s],",").concat(n)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getChatRoomInfo=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("options.count",t.count,Jh.NUMBER)&&hf("options.order",t.order,(function(e){return[0,1,2].includes(e)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"get chatroom info ->".concat(n)),[4,r.getChatroomInfo(e,t.count,t.order)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?[2,{code:s,data:a}]:(o.warn(Dd.O,"get chatroom info fail ->code+:".concat(iD[s],",").concat(n)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getChatroomHistoryMessages=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("options.timestamp",t.timestamp,Jh.NUMBER)&&hf("options.count",t.count,Jh.NUMBER)&&hf("options.order",t.order,(function(e){return 0===e||1===e}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"get chatroom history message->".concat(n)),[4,r.getChatRoomHistoryMessages(e,t.count,t.order,t.timestamp)];case 1:return i=u.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?(c=a.list.map((function(e){return YP(e)})),[2,{code:s,data:{list:c,hasMore:!!a.hasMore}}]):(o.warn(Dd.O,"get chatroom history message fail ->code+:".concat(iD[s],",").concat(n)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getConnectionStatus=function(){return tD((function(e){return e.getConnectionStatus()}))},e.getConversation=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return[4,n.getConversation(e.conversationType,e.targetId,e.channelId||"")];case 1:return t=s.sent(),o=t.code,i=t.data,o!==Ed.SUCCESS?(r.warn(Dd.O,"getConversation ->code:".concat(o,", targetId:").concat(e.targetId)),[2,{code:o,msg:iD[o]}]):[2,{code:o,data:i?JP(i):null}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getConversationList=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options.count",null==e?void 0:e.count,Jh.NUMBER)&&hf("options.startTime",null==e?void 0:e.startTime,Jh.NUMBER)&&hf("options.order",null==e?void 0:e.order,Jh.NUMBER)&&hf("channelId",t,Jh.CHANNEL_ID)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,r.getConversationList(null==e?void 0:e.count,void 0,null==e?void 0:e.startTime,null==e?void 0:e.order,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS&&s?[2,{code:0,data:s.map((function(e){return JP(e)}))}]:(o.warn(Dd.O,"get conversation list fail ->".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getConversationNotificationLevel=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return t=cD(r,e,"getConversationNotificationLevel"),[4,n.getConversationNotificationLevel(e.conversationType,e.targetId,e.channelId)];case 1:return o=a.sent(),i=o.code,s=o.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(r.warn(Dd.O,"getConversationNotificationLevel fail -> ".concat(i," : ").concat(iD[i]," , ").concat(t)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getConversationNotificationStatus=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return r.info(Dd.O,"getConversationNotificationStatus ->targetId:".concat(e.targetId,",conversationType:").concat(e.conversationType)),[4,n.getConversationNotificationStatus(e.conversationType,e.targetId,e.channelId)];case 1:return t=s.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?[2,{code:o,data:i}]:(r.warn(Dd.O,"getConversationNotificationStatus ->code:".concat(o,",targetId:").concat(e.targetId)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getConversationsFromTagByPage=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return hf("tagId",e,Jh.STRING,!0)&&hf("count",t,Jh.NUMBER,!0)&&hf("startTime",n,Jh.NUMBER,!0)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a;return ic(this,(function(c){switch(c.label){case 0:return i.info(Dd.O,"getConversationListByTag ->tagId:".concat(e)),[4,o.getConversationListByTag(e,n,t)];case 1:return r=c.sent(),s=r.code,a=r.data,s===Ed.SUCCESS?[2,{code:s,data:null==a?void 0:a.map((function(e){return function(e){return rc(rc({},JP(e)),{isTopInTag:e.isTopInTag})}(e)}))}]:(i.warn(Dd.O,"getConversationListByTag ->code:".concat(s,",tagId:").concat(e)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getCurrentUserId=function(){return tD((function(e){return e.getCurrentUserId()}))},e.getDeviceId=function(){return tD((function(e){return e.getDeviceId()}))},e.getFileToken=function(e,t,n,r){return nD((function(o){return new Promise((function(i){o.getFileToken(e,t,n,r).then((function(e){i({code:Ed.SUCCESS,data:e})})).catch((function(e){i({code:e,msg:iD[e]})}))}))}))},e.getFileUrl=kG,e.getFirstUnreadMessage=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?hf("conversation",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,n.getFirstUnreadMessage(e.conversationType,e.targetId,e.channelId)];case 1:return t=a.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?(s=i&&YP(i)||null,[2,{code:o,data:s}]):(r.warn(Dd.O,"insertMessage ->code:".concat(o,",targetId:").concat(e.targetId)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.getHistoryMessages=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options.timestamp",null==t?void 0:t.timestamp,Jh.NUMBER)&&hf("options.count",null==t?void 0:t.count,Jh.NUMBER)&&hf("options.order",null==t?void 0:t.order,(function(e){return 0===e||1===e}))&&hf("conversation",e,Jh.CONVERSATION,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n=o.createTraceId(),o.info(Dd.A_GET_HISTORY_MSG_T,JSON.stringify({targetId:e.targetId,conversationType:e.conversationType,channelId:e.channelId,timestamp:null==t?void 0:t.timestamp,count:null==t?void 0:t.count}),n),[4,r.getHistoryMessage(e.conversationType,e.targetId,null==t?void 0:t.timestamp,null==t?void 0:t.count,null==t?void 0:t.order,null==e?void 0:e.channelId,"",n)];case 1:return i=u.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?(c=a.list.map((function(e){return YP(e)})),o.info(Dd.A_GET_HISTORY_MSG_R,JSON.stringify({code:s,messageLength:c.length}),n),[2,{code:s,data:{list:c,hasMore:a.hasMore}}]):(o.warn(Dd.A_GET_HISTORY_MSG_R,JSON.stringify({code:s,messageUIds:""}),n),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getMessage=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return wE()?hf("messageId",e,(function(e){return il(e)||ol(e)}),!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return[4,n.getMessage(e)];case 1:return t=s.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?[2,{code:o,data:YP(i)}]:(r.warn(Dd.O,"getMessage ->code:".concat(o,",messageId:").concat(e)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.getMessageReader=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return hf("messageUId",t,Jh.STRING,!0)&&hf("targetId",e,Jh.STRING,!0)&&hf("channelId",n,Jh.CHANNEL_ID)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return r="messageUId:".concat(t,",targetId:").concat(e),i.debug(Dd.O,"get message reader ->".concat(r)),[4,o.getMessageReader(e,t,n)];case 1:return s=u.sent(),a=s.code,c=s.data,a===Ed.SUCCESS?[2,{code:a,data:c}]:(i.warn(Dd.O,"get message reader fail ->".concat(a,":").concat(iD[a],",").concat(r)),[2,{code:a,msg:iD[a]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getProxy=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return[4,t.getProxy()];case 1:return e=i.sent(),r=e.code,o=e.data,r===Ed.SUCCESS?[2,{code:r,data:o}]:(n.warn(Dd.O,"getProxy ->code:".concat(r)),[2,{code:r,msg:iD[r]}])}}))}))}))]}))}))},e.getRemoteHistoryMessages=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options.timestamp",null==t?void 0:t.timestamp,Jh.NUMBER)&&hf("options.count",null==t?void 0:t.count,Jh.NUMBER)&&hf("options.order",null==t?void 0:t.order,(function(e){return 0===e||1===e}))&&hf("conversation",e,Jh.CONVERSATION,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),o.debug(Dd.O,"get history message ->".concat(n)),[4,r.getRemoteHistoryMessages(e.conversationType,e.targetId,(null==t?void 0:t.timestamp)||0,(null==t?void 0:t.count)||20,(null==t?void 0:t.order)||0,e.channelId||"")];case 1:return i=u.sent(),s=i.code,a=i.data,s===Ed.SUCCESS&&a?(c=a.list.map((function(e){return YP(e)})),[2,{code:s,data:{list:c,hasMore:a.hasMore}}]):(o.warn(Dd.O,"get history message fail ->".concat(s,":").concat(iD[s],",").concat(n)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getServerTime=function(){return tD((function(e){return e.getServerTime()}))},e.getTags=function(){return oc(this,void 0,void 0,(function(){var e=this;return ic(this,(function(t){return[2,nD((function(t,n){return oc(e,void 0,void 0,(function(){var e,r,o;return ic(this,(function(i){switch(i.label){case 0:return[4,t.getTagList()];case 1:return e=i.sent(),r=e.code,o=e.data,r===Ed.SUCCESS?[2,{code:Ed.SUCCESS,data:o}]:(n.warn(Dd.O,"getTagList ->code:".concat(r)),[2,{code:r,msg:iD[r]}])}}))}))}))]}))}))},e.getTagsFromConversation=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("conversation",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return r.info(Dd.O,"getTagsForConversation ->targetId:".concat(e.targetId,",conversationType:").concat(e.conversationType)),[4,n.getTagsForConversation(e)];case 1:return t=s.sent(),o=t.code,i=t.data,o===Ed.SUCCESS?[2,{code:o,data:i}]:[2,{code:o,msg:iD[o]}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getTextMessageDraft=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,n.getConversationMessageDraft(e.conversationType,e.targetId,e.channelId)];case 1:return t=a.sent(),o=t.code,i=t.data,s="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),r.debug(Dd.O,"get draft ->".concat(s)),o===Ed.SUCCESS?[2,{code:o,data:i||""}]:(r.warn(Dd.O,"get draft fail ->".concat(o,":").concat(iD[o],",").concat(s)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getTopConversationList=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversationTypes",e,Jh.ARRAY)&&!(null==e?void 0:e.some((function(e){return!hf("conversationType",e,pl)})))&&hf("channelId",t,Jh.CHANNEL_ID)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,r.getTopConversationList(e,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS&&s?[2,{code:0,data:s.map((function(e){return JP(e)}))}]:(o.warn(Dd.A_GET_TOP_CONVERSATION_LIST_E,"".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getTotalUnreadCount=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("includeMuted",e,Jh.BOOLEAN,!1)&&hf("conversationTypes",t,Jh.ARRAY,!1)&&!(null==t?void 0:t.some((function(e){return!hf("conversationType",e,pl)})))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return o.debug(Dd.O,"get total unread count -> ConversationType:".concat(JSON.stringify(t)," includeMuted:").concat(e)),[4,r.getTotalUnreadCount("",t,e)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(o.warn(Dd.O,"getTotalUnreadCount fail ->".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getTotalUnreadCountByLevels=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return!hf("conversationTypes",e,Jh.ARRAY,!0)||!hf("levels",t,Jh.ARRAY,!0)||e.some((function(e){return!hf("conversationType",e,pl)}))||t.some((function(e){return!hf("level",e,vl)}))?[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,r.getTotalUnreadCountByLevels(e,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(o.warn(Dd.O,"getTotalUnreadCountByLevels fail ->".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]}))}))},e.getTotalUnreadMentionedCountByLevels=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return!hf("conversationTypes",e,Jh.ARRAY,!0)||!hf("levels",t,Jh.ARRAY,!0)||e.some((function(e){return!hf("conversationType",e,pl)}))||t.some((function(e){return!hf("level",e,vl)}))?[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,r.getTotalUnreadCountByLevels(e,t,!0)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(o.warn(Dd.O,"getTotalUnreadMentionedCountByLevels fail ->".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]}))}))},e.getUltraGroupDefaultNotificationLevel=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options.targetId",e.targetId,Jh.STRING,!0)&&hf("options.channelId",e.channelId,Jh.CHANNEL_ID)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t="getUltraGroupDefaultNotificationLevel",o="targetId: ".concat(e.targetId,", channelId: ").concat(e.channelId),r.debug(Dd.O,"".concat(t," -> ").concat(o)),[4,n.getUltraGroupDefaultNotificationLevel(e.targetId,e.channelId)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS?[2,{code:s,data:a}]:(r.warn(Dd.O,"".concat(t," fail -> ").concat(s," : ").concat(iD[s]," , ").concat(o)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupFirstUnreadMessageTimestamp=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("conversation.targetId",e.targetId,Jh.STRING,!0)&&hf("conversation.channelId",e.channelId,Jh.CHANNEL_ID,!0)?[2,nD((function(n){return oc(t,void 0,void 0,(function(){var t,r,o,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return t=e.targetId,r=e.channelId,o={targetId:t,channelId:r},[4,n.getUltraGroupFirstUnreadMessageTimestamp(o)];case 1:return i=c.sent(),s=i.code,a=i.data,s===Ed.SUCCESS?[2,{code:s,data:a}]:[2,{code:s,msg:iD[s]}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupList=function(t){return void 0===t&&(t={}),oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options.targetId",t.targetId,Jh.STRING,!1)&&hf("options.channelType",t.channelType,(function(t){return void 0!==e.UltraGroupChannelType[t]}),!1)?[2,nD((function(e,r){return oc(n,void 0,void 0,(function(){var n,o,i;return ic(this,(function(s){switch(s.label){case 0:return[4,e.getUltraGroupList(t)];case 1:return n=s.sent(),o=n.code,i=n.data,o===Ed.SUCCESS?[2,{code:Ed.SUCCESS,data:i}]:(r.warn(Dd.O,"get ultragroup  ->".concat(o,":").concat(iD[o])),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupMessageListByMessageUId=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options",e,Jh.CONVERSATION,!0)&&hf("msgs",t,Jh.ARRAY,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h,f;return ic(this,(function(g){switch(g.label){case 0:return n=e.targetId,i=e.conversationType,s=e.channelId,a=[],t.forEach((function(e){var t=e.sendTime,n=e.messageUId;a.push({sendTime:t,messageUId:n,channelId:s})})),c={targetId:n,conversationType:i,messages:a},[4,r.getUltraGroupMessageListByMessageUId(c)];case 1:if(u=g.sent(),d=u.code,l=u.data,d===Ed.SUCCESS){for(f in h={},l)Object.prototype.hasOwnProperty.call(l,f)&&(h[f]=l[f]?YP(l[f]):void 0);return[2,{code:Ed.SUCCESS,data:h}]}return o.warn(Dd.O,"get UltraGroup MessageList by messageUId   ->".concat(d,":").concat(iD[d])),[2,{code:d,msg:iD[d]}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupUnreadCountByTargetId=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("notificationLevels",t,Jh.ARRAY)&&!(null==t?void 0:t.some((function(e){return!hf("notificationLevel",e,vl)})))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n="getUltraGroupUnreadCountByTargetId",[4,r.getUltraGroupUnreadCountByTargetId(e,t)];case 1:return i=u.sent(),s=i.code,a=i.data,c="targetId: ".concat(e,", levels: ").concat(JSON.stringify(t)),o.debug(Dd.O,"".concat(n," -> ").concat(c)),s===Ed.SUCCESS?[2,{code:s,data:a}]:(o.warn(Dd.O,"".concat(n," fail -> ").concat(s,": ").concat(iD[s],", ").concat(c)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupUnreadMentionedCountByTargetId=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("notificationLevels",t,Jh.ARRAY)&&!(null==t?void 0:t.some((function(e){return!hf("notificationLevel",e,vl)})))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return o.debug(Dd.O,"get UltraGroup unreadMentionedCount by targetId: ".concat(e,", notificationLevels: ").concat(JSON.stringify(t))),[4,r.getUltraGroupUnreadMentionedCountByTargetId(e,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:Ed.SUCCESS,data:s}]:(o.warn(Dd.O,"get UltraGroup unreadMentionedCount by targetId error ->".concat(i,":").concat(iD[i])),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUltraGroupUnreadMentionedMessages=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return e.channelId=e.channelId||"",hf("options.targetId",e.targetId,Jh.STRING,!0)&&hf("options.channelId",e.channelId,Jh.CHANNEL_ID,!0)&&hf("options.sentTime",e.sentTime,Jh.NUMBER,!0)&&hf("options.count",e.count,(function(e){return il(e)&&e>0&&e<=50}),!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return t=e.targetId,o=e.channelId,i=e.sentTime,s=e.count,a={targetId:t,channelId:o,sentTime:i,count:s},[4,n.getUltraGroupUnreadMentionedMessages(a)];case 1:return c=l.sent(),u=c.code,d=c.data,u===Ed.SUCCESS?[2,{code:u,data:d}]:(r.warn(Dd.O,"getUltraGroupUnreadMentionedMessages fail ->".concat(u,": ").concat(iD[u])),[2,{code:u,msg:iD[u]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUnreadConversationList=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return!hf("conversationTypes",e,Jh.ARRAY)||(null==e?void 0:e.some((function(e){return!hf("conversationType",e,El)})))?[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,r,o;return ic(this,(function(i){switch(i.label){case 0:return[4,n.getUnreadConversationList(e)];case 1:return t=i.sent(),r=t.code,o=t.data,r===Ed.SUCCESS&&o?[2,{code:0,data:o.map((function(e){return JP(e)}))}]:[2,{code:r,msg:iD[r]}]}}))}))}))]}))}))},e.getUnreadCount=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s;return ic(this,(function(a){switch(a.label){case 0:return[4,n.getUnreadCount(e.conversationType,e.targetId,e.channelId)];case 1:return t=a.sent(),o=t.code,i=t.data,s="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),r.debug(Dd.O,"get unreadCount ->".concat(s)),o===Ed.SUCCESS?[2,{code:o,data:i}]:(r.warn(Dd.O,"get unreadCount fail ->".concat(o,":").concat(iD[o],",").concat(s)),[2,{code:o,msg:iD[o]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUnreadCountByTag=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("tagId",e,Jh.STRING,!0)&&hf("containMuted",t,Jh.BOOLEAN,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return o.info(Dd.O,"getUnreadCountByTag ->tagId:".concat(e)),[4,r.getUnreadCountByTag(e,t)];case 1:return n=a.sent(),i=n.code,s=n.data,i===Ed.SUCCESS?[2,{code:i,data:s}]:(o.warn(Dd.O,"getUnreadCountByTag ->code:".concat(i,",tagId:").concat(e)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUnreadMentionedCount=function(e){return oc(this,void 0,void 0,(function(){return ic(this,(function(t){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(t,n){return n.debug(Dd.O,"getUnreadMentionedCount".concat(e.targetId,",channelId:").concat(e.channelId)),t.getUnreadMentionedCount(e)}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.getUnreadMentionedMessages=function(e){if(!wE())return{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]};var t,n=e.conversationType,r=e.targetId,o=e.channelId;return hf("conversation",e,Jh.CONVERSATION,!0)?(t=function(e){var t=e.getUnreadMentionedMessages(n,r,o),i=[];return t&&t.length&&t.forEach((function(e){return i.push(YP(e))})),{code:Ed.SUCCESS,data:i}},zP?t(zP,$P,XP):{code:Ed.BIZ_ERROR_CLIENT_NOT_INIT}):{code:Ed.BIZ_ERROR_INVALID_PARAMETER}},e.init=function(e){!function(e){var t,n=e.appkey,r=e.navigators;zP?$P.warn(Dd.A_INIT_REPEAT_O):(lf("options.appkey",e.appkey,Jh.STRING,!0),lf("options.navigators",e.navigators,(function(e){return sl(e)&&(0===e.length||e.every(fl))})),XP=e,zP=gP.init((null===(t=e.__runtimeCreator__)||void 0===t?void 0:t.call(e))||jP,{appkey:e.appkey,navigators:e.navigators||[],miniCMPProxy:e.customCMP||[],logOutputLevel:e.logOutputLevel,__reportLogLevel:e.__reportLogLevel,httpInMainProcess:!!e.httpInMainProcess,logExpireTime:e.logExpireTime}),($P=zP.createLogger("RC-IM","IM")).setOutputLevel(e.logOutputLevel),$P.info(Dd.A_INIT_O,JSON.stringify({appkey:n,navigators:r,version:"5.7.2",commit:"198acd040765e3df6c49ede5d005fecdc6872348"})),zP.assignWatcher(ZP))}(e)},e.insertMessage=function(e,t,n){return void 0===n&&(n={}),oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return QP("RongIMLib.insertMessage","RongIMLib.ElectronExtension.insertMessage"),wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("message",t,Jh.OBJECT,!0)&&hf("options",n,Jh.OBJECT)&&hf("options.isUnread",null==n?void 0:n.isUnread,Jh.BOOLEAN)&&hf("options.searchContent",null==n?void 0:n.searchContent,Jh.STRING)&&hf("content.senderUserId",t.senderUserId,Jh.STRING,!0)&&hf("content.messageType",t.messageType,Jh.STRING,!0)&&hf("content.content",t.content,Jh.OBJECT,!0)&&hf("content.messageDirection",t.messageDirection,Jh.NUMBER,!0)&&hf("content.canIncludeExpansion",t.canIncludeExpansion,Jh.BOOLEAN)&&hf("content.expansion",t.expansion,Jh.OBJECT)&&hf("content.disableNotification",t.disableNotification,Jh.BOOLEAN)&&hf("content.sentTime",t.sentTime,Jh.NUMBER)&&hf("content.sentStatus",t.sentStatus,Jh.NUMBER)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a,c,u,d,l,h,f,g,p,v,_,E,m,T;return ic(this,(function(I){switch(I.label){case 0:return r=t.senderUserId,s=t.messageType,a=t.content,c=t.messageDirection,u=t.messageUId,d=t.canIncludeExpansion,l=t.expansion,h=t.disableNotification,f=t.sentTime,g=t.sentStatus,i.info(Dd.O,"insertMessage ->targetId:".concat(e.targetId,",conversationType:").concat(e.conversationType)),p=n.isUnread,v=n.searchContent,_={senderUserId:r,messageType:s,content:a,messageDirection:c,sentTime:f,sentStatus:g,searchContent:v,isUnread:p,messageUId:u,disableNotification:h,canIncludeExpansion:d,expansionMsg:JSON.stringify(l),channelId:e.channelId||""},[4,o.insertMessage(e.conversationType,e.targetId,_)];case 1:return E=I.sent(),m=E.code,T=E.data,m===Ed.SUCCESS?[2,{code:m,data:YP(T)}]:(i.warn(Dd.O,"insertMessage ->code:".concat(m,",targetId:").concat(e.targetId)),[2,{code:m,msg:iD[m]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.installPlugin=function(e,t){return tD((function(n){return n.install(e,t)}))},e.joinChatRoom=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("options.count",t.count,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return n=o.createTraceId(),o.info(Dd.A_JOIN_CHATROOM_T,JSON.stringify({chatroomId:e,count:t.count,joinExist:!1}),n),[4,r.joinChatroom(e,t.count,n)];case 1:return i=a.sent(),s=i===Ed.SUCCESS?"info":"warn",o[s](Dd.A_JOIN_CHATROOM_R,JSON.stringify({code:i,timestamp:(new Date).getTime()}),n),i!==Ed.SUCCESS?[2,{code:i,msg:iD[i]}]:[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.joinExistChatRoom=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&hf("options.count",t.count,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return n=o.createTraceId(),o.info(Dd.A_JOIN_CHATROOM_T,JSON.stringify({chatroomId:e,count:t.count,joinExist:!0}),n),[4,r.joinExistChatroom(e,t.count,n)];case 1:return i=a.sent(),s=i===Ed.SUCCESS?"info":"warn",o[s](Dd.A_JOIN_CHATROOM_R,JSON.stringify({code:i,timestamp:(new Date).getTime()}),n),i!==Ed.SUCCESS?[2,{code:i,msg:iD[i]}]:[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.modifyMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("content",e,Jh.OBJECT,!0)&&hf("message",t,Jh.OBJECT,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h,f;return ic(this,(function(g){switch(g.label){case 0:return n=t.conversationType,i=t.targetId,s=t.messageUId,a=t.senderUserId,c=t.sentTime,u=t.canIncludeExpansion,d=t.channelId,l="conversationType:".concat(n,",targetId:").concat(i,",channelId:").concat(d,",messageUId:").concat(s),o.debug(Dd.O,"update ultragroup message expansion ->".concat(l)),h={targetId:i,channelId:d,conversationType:n,fromUserId:a,sendTime:c,canIncludeExpansion:u,messageUId:s,content:e},[4,r.modifyMessage(h)];case 1:return(f=g.sent().code)===Ed.SUCCESS?[2,{code:Ed.SUCCESS}]:(o.warn(Dd.O,"modify ultraGroup message   ->".concat(f,":").concat(iD[f])),[2,{code:f,msg:iD[f]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.onceEventListener=function(e,t,n){WP.once(e,t,n)},e.quitChatRoom=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("targetId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i;return ic(this,(function(s){switch(s.label){case 0:return t=r.createTraceId(),r.info(Dd.A_QUIT_CHATROOM_T,JSON.stringify({chatroomId:e}),t),[4,n.quitChatroom(e)];case 1:return o=s.sent(),i=o===Ed.SUCCESS?"info":"warn",r[i](Dd.A_QUIT_CHATROOM_R,JSON.stringify({code:o}),t),o!==Ed.SUCCESS?[2,{code:o,msg:iD[o]}]:[2,{code:o}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.recallMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("options.messageUId",t.messageUId,Jh.STRING,!0)&&hf("options.sentTime",t.sentTime,Jh.NUMBER,!0)&&hf("options.disableNotification",null==t?void 0:t.disableNotification,Jh.BOOLEAN)&&hf("options.pushConfig",null==t?void 0:t.pushConfig,Jh.OBJECT)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n={user:t.user,channelId:e.channelId||"",disableNotification:null==t?void 0:t.disableNotification,pushConfig:null==t?void 0:t.pushConfig,extra:t.extra,isDelete:t.isDelete},i="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId,",messageUId:").concat(t.messageUId),o.debug(Dd.O,"recall message ->".concat(i)),[4,r.recallMessage(e.conversationType,e.targetId,t.messageUId,t.sentTime,n)];case 1:return s=u.sent(),a=s.code,c=s.data,a===Ed.SUCCESS&&c?[2,{code:a,data:YP(c)}]:a===Ed.SUCCESS?[2,{code:a}]:(o.warn(Dd.O,"recall message fail ->".concat(a,":").concat(iD[a],",").concat(i)),[2,{code:a,msg:iD[a]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.registerMessageType=function(e,t,n,r,o){return tD((function(i,s){return lf("messageType",e,Jh.STRING,!0),lf("isPersited",t,Jh.BOOLEAN,!0),lf("isCounted",n,Jh.BOOLEAN,!0),lf("isStatusMessage",o,Jh.BOOLEAN,!1),lf("searchProps",r,Jh.ARRAY),s.info(Dd.A_REGTYP_O,JSON.stringify({messageType:e,isCounted:n,isStatusMessage:o,isPersited:t})),i.registerMessageType(e,t,n,r,o),fD(e,t,n)}))},e.removeAllExpansionForUltraGroupMessage=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("message",e,Jh.OBJECT,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o,i,s,a,c,u,d,l;return ic(this,(function(h){switch(h.label){case 0:return t=e.conversationType,o=e.targetId,i=e.messageUId,s=e.sentTime,a=e.canIncludeExpansion,c=e.channelId,u="conversationType:".concat(t,",targetId:").concat(o,",channelId:").concat(c,",messageUId:").concat(i),r.debug(Dd.O,"remove all expansion for ultraGroup message ->".concat(u)),d={targetId:o,channelId:c,conversationType:t,sendTime:s,canIncludeExpansion:a,messageUId:i,removeAll:!0},[4,n.expandUltraMessage(d)];case 1:return(l=h.sent().code)===Ed.SUCCESS?[2,{code:Ed.SUCCESS}]:(r.warn(Dd.O,"remove all expansion for ultraGroup message   ->".concat(l,":").concat(iD[l])),[2,{code:l,msg:iD[l]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeChatRoomEntries=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&function(e){return e.entries.every((function(e){return hf("key",e,Jh.STRING,!0)}))&&hf("options.notificationExtra",e.notificationExtra,Jh.STRING)}(t)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return n="id:".concat(e),o.info(Dd.O,"remove chatroom entry->".concat(n)),(i=rc({},t)).entries=t.entries.map((function(e){return{key:e}})),[4,r.removeChatroomEntries(e,i)];case 1:return s=u.sent(),a=s.code,c=s.data,a!==Ed.SUCCESS?(o.warn(Dd.O,"remove chatroom entry fail ->code+:".concat(iD[a],",").concat(n)),[2,{code:a,msg:iD[a],data:c}]):[2,{code:a}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeChatRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&lD(t)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"remove chatroom entry->".concat(n)),[4,r.removeChatroomEntry(e,t)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"remove chatroom entry fail ->code+:".concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeConversation=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t,o;return ic(this,(function(i){switch(i.label){case 0:return[4,n.removeConversation(e.conversationType,e.targetId,e.channelId)];case 1:return t=i.sent(),o="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),r.debug(Dd.O,"destroy conversation ->".concat(o)),t!==Ed.SUCCESS?(r.warn(Dd.O,"destroy conversation fail ->".concat(t,":").concat(iD[t],",").concat(o)),[2,{code:t,msg:iD[t]}]):[2,{code:t}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeConversationsFromTag=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("tagId",e,Jh.STRING,!0)&&hf("conversations",t,Jh.ARRAY,!0)&&!t.some((function(e){return!hf("conversation",e,Jh.CONVERSATION,!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n;return ic(this,(function(i){switch(i.label){case 0:return o.info(Dd.O,"removeTagForConversations ->tagId:".concat(e)),[4,r.removeTagForConversations(e,t)];case 1:return(n=i.sent().code)===Ed.SUCCESS?[2,{code:n}]:(o.warn(Dd.O,"removeTagForConversations ->code:".concat(n,",tagId:").concat(e)),[2,{code:n,msg:iD[n]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeEventListener=function(e,t,n){WP.off(e,t,n)},e.removeEventListeners=function(e){WP.removeAll(e)},e.removeExpansionForUltraGroupMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("expansion",e,Jh.ARRAY,!0)&&hf("message",t,Jh.OBJECT,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h;return ic(this,(function(f){switch(f.label){case 0:return n=t.conversationType,i=t.targetId,s=t.messageUId,a=t.sentTime,c=t.canIncludeExpansion,u=t.channelId,d="conversationType:".concat(n,",targetId:").concat(i,",channelId:").concat(u,",messageUId:").concat(s),o.debug(Dd.O,"remove expansion for ultragroup message  ->".concat(d)),l={targetId:i,channelId:u,conversationType:n,sendTime:a,canIncludeExpansion:c,messageUId:s,keys:e},[4,r.expandUltraMessage(l)];case 1:return(h=f.sent().code)===Ed.SUCCESS?[2,{code:Ed.SUCCESS}]:(o.warn(Dd.O,"remove expansion for ultraGroup message   ->".concat(h,":").concat(iD[h])),[2,{code:h,msg:iD[h]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeFromBlacklist=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("userId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){return ic(this,(function(t){switch(t.label){case 0:return r.info(Dd.O,"removeFromBlacklist -> userId: ".concat(e)),[4,n.removeFromBlacklist(e)];case 1:return[2,{code:t.sent()}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeMessageExpansionForKey=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("keys",e,Jh.ARRAY,!0)&&hf("message",t,Jh.OBJECT,!0)&&hf("message.conversationType",t.conversationType,Jh.NUMBER,!0)&&hf("message.targetId",t.targetId,Jh.STRING,!0)&&hf("message.channelId",t.channelId,Jh.CHANNEL_ID)&&hf("message.messageUId",t.messageUId,Jh.STRING,!0)&&hf("message.canIncludeExpansion",t.canIncludeExpansion,Jh.BOOLEAN,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d;return ic(this,(function(l){switch(l.label){case 0:return n=t.conversationType,i=t.targetId,s=t.messageUId,a=t.canIncludeExpansion,c=t.channelId,u="conversationType:".concat(n,",targetId:").concat(i,",messageUId:").concat(s),o.debug(Dd.O,"remove message expansion ->".concat(u)),[4,r.sendExpansionMessage({conversationType:n,targetId:i,messageUId:s,canIncludeExpansion:a,keys:e,channelId:c})];case 1:return(d=l.sent().code)!==Ed.SUCCESS?(o.warn(Dd.O,"remove message expansion fail ->".concat(d,":").concat(iD[d],",").concat(u)),[2,{code:d,msg:iD[d]}]):[2,{code:d}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeTag=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("tagId",e,Jh.STRING,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(o){switch(o.label){case 0:return r.info(Dd.O,"removeTag ->tagId:".concat(e)),[4,n.removeTag(e)];case 1:return(t=o.sent().code)===Ed.SUCCESS?[2,{code:t}]:(r.warn(Dd.O,"removeTag ->code:".concat(t,",tagId:").concat(e)),[2,{code:t,msg:iD[t]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeTagFromConversations=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("tagId",e,Jh.STRING,!0)&&hf("conversations",t,Jh.ARRAY,!0)&&!t.some((function(e){return!hf("conversation",e,Jh.CONVERSATION,!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n;return ic(this,(function(i){switch(i.label){case 0:return o.info(Dd.O,"removeTagForConversations ->tagId:".concat(e)),[4,r.removeTagForConversations(e,t)];case 1:return(n=i.sent().code)===Ed.SUCCESS?[2,{code:n}]:(o.warn(Dd.O,"removeTagForConversations ->code:".concat(n,",tagId:").concat(e)),[2,{code:n,msg:iD[n]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.removeTagsFromConversation=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("tagIds",t,Jh.ARRAY,!0)&&!t.some((function(e){return!hf("tagId",e,Jh.STRING,!0)}))?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n;return ic(this,(function(i){switch(i.label){case 0:return o.info(Dd.O,"removeTagsForConversation ->tagIds:".concat(t,",targetId:").concat(e.targetId,",conversationType:").concat(e.conversationType)),[4,r.removeTagsForConversation(e,t)];case 1:return(n=i.sent().code)===Ed.SUCCESS?[2,{code:n}]:(o.warn(Dd.O,"removeTagsForConversation ->code:".concat(n,",tagIds:").concat(t)),[2,{code:n,msg:iD[n]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.saveTextMessageDraft=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options",e,Jh.CONVERSATION,!0)&&hf("draft",t,Jh.STRING,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),o.debug(Dd.O,"set draft ->".concat(n)),[4,r.saveConversationMessageDraft(e.conversationType,e.targetId,t,e.channelId)];case 1:return(i=s.sent())===Ed.SUCCESS?[2,{code:i}]:(o.warn(Dd.O,"set draft fail ->".concat(i,":").concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.searchConversationByContent=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return QP("RongIMLib.searchConversationByContent","RongIMLib.ElectronExtension.searchConversationByContent"),wE()?[2,nD((function(i,s){return oc(o,void 0,void 0,(function(){var o,a,c;return ic(this,(function(u){switch(u.label){case 0:return s.info(Dd.O,"searchConversationByContent ->keyword:".concat(e)),[4,i.searchConversationByContent(e,n,r,t)];case 1:return o=u.sent(),a=o.code,c=o.data,a===Ed.SUCCESS?[2,{code:a,data:c}]:(s.warn(Dd.O,"searchConversationByContent ->code:".concat(a,",keyword:").concat(e)),[2,{code:a,msg:iD[a]}])}}))}))}))]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.searchMessages=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return QP("RongIMLib.searchMessages","RongIMLib.ElectronExtension.searchMessages"),wE()?hf("conversation",e,Jh.CONVERSATION,!0)&&hf("keyword",t,Jh.STRING,!0)&&hf("timestamp",n,Jh.NUMBER)&&hf("count",r,Jh.NUMBER)?[2,nD((function(i,s){return oc(o,void 0,void 0,(function(){var o,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return 1,[4,i.searchMessageByContent(e.conversationType,e.targetId,t,n,r,1,e.channelId)];case 1:return o=d.sent(),a=o.code,c=o.data,a===Ed.SUCCESS?(u=[],(null==c?void 0:c.messages)&&c.messages.length&&c.messages.forEach((function(e){return u.push(YP(e))})),[2,{code:a,data:{messages:u,count:null==c?void 0:c.count}}]):(s.warn(Dd.O,"searchMessages ->code:".concat(a,",targetId:").concat(e.targetId)),[2,{code:a,msg:iD[a]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.sendFileMessage=qG,e.sendHQVoiceMessage=jG,e.sendImageMessage=KG,e.sendMessage=FG,e.sendReadReceiptMessage=function(e,t,n,r){return oc(this,void 0,void 0,(function(){var o=this;return ic(this,(function(i){return hf("targetId",e,Jh.STRING,!0)&&hf("messageUId",t,Jh.STRING,!0)&&hf("timestamp",n,Jh.NUMBER,!0)&&hf("channelId",r,Jh.CHANNEL_ID)?[2,nD((function(i){return oc(o,void 0,void 0,(function(){var o,i,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return o={targetId:e,conversationType:Td.PRIVATE,channelId:r},i=new hD("RC:ReadNtf",{messageUId:t,lastMessageSendTime:n,type:1}),[4,FG(o,i)];case 1:return s=u.sent(),a=s.code,c=s.msg,0===a?[2,{code:a}]:[2,{code:a,msg:c}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.sendReadReceiptRequest=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return hf("messageUId",t,Jh.STRING,!0)&&hf("targetId",e,Jh.STRING,!0)&&hf("channelId",n,Jh.CHANNEL_ID)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,o,s,a,c;return ic(this,(function(u){switch(u.label){case 0:return r="messageUId:".concat(t,",targetId:").concat(e),i.debug(Dd.O,"send read receipt message ->".concat(r)),o=new hD("RC:RRReqMsg",{messageUId:t}),[4,FG({targetId:e,conversationType:Td.GROUP,channelId:n},o)];case 1:return s=u.sent(),a=s.code,c=s.msg,0===a?[2,{code:a}]:[2,{code:a,msg:c}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.sendReadReceiptResponse=function(e,t,n){return oc(this,void 0,void 0,(function(){return ic(this,(function(e){throw new Error("This method is deprecated, please use method sendReadReceiptResponseV2.")}))}))},e.sendReadReceiptResponseV2=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return hf("targetId",e,Jh.STRING,!0)&&hf("messageList",t,Jh.OBJECT,!0)&&hf("channelId",n,Jh.CHANNEL_ID)&&!Object.keys(t).some((function(e){return!hf(e,t[e],Jh.ARRAY)}))?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r,s,a,c,u,d,l;return ic(this,(function(h){switch(h.label){case 0:return r={targetId:e,conversationType:Td.GROUP,channelId:n},a=o.getNaviInfoFromCache(),0!==(c=(null==a?void 0:a.grpRRVer)||0)?[3,2]:(u=new hD("RC:RRRspMsg",{receiptMessageDic:t}),[4,FG(r,u)]);case 1:return s=h.sent(),[3,4];case 2:return 1!==c?[3,4]:(d=[],Object.keys(t).forEach((function(e){t[e].forEach((function(e){-1===d.indexOf(e)&&d.push(e)}))})),d.length?[4,o.sendReadReceiptMessage(e,d,n)]:(i.warn(Dd.O,"Error in parameter messageList."),[2,{code:Ed.PARAMETER_ERROR}]));case 3:s=h.sent(),h.label=4;case 4:return(l=s.code)===Ed.SUCCESS?[2,{code:l}]:(i.warn(Dd.O,"send read receipt message fail ->".concat(l,":").concat(iD[l])),[2,{code:l,msg:iD[l]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.sendSightMessage=YG,e.sendSyncReadStatusMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n,r,o,i;return ic(this,(function(s){switch(s.label){case 0:return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("lastMessageSendTime",t,Jh.NUMBER,!0)?(n=new hD("RC:SRSMsg",{lastMessageSendTime:t}),[4,FG(e,n)]):[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}];case 1:return r=s.sent(),o=r.code,i=r.msg,0===o?[2,{code:o}]:[2,{code:o,msg:i}]}}))}))},e.sendTextMessage=function(e,t,n){return FG(e,new _D(t),n)},e.sendTypingStatusMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("conversation",e,Jh.CONVERSATION,!0)&&hf("typingContentType",t,Jh.STRING,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u;return ic(this,(function(d){switch(d.label){case 0:return n={messageType:"RC:TypSts",content:{typingContentType:t},isStatusMessage:!0,channelId:e.channelId},i=o.createTraceId(),o.info(Dd.A_SEND_MSG_T,JSON.stringify({messageType:n.messageType,conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId}),i),[4,r.sendMessage(e.conversationType,e.targetId,n,void 0,i)];case 1:return s=d.sent(),a=s.code,c=s.data,u=a===Ed.SUCCESS?"info":"warn",o[u](Dd.A_SEND_MSG_R,JSON.stringify({code:a,messageUId:c?c.messageUId:"",messageId:c?c.messageId:""}),i),a===Ed.SUCCESS?[2,{code:a,data:YP(c)}]:[2,{code:a,msg:iD[a]}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.sendUltraGroupTypingStatus=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(o){switch(o.label){case 0:return[4,n.sendUltraGroupTypingStatus(e)];case 1:return(t=o.sent().code)===Ed.SUCCESS?[2,{code:Ed.SUCCESS}]:(r.warn(Dd.O,"send ultraGroup OperateStatus   ->".concat(t,":").concat(iD[t])),[2,{code:t,msg:iD[t]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setChatRoomEntries=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&function(e){return e.entries.every((function(e){return hf("entry.key",e.key,Jh.STRING,!0)&&hf("entry.value",e.value,Jh.STRING,!0)}))&&hf("options.isAutoDelete",e.isAutoDelete,Jh.BOOLEAN)&&hf("options.notificationExtra",e.notificationExtra,Jh.STRING)&&hf("options.isForce",e.isForce,Jh.BOOLEAN)}(t)?t.entries.length>10?[2,oD.CHATROOM_KV_STORE_OUT_LIMIT]:[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a;return ic(this,(function(c){switch(c.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"set chatroom entry->".concat(n)),[4,r.setChatroomEntries(e,t)];case 1:return i=c.sent(),s=i.code,a=i.data,s!==Ed.SUCCESS?(o.warn(Dd.O,"set chatroom entry fail ->code+:".concat(iD[s],",").concat(n)),[2,{code:s,msg:iD[s],data:a}]):[2,{code:s}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setChatRoomEntry=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("targetId",e,Jh.STRING,!0)&&dD(t)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="id:".concat(e),o.debug(Dd.O,"set chatroom entry->".concat(n)),[4,r.setChatroomEntry(e,t)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"set chatroom entry fail ->code+:".concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setConversationNotificationLevel=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return hf("notificationLevel",t,(function(e){return void 0!==Ad[e]}),!0)&&hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return uD(r,e,(function(){return n.setConversationNotificationLevel(e.conversationType,e.targetId,t,e.channelId)}),"setConversationNotificationLevel")}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setConversationNotificationStatus=function(e,t){return oc(this,void 0,void 0,(function(){return ic(this,(function(n){return hf("notificationStatus",t,(function(e){return 1===e||2===e}),!0)&&hf("options",e,Jh.CONVERSATION,!0)?[2,nD((function(n,r){return uD(r,e,(function(){return n.setConversationStatus(e.conversationType,e.targetId,void 0,t,e.channelId)}),"setConversationNotificationStatus")}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setConversationToTop=function(e,t){return void 0===t&&(t=!0),oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("options",e,Jh.CONVERSATION,!0)&&hf("isTop",t,Jh.BOOLEAN)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i;return ic(this,(function(s){switch(s.label){case 0:return n="conversationType:".concat(e.conversationType,",targetId:").concat(e.targetId),o.debug(Dd.O,"set conversation status ->".concat(n)),[4,r.setConversationStatus(e.conversationType,e.targetId,t,void 0,e.channelId)];case 1:return(i=s.sent())!==Ed.SUCCESS?(o.warn(Dd.O,"set conversation status fail ->".concat(i,":").concat(iD[i],",").concat(n)),[2,{code:i,msg:iD[i]}]):[2,{code:i}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setConversationToTopInTag=function(e,t,n){return oc(this,void 0,void 0,(function(){var r=this;return ic(this,(function(o){return hf("tagId",e,Jh.STRING,!0)&&hf("conversation",t,Jh.CONVERSATION,!0)&&hf("status.isTop",n,Jh.BOOLEAN,!0)?[2,nD((function(o,i){return oc(r,void 0,void 0,(function(){var r;return ic(this,(function(s){switch(s.label){case 0:return i.info(Dd.O,"setConversationStatusInTag ->tagId:".concat(e,",targetId:").concat(t.targetId,",conversationType").concat(t.conversationType)),[4,o.setConversationStatusInTag(e,t,{isTop:n})];case 1:return(r=s.sent().code)===Ed.SUCCESS?[2,{code:r}]:(i.warn(Dd.O,"setConversationStatusInTag ->code:".concat(r,",tagId:").concat(e)),[2,{code:r,msg:iD[r]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setMessageReceivedStatus=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return QP("RongIMLib.setMessageReceivedStatus","RongIMLib.ElectronExtension.setMessageReceivedStatus"),wE()?hf("messageId",e,Jh.NUMBER,!0)&&hf("receivedStatus",t,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n;return ic(this,(function(i){switch(i.label){case 0:return o.info(Dd.O,"setMessageReceivedStatus ->messageId:".concat(e,",receivedStatus:").concat(t)),[4,r.setMessageReceivedStatus(e,t)];case 1:return(n=i.sent())===Ed.SUCCESS?[2,{code:n}]:(o.warn(Dd.O,"setMessageReceivedStatus ->code:".concat(n,",messageId:").concat(e)),[2,{code:n,msg:iD[n]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]:[2,{code:Ed.NOT_SUPPORT,msg:iD[Ed.NOT_SUPPORT]}]}))}))},e.setProxy=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return!e||hf("proxy.socksHost",e.socksHost,Jh.STRING,!0)&&hf("proxy.socksPort",e.socksPort,Jh.NUMBER,!0)?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(o){switch(o.label){case 0:return r.info(Dd.O,"setProxy: ->".concat(e)),[4,n.setProxy(e)];case 1:return(t=o.sent().code)===Ed.SUCCESS?[2,{code:t}]:(r.warn(Dd.O,"setProxy ->code:".concat(t)),[2,{code:t,msg:iD[t]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.setUltraGroupDefaultNotificationLevel=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return e.channelId=e.channelId||"",hf("options.targetId",e.targetId,Jh.STRING,!0)&&hf("options.channelId",e.channelId,Jh.CHANNEL_ID,!0)&&hf("notificationLevel",t,(function(e){return void 0!==Ad[e]}),!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return n="setUltraGroupDefaultNotificationLevel",i="targetId: ".concat(e.targetId,", channelId: ").concat(e.channelId),o.debug(Dd.O,"".concat(n," -> ").concat(i)),[4,r.setUltraGroupDefaultNotificationLevel(e.targetId,t,e.channelId)];case 1:return(s=a.sent().code)===Ed.SUCCESS?[2,{code:s}]:(o.warn(Dd.O,"".concat(n," fail -> ").concat(s," : ").concat(iD[s]," , ").concat(i)),[2,{code:s,msg:iD[s]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.testProxy=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return!e||hf("proxy.socksHost",e.socksHost,Jh.STRING,!0)&&hf("proxy.socksPort",e.socksPort,Jh.NUMBER,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s;return ic(this,(function(a){switch(a.label){case 0:return o.info(Dd.O,"testProxy: ->".concat(e)),[4,r.testProxy(e,t)];case 1:return n=a.sent(),i=n.status,s=n.data,i===Ed.SUCCESS?[2,{code:i,msg:s}]:(o.warn(Dd.O,"testProxy ->code:".concat(i)),[2,{code:i,msg:iD[i]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.updateExpansionForUltraGroupMessage=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("expansion",e,Jh.OBJECT,!0)&&hf("message",t,Jh.OBJECT,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l,h;return ic(this,(function(f){switch(f.label){case 0:return n=t.conversationType,i=t.targetId,s=t.messageUId,a=t.sentTime,c=t.canIncludeExpansion,u=t.channelId,d="conversationType:".concat(n,",targetId:").concat(i,",channelId:").concat(u,",messageUId:").concat(s),o.debug(Dd.O,"update expansion for ultragroup message  ->".concat(d)),l={targetId:i,channelId:u,conversationType:n,sendTime:a,canIncludeExpansion:c,messageUId:s,expansion:e},[4,r.expandUltraMessage(l)];case 1:return(h=f.sent().code)===Ed.SUCCESS?[2,{code:Ed.SUCCESS}]:(o.warn(Dd.O,"update expansion for ultragroup message   ->".concat(h,":").concat(iD[h])),[2,{code:h,msg:iD[h]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.updateMessageExpansion=function(e,t){return oc(this,void 0,void 0,(function(){var n=this;return ic(this,(function(r){return hf("expansion",e,Jh.OBJECT,!0)&&hf("message",t,Jh.OBJECT,!0)&&hf("message.conversationType",t.conversationType,Jh.NUMBER,!0)&&hf("message.targetId",t.targetId,Jh.STRING,!0)&&hf("message.channelId",t.channelId,Jh.CHANNEL_ID)&&hf("message.messageUId",t.messageUId,Jh.STRING,!0)&&hf("message.expansion",t.expansion,Jh.OBJECT)&&hf("message.canIncludeExpansion",t.canIncludeExpansion,Jh.BOOLEAN,!0)?[2,nD((function(r,o){return oc(n,void 0,void 0,(function(){var n,i,s,a,c,u,d,l;return ic(this,(function(h){switch(h.label){case 0:return n=t.conversationType,i=t.targetId,s=t.messageUId,a=t.canIncludeExpansion,c=t.expansion,u=t.channelId,d="conversationType:".concat(n,",targetId:").concat(i,",messageUId:").concat(s),o.debug(Dd.O,"update message expansion ->".concat(d)),[4,r.sendExpansionMessage({conversationType:n,targetId:i,messageUId:s,expansion:e,canIncludeExpansion:a,originExpansion:c,channelId:u})];case 1:return(l=h.sent().code)!==Ed.SUCCESS?(o.warn(Dd.O,"update message expansion fail ->".concat(l,":").concat(iD[l],",").concat(d)),[2,{code:l,msg:iD[l]}]):[2,{code:l}]}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},e.updateTag=function(e){return oc(this,void 0,void 0,(function(){var t=this;return ic(this,(function(n){return hf("tag.tagId",e.tagId,Jh.STRING,!0)&&hf("tag.tagName",e.tagName,Jh.STRING,!0)&&hf("tag.tagName",e.tagName,(function(e){return e.length<=15}))?[2,nD((function(n,r){return oc(t,void 0,void 0,(function(){var t;return ic(this,(function(o){switch(o.label){case 0:return r.info(Dd.O,"updateTag ->tagId:".concat(e.tagId,",tagName:").concat(e.tagName)),[4,n.updateTag(e)];case 1:return(t=o.sent().code)===Ed.SUCCESS?[2,{code:t}]:(r.warn(Dd.O,"updateTag ->code:".concat(t,",tagId:").concat(e.tagId)),[2,{code:t,msg:iD[t]}])}}))}))}))]:[2,{code:Ed.BIZ_ERROR_INVALID_PARAMETER}]}))}))},Object.defineProperty(e,"__esModule",{value:!0})}));
